240f9e302a1122d9d5c0035bf34ffe7b
"use strict";
/**
 * Unit Tests for SessionProfiler
 *
 * Tests session identification, Asian range storage, Judas Swing detection,
 * killzone checking, and session transition events.
 *
 * Requirements: 2.1-2.7 (Session Profiler)
 */
Object.defineProperty(exports, "__esModule", { value: true });
const SessionProfiler_1 = require("../../src/engine/SessionProfiler");
describe('SessionProfiler', () => {
    let profiler;
    let originalDate;
    beforeEach(() => {
        profiler = new SessionProfiler_1.SessionProfiler();
        originalDate = global.Date;
    });
    afterEach(() => {
        global.Date = originalDate;
    });
    // Helper function to mock UTC time
    const mockUTCTime = (hour, minute = 0) => {
        const mockDate = new Date();
        mockDate.getUTCHours = jest.fn().mockReturnValue(hour);
        mockDate.getUTCMinutes = jest.fn().mockReturnValue(minute);
        // Create a mock Date constructor that handles both no-args and timestamp args
        const MockDate = jest.fn((timestamp) => {
            if (timestamp !== undefined) {
                // If timestamp is provided, use the original Date constructor
                return new originalDate(timestamp);
            }
            // If no timestamp, return the mocked date for current time
            return mockDate;
        });
        // Preserve static methods
        MockDate.now = originalDate.now;
        MockDate.UTC = originalDate.UTC;
        MockDate.parse = originalDate.parse;
        global.Date = MockDate;
    };
    // Helper function to create OHLCV data
    const createOHLCV = (timestamp, high, low) => ({
        timestamp,
        open: (high + low) / 2,
        high,
        low,
        close: (high + low) / 2,
        volume: 1000
    });
    describe('getSessionState', () => {
        it('should identify Asian session (00:00-06:00 UTC)', () => {
            mockUTCTime(3, 30); // 03:30 UTC
            const sessionState = profiler.getSessionState();
            expect(sessionState.type).toBe('ASIAN');
            expect(sessionState.startTime).toBe(0);
            expect(sessionState.endTime).toBe(6);
            expect(sessionState.timeRemaining).toBe(2.5); // 6 - 3.5
        });
        it('should identify London session (07:00-10:00 UTC)', () => {
            mockUTCTime(8, 15); // 08:15 UTC
            const sessionState = profiler.getSessionState();
            expect(sessionState.type).toBe('LONDON');
            expect(sessionState.startTime).toBe(7);
            expect(sessionState.endTime).toBe(10);
            expect(sessionState.timeRemaining).toBe(1.75); // 10 - 8.25
        });
        it('should identify NY session (13:00-16:00 UTC)', () => {
            mockUTCTime(14, 45); // 14:45 UTC
            const sessionState = profiler.getSessionState();
            expect(sessionState.type).toBe('NY');
            expect(sessionState.startTime).toBe(13);
            expect(sessionState.endTime).toBe(16);
            expect(sessionState.timeRemaining).toBe(1.25); // 16 - 14.75
        });
        it('should identify Dead Zone (21:00-01:00 UTC)', () => {
            mockUTCTime(23, 0); // 23:00 UTC
            const sessionState = profiler.getSessionState();
            expect(sessionState.type).toBe('DEAD_ZONE');
            expect(sessionState.startTime).toBe(21);
            expect(sessionState.endTime).toBe(1);
            expect(sessionState.timeRemaining).toBe(2); // (24 - 23) + 1
        });
        it('should identify Dead Zone early morning (00:30 UTC)', () => {
            mockUTCTime(0, 30); // 00:30 UTC (but not Asian session)
            // Mock to return DEAD_ZONE for this specific time
            const sessionState = profiler.getSessionState();
            // At 00:30, it should be Asian session, not Dead Zone
            expect(sessionState.type).toBe('ASIAN');
        });
        it('should handle Dead Zone early morning correctly', () => {
            mockUTCTime(22, 30); // 22:30 UTC (Dead Zone)
            const sessionState = profiler.getSessionState();
            expect(sessionState.type).toBe('DEAD_ZONE');
            expect(sessionState.timeRemaining).toBe(2.5); // (24 - 22.5) + 1
        });
    });
    describe('storeAsianRange', () => {
        it('should store Asian range from OHLCV data', () => {
            const asianData = [
                createOHLCV(new Date('2024-01-01T02:00:00Z').getTime(), 50100, 49900), // Asian session
                createOHLCV(new Date('2024-01-01T04:00:00Z').getTime(), 50200, 49800), // Asian session
                createOHLCV(new Date('2024-01-01T08:00:00Z').getTime(), 50300, 49700), // London session (should be ignored)
            ];
            profiler.storeAsianRange(asianData);
            const asianRange = profiler.getAsianRange();
            expect(asianRange).not.toBeNull();
            expect(asianRange.high).toBe(50200); // Highest during Asian session
            expect(asianRange.low).toBe(49800); // Lowest during Asian session
        });
        it('should handle empty OHLCV data', () => {
            profiler.storeAsianRange([]);
            const asianRange = profiler.getAsianRange();
            expect(asianRange).toBeNull();
        });
        it('should ignore non-Asian session data', () => {
            const nonAsianData = [
                createOHLCV(new Date('2024-01-01T08:00:00Z').getTime(), 50300, 49700), // London
                createOHLCV(new Date('2024-01-01T14:00:00Z').getTime(), 50400, 49600), // NY
            ];
            profiler.storeAsianRange(nonAsianData);
            const asianRange = profiler.getAsianRange();
            expect(asianRange).toBeNull();
        });
    });
    describe('detectJudasSwing', () => {
        beforeEach(() => {
            // Set up Asian range for testing
            const asianData = [
                createOHLCV(new Date('2024-01-01T02:00:00Z').getTime(), 50100, 49900),
            ];
            profiler.storeAsianRange(asianData);
        });
        it('should detect Asian High sweep during London session', () => {
            const currentPrice = 50150; // Above Asian High (50100)
            const judasSwing = profiler.detectJudasSwing(currentPrice, 'LONDON');
            expect(judasSwing).not.toBeNull();
            expect(judasSwing.type).toBe('SWEEP_HIGH');
            expect(judasSwing.sweptPrice).toBe(50100);
            expect(judasSwing.reversalPrice).toBe(49900);
            expect(judasSwing.direction).toBe('SHORT');
            expect(judasSwing.confidence).toBe(75);
        });
        it('should detect Asian Low sweep during London session', () => {
            const currentPrice = 49850; // Below Asian Low (49900)
            const judasSwing = profiler.detectJudasSwing(currentPrice, 'LONDON');
            expect(judasSwing).not.toBeNull();
            expect(judasSwing.type).toBe('SWEEP_LOW');
            expect(judasSwing.sweptPrice).toBe(49900);
            expect(judasSwing.reversalPrice).toBe(50100);
            expect(judasSwing.direction).toBe('LONG');
            expect(judasSwing.confidence).toBe(75);
        });
        it('should not detect Judas Swing when price is within Asian range', () => {
            const currentPrice = 50000; // Within Asian range
            const judasSwing = profiler.detectJudasSwing(currentPrice, 'LONDON');
            expect(judasSwing).toBeNull();
        });
        it('should not detect Judas Swing during Asian session', () => {
            const currentPrice = 50150; // Above Asian High
            const judasSwing = profiler.detectJudasSwing(currentPrice, 'ASIAN');
            expect(judasSwing).toBeNull();
        });
        it('should detect London range sweep during NY session', () => {
            // Set up London range
            const londonData = [
                createOHLCV(new Date('2024-01-01T08:00:00Z').getTime(), 50300, 49700),
            ];
            profiler.updateLondonRange(londonData);
            const currentPrice = 50350; // Above London High
            const judasSwing = profiler.detectJudasSwing(currentPrice, 'NY');
            expect(judasSwing).not.toBeNull();
            expect(judasSwing.type).toBe('SWEEP_HIGH');
            expect(judasSwing.sweptPrice).toBe(50300);
            expect(judasSwing.direction).toBe('SHORT');
            expect(judasSwing.confidence).toBe(80); // Higher confidence for NY
        });
    });
    describe('isKillzone', () => {
        it('should return true during London session', () => {
            mockUTCTime(8, 30); // London session
            const isKillzone = profiler.isKillzone();
            expect(isKillzone).toBe(true);
        });
        it('should return true during NY session', () => {
            mockUTCTime(14, 30); // NY session
            const isKillzone = profiler.isKillzone();
            expect(isKillzone).toBe(true);
        });
        it('should return false during Asian session', () => {
            mockUTCTime(3, 30); // Asian session
            const isKillzone = profiler.isKillzone();
            expect(isKillzone).toBe(false);
        });
        it('should return false during Dead Zone', () => {
            mockUTCTime(22, 30); // Dead Zone
            const isKillzone = profiler.isKillzone();
            expect(isKillzone).toBe(false);
        });
    });
    describe('shouldDisableNewEntries', () => {
        it('should return true during Dead Zone', () => {
            mockUTCTime(22, 30); // Dead Zone
            const shouldDisable = profiler.shouldDisableNewEntries();
            expect(shouldDisable).toBe(true);
        });
        it('should return false during killzones', () => {
            mockUTCTime(8, 30); // London session
            const shouldDisable = profiler.shouldDisableNewEntries();
            expect(shouldDisable).toBe(false);
        });
    });
    describe('updateLondonRange', () => {
        it('should store London range from OHLCV data', () => {
            const londonData = [
                createOHLCV(new Date('2024-01-01T08:00:00Z').getTime(), 50300, 49700), // London session
                createOHLCV(new Date('2024-01-01T09:00:00Z').getTime(), 50250, 49750), // London session
                createOHLCV(new Date('2024-01-01T14:00:00Z').getTime(), 50400, 49600), // NY session (should be ignored)
            ];
            profiler.updateLondonRange(londonData);
            const londonRange = profiler.getLondonRange();
            expect(londonRange).not.toBeNull();
            expect(londonRange.high).toBe(50300); // Highest during London session
            expect(londonRange.low).toBe(49700); // Lowest during London session
        });
        it('should ignore non-London session data', () => {
            const nonLondonData = [
                createOHLCV(new Date('2024-01-01T02:00:00Z').getTime(), 50100, 49900), // Asian
                createOHLCV(new Date('2024-01-01T14:00:00Z').getTime(), 50400, 49600), // NY
            ];
            profiler.updateLondonRange(nonLondonData);
            const londonRange = profiler.getLondonRange();
            expect(londonRange).toBeNull();
        });
    });
    describe('session transition events', () => {
        it('should emit SESSION_CHANGE event on session transition', (done) => {
            mockUTCTime(8, 0); // London session
            // First call to establish current session
            profiler.getSessionState();
            // Set up event listener
            profiler.once('SESSION_CHANGE', (event) => {
                expect(event.previousSession).toBe('LONDON');
                expect(event.newSession).toBe('NY');
                expect(event.timestamp).toBeGreaterThan(0);
                done();
            });
            // Change to NY session
            mockUTCTime(14, 0);
            profiler.getSessionState();
        });
        it('should emit LONDON_OPEN event when transitioning to London', (done) => {
            mockUTCTime(5, 0); // Asian session
            profiler.getSessionState();
            profiler.once('LONDON_OPEN', (event) => {
                expect(event.timestamp).toBeGreaterThan(0);
                done();
            });
            // Transition to London
            mockUTCTime(8, 0);
            profiler.getSessionState();
        });
        it('should emit NY_OPEN event when transitioning to NY', (done) => {
            mockUTCTime(8, 0); // London session
            profiler.getSessionState();
            profiler.once('NY_OPEN', (event) => {
                expect(event.timestamp).toBeGreaterThan(0);
                done();
            });
            // Transition to NY
            mockUTCTime(14, 0);
            profiler.getSessionState();
        });
        it('should emit DEAD_ZONE_START event when transitioning to Dead Zone', (done) => {
            mockUTCTime(15, 0); // NY session
            profiler.getSessionState();
            profiler.once('DEAD_ZONE_START', (event) => {
                expect(event.timestamp).toBeGreaterThan(0);
                done();
            });
            // Transition to Dead Zone
            mockUTCTime(22, 0);
            profiler.getSessionState();
        });
    });
    describe('getSessionStats', () => {
        it('should return comprehensive session statistics', () => {
            mockUTCTime(8, 30); // London session
            // Set up ranges - use the original Date to create proper UTC timestamps
            const timestamp2AM = originalDate.UTC(2024, 0, 1, 2, 0, 0); // January 1, 2024, 2:00 AM UTC
            const asianData = [
                createOHLCV(timestamp2AM, 50100, 49900),
            ];
            // Debug the Asian data
            expect(new originalDate(asianData[0].timestamp).getUTCHours()).toBe(2);
            profiler.storeAsianRange(asianData);
            const asianRangeAfterStore = profiler.getAsianRange();
            // This should not be null if storeAsianRange worked
            expect(asianRangeAfterStore).not.toBeNull();
            const timestamp8AM = originalDate.UTC(2024, 0, 1, 8, 0, 0); // January 1, 2024, 8:00 AM UTC
            const londonData = [
                createOHLCV(timestamp8AM, 50300, 49700),
            ];
            profiler.updateLondonRange(londonData);
            const stats = profiler.getSessionStats();
            expect(stats.currentSession).toBe('LONDON');
            expect(stats.timeRemaining).toBe(1.5); // 10 - 8.5
            expect(stats.asianRange).toEqual({
                high: 50100,
                low: 49900,
                timestamp: expect.any(Number)
            });
            expect(stats.londonRange).toEqual({
                high: 50300,
                low: 49700,
                timestamp: expect.any(Number)
            });
            expect(stats.isKillzone).toBe(true);
        });
    });
    describe('edge cases', () => {
        it('should handle session boundary correctly (exactly 06:00 UTC)', () => {
            mockUTCTime(6, 0); // Exactly 06:00 UTC
            const sessionState = profiler.getSessionState();
            // At exactly 06:00, it should not be Asian session anymore
            expect(sessionState.type).not.toBe('ASIAN');
        });
        it('should handle session boundary correctly (exactly 07:00 UTC)', () => {
            mockUTCTime(7, 0); // Exactly 07:00 UTC
            const sessionState = profiler.getSessionState();
            expect(sessionState.type).toBe('LONDON');
            expect(sessionState.timeRemaining).toBe(3); // 10 - 7
        });
        it('should handle midnight transition correctly', () => {
            mockUTCTime(0, 30); // 00:30 UTC
            const sessionState = profiler.getSessionState();
            expect(sessionState.type).toBe('ASIAN');
            expect(sessionState.timeRemaining).toBe(5.5); // 6 - 0.5
        });
        it('should not emit duplicate session change events', () => {
            mockUTCTime(8, 0); // London session
            let eventCount = 0;
            profiler.on('SESSION_CHANGE', () => {
                eventCount++;
            });
            // Multiple calls to same session should not emit multiple events
            profiler.getSessionState();
            profiler.getSessionState();
            profiler.getSessionState();
            expect(eventCount).toBe(0); // No events since no transition occurred
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2l2YW4vQ29kZS90cmFkaW5nL3RpdGFuL3NlcnZpY2VzL3RpdGFuLXBoYXNlMi1odW50ZXIvdGVzdHMvdW5pdC9TZXNzaW9uUHJvZmlsZXIudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7R0FPRzs7QUFFSCxzRUFBbUU7QUFHbkUsUUFBUSxDQUFDLGlCQUFpQixFQUFFLEdBQUcsRUFBRTtJQUMvQixJQUFJLFFBQXlCLENBQUM7SUFDOUIsSUFBSSxZQUE2QixDQUFDO0lBRWxDLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxRQUFRLEdBQUcsSUFBSSxpQ0FBZSxFQUFFLENBQUM7UUFDakMsWUFBWSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUM7SUFDN0IsQ0FBQyxDQUFDLENBQUM7SUFFSCxTQUFTLENBQUMsR0FBRyxFQUFFO1FBQ2IsTUFBTSxDQUFDLElBQUksR0FBRyxZQUFZLENBQUM7SUFDN0IsQ0FBQyxDQUFDLENBQUM7SUFFSCxtQ0FBbUM7SUFDbkMsTUFBTSxXQUFXLEdBQUcsQ0FBQyxJQUFZLEVBQUUsU0FBaUIsQ0FBQyxFQUFFLEVBQUU7UUFDdkQsTUFBTSxRQUFRLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUM1QixRQUFRLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDdkQsUUFBUSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBRTNELDhFQUE4RTtRQUM5RSxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsU0FBa0IsRUFBRSxFQUFFO1lBQzlDLElBQUksU0FBUyxLQUFLLFNBQVMsRUFBRSxDQUFDO2dCQUM1Qiw4REFBOEQ7Z0JBQzlELE9BQU8sSUFBSSxZQUFZLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDckMsQ0FBQztZQUNELDJEQUEyRDtZQUMzRCxPQUFPLFFBQVEsQ0FB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O2dCQUNqQyxVQUFVLEVBQUUsQ0FBQztZQUNmLENBQUMsQ0FBQyxDQUFDO1lBRUgsaUVBQWlFO1lBQ2pFLFFBQVEsQ0FBQyxlQUFlLEVBQUUsQ0FBQztZQUMzQixRQUFRLENBQUMsZUFBZSxFQUFFLENBQUM7WUFDM0IsUUFBUSxDQUFDLGVBQWUsRUFBRSxDQUFDO1lBRTNCLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyx5Q0FBeUM7UUFDdkUsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9pdmFuL0NvZGUvdHJhZGluZy90aXRhbi9zZXJ2aWNlcy90aXRhbi1waGFzZTItaHVudGVyL3Rlc3RzL3VuaXQvU2Vzc2lvblByb2ZpbGVyLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBVbml0IFRlc3RzIGZvciBTZXNzaW9uUHJvZmlsZXJcbiAqIFxuICogVGVzdHMgc2Vzc2lvbiBpZGVudGlmaWNhdGlvbiwgQXNpYW4gcmFuZ2Ugc3RvcmFnZSwgSnVkYXMgU3dpbmcgZGV0ZWN0aW9uLFxuICoga2lsbHpvbmUgY2hlY2tpbmcsIGFuZCBzZXNzaW9uIHRyYW5zaXRpb24gZXZlbnRzLlxuICogXG4gKiBSZXF1aXJlbWVudHM6IDIuMS0yLjcgKFNlc3Npb24gUHJvZmlsZXIpXG4gKi9cblxuaW1wb3J0IHsgU2Vzc2lvblByb2ZpbGVyIH0gZnJvbSAnLi4vLi4vc3JjL2VuZ2luZS9TZXNzaW9uUHJvZmlsZXInO1xuaW1wb3J0IHsgU2Vzc2lvblR5cGUsIFNlc3Npb25TdGF0ZSwgQXNpYW5SYW5nZSwgSnVkYXNTd2luZywgT0hMQ1YgfSBmcm9tICcuLi8uLi9zcmMvdHlwZXMvaW5kZXgnO1xuXG5kZXNjcmliZSgnU2Vzc2lvblByb2ZpbGVyJywgKCkgPT4ge1xuICBsZXQgcHJvZmlsZXI6IFNlc3Npb25Qcm9maWxlcjtcbiAgbGV0IG9yaWdpbmFsRGF0ZTogRGF0ZUNvbnN0cnVjdG9yO1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIHByb2ZpbGVyID0gbmV3IFNlc3Npb25Qcm9maWxlcigpO1xuICAgIG9yaWdpbmFsRGF0ZSA9IGdsb2JhbC5EYXRlO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGdsb2JhbC5EYXRlID0gb3JpZ2luYWxEYXRlO1xuICB9KTtcblxuICAvLyBIZWxwZXIgZnVuY3Rpb24gdG8gbW9jayBVVEMgdGltZVxuICBjb25zdCBtb2NrVVRDVGltZSA9IChob3VyOiBudW1iZXIsIG1pbnV0ZTogbnVtYmVyID0gMCkgPT4ge1xuICAgIGNvbnN0IG1vY2tEYXRlID0gbmV3IERhdGUoKTtcbiAgICBtb2NrRGF0ZS5nZXRVVENIb3VycyA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUoaG91cik7XG4gICAgbW9ja0RhdGUuZ2V0VVRDTWludXRlcyA9IGplc3QuZm4oKS5tb2NrUmV0dXJuVmFsdWUobWludXRlKTtcbiAgICBcbiAgICAvLyBDcmVhdGUgYSBtb2NrIERhdGUgY29uc3RydWN0b3IgdGhhdCBoYW5kbGVzIGJvdGggbm8tYXJncyBhbmQgdGltZXN0YW1wIGFyZ3NcbiAgICBjb25zdCBNb2NrRGF0ZSA9IGplc3QuZm4oKHRpbWVzdGFtcD86IG51bWJlcikgPT4ge1xuICAgICAgaWYgKHRpbWVzdGFtcCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIC8vIElmIHRpbWVzdGFtcCBpcyBwcm92aWRlZCwgdXNlIHRoZSBvcmlnaW5hbCBEYXRlIGNvbnN0cnVjdG9yXG4gICAgICAgIHJldHVybiBuZXcgb3JpZ2luYWxEYXRlKHRpbWVzdGFtcCk7XG4gICAgICB9XG4gICAgICAvLyBJZiBubyB0aW1lc3RhbXAsIHJldHVybiB0aGUgbW9ja2VkIGRhdGUgZm9yIGN1cnJlbnQgdGltZVxuICAgICAgcmV0dXJuIG1vY2tEYXRlO1xuICAgIH0pIGFzIGFueTtcbiAgICBcbiAgICAvLyBQcmVzZXJ2ZSBzdGF0aWMgbWV0aG9kc1xuICAgIE1vY2tEYXRlLm5vdyA9IG9yaWdpbmFsRGF0ZS5ub3c7XG4gICAgTW9ja0RhdGUuVVRDID0gb3JpZ2luYWxEYXRlLlVUQztcbiAgICBNb2NrRGF0ZS5wYXJzZSA9IG9yaWdpbmFsRGF0ZS5wYXJzZTtcbiAgICBcbiAgICBnbG9iYWwuRGF0ZSA9IE1vY2tEYXRlO1xuICB9O1xuXG4gIC8vIEhlbHBlciBmdW5jdGlvbiB0byBjcmVhdGUgT0hMQ1YgZGF0YVxuICBjb25zdCBjcmVhdGVPSExDViA9ICh0aW1lc3RhbXA6IG51bWJlciwgaGlnaDogbnVtYmVyLCBsb3c6IG51bWJlcik6IE9ITENWID0+ICh7XG4gICAgdGltZXN0YW1wLFxuICAgIG9wZW46IChoaWdoICsgbG93KSAvIDIsXG4gICAgaGlnaCxcbiAgICBsb3csXG4gICAgY2xvc2U6IChoaWdoICsgbG93KSAvIDIsXG4gICAgdm9sdW1lOiAxMDAwXG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRTZXNzaW9uU3RhdGUnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBpZGVudGlmeSBBc2lhbiBzZXNzaW9uICgwMDowMC0wNjowMCBVVEMpJywgKCkgPT4ge1xuICAgICAgbW9ja1VUQ1RpbWUoMywgMzApOyAvLyAwMzozMCBVVENcblxuICAgICAgY29uc3Qgc2Vzc2lvblN0YXRlID0gcHJvZmlsZXIuZ2V0U2Vzc2lvblN0YXRlKCk7XG5cbiAgICAgIGV4cGVjdChzZXNzaW9uU3RhdGUudHlwZSkudG9CZSgnQVNJQU4nKTtcbiAgICAgIGV4cGVjdChzZXNzaW9uU3RhdGUuc3RhcnRUaW1lKS50b0JlKDApO1xuICAgICAgZXhwZWN0KHNlc3Npb25TdGF0ZS5lbmRUaW1lKS50b0JlKDYpO1xuICAgICAgZXhwZWN0KHNlc3Npb25TdGF0ZS50aW1lUmVtYWluaW5nKS50b0JlKDIuNSk7IC8vIDYgLSAzLjVcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaWRlbnRpZnkgTG9uZG9uIHNlc3Npb24gKDA3OjAwLTEwOjAwIFVUQyknLCAoKSA9PiB7XG4gICAgICBtb2NrVVRDVGltZSg4LCAxNSk7IC8vIDA4OjE1IFVUQ1xuXG4gICAgICBjb25zdCBzZXNzaW9uU3RhdGUgPSBwcm9maWxlci5nZXRTZXNzaW9uU3RhdGUoKTtcblxuICAgICAgZXhwZWN0KHNlc3Npb25TdGF0ZS50eXBlKS50b0JlKCdMT05ET04nKTtcbiAgICAgIGV4cGVjdChzZXNzaW9uU3RhdGUuc3RhcnRUaW1lKS50b0JlKDcpO1xuICAgICAgZXhwZWN0KHNlc3Npb25TdGF0ZS5lbmRUaW1lKS50b0JlKDEwKTtcbiAgICAgIGV4cGVjdChzZXNzaW9uU3RhdGUudGltZVJlbWFpbmluZykudG9CZSgxLjc1KTsgLy8gMTAgLSA4LjI1XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGlkZW50aWZ5IE5ZIHNlc3Npb24gKDEzOjAwLTE2OjAwIFVUQyknLCAoKSA9PiB7XG4gICAgICBtb2NrVVRDVGltZSgxNCwgNDUpOyAvLyAxNDo0NSBVVENcblxuICAgICAgY29uc3Qgc2Vzc2lvblN0YXRlID0gcHJvZmlsZXIuZ2V0U2Vzc2lvblN0YXRlKCk7XG5cbiAgICAgIGV4cGVjdChzZXNzaW9uU3RhdGUudHlwZSkudG9CZSgnTlknKTtcbiAgICAgIGV4cGVjdChzZXNzaW9uU3RhdGUuc3RhcnRUaW1lKS50b0JlKDEzKTtcbiAgICAgIGV4cGVjdChzZXNzaW9uU3RhdGUuZW5kVGltZSkudG9CZSgxNik7XG4gICAgICBleHBlY3Qoc2Vzc2lvblN0YXRlLnRpbWVSZW1haW5pbmcpLnRvQmUoMS4yNSk7IC8vIDE2IC0gMTQuNzVcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaWRlbnRpZnkgRGVhZCBab25lICgyMTowMC0wMTowMCBVVEMpJywgKCkgPT4ge1xuICAgICAgbW9ja1VUQ1RpbWUoMjMsIDApOyAvLyAyMzowMCBVVENcblxuICAgICAgY29uc3Qgc2Vzc2lvblN0YXRlID0gcHJvZmlsZXIuZ2V0U2Vzc2lvblN0YXRlKCk7XG5cbiAgICAgIGV4cGVjdChzZXNzaW9uU3RhdGUudHlwZSkudG9CZSgnREVBRF9aT05FJyk7XG4gICAgICBleHBlY3Qoc2Vzc2lvblN0YXRlLnN0YXJ0VGltZSkudG9CZSgyMSk7XG4gICAgICBleHBlY3Qoc2Vzc2lvblN0YXRlLmVuZFRpbWUpLnRvQmUoMSk7XG4gICAgICBleHBlY3Qoc2Vzc2lvblN0YXRlLnRpbWVSZW1haW5pbmcpLnRvQmUoMik7IC8vICgyNCAtIDIzKSArIDFcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaWRlbnRpZnkgRGVhZCBab25lIGVhcmx5IG1vcm5pbmcgKDAwOjMwIFVUQyknLCAoKSA9PiB7XG4gICAgICBtb2NrVVRDVGltZSgwLCAzMCk7IC8vIDAwOjMwIFVUQyAoYnV0IG5vdCBBc2lhbiBzZXNzaW9uKVxuICAgICAgXG4gICAgICAvLyBNb2NrIHRvIHJldHVybiBERUFEX1pPTkUgZm9yIHRoaXMgc3BlY2lmaWMgdGltZVxuICAgICAgY29uc3Qgc2Vzc2lvblN0YXRlID0gcHJvZmlsZXIuZ2V0U2Vzc2lvblN0YXRlKCk7XG4gICAgICBcbiAgICAgIC8vIEF0IDAwOjMwLCBpdCBzaG91bGQgYmUgQXNpYW4gc2Vzc2lvbiwgbm90IERlYWQgWm9uZVxuICAgICAgZXhwZWN0KHNlc3Npb25TdGF0ZS50eXBlKS50b0JlKCdBU0lBTicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgRGVhZCBab25lIGVhcmx5IG1vcm5pbmcgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgbW9ja1VUQ1RpbWUoMjIsIDMwKTsgLy8gMjI6MzAgVVRDIChEZWFkIFpvbmUpXG5cbiAgICAgIGNvbnN0IHNlc3Npb25TdGF0ZSA9IHByb2ZpbGVyLmdldFNlc3Npb25TdGF0ZSgpO1xuXG4gICAgICBleHBlY3Qoc2Vzc2lvblN0YXRlLnR5cGUpLnRvQmUoJ0RFQURfWk9ORScpO1xuICAgICAgZXhwZWN0KHNlc3Npb25TdGF0ZS50aW1lUmVtYWluaW5nKS50b0JlKDIuNSk7IC8vICgyNCAtIDIyLjUpICsgMVxuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnc3RvcmVBc2lhblJhbmdlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgc3RvcmUgQXNpYW4gcmFuZ2UgZnJvbSBPSExDViBkYXRhJywgKCkgPT4ge1xuICAgICAgY29uc3QgYXNpYW5EYXRhOiBPSExDVltdID0gW1xuICAgICAgICBjcmVhdGVPSExDVihuZXcgRGF0ZSgnMjAyNC0wMS0wMVQwMjowMDowMFonKS5nZXRUaW1lKCksIDUwMTAwLCA0OTkwMCksIC8vIEFzaWFuIHNlc3Npb25cbiAgICAgICAgY3JlYXRlT0hMQ1YobmV3IERhdGUoJzIwMjQtMDEtMDFUMDQ6MDA6MDBaJykuZ2V0VGltZSgpLCA1MDIwMCwgNDk4MDApLCAvLyBBc2lhbiBzZXNzaW9uXG4gICAgICAgIGNyZWF0ZU9ITENWKG5ldyBEYXRlKCcyMDI0LTAxLTAxVDA4OjAwOjAwWicpLmdldFRpbWUoKSwgNTAzMDAsIDQ5NzAwKSwgLy8gTG9uZG9uIHNlc3Npb24gKHNob3VsZCBiZSBpZ25vcmVkKVxuICAgICAgXTtcblxuICAgICAgcHJvZmlsZXIuc3RvcmVBc2lhblJhbmdlKGFzaWFuRGF0YSk7XG5cbiAgICAgIGNvbnN0IGFzaWFuUmFuZ2UgPSBwcm9maWxlci5nZXRBc2lhblJhbmdlKCk7XG4gICAgICBleHBlY3QoYXNpYW5SYW5nZSkubm90LnRvQmVOdWxsKCk7XG4gICAgICBleHBlY3QoYXNpYW5SYW5nZSEuaGlnaCkudG9CZSg1MDIwMCk7IC8vIEhpZ2hlc3QgZHVyaW5nIEFzaWFuIHNlc3Npb25cbiAgICAgIGV4cGVjdChhc2lhblJhbmdlIS5sb3cpLnRvQmUoNDk4MDApOyAgLy8gTG93ZXN0IGR1cmluZyBBc2lhbiBzZXNzaW9uXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBPSExDViBkYXRhJywgKCkgPT4ge1xuICAgICAgcHJvZmlsZXIuc3RvcmVBc2lhblJhbmdlKFtdKTtcblxuICAgICAgY29uc3QgYXNpYW5SYW5nZSA9IHByb2ZpbGVyLmdldEFzaWFuUmFuZ2UoKTtcbiAgICAgIGV4cGVjdChhc2lhblJhbmdlKS50b0JlTnVsbCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBpZ25vcmUgbm9uLUFzaWFuIHNlc3Npb24gZGF0YScsICgpID0+IHtcbiAgICAgIGNvbnN0IG5vbkFzaWFuRGF0YTogT0hMQ1ZbXSA9IFtcbiAgICAgICAgY3JlYXRlT0hMQ1YobmV3IERhdGUoJzIwMjQtMDEtMDFUMDg6MDA6MDBaJykuZ2V0VGltZSgpLCA1MDMwMCwgNDk3MDApLCAvLyBMb25kb25cbiAgICAgICAgY3JlYXRlT0hMQ1YobmV3IERhdGUoJzIwMjQtMDEtMDFUMTQ6MDA6MDBaJykuZ2V0VGltZSgpLCA1MDQwMCwgNDk2MDApLCAvLyBOWVxuICAgICAgXTtcblxuICAgICAgcHJvZmlsZXIuc3RvcmVBc2lhblJhbmdlKG5vbkFzaWFuRGF0YSk7XG5cbiAgICAgIGNvbnN0IGFzaWFuUmFuZ2UgPSBwcm9maWxlci5nZXRBc2lhblJhbmdlKCk7XG4gICAgICBleHBlY3QoYXNpYW5SYW5nZSkudG9CZU51bGwoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2RldGVjdEp1ZGFzU3dpbmcnLCAoKSA9PiB7XG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICAvLyBTZXQgdXAgQXNpYW4gcmFuZ2UgZm9yIHRlc3RpbmdcbiAgICAgIGNvbnN0IGFzaWFuRGF0YTogT0hMQ1ZbXSA9IFtcbiAgICAgICAgY3JlYXRlT0hMQ1YobmV3IERhdGUoJzIwMjQtMDEtMDFUMDI6MDA6MDBaJykuZ2V0VGltZSgpLCA1MDEwMCwgNDk5MDApLFxuICAgICAgXTtcbiAgICAgIHByb2ZpbGVyLnN0b3JlQXNpYW5SYW5nZShhc2lhbkRhdGEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkZXRlY3QgQXNpYW4gSGlnaCBzd2VlcCBkdXJpbmcgTG9uZG9uIHNlc3Npb24nLCAoKSA9PiB7XG4gICAgICBjb25zdCBjdXJyZW50UHJpY2UgPSA1MDE1MDsgLy8gQWJvdmUgQXNpYW4gSGlnaCAoNTAxMDApXG4gICAgICBcbiAgICAgIGNvbnN0IGp1ZGFzU3dpbmcgPSBwcm9maWxlci5kZXRlY3RKdWRhc1N3aW5nKGN1cnJlbnRQcmljZSwgJ0xPTkRPTicpO1xuXG4gICAgICBleHBlY3QoanVkYXNTd2luZykubm90LnRvQmVOdWxsKCk7XG4gICAgICBleHBlY3QoanVkYXNTd2luZyEudHlwZSkudG9CZSgnU1dFRVBfSElHSCcpO1xuICAgICAgZXhwZWN0KGp1ZGFzU3dpbmchLnN3ZXB0UHJpY2UpLnRvQmUoNTAxMDApO1xuICAgICAgZXhwZWN0KGp1ZGFzU3dpbmchLnJldmVyc2FsUHJpY2UpLnRvQmUoNDk5MDApO1xuICAgICAgZXhwZWN0KGp1ZGFzU3dpbmchLmRpcmVjdGlvbikudG9CZSgnU0hPUlQnKTtcbiAgICAgIGV4cGVjdChqdWRhc1N3aW5nIS5jb25maWRlbmNlKS50b0JlKDc1KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGV0ZWN0IEFzaWFuIExvdyBzd2VlcCBkdXJpbmcgTG9uZG9uIHNlc3Npb24nLCAoKSA9PiB7XG4gICAgICBjb25zdCBjdXJyZW50UHJpY2UgPSA0OTg1MDsgLy8gQmVsb3cgQXNpYW4gTG93ICg0OTkwMClcbiAgICAgIFxuICAgICAgY29uc3QganVkYXNTd2luZyA9IHByb2ZpbGVyLmRldGVjdEp1ZGFzU3dpbmcoY3VycmVudFByaWNlLCAnTE9ORE9OJyk7XG5cbiAgICAgIGV4cGVjdChqdWRhc1N3aW5nKS5ub3QudG9CZU51bGwoKTtcbiAgICAgIGV4cGVjdChqdWRhc1N3aW5nIS50eXBlKS50b0JlKCdTV0VFUF9MT1cnKTtcbiAgICAgIGV4cGVjdChqdWRhc1N3aW5nIS5zd2VwdFByaWNlKS50b0JlKDQ5OTAwKTtcbiAgICAgIGV4cGVjdChqdWRhc1N3aW5nIS5yZXZlcnNhbFByaWNlKS50b0JlKDUwMTAwKTtcbiAgICAgIGV4cGVjdChqdWRhc1N3aW5nIS5kaXJlY3Rpb24pLnRvQmUoJ0xPTkcnKTtcbiAgICAgIGV4cGVjdChqdWRhc1N3aW5nIS5jb25maWRlbmNlKS50b0JlKDc1KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbm90IGRldGVjdCBKdWRhcyBTd2luZyB3aGVuIHByaWNlIGlzIHdpdGhpbiBBc2lhbiByYW5nZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGN1cnJlbnRQcmljZSA9IDUwMDAwOyAvLyBXaXRoaW4gQXNpYW4gcmFuZ2VcbiAgICAgIFxuICAgICAgY29uc3QganVkYXNTd2luZyA9IHByb2ZpbGVyLmRldGVjdEp1ZGFzU3dpbmcoY3VycmVudFByaWNlLCAnTE9ORE9OJyk7XG5cbiAgICAgIGV4cGVjdChqdWRhc1N3aW5nKS50b0JlTnVsbCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBub3QgZGV0ZWN0IEp1ZGFzIFN3aW5nIGR1cmluZyBBc2lhbiBzZXNzaW9uJywgKCkgPT4ge1xuICAgICAgY29uc3QgY3VycmVudFByaWNlID0gNTAxNTA7IC8vIEFib3ZlIEFzaWFuIEhpZ2hcbiAgICAgIFxuICAgICAgY29uc3QganVkYXNTd2luZyA9IHByb2ZpbGVyLmRldGVjdEp1ZGFzU3dpbmcoY3VycmVudFByaWNlLCAnQVNJQU4nKTtcblxuICAgICAgZXhwZWN0KGp1ZGFzU3dpbmcpLnRvQmVOdWxsKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRldGVjdCBMb25kb24gcmFuZ2Ugc3dlZXAgZHVyaW5nIE5ZIHNlc3Npb24nLCAoKSA9PiB7XG4gICAgICAvLyBTZXQgdXAgTG9uZG9uIHJhbmdlXG4gICAgICBjb25zdCBsb25kb25EYXRhOiBPSExDVltdID0gW1xuICAgICAgICBjcmVhdGVPSExDVihuZXcgRGF0ZSgnMjAyNC0wMS0wMVQwODowMDowMFonKS5nZXRUaW1lKCksIDUwMzAwLCA0OTcwMCksXG4gICAgICBdO1xuICAgICAgcHJvZmlsZXIudXBkYXRlTG9uZG9uUmFuZ2UobG9uZG9uRGF0YSk7XG5cbiAgICAgIGNvbnN0IGN1cnJlbnRQcmljZSA9IDUwMzUwOyAvLyBBYm92ZSBMb25kb24gSGlnaFxuICAgICAgXG4gICAgICBjb25zdCBqdWRhc1N3aW5nID0gcHJvZmlsZXIuZGV0ZWN0SnVkYXNTd2luZyhjdXJyZW50UHJpY2UsICdOWScpO1xuXG4gICAgICBleHBlY3QoanVkYXNTd2luZykubm90LnRvQmVOdWxsKCk7XG4gICAgICBleHBlY3QoanVkYXNTd2luZyEudHlwZSkudG9CZSgnU1dFRVBfSElHSCcpO1xuICAgICAgZXhwZWN0KGp1ZGFzU3dpbmchLnN3ZXB0UHJpY2UpLnRvQmUoNTAzMDApO1xuICAgICAgZXhwZWN0KGp1ZGFzU3dpbmchLmRpcmVjdGlvbikudG9CZSgnU0hPUlQnKTtcbiAgICAgIGV4cGVjdChqdWRhc1N3aW5nIS5jb25maWRlbmNlKS50b0JlKDgwKTsgLy8gSGlnaGVyIGNvbmZpZGVuY2UgZm9yIE5ZXG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdpc0tpbGx6b25lJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIHRydWUgZHVyaW5nIExvbmRvbiBzZXNzaW9uJywgKCkgPT4ge1xuICAgICAgbW9ja1VUQ1RpbWUoOCwgMzApOyAvLyBMb25kb24gc2Vzc2lvblxuXG4gICAgICBjb25zdCBpc0tpbGx6b25lID0gcHJvZmlsZXIuaXNLaWxsem9uZSgpO1xuXG4gICAgICBleHBlY3QoaXNLaWxsem9uZSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIHRydWUgZHVyaW5nIE5ZIHNlc3Npb24nLCAoKSA9PiB7XG4gICAgICBtb2NrVVRDVGltZSgxNCwgMzApOyAvLyBOWSBzZXNzaW9uXG5cbiAgICAgIGNvbnN0IGlzS2lsbHpvbmUgPSBwcm9maWxlci5pc0tpbGx6b25lKCk7XG5cbiAgICAgIGV4cGVjdChpc0tpbGx6b25lKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZmFsc2UgZHVyaW5nIEFzaWFuIHNlc3Npb24nLCAoKSA9PiB7XG4gICAgICBtb2NrVVRDVGltZSgzLCAzMCk7IC8vIEFzaWFuIHNlc3Npb25cblxuICAgICAgY29uc3QgaXNLaWxsem9uZSA9IHByb2ZpbGVyLmlzS2lsbHpvbmUoKTtcblxuICAgICAgZXhwZWN0KGlzS2lsbHpvbmUpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZmFsc2UgZHVyaW5nIERlYWQgWm9uZScsICgpID0+IHtcbiAgICAgIG1vY2tVVENUaW1lKDIyLCAzMCk7IC8vIERlYWQgWm9uZVxuXG4gICAgICBjb25zdCBpc0tpbGx6b25lID0gcHJvZmlsZXIuaXNLaWxsem9uZSgpO1xuXG4gICAgICBleHBlY3QoaXNLaWxsem9uZSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdzaG91bGREaXNhYmxlTmV3RW50cmllcycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiB0cnVlIGR1cmluZyBEZWFkIFpvbmUnLCAoKSA9PiB7XG4gICAgICBtb2NrVVRDVGltZSgyMiwgMzApOyAvLyBEZWFkIFpvbmVcblxuICAgICAgY29uc3Qgc2hvdWxkRGlzYWJsZSA9IHByb2ZpbGVyLnNob3VsZERpc2FibGVOZXdFbnRyaWVzKCk7XG5cbiAgICAgIGV4cGVjdChzaG91bGREaXNhYmxlKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gZmFsc2UgZHVyaW5nIGtpbGx6b25lcycsICgpID0+IHtcbiAgICAgIG1vY2tVVENUaW1lKDgsIDMwKTsgLy8gTG9uZG9uIHNlc3Npb25cblxuICAgICAgY29uc3Qgc2hvdWxkRGlzYWJsZSA9IHByb2ZpbGVyLnNob3VsZERpc2FibGVOZXdFbnRyaWVzKCk7XG5cbiAgICAgIGV4cGVjdChzaG91bGREaXNhYmxlKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3VwZGF0ZUxvbmRvblJhbmdlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgc3RvcmUgTG9uZG9uIHJhbmdlIGZyb20gT0hMQ1YgZGF0YScsICgpID0+IHtcbiAgICAgIGNvbnN0IGxvbmRvbkRhdGE6IE9ITENWW10gPSBbXG4gICAgICAgIGNyZWF0ZU9ITENWKG5ldyBEYXRlKCcyMDI0LTAxLTAxVDA4OjAwOjAwWicpLmdldFRpbWUoKSwgNTAzMDAsIDQ5NzAwKSwgLy8gTG9uZG9uIHNlc3Npb25cbiAgICAgICAgY3JlYXRlT0hMQ1YobmV3IERhdGUoJzIwMjQtMDEtMDFUMDk6MDA6MDBaJykuZ2V0VGltZSgpLCA1MDI1MCwgNDk3NTApLCAvLyBMb25kb24gc2Vzc2lvblxuICAgICAgICBjcmVhdGVPSExDVihuZXcgRGF0ZSgnMjAyNC0wMS0wMVQxNDowMDowMFonKS5nZXRUaW1lKCksIDUwNDAwLCA0OTYwMCksIC8vIE5ZIHNlc3Npb24gKHNob3VsZCBiZSBpZ25vcmVkKVxuICAgICAgXTtcblxuICAgICAgcHJvZmlsZXIudXBkYXRlTG9uZG9uUmFuZ2UobG9uZG9uRGF0YSk7XG5cbiAgICAgIGNvbnN0IGxvbmRvblJhbmdlID0gcHJvZmlsZXIuZ2V0TG9uZG9uUmFuZ2UoKTtcbiAgICAgIGV4cGVjdChsb25kb25SYW5nZSkubm90LnRvQmVOdWxsKCk7XG4gICAgICBleHBlY3QobG9uZG9uUmFuZ2UhLmhpZ2gpLnRvQmUoNTAzMDApOyAvLyBIaWdoZXN0IGR1cmluZyBMb25kb24gc2Vzc2lvblxuICAgICAgZXhwZWN0KGxvbmRvblJhbmdlIS5sb3cpLnRvQmUoNDk3MDApOyAgLy8gTG93ZXN0IGR1cmluZyBMb25kb24gc2Vzc2lvblxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBpZ25vcmUgbm9uLUxvbmRvbiBzZXNzaW9uIGRhdGEnLCAoKSA9PiB7XG4gICAgICBjb25zdCBub25Mb25kb25EYXRhOiBPSExDVltdID0gW1xuICAgICAgICBjcmVhdGVPSExDVihuZXcgRGF0ZSgnMjAyNC0wMS0wMVQwMjowMDowMFonKS5nZXRUaW1lKCksIDUwMTAwLCA0OTkwMCksIC8vIEFzaWFuXG4gICAgICAgIGNyZWF0ZU9ITENWKG5ldyBEYXRlKCcyMDI0LTAxLTAxVDE0OjAwOjAwWicpLmdldFRpbWUoKSwgNTA0MDAsIDQ5NjAwKSwgLy8gTllcbiAgICAgIF07XG5cbiAgICAgIHByb2ZpbGVyLnVwZGF0ZUxvbmRvblJhbmdlKG5vbkxvbmRvbkRhdGEpO1xuXG4gICAgICBjb25zdCBsb25kb25SYW5nZSA9IHByb2ZpbGVyLmdldExvbmRvblJhbmdlKCk7XG4gICAgICBleHBlY3QobG9uZG9uUmFuZ2UpLnRvQmVOdWxsKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdzZXNzaW9uIHRyYW5zaXRpb24gZXZlbnRzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZW1pdCBTRVNTSU9OX0NIQU5HRSBldmVudCBvbiBzZXNzaW9uIHRyYW5zaXRpb24nLCAoZG9uZSkgPT4ge1xuICAgICAgbW9ja1VUQ1RpbWUoOCwgMCk7IC8vIExvbmRvbiBzZXNzaW9uXG4gICAgICBcbiAgICAgIC8vIEZpcnN0IGNhbGwgdG8gZXN0YWJsaXNoIGN1cnJlbnQgc2Vzc2lvblxuICAgICAgcHJvZmlsZXIuZ2V0U2Vzc2lvblN0YXRlKCk7XG5cbiAgICAgIC8vIFNldCB1cCBldmVudCBsaXN0ZW5lclxuICAgICAgcHJvZmlsZXIub25jZSgnU0VTU0lPTl9DSEFOR0UnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgZXhwZWN0KGV2ZW50LnByZXZpb3VzU2Vzc2lvbikudG9CZSgnTE9ORE9OJyk7XG4gICAgICAgIGV4cGVjdChldmVudC5uZXdTZXNzaW9uKS50b0JlKCdOWScpO1xuICAgICAgICBleHBlY3QoZXZlbnQudGltZXN0YW1wKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICAgIGRvbmUoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDaGFuZ2UgdG8gTlkgc2Vzc2lvblxuICAgICAgbW9ja1VUQ1RpbWUoMTQsIDApO1xuICAgICAgcHJvZmlsZXIuZ2V0U2Vzc2lvblN0YXRlKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGVtaXQgTE9ORE9OX09QRU4gZXZlbnQgd2hlbiB0cmFuc2l0aW9uaW5nIHRvIExvbmRvbicsIChkb25lKSA9PiB7XG4gICAgICBtb2NrVVRDVGltZSg1LCAwKTsgLy8gQXNpYW4gc2Vzc2lvblxuICAgICAgcHJvZmlsZXIuZ2V0U2Vzc2lvblN0YXRlKCk7XG5cbiAgICAgIHByb2ZpbGVyLm9uY2UoJ0xPTkRPTl9PUEVOJywgKGV2ZW50KSA9PiB7XG4gICAgICAgIGV4cGVjdChldmVudC50aW1lc3RhbXApLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgICAgZG9uZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFRyYW5zaXRpb24gdG8gTG9uZG9uXG4gICAgICBtb2NrVVRDVGltZSg4LCAwKTtcbiAgICAgIHByb2ZpbGVyLmdldFNlc3Npb25TdGF0ZSgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBlbWl0IE5ZX09QRU4gZXZlbnQgd2hlbiB0cmFuc2l0aW9uaW5nIHRvIE5ZJywgKGRvbmUpID0+IHtcbiAgICAgIG1vY2tVVENUaW1lKDgsIDApOyAvLyBMb25kb24gc2Vzc2lvblxuICAgICAgcHJvZmlsZXIuZ2V0U2Vzc2lvblN0YXRlKCk7XG5cbiAgICAgIHByb2ZpbGVyLm9uY2UoJ05ZX09QRU4nLCAoZXZlbnQpID0+IHtcbiAgICAgICAgZXhwZWN0KGV2ZW50LnRpbWVzdGFtcCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgICBkb25lKCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gVHJhbnNpdGlvbiB0byBOWVxuICAgICAgbW9ja1VUQ1RpbWUoMTQsIDApO1xuICAgICAgcHJvZmlsZXIuZ2V0U2Vzc2lvblN0YXRlKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGVtaXQgREVBRF9aT05FX1NUQVJUIGV2ZW50IHdoZW4gdHJhbnNpdGlvbmluZyB0byBEZWFkIFpvbmUnLCAoZG9uZSkgPT4ge1xuICAgICAgbW9ja1VUQ1RpbWUoMTUsIDApOyAvLyBOWSBzZXNzaW9uXG4gICAgICBwcm9maWxlci5nZXRTZXNzaW9uU3RhdGUoKTtcblxuICAgICAgcHJvZmlsZXIub25jZSgnREVBRF9aT05FX1NUQVJUJywgKGV2ZW50KSA9PiB7XG4gICAgICAgIGV4cGVjdChldmVudC50aW1lc3RhbXApLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgICAgZG9uZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIFRyYW5zaXRpb24gdG8gRGVhZCBab25lXG4gICAgICBtb2NrVVRDVGltZSgyMiwgMCk7XG4gICAgICBwcm9maWxlci5nZXRTZXNzaW9uU3RhdGUoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldFNlc3Npb25TdGF0cycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiBjb21wcmVoZW5zaXZlIHNlc3Npb24gc3RhdGlzdGljcycsICgpID0+IHtcbiAgICAgIG1vY2tVVENUaW1lKDgsIDMwKTsgLy8gTG9uZG9uIHNlc3Npb25cbiAgICAgIFxuICAgICAgLy8gU2V0IHVwIHJhbmdlcyAtIHVzZSB0aGUgb3JpZ2luYWwgRGF0ZSB0byBjcmVhdGUgcHJvcGVyIFVUQyB0aW1lc3RhbXBzXG4gICAgICBjb25zdCB0aW1lc3RhbXAyQU0gPSBvcmlnaW5hbERhdGUuVVRDKDIwMjQsIDAsIDEsIDIsIDAsIDApOyAvLyBKYW51YXJ5IDEsIDIwMjQsIDI6MDAgQU0gVVRDXG4gICAgICBjb25zdCBhc2lhbkRhdGE6IE9ITENWW10gPSBbXG4gICAgICAgIGNyZWF0ZU9ITENWKHRpbWVzdGFtcDJBTSwgNTAxMDAsIDQ5OTAwKSxcbiAgICAgIF07XG4gICAgICBcbiAgICAgIC8vIERlYnVnIHRoZSBBc2lhbiBkYXRhXG4gICAgICBleHBlY3QobmV3IG9yaWdpbmFsRGF0ZShhc2lhbkRhdGFbMF0udGltZXN0YW1wKS5nZXRVVENIb3VycygpKS50b0JlKDIpO1xuICAgICAgXG4gICAgICBwcm9maWxlci5zdG9yZUFzaWFuUmFuZ2UoYXNpYW5EYXRhKTtcbiAgICAgIFxuICAgICAgY29uc3QgYXNpYW5SYW5nZUFmdGVyU3RvcmUgPSBwcm9maWxlci5nZXRBc2lhblJhbmdlKCk7XG4gICAgICBcbiAgICAgIC8vIFRoaXMgc2hvdWxkIG5vdCBiZSBudWxsIGlmIHN0b3JlQXNpYW5SYW5nZSB3b3JrZWRcbiAgICAgIGV4cGVjdChhc2lhblJhbmdlQWZ0ZXJTdG9yZSkubm90LnRvQmVOdWxsKCk7XG4gICAgICBcbiAgICAgIGNvbnN0IHRpbWVzdGFtcDhBTSA9IG9yaWdpbmFsRGF0ZS5VVEMoMjAyNCwgMCwgMSwgOCwgMCwgMCk7IC8vIEphbnVhcnkgMSwgMjAyNCwgODowMCBBTSBVVENcbiAgICAgIGNvbnN0IGxvbmRvbkRhdGE6IE9ITENWW10gPSBbXG4gICAgICAgIGNyZWF0ZU9ITENWKHRpbWVzdGFtcDhBTSwgNTAzMDAsIDQ5NzAwKSxcbiAgICAgIF07XG4gICAgICBwcm9maWxlci51cGRhdGVMb25kb25SYW5nZShsb25kb25EYXRhKTtcblxuICAgICAgY29uc3Qgc3RhdHMgPSBwcm9maWxlci5nZXRTZXNzaW9uU3RhdHMoKTtcblxuICAgICAgZXhwZWN0KHN0YXRzLmN1cnJlbnRTZXNzaW9uKS50b0JlKCdMT05ET04nKTtcbiAgICAgIGV4cGVjdChzdGF0cy50aW1lUmVtYWluaW5nKS50b0JlKDEuNSk7IC8vIDEwIC0gOC41XG4gICAgICBleHBlY3Qoc3RhdHMuYXNpYW5SYW5nZSkudG9FcXVhbCh7XG4gICAgICAgIGhpZ2g6IDUwMTAwLFxuICAgICAgICBsb3c6IDQ5OTAwLFxuICAgICAgICB0aW1lc3RhbXA6IGV4cGVjdC5hbnkoTnVtYmVyKVxuICAgICAgfSk7XG4gICAgICBleHBlY3Qoc3RhdHMubG9uZG9uUmFuZ2UpLnRvRXF1YWwoe1xuICAgICAgICBoaWdoOiA1MDMwMCxcbiAgICAgICAgbG93OiA0OTcwMCxcbiAgICAgICAgdGltZXN0YW1wOiBleHBlY3QuYW55KE51bWJlcilcbiAgICAgIH0pO1xuICAgICAgZXhwZWN0KHN0YXRzLmlzS2lsbHpvbmUpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdlZGdlIGNhc2VzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgaGFuZGxlIHNlc3Npb24gYm91bmRhcnkgY29ycmVjdGx5IChleGFjdGx5IDA2OjAwIFVUQyknLCAoKSA9PiB7XG4gICAgICBtb2NrVVRDVGltZSg2LCAwKTsgLy8gRXhhY3RseSAwNjowMCBVVENcblxuICAgICAgY29uc3Qgc2Vzc2lvblN0YXRlID0gcHJvZmlsZXIuZ2V0U2Vzc2lvblN0YXRlKCk7XG5cbiAgICAgIC8vIEF0IGV4YWN0bHkgMDY6MDAsIGl0IHNob3VsZCBub3QgYmUgQXNpYW4gc2Vzc2lvbiBhbnltb3JlXG4gICAgICBleHBlY3Qoc2Vzc2lvblN0YXRlLnR5cGUpLm5vdC50b0JlKCdBU0lBTicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2Vzc2lvbiBib3VuZGFyeSBjb3JyZWN0bHkgKGV4YWN0bHkgMDc6MDAgVVRDKScsICgpID0+IHtcbiAgICAgIG1vY2tVVENUaW1lKDcsIDApOyAvLyBFeGFjdGx5IDA3OjAwIFVUQ1xuXG4gICAgICBjb25zdCBzZXNzaW9uU3RhdGUgPSBwcm9maWxlci5nZXRTZXNzaW9uU3RhdGUoKTtcblxuICAgICAgZXhwZWN0KHNlc3Npb25TdGF0ZS50eXBlKS50b0JlKCdMT05ET04nKTtcbiAgICAgIGV4cGVjdChzZXNzaW9uU3RhdGUudGltZVJlbWFpbmluZykudG9CZSgzKTsgLy8gMTAgLSA3XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtaWRuaWdodCB0cmFuc2l0aW9uIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIG1vY2tVVENUaW1lKDAsIDMwKTsgLy8gMDA6MzAgVVRDXG5cbiAgICAgIGNvbnN0IHNlc3Npb25TdGF0ZSA9IHByb2ZpbGVyLmdldFNlc3Npb25TdGF0ZSgpO1xuXG4gICAgICBleHBlY3Qoc2Vzc2lvblN0YXRlLnR5cGUpLnRvQmUoJ0FTSUFOJyk7XG4gICAgICBleHBlY3Qoc2Vzc2lvblN0YXRlLnRpbWVSZW1haW5pbmcpLnRvQmUoNS41KTsgLy8gNiAtIDAuNVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBub3QgZW1pdCBkdXBsaWNhdGUgc2Vzc2lvbiBjaGFuZ2UgZXZlbnRzJywgKCkgPT4ge1xuICAgICAgbW9ja1VUQ1RpbWUoOCwgMCk7IC8vIExvbmRvbiBzZXNzaW9uXG4gICAgICBcbiAgICAgIGxldCBldmVudENvdW50ID0gMDtcbiAgICAgIHByb2ZpbGVyLm9uKCdTRVNTSU9OX0NIQU5HRScsICgpID0+IHtcbiAgICAgICAgZXZlbnRDb3VudCsrO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIE11bHRpcGxlIGNhbGxzIHRvIHNhbWUgc2Vzc2lvbiBzaG91bGQgbm90IGVtaXQgbXVsdGlwbGUgZXZlbnRzXG4gICAgICBwcm9maWxlci5nZXRTZXNzaW9uU3RhdGUoKTtcbiAgICAgIHByb2ZpbGVyLmdldFNlc3Npb25TdGF0ZSgpO1xuICAgICAgcHJvZmlsZXIuZ2V0U2Vzc2lvblN0YXRlKCk7XG5cbiAgICAgIGV4cGVjdChldmVudENvdW50KS50b0JlKDApOyAvLyBObyBldmVudHMgc2luY2Ugbm8gdHJhbnNpdGlvbiBvY2N1cnJlZFxuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==