{"file":"/Users/ivan/Code/trading/titan/services/titan-phase2-hunter/tests/unit/CredentialManager.test.ts","mappings":"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","names":[],"sources":["/Users/ivan/Code/trading/titan/services/titan-phase2-hunter/tests/unit/CredentialManager.test.ts"],"sourcesContent":["/**\n * Unit tests for CredentialManager\n * \n * Tests AES-256-GCM encryption/decryption, master password handling,\n * credential validation, and file operations.\n */\n\nimport { CredentialManager, ExchangeCredentials } from '../../src/config/CredentialManager';\nimport { existsSync, unlinkSync, mkdirSync } from 'fs';\nimport { join } from 'path';\nimport { tmpdir } from 'os';\n\ndescribe('CredentialManager', () => {\n  let credentialManager: CredentialManager;\n  let testDir: string;\n  let originalEnv: string | undefined;\n\n  const validCredentials: ExchangeCredentials = {\n    binance: {\n      apiKey: 'binance_test_api_key_32_characters_long',\n      apiSecret: 'binance_test_api_secret_64_characters_long_for_testing_purposes'\n    },\n    bybit: {\n      apiKey: 'bybit_test_api_key_24_chars',\n      apiSecret: 'bybit_test_api_secret_48_characters_long_test'\n    }\n  };\n\n  const testPassword = 'test_master_password_123';\n\n  beforeEach(() => {\n    // Create temporary test directory\n    testDir = join(tmpdir(), `titan-test-${Date.now()}`);\n    mkdirSync(testDir, { recursive: true });\n\n    // Mock homedir to use test directory\n    jest.spyOn(require('os'), 'homedir').mockReturnValue(testDir);\n\n    // Save original environment variable\n    originalEnv = process.env.TITAN_MASTER_PASSWORD;\n\n    credentialManager = new CredentialManager();\n  });\n\n  afterEach(() => {\n    // Restore environment variable\n    if (originalEnv !== undefined) {\n      process.env.TITAN_MASTER_PASSWORD = originalEnv;\n    } else {\n      delete process.env.TITAN_MASTER_PASSWORD;\n    }\n\n    // Clean up test files\n    try {\n      const credentialsPath = join(testDir, '.titan-scanner', 'secrets.enc');\n      if (existsSync(credentialsPath)) {\n        unlinkSync(credentialsPath);\n      }\n    } catch (error) {\n      // Ignore cleanup errors\n    }\n\n    // Restore mocks\n    jest.restoreAllMocks();\n  });\n\n  describe('Master Password Management', () => {\n    test('should set master password directly', () => {\n      expect(() => credentialManager.setMasterPassword(testPassword)).not.toThrow();\n    });\n\n    test('should get master password from environment variable', () => {\n      process.env.TITAN_MASTER_PASSWORD = testPassword;\n      expect(() => credentialManager.setMasterPassword()).not.toThrow();\n    });\n\n    test('should throw error when no master password provided', () => {\n      delete process.env.TITAN_MASTER_PASSWORD;\n      expect(() => credentialManager.setMasterPassword()).toThrow(\n        'Master password not provided'\n      );\n    });\n\n    test('should throw error when trying to save without master password', () => {\n      expect(() => credentialManager.saveCredentials(validCredentials)).toThrow(\n        'Master password not set'\n      );\n    });\n\n    test('should throw error when trying to load without master password', () => {\n      expect(() => credentialManager.loadCredentials()).toThrow(\n        'Master password not set'\n      );\n    });\n  });\n\n  describe('Credential Validation', () => {\n    beforeEach(() => {\n      credentialManager.setMasterPassword(testPassword);\n    });\n\n    test('should validate valid credentials', () => {\n      expect(() => credentialManager.saveCredentials(validCredentials)).not.toThrow();\n    });\n\n    test('should reject credentials with empty Binance API key', () => {\n      const invalidCredentials = {\n        ...validCredentials,\n        binance: { ...validCredentials.binance, apiKey: '' }\n      };\n\n      expect(() => credentialManager.saveCredentials(invalidCredentials)).toThrow(\n        'Binance API key is empty'\n      );\n    });\n\n    test('should reject credentials with empty Binance API secret', () => {\n      const invalidCredentials = {\n        ...validCredentials,\n        binance: { ...validCredentials.binance, apiSecret: '' }\n      };\n\n      expect(() => credentialManager.saveCredentials(invalidCredentials)).toThrow(\n        'Binance API secret is empty'\n      );\n    });\n\n    test('should reject credentials with empty Bybit API key', () => {\n      const invalidCredentials = {\n        ...validCredentials,\n        bybit: { ...validCredentials.bybit, apiKey: '' }\n      };\n\n      expect(() => credentialManager.saveCredentials(invalidCredentials)).toThrow(\n        'Bybit API key is empty'\n      );\n    });\n\n    test('should reject credentials with empty Bybit API secret', () => {\n      const invalidCredentials = {\n        ...validCredentials,\n        bybit: { ...validCredentials.bybit, apiSecret: '' }\n      };\n\n      expect(() => credentialManager.saveCredentials(invalidCredentials)).toThrow(\n        'Bybit API secret is empty'\n      );\n    });\n\n    test('should reject credentials missing Binance section', () => {\n      const invalidCredentials = {\n        bybit: validCredentials.bybit\n      } as any;\n\n      expect(() => credentialManager.saveCredentials(invalidCredentials)).toThrow(\n        'Missing Binance credentials'\n      );\n    });\n\n    test('should reject credentials missing Bybit section', () => {\n      const invalidCredentials = {\n        binance: validCredentials.binance\n      } as any;\n\n      expect(() => credentialManager.saveCredentials(invalidCredentials)).toThrow(\n        'Missing Bybit credentials'\n      );\n    });\n  });\n\n  describe('Encryption and Decryption', () => {\n    beforeEach(() => {\n      credentialManager.setMasterPassword(testPassword);\n    });\n\n    test('should save and load credentials successfully', () => {\n      // Save credentials\n      credentialManager.saveCredentials(validCredentials);\n\n      // Load credentials\n      const loadedCredentials = credentialManager.loadCredentials();\n\n      // Verify credentials match\n      expect(loadedCredentials).toEqual(validCredentials);\n    });\n\n    test('should create encrypted file with restricted permissions', () => {\n      credentialManager.saveCredentials(validCredentials);\n\n      const credentialsPath = join(testDir, '.titan-scanner', 'secrets.enc');\n      expect(existsSync(credentialsPath)).toBe(true);\n\n      // Check file permissions (on Unix systems)\n      if (process.platform !== 'win32') {\n        const stats = require('fs').statSync(credentialsPath);\n        const permissions = (stats.mode & parseInt('777', 8)).toString(8);\n        expect(permissions).toBe('600'); // Read/write for owner only\n      }\n    });\n\n    test('should fail to load with wrong master password', () => {\n      // Save with correct password\n      credentialManager.saveCredentials(validCredentials);\n\n      // Try to load with wrong password\n      credentialManager.setMasterPassword('wrong_password');\n      expect(() => credentialManager.loadCredentials()).toThrow(\n        'Failed to decrypt credentials'\n      );\n    });\n\n    test('should throw error when loading non-existent credentials', () => {\n      expect(() => credentialManager.loadCredentials()).toThrow(\n        'No credentials file found'\n      );\n    });\n\n    test('should handle corrupted credentials file', () => {\n      // Save valid credentials first\n      credentialManager.saveCredentials(validCredentials);\n\n      // Corrupt the file\n      const credentialsPath = join(testDir, '.titan-scanner', 'secrets.enc');\n      require('fs').writeFileSync(credentialsPath, 'corrupted data');\n\n      // Try to load corrupted file\n      expect(() => credentialManager.loadCredentials()).toThrow(\n        'Failed to decrypt credentials'\n      );\n    });\n  });\n\n  describe('File Operations', () => {\n    beforeEach(() => {\n      credentialManager.setMasterPassword(testPassword);\n    });\n\n    test('should check if credentials exist', () => {\n      expect(credentialManager.hasCredentials()).toBe(false);\n\n      credentialManager.saveCredentials(validCredentials);\n      expect(credentialManager.hasCredentials()).toBe(true);\n    });\n\n    test('should delete credentials securely', () => {\n      credentialManager.saveCredentials(validCredentials);\n      expect(credentialManager.hasCredentials()).toBe(true);\n\n      credentialManager.deleteCredentials();\n      expect(credentialManager.hasCredentials()).toBe(false);\n    });\n\n    test('should get credentials file info', () => {\n      // Before saving\n      let info = credentialManager.getCredentialsInfo();\n      expect(info.exists).toBe(false);\n      expect(info.path).toContain('.titan-scanner/secrets.enc');\n\n      // After saving\n      credentialManager.saveCredentials(validCredentials);\n      info = credentialManager.getCredentialsInfo();\n      expect(info.exists).toBe(true);\n      expect(info.size).toBeGreaterThan(0);\n      expect(typeof info.modified).toBe('object');\n      expect(info.modified).toBeTruthy();\n    });\n\n    test('should test credentials validity', () => {\n      expect(credentialManager.testCredentials()).toBe(false);\n\n      credentialManager.saveCredentials(validCredentials);\n      expect(credentialManager.testCredentials()).toBe(true);\n\n      // Test with wrong password\n      credentialManager.setMasterPassword('wrong_password');\n      expect(credentialManager.testCredentials()).toBe(false);\n    });\n  });\n\n  describe('Exchange-Specific Operations', () => {\n    beforeEach(() => {\n      credentialManager.setMasterPassword(testPassword);\n    });\n\n    test('should update Binance credentials', () => {\n      const newApiKey = 'new_binance_api_key_32_characters_long';\n      const newApiSecret = 'new_binance_api_secret_64_characters_long_for_testing_purposes';\n\n      credentialManager.updateExchangeCredentials('binance', newApiKey, newApiSecret);\n\n      const credentials = credentialManager.loadCredentials();\n      expect(credentials.binance.apiKey).toBe(newApiKey);\n      expect(credentials.binance.apiSecret).toBe(newApiSecret);\n    });\n\n    test('should update Bybit credentials', () => {\n      const newApiKey = 'new_bybit_api_key_24_chars';\n      const newApiSecret = 'new_bybit_api_secret_48_characters_long_test';\n\n      credentialManager.updateExchangeCredentials('bybit', newApiKey, newApiSecret);\n\n      const credentials = credentialManager.loadCredentials();\n      expect(credentials.bybit.apiKey).toBe(newApiKey);\n      expect(credentials.bybit.apiSecret).toBe(newApiSecret);\n    });\n\n    test('should get specific exchange credentials', () => {\n      credentialManager.saveCredentials(validCredentials);\n\n      const binanceCredentials = credentialManager.getExchangeCredentials('binance');\n      expect(binanceCredentials).toEqual(validCredentials.binance);\n\n      const bybitCredentials = credentialManager.getExchangeCredentials('bybit');\n      expect(bybitCredentials).toEqual(validCredentials.bybit);\n    });\n\n    test('should create new credentials when updating non-existent file', () => {\n      const apiKey = 'test_api_key_32_characters_long';\n      const apiSecret = 'test_api_secret_64_characters_long_for_testing_purposes';\n\n      credentialManager.updateExchangeCredentials('binance', apiKey, apiSecret);\n\n      const credentials = credentialManager.loadCredentials();\n      expect(credentials.binance.apiKey).toBe(apiKey);\n      expect(credentials.binance.apiSecret).toBe(apiSecret);\n      expect(credentials.bybit.apiKey).toBe('placeholder_bybit_api_key_24');\n      expect(credentials.bybit.apiSecret).toBe('placeholder_bybit_api_secret_48_characters_long');\n    });\n  });\n\n  describe('Master Password Change', () => {\n    beforeEach(() => {\n      credentialManager.setMasterPassword(testPassword);\n    });\n\n    test('should change master password successfully', () => {\n      credentialManager.saveCredentials(validCredentials);\n\n      const newPassword = 'new_master_password_456';\n      credentialManager.changeMasterPassword(newPassword);\n\n      // Verify credentials can be loaded with new password\n      const loadedCredentials = credentialManager.loadCredentials();\n      expect(loadedCredentials).toEqual(validCredentials);\n\n      // Verify old password no longer works\n      credentialManager.setMasterPassword(testPassword);\n      expect(() => credentialManager.loadCredentials()).toThrow();\n    });\n\n    test('should throw error when changing password without current password set', () => {\n      const newCredentialManager = new CredentialManager();\n      expect(() => newCredentialManager.changeMasterPassword('new_password')).toThrow(\n        'Current master password not set'\n      );\n    });\n\n    test('should restore old password on failure', () => {\n      credentialManager.saveCredentials(validCredentials);\n\n      // Mock writeFileSync to fail\n      const originalWriteFileSync = require('fs').writeFileSync;\n      jest.spyOn(require('fs'), 'writeFileSync').mockImplementation(() => {\n        throw new Error('Write failed');\n      });\n\n      const newPassword = 'new_master_password_456';\n      expect(() => credentialManager.changeMasterPassword(newPassword)).toThrow('Write failed');\n\n      // Restore original function\n      require('fs').writeFileSync = originalWriteFileSync;\n\n      // Verify old password still works\n      const loadedCredentials = credentialManager.loadCredentials();\n      expect(loadedCredentials).toEqual(validCredentials);\n    });\n  });\n\n  describe('Edge Cases', () => {\n    beforeEach(() => {\n      credentialManager.setMasterPassword(testPassword);\n    });\n\n    test('should handle credentials with whitespace', () => {\n      const credentialsWithWhitespace = {\n        binance: {\n          apiKey: '  binance_test_api_key_32_characters_long  ',\n          apiSecret: '  binance_test_api_secret_64_characters_long_for_testing_purposes  '\n        },\n        bybit: {\n          apiKey: '  bybit_test_api_key_24_chars  ',\n          apiSecret: '  bybit_test_api_secret_48_characters_long_test  '\n        }\n      };\n\n      expect(() => credentialManager.saveCredentials(credentialsWithWhitespace)).not.toThrow();\n    });\n\n    test('should handle very long credentials', () => {\n      const longCredentials = {\n        binance: {\n          apiKey: 'a'.repeat(100),\n          apiSecret: 'b'.repeat(200)\n        },\n        bybit: {\n          apiKey: 'c'.repeat(100),\n          apiSecret: 'd'.repeat(200)\n        }\n      };\n\n      expect(() => credentialManager.saveCredentials(longCredentials)).not.toThrow();\n\n      const loadedCredentials = credentialManager.loadCredentials();\n      expect(loadedCredentials).toEqual(longCredentials);\n    });\n\n    test('should handle special characters in credentials', () => {\n      const specialCredentials = {\n        binance: {\n          apiKey: 'binance_key_with_special_chars_!@#$%^&*()',\n          apiSecret: 'binance_secret_with_unicode_chars_Î±Î²Î³Î´Îµ_and_emojis_ðŸš€ðŸŒ™'\n        },\n        bybit: {\n          apiKey: 'bybit_key_with_numbers_123456789',\n          apiSecret: 'bybit_secret_with_mixed_Case_AND_symbols_+=[]{}|;:,.<>?'\n        }\n      };\n\n      expect(() => credentialManager.saveCredentials(specialCredentials)).not.toThrow();\n\n      const loadedCredentials = credentialManager.loadCredentials();\n      expect(loadedCredentials).toEqual(specialCredentials);\n    });\n  });\n});"],"version":3}