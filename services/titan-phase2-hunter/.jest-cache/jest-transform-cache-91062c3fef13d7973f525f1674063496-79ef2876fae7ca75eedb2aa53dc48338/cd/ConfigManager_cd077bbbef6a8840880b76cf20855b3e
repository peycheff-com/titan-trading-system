7a2fc46cd1212f16ceff28ad58cc4fcf
"use strict";
/**
 * Configuration Manager for Titan Phase 2 - The Hunter
 *
 * Provides runtime configuration management with hot-reload support,
 * default values, and validation for Phase 2 specific settings.
 *
 * Requirements: 18.1-18.8 (Runtime Configuration)
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.ConfigManager = void 0;
const events_1 = require("events");
const fs_1 = require("fs");
const path_1 = require("path");
/**
 * Default configuration values
 */
const DEFAULT_CONFIG = {
    alignmentWeights: {
        daily: 50, // 50%
        h4: 30, // 30%
        m15: 20, // 20%
    },
    rsConfig: {
        threshold: 2, // 2%
        lookbackPeriod: 4, // 4 hours
    },
    riskConfig: {
        maxLeverage: 5, // 5x
        stopLossPercent: 1.5, // 1.5%
        targetPercent: 4.5, // 4.5% (3:1 R:R)
    },
    portfolioConfig: {
        maxConcurrentPositions: 5, // 5 positions
        maxPortfolioHeat: 15, // 15%
        correlationThreshold: 0.7, // 0.7
    },
    forwardTestConfig: {
        enabled: false, // Paper trading disabled by default
        duration: 24, // 24 hours
        logSignalsOnly: false, // Full paper trading by default
        compareToBacktest: false, // No comparison by default
    },
    version: 1,
    lastModified: Date.now(),
};
/**
 * Configuration Manager for Phase 2
 */
class ConfigManager extends events_1.EventEmitter {
    config;
    configPath;
    isWatching = false;
    constructor(configDirectory = "./config") {
        super();
        this.configPath = (0, path_1.join)(configDirectory, "phase2.config.json");
        this.config = this.loadConfig();
    }
    /**
     * Load configuration from file with defaults
     * Requirement 18.8: Load default configuration if file is corrupted
     */
    loadConfig() {
        try {
            if (!(0, fs_1.existsSync)(this.configPath)) {
                console.log("üìã No config file found, creating default configuration");
                this.saveConfig(DEFAULT_CONFIG);
                return { ...DEFAULT_CONFIG };
            }
            const fileContent = (0, fs_1.readFileSync)(this.configPath, "utf8");
            const loadedConfig = JSON.parse(fileContent);
            // Validate loaded configuration
            const validation = this.validateConfig(loadedConfig);
            if (!validation.isValid) {
                console.error("‚ùå CONFIG_CORRUPTED: Invalid configuration file");
                console.error("Errors:", validation.errors);
                console.log("üìã Loading default configuration");
                // Backup corrupted config
                const backupPath = `${this.configPath}.corrupted.${Date.now()}`;
                (0, fs_1.writeFileSync)(backupPath, fileContent);
                console.log(`üíæ Corrupted config backed up to: ${backupPath}`);
                // Load defaults
                this.saveConfig(DEFAULT_CONFIG);
                return { ...DEFAULT_CONFIG };
            }
            // Merge with defaults to ensure all fields are present
            const mergedConfig = this.mergeWithDefaults(loadedConfig);
            console.log("‚úÖ Configuration loaded successfully");
            if (validation.warnings.length > 0) {
                console.warn("‚ö†Ô∏è Configuration warnings:", validation.warnings);
            }
            return mergedConfig;
        }
        catch (error) {
            console.error("‚ùå CONFIG_CORRUPTED: Failed to load configuration:", error);
            console.log("üìã Loading default configuration");
            // Save defaults
            this.saveConfig(DEFAULT_CONFIG);
            return { ...DEFAULT_CONFIG };
        }
    }
    /**
     * Save configuration to file with immediate write
     * Requirement 18.6: Write configuration to config.json file and apply changes immediately
     */
    saveConfig(config) {
        try {
            // Update version and timestamp
            config.version = (config.version || 0) + 1;
            config.lastModified = Date.now();
            // Validate before saving
            const validation = this.validateConfig(config);
            if (!validation.isValid) {
                throw new Error(`Invalid configuration: ${validation.errors.join(", ")}`);
            }
            // Ensure directory exists
            const configDir = (0, path_1.dirname)(this.configPath);
            if (!(0, fs_1.existsSync)(configDir)) {
                (0, fs_1.mkdirSync)(configDir, { recursive: true });
            }
            // Write to file immediately
            (0, fs_1.writeFileSync)(this.configPath, JSON.stringify(config, null, 2), "utf8");
            // Update internal config
            const oldConfig = { ...this.config };
            this.config = { ...config };
            // Emit change event
            this.emit("configChanged", {
                section: "all",
                oldValue: oldConfig,
                newValue: config,
                timestamp: Date.now(),
            });
            console.log("üíæ Configuration saved successfully");
        }
        catch (error) {
            console.error("‚ùå Failed to save configuration:", error);
            throw error;
        }
    }
    /**
     * Get current configuration
     */
    getConfig() {
        return { ...this.config };
    }
    /**
     * Update alignment weights
     * Requirement 18.2: Allow adjustment of Daily weight (30-60%), 4H weight (20-40%), 15m weight (10-30%)
     */
    updateAlignmentWeights(weights) {
        const newWeights = { ...this.config.alignmentWeights, ...weights };
        // Validate individual weight ranges first
        if (newWeights.daily < 30 || newWeights.daily > 60) {
            throw new Error(`Daily weight must be 30-60%, got ${newWeights.daily}%`);
        }
        if (newWeights.h4 < 20 || newWeights.h4 > 40) {
            throw new Error(`4H weight must be 20-40%, got ${newWeights.h4}%`);
        }
        if (newWeights.m15 < 10 || newWeights.m15 > 30) {
            throw new Error(`15m weight must be 10-30%, got ${newWeights.m15}%`);
        }
        // Validate weights sum to 100%
        const total = newWeights.daily + newWeights.h4 + newWeights.m15;
        if (Math.abs(total - 100) > 0.1) {
            throw new Error(`Alignment weights must sum to 100%, got ${total}%`);
        }
        const newConfig = {
            ...this.config,
            alignmentWeights: newWeights,
        };
        this.saveConfig(newConfig);
    }
    /**
     * Update RS configuration
     * Requirement 18.3: Allow adjustment of RS threshold (0-5%) and lookback period (2-8 hours)
     */
    updateRSConfig(rsConfig) {
        const newRSConfig = { ...this.config.rsConfig, ...rsConfig };
        const newConfig = {
            ...this.config,
            rsConfig: newRSConfig,
        };
        this.saveConfig(newConfig);
    }
    /**
     * Update risk configuration
     * Requirement 18.4: Allow adjustment of max leverage (3-5x), stop loss (1-3%), target (3-6%)
     */
    updateRiskConfig(riskConfig) {
        const newRiskConfig = { ...this.config.riskConfig, ...riskConfig };
        const newConfig = {
            ...this.config,
            riskConfig: newRiskConfig,
        };
        this.saveConfig(newConfig);
    }
    /**
     * Update portfolio configuration
     * Requirement 18.5: Allow adjustment of max positions (3-8), max heat (10-20%), correlation (0.6-0.9)
     */
    updatePortfolioConfig(portfolioConfig) {
        const newPortfolioConfig = {
            ...this.config.portfolioConfig,
            ...portfolioConfig,
        };
        const newConfig = {
            ...this.config,
            portfolioConfig: newPortfolioConfig,
        };
        this.saveConfig(newConfig);
    }
    /**
     * Update forward test configuration
     * Add paper trading toggle in config
     */
    updateForwardTestConfig(forwardTestConfig) {
        const newForwardTestConfig = {
            ...this.config.forwardTestConfig,
            ...forwardTestConfig,
        };
        const newConfig = {
            ...this.config,
            forwardTestConfig: newForwardTestConfig,
        };
        this.saveConfig(newConfig);
    }
    /**
     * Start watching configuration file for changes (hot-reload)
     * Support hot-reload without restart
     */
    startWatching() {
        if (this.isWatching) {
            return;
        }
        this.isWatching = true;
        (0, fs_1.watchFile)(this.configPath, { interval: 1000 }, (curr, prev) => {
            if (curr.mtime !== prev.mtime) {
                console.log("üîÑ Configuration file changed, reloading...");
                try {
                    const newConfig = this.loadConfig();
                    const oldConfig = { ...this.config };
                    this.config = newConfig;
                    this.emit("configReloaded", {
                        section: "all",
                        oldValue: oldConfig,
                        newValue: newConfig,
                        timestamp: Date.now(),
                    });
                    console.log("‚úÖ Configuration reloaded successfully");
                }
                catch (error) {
                    console.error("‚ùå Failed to reload configuration:", error);
                }
            }
        });
        console.log("üëÅÔ∏è Started watching configuration file for changes");
    }
    /**
     * Stop watching configuration file
     */
    stopWatching() {
        if (!this.isWatching) {
            return;
        }
        (0, fs_1.unwatchFile)(this.configPath);
        this.isWatching = false;
        console.log("üëÅÔ∏è Stopped watching configuration file");
    }
    /**
     * Validate configuration against requirements
     */
    validateConfig(config) {
        const errors = [];
        const warnings = [];
        // Validate alignment weights
        if (!config.alignmentWeights) {
            errors.push("Missing alignmentWeights");
        }
        else {
            const { daily, h4, m15 } = config.alignmentWeights;
            if (daily < 30 || daily > 60) {
                errors.push(`Daily weight must be 30-60%, got ${daily}%`);
            }
            if (h4 < 20 || h4 > 40) {
                errors.push(`4H weight must be 20-40%, got ${h4}%`);
            }
            if (m15 < 10 || m15 > 30) {
                errors.push(`15m weight must be 10-30%, got ${m15}%`);
            }
            const total = daily + h4 + m15;
            if (Math.abs(total - 100) > 0.1) {
                errors.push(`Alignment weights must sum to 100%, got ${total}%`);
            }
        }
        // Validate RS config
        if (!config.rsConfig) {
            errors.push("Missing rsConfig");
        }
        else {
            const { threshold, lookbackPeriod } = config.rsConfig;
            if (threshold < 0 || threshold > 5) {
                errors.push(`RS threshold must be 0-5%, got ${threshold}%`);
            }
            if (lookbackPeriod < 2 || lookbackPeriod > 8) {
                errors.push(`RS lookback period must be 2-8 hours, got ${lookbackPeriod} hours`);
            }
        }
        // Validate risk config
        if (!config.riskConfig) {
            errors.push("Missing riskConfig");
        }
        else {
            const { maxLeverage, stopLossPercent, targetPercent } = config.riskConfig;
            if (maxLeverage < 3 || maxLeverage > 5) {
                errors.push(`Max leverage must be 3-5x, got ${maxLeverage}x`);
            }
            if (stopLossPercent < 1 || stopLossPercent > 3) {
                errors.push(`Stop loss must be 1-3%, got ${stopLossPercent}%`);
            }
            if (targetPercent < 3 || targetPercent > 6) {
                errors.push(`Target must be 3-6%, got ${targetPercent}%`);
            }
            // Check R:R ratio
            const rrRatio = targetPercent / stopLossPercent;
            if (rrRatio < 2.5) {
                warnings.push(`R:R ratio is ${rrRatio.toFixed(1)}:1, consider increasing target or decreasing stop`);
            }
        }
        // Validate portfolio config
        if (!config.portfolioConfig) {
            errors.push("Missing portfolioConfig");
        }
        else {
            const { maxConcurrentPositions, maxPortfolioHeat, correlationThreshold } = config.portfolioConfig;
            if (maxConcurrentPositions < 3 || maxConcurrentPositions > 8) {
                errors.push(`Max concurrent positions must be 3-8, got ${maxConcurrentPositions}`);
            }
            if (maxPortfolioHeat < 10 || maxPortfolioHeat > 20) {
                errors.push(`Max portfolio heat must be 10-20%, got ${maxPortfolioHeat}%`);
            }
            if (correlationThreshold < 0.6 || correlationThreshold > 0.9) {
                errors.push(`Correlation threshold must be 0.6-0.9, got ${correlationThreshold}`);
            }
        }
        // Validate forward test config
        if (!config.forwardTestConfig) {
            errors.push("Missing forwardTestConfig");
        }
        else {
            const { enabled, duration, logSignalsOnly, compareToBacktest } = config.forwardTestConfig;
            if (typeof enabled !== 'boolean') {
                errors.push("Forward test enabled must be boolean");
            }
            if (duration < 1 || duration > 168) { // 1 hour to 1 week
                errors.push(`Forward test duration must be 1-168 hours, got ${duration} hours`);
            }
            if (typeof logSignalsOnly !== 'boolean') {
                errors.push("Forward test logSignalsOnly must be boolean");
            }
            if (typeof compareToBacktest !== 'boolean') {
                errors.push("Forward test compareToBacktest must be boolean");
            }
        }
        return {
            isValid: errors.length === 0,
            errors,
            warnings,
        };
    }
    /**
     * Merge loaded config with defaults to ensure all fields are present
     */
    mergeWithDefaults(loadedConfig) {
        return {
            alignmentWeights: {
                ...DEFAULT_CONFIG.alignmentWeights,
                ...loadedConfig.alignmentWeights,
            },
            rsConfig: {
                ...DEFAULT_CONFIG.rsConfig,
                ...loadedConfig.rsConfig,
            },
            riskConfig: {
                ...DEFAULT_CONFIG.riskConfig,
                ...loadedConfig.riskConfig,
            },
            portfolioConfig: {
                ...DEFAULT_CONFIG.portfolioConfig,
                ...loadedConfig.portfolioConfig,
            },
            forwardTestConfig: {
                ...DEFAULT_CONFIG.forwardTestConfig,
                ...loadedConfig.forwardTestConfig,
            },
            version: loadedConfig.version || DEFAULT_CONFIG.version,
            lastModified: loadedConfig.lastModified || Date.now(),
        };
    }
    /**
     * Reset configuration to defaults
     */
    resetToDefaults() {
        console.log("üîÑ Resetting configuration to defaults");
        this.saveConfig({ ...DEFAULT_CONFIG });
    }
    /**
     * Get configuration summary for display
     */
    getConfigSummary() {
        const config = this.config;
        return [
            `üìä Alignment: Daily ${config.alignmentWeights.daily}%, 4H ${config.alignmentWeights.h4}%, 15m ${config.alignmentWeights.m15}%`,
            `üìà RS: Threshold ${config.rsConfig.threshold}%, Lookback ${config.rsConfig.lookbackPeriod}h`,
            `‚ö° Risk: Leverage ${config.riskConfig.maxLeverage}x, Stop ${config.riskConfig.stopLossPercent}%, Target ${config.riskConfig.targetPercent}%`,
            `üíº Portfolio: Max ${config.portfolioConfig.maxConcurrentPositions} positions, Heat ${config.portfolioConfig.maxPortfolioHeat}%, Correlation ${config.portfolioConfig.correlationThreshold}`,
            `üß™ Forward Test: ${config.forwardTestConfig.enabled ? 'Enabled' : 'Disabled'}, Duration ${config.forwardTestConfig.duration}h, Signals Only: ${config.forwardTestConfig.logSignalsOnly}`,
        ].join("\n");
    }
    /**
     * Cleanup resources
     */
    destroy() {
        this.stopWatching();
        this.removeAllListeners();
    }
}
exports.ConfigManager = ConfigManager;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2l2YW4vQ29kZS90cmFkaW5nL3RpdGFuL3NlcnZpY2VzL3RpdGFuLXBoYXNlMi1odW50ZXIvc3JjL2NvbmZpZy9Db25maWdNYW5hZ2VyLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7OztHQU9HOzs7QUFFSCxtQ0FBc0M7QUFDdEMsMkJBT1k7QUFDWiwrQkFBcUM7QUErRXJDOztHQUVHO0FBQ0gsTUFBTSxjQUFjLEdBQWlCO0lBQ25DLGdCQUFnQixFQUFFO1FBQ2hCLEtBQUssRUFBRSxFQUFFLEVBQUUsTUFBTTtRQUNqQixFQUFFLEVBQUUsRUFBRSxFQUFFLE1BQU07UUFDZCxHQUFHLEVBQUUsRUFBRSxFQUFFLE1BQU07S0FDaEI7SUFDRCxRQUFRLEVBQUU7UUFDUixTQUFTLEVBQUUsQ0FBQyxFQUFFLEtBQUs7UUFDbkIsY0FBYyxFQUFFLENBQUMsRUFBRSxVQUFVO0tBQzlCO0lBQ0QsVUFBVSxFQUFFO1FBQ1YsV0FBVyxFQUFFLENBQUMsRUFBRSxLQUFLO1FBQ3JCLGVBQWUsRUFBRSxHQUFHLEVBQUUsT0FBTztRQUM3QixhQUFhLEVBQUUsR0FBRyxFQUFFLGlCQUFpQjtLQUN0QztJQUNELGVBQWUsRUFBRTtRQUNmLHNCQUFzQixFQUFFLENBQUMsRUFBRSxjQUFjO1FBQ3pDLGdCQUFnQixFQUFFLEVBQUUsRUFBRSxNQUFNO1FBQzVCLG9CQUFvQixFQUFFLEdBQUcsRUFBRSxNQUFNO0tBQ2xDO0lBQ0QsaUJBQWlCLEVBQUU7UUFDakIsT0FBTyxFQUFFLEtBQUssRUFBRSxvQ0FBb0M7UUFDcEQsUUFBUSxFQUFFLEVBQUUsRUFBRSxXQUFXO1FBQ3pCLGNBQWMsRUFBRSxLQUFLLEVBQUUsZ0NBQWdDO1FBQ3ZELGlCQUFpQixFQUFFLEtBQUssRUFBRSwyQkFBMkI7S0FDdEQ7SUFDRCxPQUFPLEVBQUUsQ0FBQztJQUNWLFlBQVksRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFO0NBQ3pCLENBQUM7QUFFRjs7R0FFRztBQUNILE1BQWEsYUFBYyxTQUFRLHFCQUFZO0lBQ3JDLE1BQU0s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QUM7SUFDekMsQ0FBQztJQUVEOztPQUVHO0lBQ0gsZ0JBQWdCO1FBQ2QsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQztRQUMzQixPQUFPO1lBQ0wsdUJBQXVCLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLFNBQVMsTUFBTSxDQUFDLGdCQUFnQixDQUFDLEVBQUUsVUFBVSxNQUFNLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxHQUFHO1lBQy9ILG9CQUFvQixNQUFNLENBQUMsUUFBUSxDQUFDLFNBQVMsZUFBZSxNQUFNLENBQUMsUUFBUSxDQUFDLGNBQWMsR0FBRztZQUM3RixvQkFBb0IsTUFBTSxDQUFDLFVBQVUsQ0FBQyxXQUFXLFdBQVcsTUFBTSxDQUFDLFVBQVUsQ0FBQyxlQUFlLGFBQWEsTUFBTSxDQUFDLFVBQVUsQ0FBQyxhQUFhLEdBQUc7WUFDNUkscUJBQXFCLE1BQU0sQ0FBQyxlQUFlLENBQUMsc0JBQXNCLG9CQUFvQixNQUFNLENBQUMsZUFBZSxDQUFDLGdCQUFnQixrQkFBa0IsTUFBTSxDQUFDLGVBQWUsQ0FBQyxvQkFBb0IsRUFBRTtZQUM1TCxvQkFBb0IsTUFBTSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxVQUFVLGNBQWMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLFFBQVEsb0JBQW9CLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxjQUFjLEVBQUU7U0FDMUwsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDZixDQUFDO0lBRUQ7O09BRUc7SUFDSCxPQUFPO1FBQ0wsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO1FBQ3BCLElBQUksQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO0lBQzVCLENBQUM7Q0FDRjtBQS9iRCxzQ0ErYkMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2l2YW4vQ29kZS90cmFkaW5nL3RpdGFuL3NlcnZpY2VzL3RpdGFuLXBoYXNlMi1odW50ZXIvc3JjL2NvbmZpZy9Db25maWdNYW5hZ2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29uZmlndXJhdGlvbiBNYW5hZ2VyIGZvciBUaXRhbiBQaGFzZSAyIC0gVGhlIEh1bnRlclxuICpcbiAqIFByb3ZpZGVzIHJ1bnRpbWUgY29uZmlndXJhdGlvbiBtYW5hZ2VtZW50IHdpdGggaG90LXJlbG9hZCBzdXBwb3J0LFxuICogZGVmYXVsdCB2YWx1ZXMsIGFuZCB2YWxpZGF0aW9uIGZvciBQaGFzZSAyIHNwZWNpZmljIHNldHRpbmdzLlxuICpcbiAqIFJlcXVpcmVtZW50czogMTguMS0xOC44IChSdW50aW1lIENvbmZpZ3VyYXRpb24pXG4gKi9cblxuaW1wb3J0IHsgRXZlbnRFbWl0dGVyIH0gZnJvbSBcImV2ZW50c1wiO1xuaW1wb3J0IHtcbiAgZXhpc3RzU3luYyxcbiAgbWtkaXJTeW5jLFxuICByZWFkRmlsZVN5bmMsXG4gIHVud2F0Y2hGaWxlLFxuICB3YXRjaEZpbGUsXG4gIHdyaXRlRmlsZVN5bmMsXG59IGZyb20gXCJmc1wiO1xuaW1wb3J0IHsgZGlybmFtZSwgam9pbiB9IGZyb20gXCJwYXRoXCI7XG5cbi8qKlxuICogQWxpZ25tZW50IHdlaWdodCBjb25maWd1cmF0aW9uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQWxpZ25tZW50V2VpZ2h0cyB7XG4gIGRhaWx5OiBudW1iZXI7IC8vIDMwLTYwJVxuICBoNDogbnVtYmVyOyAvLyAyMC00MCVcbiAgbTE1OiBudW1iZXI7IC8vIDEwLTMwJVxufVxuXG4vKipcbiAqIFJlbGF0aXZlIFN0cmVuZ3RoIGNvbmZpZ3VyYXRpb25cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBSU0NvbmZpZyB7XG4gIHRocmVzaG9sZDogbnVtYmVyOyAvLyAwLTUlXG4gIGxvb2tiYWNrUGVyaW9kOiBudW1iZXI7IC8vIDItOCBob3Vyc1xufVxuXG4vKipcbiAqIFJpc2sgbWFuYWdlbWVudCBjb25maWd1cmF0aW9uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgUmlza0NvbmZpZyB7XG4gIG1heExldmVyYWdlOiBudW1iZXI7IC8vIDMtNXhcbiAgc3RvcExvc3NQZXJjZW50OiBudW1iZXI7IC8vIDEtMyVcbiAgdGFyZ2V0UGVyY2VudDogbnVtYmVyOyAvLyAzLTYlXG59XG5cbi8qKlxuICogUG9ydGZvbGlvIG1hbmFnZW1lbnQgY29uZmlndXJhdGlvblxuICovXG5leHBvcnQgaW50ZXJmYWNlIFBvcnRmb2xpb0NvbmZpZyB7XG4gIG1heENvbmN1cnJlbnRQb3NpdGlvbnM6IG51bWJlcjsgLy8gMy04XG4gIG1heFBvcnRmb2xpb0hlYXQ6IG51bWJlcjsgLy8gMTAtMjAlXG4gIGNvcnJlbGF0aW9uVGhyZXNob2xkOiBudW1iZXI7IC8vIDAuNi0wLjlcbn1cblxuLyoqXG4gKiBGb3J3YXJkIHRlc3QgY29uZmlndXJhdGlvblxuICovXG5leHBvcnQgaW50ZXJmYWNlIEZvcndhcmRUZXN0Q29uZmlnIHtcbiAgZW5hYmxlZDogYm9vbGVhbjsgLy8gUGFwZXIgdHJhZGluZyB0b2dnbGVcbiAgZHVyYXRpb246IG51bWJlcjsgLy8gVGVzdCBkdXJhdGlvbiBpbiBob3Vyc1xuICBsb2dTaWduYWxzT25seTogYm9vbGVhbjsgLy8gSWYgdHJ1ZSwgb25seSBsb2cgc2lnbmFscyB3aXRob3V0IHNpbXVsYXRpbmcgdHJhZGVzXG4gIGNvbXBhcmVUb0JhY2t0ZXN0OiBib29sZWFuOyAvLyBJZiB0cnVlLCBjb21wYXJlIHJlc3VsdHMgdG8gYmFja3Rlc3Rcbn1cblxuLyoqXG4gKiBDb21wbGV0ZSBQaGFzZSAyIGNvbmZpZ3VyYXRpb25cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBQaGFzZTJDb25maWcge1xuICBhbGlnbm1lbnRXZWlnaHRzOiBBbGlnbm1lbnRXZWlnaHRzO1xuICByc0NvbmZpZzogUlNDb25maWc7XG4gIHJpc2tDb25maWc6IFJpc2tDb25maWc7XG4gIHBvcnRmb2xpb0NvbmZpZzogUG9ydGZvbGlvQ29uZmlnO1xuICBmb3J3YXJkVGVzdENvbmZpZzogRm9yd2FyZFRlc3RDb25maWc7XG4gIHZlcnNpb246IG51bWJlcjtcbiAgbGFzdE1vZGlmaWVkOiBudW1iZXI7XG59XG5cbi8qKlxuICogQ29uZmlndXJhdGlvbiB2YWxpZGF0aW9uIHJlc3VsdFxuICovXG5leHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRpb25SZXN1bHQge1xuICBpc1ZhbGlkOiBib29sZWFuO1xuICBlcnJvcnM6IHN0cmluZ1tdO1xuICB3YXJuaW5nczogc3RyaW5nW107XG59XG5cbi8qKlxuICogQ29uZmlndXJhdGlvbiBjaGFuZ2UgZXZlbnRcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBDb25maWdDaGFuZ2VFdmVudCB7XG4gIHNlY3Rpb246IGtleW9mIFBoYXNlMkNvbmZpZztcbiAgb2xkVmFsdWU6IGFueTtcbiAgbmV3VmFsdWU6IGFueTtcbiAgdGltZXN0YW1wOiBudW1iZXI7XG59XG5cbi8qKlxuICogRGVmYXVsdCBjb25maWd1cmF0aW9uIHZhbHVlc1xuICovXG5jb25zdCBERUZBVUxUX0NPTkZJRzogUGhhc2UyQ29uZmlnID0ge1xuICBhbGlnbm1lbnRXZWlnaHRzOiB7XG4gICAgZGFpbHk6IDUwLCAvLyA1MCVcbiAgICBoNDogMzAsIC8vIDMwJVxuICAgIG0xNTogMjAsIC8vIDIwJVxuICB9LFxuICByc0NvbmZpZzoge1xuICAgIHRocmVzaG9sZDogMiwgLy8gMiVcbiAgICBsb29rYmFja1BlcmlvZDogNCwgLy8gNCBob3Vyc1xuICB9LFxuICByaXNrQ29uZmlnOiB7XG4gICAgbWF4TGV2ZXJhZ2U6IDUsIC8vIDV4XG4gICAgc3RvcExvc3NQZXJjZW50OiAxLjUsIC8vIDEuNSVcbiAgICB0YXJnZXRQZXJjZW50OiA0LjUsIC8vIDQuNSUgKDM6MSBSOlIpXG4gIH0sXG4gIHBvcnRmb2xpb0NvbmZpZzoge1xuICAgIG1heENvbmN1cnJlbnRQb3NpdGlvbnM6IDUsIC8vIDUgcG9zaXRpb25zXG4gICAgbWF4UG9ydGZvbGlvSGVhdDogMTUsIC8vIDE1JVxuICAgIGNvcnJlbGF0aW9uVGhyZXNob2xkOiAwLjcsIC8vIDAuN1xuICB9LFxuICBmb3J3YXJkVGVzdENvbmZpZzoge1xuICAgIGVuYWJsZWQ6IGZhbHNlLCAvLyBQYXBlciB0cmFkaW5nIGRpc2FibGVkIGJ5IGRlZmF1bHRcbiAgICBkdXJhdGlvbjogMjQsIC8vIDI0IGhvdXJzXG4gICAgbG9nU2lnbmFsc09ubHk6IGZhbHNlLCAvLyBGdWxsIHBhcGVyIHRyYWRpbmcgYnkgZGVmYXVsdFxuICAgIGNvbXBhcmVUb0JhY2t0ZXN0OiBmYWxzZSwgLy8gTm8gY29tcGFyaXNvbiBieSBkZWZhdWx0XG4gIH0sXG4gIHZlcnNpb246IDEsXG4gIGxhc3RNb2RpZmllZDogRGF0ZS5ub3coKSxcbn07XG5cbi8qKlxuICogQ29uZmlndXJhdGlvbiBNYW5hZ2VyIGZvciBQaGFzZSAyXG4gKi9cbmV4cG9ydCBjbGFzcyBDb25maWdNYW5hZ2VyIGV4dGVuZHMgRXZlbnRFbWl0dGVyIHtcbiAgcHJpdmF0ZSBjb25maWc6IFBoYXNlMkNvbmZpZztcbiAgcHJpdmF0ZSBjb25maWdQYXRoOiBzdHJpbmc7XG4gIHByaXZhdGUgaXNXYXRjaGluZzogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIGNvbnN0cnVjdG9yKGNvbmZpZ0RpcmVjdG9yeTogc3RyaW5nID0gXCIuL2NvbmZpZ1wiKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLmNvbmZpZ1BhdGggPSBqb2luKGNvbmZpZ0RpcmVjdG9yeSwgXCJwaGFzZTIuY29uZmlnLmpzb25cIik7XG4gICAgdGhpcy5jb25maWcgPSB0aGlzLmxvYWRDb25maWcoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBMb2FkIGNvbmZpZ3VyYXRpb24gZnJvbSBmaWxlIHdpdGggZGVmYXVsdHNcbiAgICogUmVxdWlyZW1lbnQgMTguODogTG9hZCBkZWZhdWx0IGNvbmZpZ3VyYXRpb24gaWYgZmlsZSBpcyBjb3JydXB0ZWRcbiAgICovXG4gIGxvYWRDb25maWcoKTogUGhhc2UyQ29uZmlnIHtcbiAgICB0cnkge1xuICAgICAgaWYgKCFleGlzdHNTeW5jKHRoaXMuY29uZmlnUGF0aCkpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCLwn5OLIE5vIGNvbmZpZyBmaWxlIGZvdW5kLCBjcmVhdGluZyBkZWZhdWx0IGNvbmZpZ3VyYXRpb25cIik7XG4gICAgICAgIHRoaXMuc2F2ZUNvbmZpZyhERUZBVUxUX0NPTkZJRyk7XG4gICAgICAgIHJldHVybiB7IC4uLkRFRkFVTFRfQ09ORklHIH07XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGZpbGVDb250ZW50ID0gcmVhZEZpbGVTeW5jKHRoaXMuY29uZmlnUGF0aCwgXCJ1dGY4XCIpO1xuICAgICAgY29uc3QgbG9hZGVkQ29uZmlnID0gSlNPTi5wYXJzZShmaWxlQ29udGVudCkgYXMgUGhhc2UyQ29uZmlnO1xuXG4gICAgICAvLyBWYWxpZGF0ZSBsb2FkZWQgY29uZmlndXJhdGlvblxuICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IHRoaXMudmFsaWRhdGVDb25maWcobG9hZGVkQ29uZmlnKTtcbiAgICAgIGlmICghdmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgQ09ORklHX0NPUlJVUFRFRDogSW52YWxpZCBjb25maWd1cmF0aW9uIGZpbGVcIik7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvcnM6XCIsIHZhbGlkYXRpb24uZXJyb3JzKTtcbiAgICAgICAgY29uc29sZS5sb2coXCLwn5OLIExvYWRpbmcgZGVmYXVsdCBjb25maWd1cmF0aW9uXCIpO1xuXG4gICAgICAgIC8vIEJhY2t1cCBjb3JydXB0ZWQgY29uZmlnXG4gICAgICAgIGNvbnN0IGJhY2t1cFBhdGggPSBgJHt0aGlzLmNvbmZpZ1BhdGh9LmNvcnJ1cHRlZC4ke0RhdGUubm93KCl9YDtcbiAgICAgICAgd3JpdGVGaWxlU3luYyhiYWNrdXBQYXRoLCBmaWxlQ29udGVudCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGDwn5K+IENvcnJ1cHRlZCBjb25maWcgYmFja2VkIHVwIHRvOiAke2JhY2t1cFBhdGh9YCk7XG5cbiAgICAgICAgLy8gTG9hZCBkZWZhdWx0c1xuICAgICAgICB0aGlzLnNhdmVDb25maWcoREVGQVVMVF9DT05GSUcpO1xuICAgICAgICByZXR1cm4geyAuLi5ERUZBVUxUX0NPTkZJRyB9O1xuICAgICAgfVxuXG4gICAgICAvLyBNZXJnZSB3aXRoIGRlZmF1bHRzIHRvIGVuc3VyZSBhbGwgZmllbGRzIGFyZSBwcmVzZW50XG4gICAgICBjb25zdCBtZXJnZWRDb25maWcgPSB0aGlzLm1lcmdlV2l0aERlZmF1bHRzKGxvYWRlZENvbmZpZyk7XG5cbiAgICAgIGNvbnNvbGUubG9nKFwi4pyFIENvbmZpZ3VyYXRpb24gbG9hZGVkIHN1Y2Nlc3NmdWxseVwiKTtcbiAgICAgIGlmICh2YWxpZGF0aW9uLndhcm5pbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc29sZS53YXJuKFwi4pqg77iPIENvbmZpZ3VyYXRpb24gd2FybmluZ3M6XCIsIHZhbGlkYXRpb24ud2FybmluZ3MpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gbWVyZ2VkQ29uZmlnO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFxuICAgICAgICBcIuKdjCBDT05GSUdfQ09SUlVQVEVEOiBGYWlsZWQgdG8gbG9hZCBjb25maWd1cmF0aW9uOlwiLFxuICAgICAgICBlcnJvcixcbiAgICAgICk7XG4gICAgICBjb25zb2xlLmxvZyhcIvCfk4sgTG9hZGluZyBkZWZhdWx0IGNvbmZpZ3VyYXRpb25cIik7XG5cbiAgICAgIC8vIFNhdmUgZGVmYXVsdHNcbiAgICAgIHRoaXMuc2F2ZUNvbmZpZyhERUZBVUxUX0NPTkZJRyk7XG4gICAgICByZXR1cm4geyAuLi5ERUZBVUxUX0NPTkZJRyB9O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTYXZlIGNvbmZpZ3VyYXRpb24gdG8gZmlsZSB3aXRoIGltbWVkaWF0ZSB3cml0ZVxuICAgKiBSZXF1aXJlbWVudCAxOC42OiBXcml0ZSBjb25maWd1cmF0aW9uIHRvIGNvbmZpZy5qc29uIGZpbGUgYW5kIGFwcGx5IGNoYW5nZXMgaW1tZWRpYXRlbHlcbiAgICovXG4gIHNhdmVDb25maWcoY29uZmlnOiBQaGFzZTJDb25maWcpOiB2b2lkIHtcbiAgICB0cnkge1xuICAgICAgLy8gVXBkYXRlIHZlcnNpb24gYW5kIHRpbWVzdGFtcFxuICAgICAgY29uZmlnLnZlcnNpb24gPSAoY29uZmlnLnZlcnNpb24gfHwgMCkgKyAxO1xuICAgICAgY29uZmlnLmxhc3RNb2RpZmllZCA9IERhdGUubm93KCk7XG5cbiAgICAgIC8vIFZhbGlkYXRlIGJlZm9yZSBzYXZpbmdcbiAgICAgIGNvbnN0IHZhbGlkYXRpb24gPSB0aGlzLnZhbGlkYXRlQ29uZmlnKGNvbmZpZyk7XG4gICAgICBpZiAoIXZhbGlkYXRpb24uaXNWYWxpZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgYEludmFsaWQgY29uZmlndXJhdGlvbjogJHt2YWxpZGF0aW9uLmVycm9ycy5qb2luKFwiLCBcIil9YCxcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgLy8gRW5zdXJlIGRpcmVjdG9yeSBleGlzdHNcbiAgICAgIGNvbnN0IGNvbmZpZ0RpciA9IGRpcm5hbWUodGhpcy5jb25maWdQYXRoKTtcbiAgICAgIGlmICghZXhpc3RzU3luYyhjb25maWdEaXIpKSB7XG4gICAgICAgIG1rZGlyU3luYyhjb25maWdEaXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBXcml0ZSB0byBmaWxlIGltbWVkaWF0ZWx5XG4gICAgICB3cml0ZUZpbGVTeW5jKHRoaXMuY29uZmlnUGF0aCwgSlNPTi5zdHJpbmdpZnkoY29uZmlnLCBudWxsLCAyKSwgXCJ1dGY4XCIpO1xuXG4gICAgICAvLyBVcGRhdGUgaW50ZXJuYWwgY29uZmlnXG4gICAgICBjb25zdCBvbGRDb25maWcgPSB7IC4uLnRoaXMuY29uZmlnIH07XG4gICAgICB0aGlzLmNvbmZpZyA9IHsgLi4uY29uZmlnIH07XG5cbiAgICAgIC8vIEVtaXQgY2hhbmdlIGV2ZW50XG4gICAgICB0aGlzLmVtaXQoXCJjb25maWdDaGFuZ2VkXCIsIHtcbiAgICAgICAgc2VjdGlvbjogXCJhbGxcIixcbiAgICAgICAgb2xkVmFsdWU6IG9sZENvbmZpZyxcbiAgICAgICAgbmV3VmFsdWU6IGNvbmZpZyxcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgfSBhcyB1bmtub3duIGFzIENvbmZpZ0NoYW5nZUV2ZW50KTtcblxuICAgICAgY29uc29sZS5sb2coXCLwn5K+IENvbmZpZ3VyYXRpb24gc2F2ZWQgc3VjY2Vzc2Z1bGx5XCIpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwi4p2MIEZhaWxlZCB0byBzYXZlIGNvbmZpZ3VyYXRpb246XCIsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY3VycmVudCBjb25maWd1cmF0aW9uXG4gICAqL1xuICBnZXRDb25maWcoKTogUGhhc2UyQ29uZmlnIHtcbiAgICByZXR1cm4geyAuLi50aGlzLmNvbmZpZyB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBhbGlnbm1lbnQgd2VpZ2h0c1xuICAgKiBSZXF1aXJlbWVudCAxOC4yOiBBbGxvdyBhZGp1c3RtZW50IG9mIERhaWx5IHdlaWdodCAoMzAtNjAlKSwgNEggd2VpZ2h0ICgyMC00MCUpLCAxNW0gd2VpZ2h0ICgxMC0zMCUpXG4gICAqL1xuICB1cGRhdGVBbGlnbm1lbnRXZWlnaHRzKHdlaWdodHM6IFBhcnRpYWw8QWxpZ25tZW50V2VpZ2h0cz4pOiB2b2lkIHtcbiAgICBjb25zdCBuZXdXZWlnaHRzID0geyAuLi50aGlzLmNvbmZpZy5hbGlnbm1lbnRXZWlnaHRzLCAuLi53ZWlnaHRzIH07XG5cbiAgICAvLyBWYWxpZGF0ZSBpbmRpdmlkdWFsIHdlaWdodCByYW5nZXMgZmlyc3RcbiAgICBpZiAobmV3V2VpZ2h0cy5kYWlseSA8IDMwIHx8IG5ld1dlaWdodHMuZGFpbHkgPiA2MCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBEYWlseSB3ZWlnaHQgbXVzdCBiZSAzMC02MCUsIGdvdCAke25ld1dlaWdodHMuZGFpbHl9JWApO1xuICAgIH1cbiAgICBpZiAobmV3V2VpZ2h0cy5oNCA8IDIwIHx8IG5ld1dlaWdodHMuaDQgPiA0MCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGA0SCB3ZWlnaHQgbXVzdCBiZSAyMC00MCUsIGdvdCAke25ld1dlaWdodHMuaDR9JWApO1xuICAgIH1cbiAgICBpZiAobmV3V2VpZ2h0cy5tMTUgPCAxMCB8fCBuZXdXZWlnaHRzLm0xNSA+IDMwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYDE1bSB3ZWlnaHQgbXVzdCBiZSAxMC0zMCUsIGdvdCAke25ld1dlaWdodHMubTE1fSVgKTtcbiAgICB9XG5cbiAgICAvLyBWYWxpZGF0ZSB3ZWlnaHRzIHN1bSB0byAxMDAlXG4gICAgY29uc3QgdG90YWwgPSBuZXdXZWlnaHRzLmRhaWx5ICsgbmV3V2VpZ2h0cy5oNCArIG5ld1dlaWdodHMubTE1O1xuICAgIGlmIChNYXRoLmFicyh0b3RhbCAtIDEwMCkgPiAwLjEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQWxpZ25tZW50IHdlaWdodHMgbXVzdCBzdW0gdG8gMTAwJSwgZ290ICR7dG90YWx9JWApO1xuICAgIH1cblxuICAgIGNvbnN0IG5ld0NvbmZpZyA9IHtcbiAgICAgIC4uLnRoaXMuY29uZmlnLFxuICAgICAgYWxpZ25tZW50V2VpZ2h0czogbmV3V2VpZ2h0cyxcbiAgICB9O1xuXG4gICAgdGhpcy5zYXZlQ29uZmlnKG5ld0NvbmZpZyk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIFJTIGNvbmZpZ3VyYXRpb25cbiAgICogUmVxdWlyZW1lbnQgMTguMzogQWxsb3cgYWRqdXN0bWVudCBvZiBSUyB0aHJlc2hvbGQgKDAtNSUpIGFuZCBsb29rYmFjayBwZXJpb2QgKDItOCBob3VycylcbiAgICovXG4gIHVwZGF0ZVJTQ29uZmlnKHJzQ29uZmlnOiBQYXJ0aWFsPFJTQ29uZmlnPik6IHZvaWQge1xuICAgIGNvbnN0IG5ld1JTQ29uZmlnID0geyAuLi50aGlzLmNvbmZpZy5yc0NvbmZpZywgLi4ucnNDb25maWcgfTtcblxuICAgIGNvbnN0IG5ld0NvbmZpZyA9IHtcbiAgICAgIC4uLnRoaXMuY29uZmlnLFxuICAgICAgcnNDb25maWc6IG5ld1JTQ29uZmlnLFxuICAgIH07XG5cbiAgICB0aGlzLnNhdmVDb25maWcobmV3Q29uZmlnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgcmlzayBjb25maWd1cmF0aW9uXG4gICAqIFJlcXVpcmVtZW50IDE4LjQ6IEFsbG93IGFkanVzdG1lbnQgb2YgbWF4IGxldmVyYWdlICgzLTV4KSwgc3RvcCBsb3NzICgxLTMlKSwgdGFyZ2V0ICgzLTYlKVxuICAgKi9cbiAgdXBkYXRlUmlza0NvbmZpZyhyaXNrQ29uZmlnOiBQYXJ0aWFsPFJpc2tDb25maWc+KTogdm9pZCB7XG4gICAgY29uc3QgbmV3Umlza0NvbmZpZyA9IHsgLi4udGhpcy5jb25maWcucmlza0NvbmZpZywgLi4ucmlza0NvbmZpZyB9O1xuXG4gICAgY29uc3QgbmV3Q29uZmlnID0ge1xuICAgICAgLi4udGhpcy5jb25maWcsXG4gICAgICByaXNrQ29uZmlnOiBuZXdSaXNrQ29uZmlnLFxuICAgIH07XG5cbiAgICB0aGlzLnNhdmVDb25maWcobmV3Q29uZmlnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgcG9ydGZvbGlvIGNvbmZpZ3VyYXRpb25cbiAgICogUmVxdWlyZW1lbnQgMTguNTogQWxsb3cgYWRqdXN0bWVudCBvZiBtYXggcG9zaXRpb25zICgzLTgpLCBtYXggaGVhdCAoMTAtMjAlKSwgY29ycmVsYXRpb24gKDAuNi0wLjkpXG4gICAqL1xuICB1cGRhdGVQb3J0Zm9saW9Db25maWcocG9ydGZvbGlvQ29uZmlnOiBQYXJ0aWFsPFBvcnRmb2xpb0NvbmZpZz4pOiB2b2lkIHtcbiAgICBjb25zdCBuZXdQb3J0Zm9saW9Db25maWcgPSB7XG4gICAgICAuLi50aGlzLmNvbmZpZy5wb3J0Zm9saW9Db25maWcsXG4gICAgICAuLi5wb3J0Zm9saW9Db25maWcsXG4gICAgfTtcblxuICAgIGNvbnN0IG5ld0NvbmZpZyA9IHtcbiAgICAgIC4uLnRoaXMuY29uZmlnLFxuICAgICAgcG9ydGZvbGlvQ29uZmlnOiBuZXdQb3J0Zm9saW9Db25maWcsXG4gICAgfTtcblxuICAgIHRoaXMuc2F2ZUNvbmZpZyhuZXdDb25maWcpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBmb3J3YXJkIHRlc3QgY29uZmlndXJhdGlvblxuICAgKiBBZGQgcGFwZXIgdHJhZGluZyB0b2dnbGUgaW4gY29uZmlnXG4gICAqL1xuICB1cGRhdGVGb3J3YXJkVGVzdENvbmZpZyhmb3J3YXJkVGVzdENvbmZpZzogUGFydGlhbDxGb3J3YXJkVGVzdENvbmZpZz4pOiB2b2lkIHtcbiAgICBjb25zdCBuZXdGb3J3YXJkVGVzdENvbmZpZyA9IHtcbiAgICAgIC4uLnRoaXMuY29uZmlnLmZvcndhcmRUZXN0Q29uZmlnLFxuICAgICAgLi4uZm9yd2FyZFRlc3RDb25maWcsXG4gICAgfTtcblxuICAgIGNvbnN0IG5ld0NvbmZpZyA9IHtcbiAgICAgIC4uLnRoaXMuY29uZmlnLFxuICAgICAgZm9yd2FyZFRlc3RDb25maWc6IG5ld0ZvcndhcmRUZXN0Q29uZmlnLFxuICAgIH07XG5cbiAgICB0aGlzLnNhdmVDb25maWcobmV3Q29uZmlnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdGFydCB3YXRjaGluZyBjb25maWd1cmF0aW9uIGZpbGUgZm9yIGNoYW5nZXMgKGhvdC1yZWxvYWQpXG4gICAqIFN1cHBvcnQgaG90LXJlbG9hZCB3aXRob3V0IHJlc3RhcnRcbiAgICovXG4gIHN0YXJ0V2F0Y2hpbmcoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuaXNXYXRjaGluZykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuaXNXYXRjaGluZyA9IHRydWU7XG5cbiAgICB3YXRjaEZpbGUodGhpcy5jb25maWdQYXRoLCB7IGludGVydmFsOiAxMDAwIH0sIChjdXJyLCBwcmV2KSA9PiB7XG4gICAgICBpZiAoY3Vyci5tdGltZSAhPT0gcHJldi5tdGltZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIvCflIQgQ29uZmlndXJhdGlvbiBmaWxlIGNoYW5nZWQsIHJlbG9hZGluZy4uLlwiKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBuZXdDb25maWcgPSB0aGlzLmxvYWRDb25maWcoKTtcbiAgICAgICAgICBjb25zdCBvbGRDb25maWcgPSB7IC4uLnRoaXMuY29uZmlnIH07XG4gICAgICAgICAgdGhpcy5jb25maWcgPSBuZXdDb25maWc7XG5cbiAgICAgICAgICB0aGlzLmVtaXQoXCJjb25maWdSZWxvYWRlZFwiLCB7XG4gICAgICAgICAgICBzZWN0aW9uOiBcImFsbFwiLFxuICAgICAgICAgICAgb2xkVmFsdWU6IG9sZENvbmZpZyxcbiAgICAgICAgICAgIG5ld1ZhbHVlOiBuZXdDb25maWcsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgICAgfSBhcyB1bmtub3duIGFzIENvbmZpZ0NoYW5nZUV2ZW50KTtcblxuICAgICAgICAgIGNvbnNvbGUubG9nKFwi4pyFIENvbmZpZ3VyYXRpb24gcmVsb2FkZWQgc3VjY2Vzc2Z1bGx5XCIpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgRmFpbGVkIHRvIHJlbG9hZCBjb25maWd1cmF0aW9uOlwiLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKFwi8J+Rge+4jyBTdGFydGVkIHdhdGNoaW5nIGNvbmZpZ3VyYXRpb24gZmlsZSBmb3IgY2hhbmdlc1wiKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9wIHdhdGNoaW5nIGNvbmZpZ3VyYXRpb24gZmlsZVxuICAgKi9cbiAgc3RvcFdhdGNoaW5nKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5pc1dhdGNoaW5nKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdW53YXRjaEZpbGUodGhpcy5jb25maWdQYXRoKTtcbiAgICB0aGlzLmlzV2F0Y2hpbmcgPSBmYWxzZTtcbiAgICBjb25zb2xlLmxvZyhcIvCfkYHvuI8gU3RvcHBlZCB3YXRjaGluZyBjb25maWd1cmF0aW9uIGZpbGVcIik7XG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgY29uZmlndXJhdGlvbiBhZ2FpbnN0IHJlcXVpcmVtZW50c1xuICAgKi9cbiAgcHJpdmF0ZSB2YWxpZGF0ZUNvbmZpZyhjb25maWc6IFBoYXNlMkNvbmZpZyk6IFZhbGlkYXRpb25SZXN1bHQge1xuICAgIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcbiAgICBjb25zdCB3YXJuaW5nczogc3RyaW5nW10gPSBbXTtcblxuICAgIC8vIFZhbGlkYXRlIGFsaWdubWVudCB3ZWlnaHRzXG4gICAgaWYgKCFjb25maWcuYWxpZ25tZW50V2VpZ2h0cykge1xuICAgICAgZXJyb3JzLnB1c2goXCJNaXNzaW5nIGFsaWdubWVudFdlaWdodHNcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHsgZGFpbHksIGg0LCBtMTUgfSA9IGNvbmZpZy5hbGlnbm1lbnRXZWlnaHRzO1xuXG4gICAgICBpZiAoZGFpbHkgPCAzMCB8fCBkYWlseSA+IDYwKSB7XG4gICAgICAgIGVycm9ycy5wdXNoKGBEYWlseSB3ZWlnaHQgbXVzdCBiZSAzMC02MCUsIGdvdCAke2RhaWx5fSVgKTtcbiAgICAgIH1cbiAgICAgIGlmIChoNCA8IDIwIHx8IGg0ID4gNDApIHtcbiAgICAgICAgZXJyb3JzLnB1c2goYDRIIHdlaWdodCBtdXN0IGJlIDIwLTQwJSwgZ290ICR7aDR9JWApO1xuICAgICAgfVxuICAgICAgaWYgKG0xNSA8IDEwIHx8IG0xNSA+IDMwKSB7XG4gICAgICAgIGVycm9ycy5wdXNoKGAxNW0gd2VpZ2h0IG11c3QgYmUgMTAtMzAlLCBnb3QgJHttMTV9JWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB0b3RhbCA9IGRhaWx5ICsgaDQgKyBtMTU7XG4gICAgICBpZiAoTWF0aC5hYnModG90YWwgLSAxMDApID4gMC4xKSB7XG4gICAgICAgIGVycm9ycy5wdXNoKGBBbGlnbm1lbnQgd2VpZ2h0cyBtdXN0IHN1bSB0byAxMDAlLCBnb3QgJHt0b3RhbH0lYCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gVmFsaWRhdGUgUlMgY29uZmlnXG4gICAgaWYgKCFjb25maWcucnNDb25maWcpIHtcbiAgICAgIGVycm9ycy5wdXNoKFwiTWlzc2luZyByc0NvbmZpZ1wiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgeyB0aHJlc2hvbGQsIGxvb2tiYWNrUGVyaW9kIH0gPSBjb25maWcucnNDb25maWc7XG5cbiAgICAgIGlmICh0aHJlc2hvbGQgPCAwIHx8IHRocmVzaG9sZCA+IDUpIHtcbiAgICAgICAgZXJyb3JzLnB1c2goYFJTIHRocmVzaG9sZCBtdXN0IGJlIDAtNSUsIGdvdCAke3RocmVzaG9sZH0lYCk7XG4gICAgICB9XG4gICAgICBpZiAobG9va2JhY2tQZXJpb2QgPCAyIHx8IGxvb2tiYWNrUGVyaW9kID4gOCkge1xuICAgICAgICBlcnJvcnMucHVzaChcbiAgICAgICAgICBgUlMgbG9va2JhY2sgcGVyaW9kIG11c3QgYmUgMi04IGhvdXJzLCBnb3QgJHtsb29rYmFja1BlcmlvZH0gaG91cnNgLFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFZhbGlkYXRlIHJpc2sgY29uZmlnXG4gICAgaWYgKCFjb25maWcucmlza0NvbmZpZykge1xuICAgICAgZXJyb3JzLnB1c2goXCJNaXNzaW5nIHJpc2tDb25maWdcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHsgbWF4TGV2ZXJhZ2UsIHN0b3BMb3NzUGVyY2VudCwgdGFyZ2V0UGVyY2VudCB9ID0gY29uZmlnLnJpc2tDb25maWc7XG5cbiAgICAgIGlmIChtYXhMZXZlcmFnZSA8IDMgfHwgbWF4TGV2ZXJhZ2UgPiA1KSB7XG4gICAgICAgIGVycm9ycy5wdXNoKGBNYXggbGV2ZXJhZ2UgbXVzdCBiZSAzLTV4LCBnb3QgJHttYXhMZXZlcmFnZX14YCk7XG4gICAgICB9XG4gICAgICBpZiAoc3RvcExvc3NQZXJjZW50IDwgMSB8fCBzdG9wTG9zc1BlcmNlbnQgPiAzKSB7XG4gICAgICAgIGVycm9ycy5wdXNoKGBTdG9wIGxvc3MgbXVzdCBiZSAxLTMlLCBnb3QgJHtzdG9wTG9zc1BlcmNlbnR9JWApO1xuICAgICAgfVxuICAgICAgaWYgKHRhcmdldFBlcmNlbnQgPCAzIHx8IHRhcmdldFBlcmNlbnQgPiA2KSB7XG4gICAgICAgIGVycm9ycy5wdXNoKGBUYXJnZXQgbXVzdCBiZSAzLTYlLCBnb3QgJHt0YXJnZXRQZXJjZW50fSVgKTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgUjpSIHJhdGlvXG4gICAgICBjb25zdCByclJhdGlvID0gdGFyZ2V0UGVyY2VudCAvIHN0b3BMb3NzUGVyY2VudDtcbiAgICAgIGlmIChyclJhdGlvIDwgMi41KSB7XG4gICAgICAgIHdhcm5pbmdzLnB1c2goXG4gICAgICAgICAgYFI6UiByYXRpbyBpcyAke1xuICAgICAgICAgICAgcnJSYXRpby50b0ZpeGVkKDEpXG4gICAgICAgICAgfToxLCBjb25zaWRlciBpbmNyZWFzaW5nIHRhcmdldCBvciBkZWNyZWFzaW5nIHN0b3BgLFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFZhbGlkYXRlIHBvcnRmb2xpbyBjb25maWdcbiAgICBpZiAoIWNvbmZpZy5wb3J0Zm9saW9Db25maWcpIHtcbiAgICAgIGVycm9ycy5wdXNoKFwiTWlzc2luZyBwb3J0Zm9saW9Db25maWdcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHsgbWF4Q29uY3VycmVudFBvc2l0aW9ucywgbWF4UG9ydGZvbGlvSGVhdCwgY29ycmVsYXRpb25UaHJlc2hvbGQgfSA9XG4gICAgICAgIGNvbmZpZy5wb3J0Zm9saW9Db25maWc7XG5cbiAgICAgIGlmIChtYXhDb25jdXJyZW50UG9zaXRpb25zIDwgMyB8fCBtYXhDb25jdXJyZW50UG9zaXRpb25zID4gOCkge1xuICAgICAgICBlcnJvcnMucHVzaChcbiAgICAgICAgICBgTWF4IGNvbmN1cnJlbnQgcG9zaXRpb25zIG11c3QgYmUgMy04LCBnb3QgJHttYXhDb25jdXJyZW50UG9zaXRpb25zfWAsXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBpZiAobWF4UG9ydGZvbGlvSGVhdCA8IDEwIHx8IG1heFBvcnRmb2xpb0hlYXQgPiAyMCkge1xuICAgICAgICBlcnJvcnMucHVzaChcbiAgICAgICAgICBgTWF4IHBvcnRmb2xpbyBoZWF0IG11c3QgYmUgMTAtMjAlLCBnb3QgJHttYXhQb3J0Zm9saW9IZWF0fSVgLFxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgaWYgKGNvcnJlbGF0aW9uVGhyZXNob2xkIDwgMC42IHx8IGNvcnJlbGF0aW9uVGhyZXNob2xkID4gMC45KSB7XG4gICAgICAgIGVycm9ycy5wdXNoKFxuICAgICAgICAgIGBDb3JyZWxhdGlvbiB0aHJlc2hvbGQgbXVzdCBiZSAwLjYtMC45LCBnb3QgJHtjb3JyZWxhdGlvblRocmVzaG9sZH1gLFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFZhbGlkYXRlIGZvcndhcmQgdGVzdCBjb25maWdcbiAgICBpZiAoIWNvbmZpZy5mb3J3YXJkVGVzdENvbmZpZykge1xuICAgICAgZXJyb3JzLnB1c2goXCJNaXNzaW5nIGZvcndhcmRUZXN0Q29uZmlnXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCB7IGVuYWJsZWQsIGR1cmF0aW9uLCBsb2dTaWduYWxzT25seSwgY29tcGFyZVRvQmFja3Rlc3QgfSA9IGNvbmZpZy5mb3J3YXJkVGVzdENvbmZpZztcblxuICAgICAgaWYgKHR5cGVvZiBlbmFibGVkICE9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgZXJyb3JzLnB1c2goXCJGb3J3YXJkIHRlc3QgZW5hYmxlZCBtdXN0IGJlIGJvb2xlYW5cIik7XG4gICAgICB9XG4gICAgICBpZiAoZHVyYXRpb24gPCAxIHx8IGR1cmF0aW9uID4gMTY4KSB7IC8vIDEgaG91ciB0byAxIHdlZWtcbiAgICAgICAgZXJyb3JzLnB1c2goYEZvcndhcmQgdGVzdCBkdXJhdGlvbiBtdXN0IGJlIDEtMTY4IGhvdXJzLCBnb3QgJHtkdXJhdGlvbn0gaG91cnNgKTtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgbG9nU2lnbmFsc09ubHkgIT09ICdib29sZWFuJykge1xuICAgICAgICBlcnJvcnMucHVzaChcIkZvcndhcmQgdGVzdCBsb2dTaWduYWxzT25seSBtdXN0IGJlIGJvb2xlYW5cIik7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIGNvbXBhcmVUb0JhY2t0ZXN0ICE9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgZXJyb3JzLnB1c2goXCJGb3J3YXJkIHRlc3QgY29tcGFyZVRvQmFja3Rlc3QgbXVzdCBiZSBib29sZWFuXCIpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBpc1ZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxuICAgICAgZXJyb3JzLFxuICAgICAgd2FybmluZ3MsXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBNZXJnZSBsb2FkZWQgY29uZmlnIHdpdGggZGVmYXVsdHMgdG8gZW5zdXJlIGFsbCBmaWVsZHMgYXJlIHByZXNlbnRcbiAgICovXG4gIHByaXZhdGUgbWVyZ2VXaXRoRGVmYXVsdHMobG9hZGVkQ29uZmlnOiBQYXJ0aWFsPFBoYXNlMkNvbmZpZz4pOiBQaGFzZTJDb25maWcge1xuICAgIHJldHVybiB7XG4gICAgICBhbGlnbm1lbnRXZWlnaHRzOiB7XG4gICAgICAgIC4uLkRFRkFVTFRfQ09ORklHLmFsaWdubWVudFdlaWdodHMsXG4gICAgICAgIC4uLmxvYWRlZENvbmZpZy5hbGlnbm1lbnRXZWlnaHRzLFxuICAgICAgfSxcbiAgICAgIHJzQ29uZmlnOiB7XG4gICAgICAgIC4uLkRFRkFVTFRfQ09ORklHLnJzQ29uZmlnLFxuICAgICAgICAuLi5sb2FkZWRDb25maWcucnNDb25maWcsXG4gICAgICB9LFxuICAgICAgcmlza0NvbmZpZzoge1xuICAgICAgICAuLi5ERUZBVUxUX0NPTkZJRy5yaXNrQ29uZmlnLFxuICAgICAgICAuLi5sb2FkZWRDb25maWcucmlza0NvbmZpZyxcbiAgICAgIH0sXG4gICAgICBwb3J0Zm9saW9Db25maWc6IHtcbiAgICAgICAgLi4uREVGQVVMVF9DT05GSUcucG9ydGZvbGlvQ29uZmlnLFxuICAgICAgICAuLi5sb2FkZWRDb25maWcucG9ydGZvbGlvQ29uZmlnLFxuICAgICAgfSxcbiAgICAgIGZvcndhcmRUZXN0Q29uZmlnOiB7XG4gICAgICAgIC4uLkRFRkFVTFRfQ09ORklHLmZvcndhcmRUZXN0Q29uZmlnLFxuICAgICAgICAuLi5sb2FkZWRDb25maWcuZm9yd2FyZFRlc3RDb25maWcsXG4gICAgICB9LFxuICAgICAgdmVyc2lvbjogbG9hZGVkQ29uZmlnLnZlcnNpb24gfHwgREVGQVVMVF9DT05GSUcudmVyc2lvbixcbiAgICAgIGxhc3RNb2RpZmllZDogbG9hZGVkQ29uZmlnLmxhc3RNb2RpZmllZCB8fCBEYXRlLm5vdygpLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUmVzZXQgY29uZmlndXJhdGlvbiB0byBkZWZhdWx0c1xuICAgKi9cbiAgcmVzZXRUb0RlZmF1bHRzKCk6IHZvaWQge1xuICAgIGNvbnNvbGUubG9nKFwi8J+UhCBSZXNldHRpbmcgY29uZmlndXJhdGlvbiB0byBkZWZhdWx0c1wiKTtcbiAgICB0aGlzLnNhdmVDb25maWcoeyAuLi5ERUZBVUxUX0NPTkZJRyB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY29uZmlndXJhdGlvbiBzdW1tYXJ5IGZvciBkaXNwbGF5XG4gICAqL1xuICBnZXRDb25maWdTdW1tYXJ5KCk6IHN0cmluZyB7XG4gICAgY29uc3QgY29uZmlnID0gdGhpcy5jb25maWc7XG4gICAgcmV0dXJuIFtcbiAgICAgIGDwn5OKIEFsaWdubWVudDogRGFpbHkgJHtjb25maWcuYWxpZ25tZW50V2VpZ2h0cy5kYWlseX0lLCA0SCAke2NvbmZpZy5hbGlnbm1lbnRXZWlnaHRzLmg0fSUsIDE1bSAke2NvbmZpZy5hbGlnbm1lbnRXZWlnaHRzLm0xNX0lYCxcbiAgICAgIGDwn5OIIFJTOiBUaHJlc2hvbGQgJHtjb25maWcucnNDb25maWcudGhyZXNob2xkfSUsIExvb2tiYWNrICR7Y29uZmlnLnJzQ29uZmlnLmxvb2tiYWNrUGVyaW9kfWhgLFxuICAgICAgYOKaoSBSaXNrOiBMZXZlcmFnZSAke2NvbmZpZy5yaXNrQ29uZmlnLm1heExldmVyYWdlfXgsIFN0b3AgJHtjb25maWcucmlza0NvbmZpZy5zdG9wTG9zc1BlcmNlbnR9JSwgVGFyZ2V0ICR7Y29uZmlnLnJpc2tDb25maWcudGFyZ2V0UGVyY2VudH0lYCxcbiAgICAgIGDwn5K8IFBvcnRmb2xpbzogTWF4ICR7Y29uZmlnLnBvcnRmb2xpb0NvbmZpZy5tYXhDb25jdXJyZW50UG9zaXRpb25zfSBwb3NpdGlvbnMsIEhlYXQgJHtjb25maWcucG9ydGZvbGlvQ29uZmlnLm1heFBvcnRmb2xpb0hlYXR9JSwgQ29ycmVsYXRpb24gJHtjb25maWcucG9ydGZvbGlvQ29uZmlnLmNvcnJlbGF0aW9uVGhyZXNob2xkfWAsXG4gICAgICBg8J+nqiBGb3J3YXJkIFRlc3Q6ICR7Y29uZmlnLmZvcndhcmRUZXN0Q29uZmlnLmVuYWJsZWQgPyAnRW5hYmxlZCcgOiAnRGlzYWJsZWQnfSwgRHVyYXRpb24gJHtjb25maWcuZm9yd2FyZFRlc3RDb25maWcuZHVyYXRpb259aCwgU2lnbmFscyBPbmx5OiAke2NvbmZpZy5mb3J3YXJkVGVzdENvbmZpZy5sb2dTaWduYWxzT25seX1gLFxuICAgIF0uam9pbihcIlxcblwiKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhbnVwIHJlc291cmNlc1xuICAgKi9cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICB0aGlzLnN0b3BXYXRjaGluZygpO1xuICAgIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKCk7XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==