c643eb844bec4c9b38b056f4e9cede59
"use strict";
/**
 * Unit tests for DrawdownProtector
 * Tests drawdown protection functionality including daily/weekly thresholds, consecutive losses, win rate monitoring
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock BybitPerpsClient
jest.mock('../../src/exchanges/BybitPerpsClient');
const DrawdownProtector_1 = require("../../src/risk/DrawdownProtector");
const BybitPerpsClient_1 = require("../../src/exchanges/BybitPerpsClient");
describe('DrawdownProtector', () => {
    let drawdownProtector;
    let mockBybitClient;
    let mockConfig;
    beforeEach(() => {
        // Create mock client
        mockBybitClient = new BybitPerpsClient_1.BybitPerpsClient('test-key', 'test-secret');
        // Mock client methods
        mockBybitClient.getEquity = jest.fn().mockResolvedValue(10000); // $10,000 starting equity
        mockBybitClient.placeOrderWithRetry = jest.fn().mockResolvedValue({
            orderId: 'test-order-id',
            symbol: 'BTCUSDT',
            side: 'Sell',
            qty: 0.1,
            price: 50000,
            status: 'FILLED',
            timestamp: Date.now()
        });
        // Create test config
        mockConfig = {
            dailyDrawdownThresholds: {
                level1: 0.03, // 3%
                level2: 0.05, // 5%
                level3: 0.07 // 7%
            },
            weeklyDrawdownThreshold: 0.10, // 10%
            consecutiveLossThreshold: 3,
            consecutiveLossReduction: 0.30,
            winRateThreshold: 0.40,
            winRateTradeCount: 20,
            emergencyPauseDuration: 24 * 60 * 60 * 1000, // 24 hours
            leverageReduction: {
                from: 5,
                to: 3
            }
        };
        drawdownProtector = new DrawdownProtector_1.DrawdownProtector(mockBybitClient, mockConfig);
        // Stop monitoring to avoid interference with tests
        drawdownProtector.stopMonitoring();
    });
    afterEach(() => {
        drawdownProtector.destroy();
    });
    describe('Daily Drawdown Protection', () => {
        test('should trigger level 1 protection at 3% drawdown', async () => {
            const startEquity = 10000;
            const currentEquity = 9700; // 3% drawdown
            // Set initial state
            drawdownProtector.setStartOfDayEquity(startEquity);
            const action = await drawdownProtector.checkDailyDrawdown(currentEquity);
            expect(action).toBe('REDUCE_POSITION_SIZES');
            expect(drawdownProtector.getPositionSizeMultiplier()).toBe(0.5);
            const newState = drawdownProtector.getState();
            expect(newState.dailyDrawdown).toBeCloseTo(0.03, 3);
        });
        test('should trigger level 2 protection at 5% drawdown', async () => {
            const startEquity = 10000;
            const currentEquity = 9500; // 5% drawdown
            drawdownProtector.setStartOfDayEquity(startEquity);
            const action = await drawdownProtector.checkDailyDrawdown(currentEquity);
            expect(action).toBe('HALT_NEW_ENTRIES');
            expect(drawdownProtector.canOpenNewPositions()).toBe(false);
        });
        test('should trigger level 3 protection at 7% drawdown', async () => {
            const startEquity = 10000;
            const currentEquity = 9300; // 7% drawdown
            drawdownProtector.setStartOfDayEquity(startEquity);
            const action = await drawdownProtector.checkDailyDrawdown(currentEquity);
            expect(action).toBe('EMERGENCY_FLATTEN');
            expect(drawdownProtector.isEmergencyPaused()).toBe(true);
        });
        test('should reset daily drawdown on new day', async () => {
            const startEquity = 10000;
            const currentEquity = 9700; // 3% drawdown
            // Set state to previous day
            drawdownProtector.setStartOfDayEquity(startEquity);
            const state = drawdownProtector.getState();
            state.lastUpdate = Date.now() - (25 * 60 * 60 * 1000); // 25 hours ago
            // Check drawdown (should reset for new day)
            await drawdownProtector.checkDailyDrawdown(currentEquity);
            const newState = drawdownProtector.getState();
            expect(newState.startOfDayEquity).toBe(currentEquity);
            expect(newState.dailyDrawdown).toBe(0);
        });
    });
    describe('Weekly Drawdown Protection', () => {
        test('should trigger leverage reduction at 10% weekly drawdown', async () => {
            const startEquity = 10000;
            const currentEquity = 9000; // 10% drawdown
            drawdownProtector.setStartOfWeekEquity(startEquity);
            const action = await drawdownProtector.checkWeeklyDrawdown(currentEquity);
            expect(action).toBe('REDUCE_MAX_LEVERAGE');
            expect(drawdownProtector.getMaxLeverage()).toBe(3); // Reduced from 5x to 3x
        });
        test('should reset weekly drawdown on new week', async () => {
            const startEquity = 10000;
            const currentEquity = 9000; // 10% drawdown
            // Set state to previous week
            drawdownProtector.setStartOfWeekEquity(startEquity);
            const state = drawdownProtector.getState();
            state.lastUpdate = Date.now() - (8 * 24 * 60 * 60 * 1000); // 8 days ago
            // Check drawdown (should reset for new week)
            await drawdownProtector.checkWeeklyDrawdown(currentEquity);
            const newState = drawdownProtector.getState();
            expect(newState.startOfWeekEquity).toBe(currentEquity);
            expect(newState.weeklyDrawdown).toBe(0);
        });
    });
    describe('Consecutive Loss Protection', () => {
        test('should trigger protection after 3 consecutive losses', () => {
            const trades = [
                { id: '1', symbol: 'BTCUSDT', side: 'LONG', entryPrice: 50000, exitPrice: 49000, quantity: 0.1, pnl: -100, isWin: false, timestamp: Date.now() - 3000 },
                { id: '2', symbol: 'ETHUSDT', side: 'SHORT', entryPrice: 3000, exitPrice: 3100, quantity: 1, pnl: -100, isWin: false, timestamp: Date.now() - 2000 },
                { id: '3', symbol: 'BTCUSDT', side: 'LONG', entryPrice: 51000, exitPrice: 50000, quantity: 0.1, pnl: -100, isWin: false, timestamp: Date.now() - 1000 }
            ];
            const action = drawdownProtector.checkConsecutiveLosses(trades);
            expect(action).toBe('CONSECUTIVE_LOSSES');
            expect(drawdownProtector.getPositionSizeMultiplier()).toBeLessThanOrEqual(0.7); // 30% reduction
            const state = drawdownProtector.getState();
            expect(state.consecutiveLosses).toBe(3);
        });
        test('should reset consecutive losses on win', () => {
            const trades = [
                { id: '1', symbol: 'BTCUSDT', side: 'LONG', entryPrice: 50000, exitPrice: 49000, quantity: 0.1, pnl: -100, isWin: false, timestamp: Date.now() - 3000 },
                { id: '2', symbol: 'ETHUSDT', side: 'SHORT', entryPrice: 3000, exitPrice: 3100, quantity: 1, pnl: -100, isWin: false, timestamp: Date.now() - 2000 },
                { id: '3', symbol: 'BTCUSDT', side: 'LONG', entryPrice: 50000, exitPrice: 52000, quantity: 0.1, pnl: 200, isWin: true, timestamp: Date.now() - 1000 }
            ];
            const action = drawdownProtector.checkConsecutiveLosses(trades);
            expect(action).toBeNull();
            const state = drawdownProtector.getState();
            expect(state.consecutiveLosses).toBe(0);
        });
    });
    describe('Win Rate Monitoring', () => {
        test('should trigger strategy degradation warning when win rate < 40%', () => {
            // Create 20 trades with 30% win rate (6 wins, 14 losses)
            const trades = [];
            for (let i = 0; i < 20; i++) {
                const isWin = i < 6; // First 6 are wins, rest are losses
                trades.push({
                    id: `trade-${i}`,
                    symbol: 'BTCUSDT',
                    side: 'LONG',
                    entryPrice: 50000,
                    exitPrice: isWin ? 52000 : 49000,
                    quantity: 0.1,
                    pnl: isWin ? 200 : -100,
                    isWin,
                    timestamp: Date.now() - (i * 1000)
                });
            }
            const action = drawdownProtector.checkWinRate(trades);
            expect(action).toBe('STRATEGY_DEGRADATION');
            const state = drawdownProtector.getState();
            expect(state.winRate).toBeCloseTo(0.3, 2); // 30% win rate
        });
        test('should not trigger warning with insufficient trades', () => {
            const trades = [
                { id: '1', symbol: 'BTCUSDT', side: 'LONG', entryPrice: 50000, exitPrice: 49000, quantity: 0.1, pnl: -100, isWin: false, timestamp: Date.now() }
            ];
            const action = drawdownProtector.checkWinRate(trades);
            expect(action).toBeNull();
        });
        test('should not trigger warning with good win rate', () => {
            // Create 20 trades with 60% win rate (12 wins, 8 losses)
            const trades = [];
            for (let i = 0; i < 20; i++) {
                const isWin = i < 12; // First 12 are wins, rest are losses
                trades.push({
                    id: `trade-${i}`,
                    symbol: 'BTCUSDT',
                    side: 'LONG',
                    entryPrice: 50000,
                    exitPrice: isWin ? 52000 : 49000,
                    quantity: 0.1,
                    pnl: isWin ? 200 : -100,
                    isWin,
                    timestamp: Date.now() - (i * 1000)
                });
            }
            const action = drawdownProtector.checkWinRate(trades);
            expect(action).toBeNull();
            const state = drawdownProtector.getState();
            expect(state.winRate).toBeCloseTo(0.6, 2); // 60% win rate
        });
    });
    describe('Emergency Flatten', () => {
        test('should close all positions during emergency flatten', async () => {
            const positions = [
                {
                    id: 'pos-1',
                    symbol: 'BTCUSDT',
                    side: 'LONG',
                    entryPrice: 50000,
                    currentPrice: 49000,
                    quantity: 0.1,
                    leverage: 5,
                    stopLoss: 48000,
                    takeProfit: 55000,
                    unrealizedPnL: -100,
                    realizedPnL: 0,
                    entryTime: Date.now() - 60000,
                    status: 'OPEN',
                    rValue: -0.5,
                    atr: 1000
                },
                {
                    id: 'pos-2',
                    symbol: 'ETHUSDT',
                    side: 'SHORT',
                    entryPrice: 3000,
                    currentPrice: 3100,
                    quantity: 1,
                    leverage: 3,
                    stopLoss: 3200,
                    takeProfit: 2800,
                    unrealizedPnL: -100,
                    realizedPnL: 0,
                    entryTime: Date.now() - 120000,
                    status: 'OPEN',
                    rValue: -0.5,
                    atr: 50
                }
            ];
            const success = await drawdownProtector.emergencyFlatten(positions);
            expect(success).toBe(true);
            expect(mockBybitClient.placeOrderWithRetry).toHaveBeenCalledTimes(2);
            expect(drawdownProtector.isEmergencyPaused()).toBe(true);
        });
        test('should handle order failures during emergency flatten', async () => {
            // Mock one successful and one failed order
            mockBybitClient.placeOrderWithRetry
                .mockResolvedValueOnce({
                orderId: 'order-1',
                symbol: 'BTCUSDT',
                side: 'Sell',
                qty: 0.1,
                price: 49000,
                status: 'FILLED',
                timestamp: Date.now()
            })
                .mockRejectedValueOnce(new Error('Order failed'));
            const positions = [
                {
                    id: 'pos-1',
                    symbol: 'BTCUSDT',
                    side: 'LONG',
                    entryPrice: 50000,
                    currentPrice: 49000,
                    quantity: 0.1,
                    leverage: 5,
                    stopLoss: 48000,
                    takeProfit: 55000,
                    unrealizedPnL: -100,
                    realizedPnL: 0,
                    entryTime: Date.now() - 60000,
                    status: 'OPEN',
                    rValue: -0.5,
                    atr: 1000
                },
                {
                    id: 'pos-2',
                    symbol: 'ETHUSDT',
                    side: 'SHORT',
                    entryPrice: 3000,
                    currentPrice: 3100,
                    quantity: 1,
                    leverage: 3,
                    stopLoss: 3200,
                    takeProfit: 2800,
                    unrealizedPnL: -100,
                    realizedPnL: 0,
                    entryTime: Date.now() - 120000,
                    status: 'OPEN',
                    rValue: -0.5,
                    atr: 50
                }
            ];
            const success = await drawdownProtector.emergencyFlatten(positions);
            expect(success).toBe(false); // Should return false due to one failure
            expect(drawdownProtector.isEmergencyPaused()).toBe(true);
        });
    });
    describe('Trade Tracking', () => {
        test('should add trades and maintain history', () => {
            const trade = {
                id: 'trade-1',
                symbol: 'BTCUSDT',
                side: 'LONG',
                entryPrice: 50000,
                exitPrice: 52000,
                quantity: 0.1,
                pnl: 200,
                isWin: true,
                timestamp: Date.now()
            };
            drawdownProtector.addTrade(trade);
            const state = drawdownProtector.getState();
            expect(state.recentTrades).toHaveLength(1);
            expect(state.recentTrades[0]).toEqual(trade);
        });
        test('should limit trade history to 100 trades', () => {
            // Add 150 trades
            for (let i = 0; i < 150; i++) {
                const trade = {
                    id: `trade-${i}`,
                    symbol: 'BTCUSDT',
                    side: 'LONG',
                    entryPrice: 50000,
                    exitPrice: 52000,
                    quantity: 0.1,
                    pnl: 200,
                    isWin: true,
                    timestamp: Date.now() + i
                };
                drawdownProtector.addTrade(trade);
            }
            const state = drawdownProtector.getState();
            expect(state.recentTrades).toHaveLength(100);
            // Should keep the most recent 100 trades (last 100 added)
            expect(state.recentTrades[0].id).toBe('trade-50');
            expect(state.recentTrades[99].id).toBe('trade-149');
        });
    });
    describe('State Management', () => {
        test('should return current state', () => {
            const state = drawdownProtector.getState();
            expect(state).toHaveProperty('currentEquity');
            expect(state).toHaveProperty('dailyDrawdown');
            expect(state).toHaveProperty('weeklyDrawdown');
            expect(state).toHaveProperty('consecutiveLosses');
            expect(state).toHaveProperty('winRate');
            expect(state).toHaveProperty('isEmergencyPaused');
        });
        test('should reset state correctly', () => {
            // Modify state
            const state = drawdownProtector.getState();
            state.dailyDrawdown = 0.05;
            state.consecutiveLosses = 3;
            state.isEmergencyPaused = true;
            // Reset state
            drawdownProtector.resetState();
            const newState = drawdownProtector.getState();
            expect(newState.dailyDrawdown).toBe(0);
            expect(newState.consecutiveLosses).toBe(0);
            expect(newState.isEmergencyPaused).toBe(false);
            expect(newState.positionSizeReduction).toBe(1.0);
        });
        test('should provide statistics', () => {
            const stats = drawdownProtector.getStatistics();
            expect(stats).toHaveProperty('dailyDrawdown');
            expect(stats).toHaveProperty('weeklyDrawdown');
            expect(stats).toHaveProperty('consecutiveLosses');
            expect(stats).toHaveProperty('winRate');
            expect(stats).toHaveProperty('totalTrades');
            expect(stats).toHaveProperty('isEmergencyPaused');
            expect(stats).toHaveProperty('positionSizeReduction');
            expect(stats).toHaveProperty('maxLeverageReduction');
        });
    });
    describe('Configuration', () => {
        test('should update configuration', async () => {
            const newConfig = {
                dailyDrawdownThresholds: {
                    level1: 0.02, // 2%
                    level2: 0.04, // 4%
                    level3: 0.06 // 6%
                }
            };
            drawdownProtector.updateConfig(newConfig);
            // Test that new thresholds are applied
            drawdownProtector.setStartOfDayEquity(10000);
            // Should trigger at 2% now instead of 3%
            await drawdownProtector.checkDailyDrawdown(9800); // 2% drawdown
            expect(drawdownProtector.getPositionSizeMultiplier()).toBe(0.5);
        });
    });
    describe('Emergency Pause Management', () => {
        test('should lift emergency pause after duration expires', () => {
            // Set emergency pause with short duration for testing
            const state = drawdownProtector.getState();
            state.isEmergencyPaused = true;
            state.emergencyPauseUntil = Date.now() + 100; // 100ms
            expect(drawdownProtector.isEmergencyPaused()).toBe(true);
            // Wait for pause to expire
            return new Promise((resolve) => {
                setTimeout(() => {
                    expect(drawdownProtector.isEmergencyPaused()).toBe(false);
                    resolve();
                }, 150);
            });
        });
        test('should block new positions during emergency pause', () => {
            const state = drawdownProtector.getState();
            state.isEmergencyPaused = true;
            state.emergencyPauseUntil = Date.now() + 60000; // 1 minute
            expect(drawdownProtector.canOpenNewPositions()).toBe(false);
        });
        test('should block new positions when daily drawdown >= 5%', async () => {
            drawdownProtector.setStartOfDayEquity(10000);
            await drawdownProtector.checkDailyDrawdown(9500); // 5% drawdown
            expect(drawdownProtector.canOpenNewPositions()).toBe(false);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2l2YW4vQ29kZS90cmFkaW5nL3RpdGFuL3NlcnZpY2VzL3RpdGFuLXBoYXNlMi1odW50ZXIvdGVzdHMvdW5pdC9EcmF3ZG93blByb3RlY3Rvci50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7O0dBR0c7O0FBTUgsd0JBQXdCO0FBQ3hCLElBQUksQ0FBQyxJQUFJLENBQUMsc0NBQXNDLENBQUMsQ0FBQztBQUxsRCx3RUFBMkc7QUFDM0csMkVBQXdFO0FBTXhFLFFBQVEsQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUU7SUFDakMsSUFBSSxpQkFBb0MsQ0FBQztJQUN6QyxJQUFJLGVBQThDLENBQUM7SUFDbkQsSUFBSSxVQUE0QyxDQUFDO0lBRWpELFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxxQkFBcUI7UUFDckIsZUFBZSxHQUFHLElBQUksbUNBQWdCLENBQUMsVUFBVSxFQUFFLGFBQWEsQ0FBa0MsQ0FBQztRQUVuRyxzQkFBc0I7UUFDdEIsZUFBZSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsaUJBQWlCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQywwQkFBMEI7UUFDMUYsZUFBZSxDQUFDLG1CQUFtQixHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQztZQUNoRSxPQUFPLEVBQUUsZUFBZTtZQUN4QixNQUFNLEVBQUUsU0FBUztZQUNqQixJQUFJLEVBQUUsTUFBTTtZQUNaLEdBQUcsRUFBRSxHQUFHO1lBQ1IsS0FBSyxFQUFFLEtBQUs7WUFDWixNQUFNLEVBQUUsUUFBUTtZQUNoQixTQUFTLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRTtTQUN0QixDQUFDLENBQUM7UUFFSCxxQkFBcUI7UUFDckIsVUFBVSxHQUFHO1lBQ1gsdUJBQXVCLEVBQUU7Z0JBQ3ZCLE1BQU0sRUFBRSxJQUFJLEVBQUUsS0FBSztnQkFDbkIsTUFBTSxFQUFFLElBQUksRUFBRSxLQUFLO2dCQUNuQixNQUFNLEVBQUUsSUFBSSxDQUFFLEtBQUs7YUFDcEI7WUFDRCx1QkFBdUIsRUFBRSxJQUFJLEVBQUUsTUFBTTtZQUNyQyx3QkFBd0IsRUFBRSxDQUFDO1lBQzNCLHdCQUF3QixFQUFFLElBQUk7WUFDOUIsZ0JBQWdCLEVBQUUsSUFBSTtZQUN0QixpQkFBaUIsRUFBRSxFQUFFO1lBQ3JCLHNCQUFzQixFQUFFLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLElBQUksRUFBRSxXQUFXO1lBQ3hELGlCQUFpQixFQUFFO2dCQUNqQixJQUFJLEVBQUUsQ0FBQztnQkFDUCxFQUFFLEVBQUUsQ0FBQzthQUNOO1NBQ0YsQ0FBQztRQUVGLGlCQUFpQixHQUFHLElBQUkscUNBQWlCLENBQUMsZUFBZSxFQUFFLFVBQVUsQ0FBQyxDQUFDO1FBRXZFLG1EQUFtRDtRQUNuRCxpQkFBaUIsQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUNyQyxDQUFDLENBQUMsQ0FBQztJQUVILFNBQVMsQ0FBQyxHQUFHLEVBQUU7UUFDYixpQkFBaUIsQ0FBQyxPQUFPLEVBQUUsQ0FBQztJQUM5QixDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQywyQkFBMkIsRUFBRSxHQUFHLEVBQUU7UUFDekMsSUFBSSxDQUFDLGtEQUFrRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2xFLE1BQU0sV0FBVyxHQUFHLEtBQUssQ0FBQztZQUMxQixNQUFNLGFBQWEsR0FBRyxJQUFJLENBQUMsQ0FBQyxjQUFjO1lBRTFDLG9CQUFvQjtZQUNwQixpQkFBaUIsQ0FBQyxtQkFBbUIsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUVuRCxNQUFNLE1BQU0sR0FBRyxNQUFNLGlCQUFpQixDQUFDLGtCQUFrQixDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBRXpFLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsdUJBQXVCLENBQUMsQ0FBQztZQUM3QyxNQUFNLENBQUMsaUJBQWlCLENBQUMseUJBQXlCLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUVoRSxNQUFNLFFBQVEsR0FBRyxpQkFBaUIsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUM5QyxNQUFNLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDdEQsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsa0RBQWtELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbEUsTUFBTSxXQUFXLEdBQUcsS0FBSyxDQUFDO1lBQzFCLE1BQU0sYUFBYSxHQUFHLElBQUksQ0FBQyxDQUFDLGNBQWM7WUFFMUMsaUJBQWlCLENBQUMsbUJBQW1CLENBQUMsV0FBVyxDQUFDLENBQUM7WUFFbkQsTUFBTSxNQUFNLEdBQUcsTUFBTSxpQkFBaUIsQ0FBQyxrQkFBa0IsQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUV6RSxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUM7WUFDeEMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLG1CQUFtQixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDOUQsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsa0RBQWtELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDbEUsTUFBTSxXQUFXLEdBQUcsS0FBSyxDQUFDO1lBQzFCLE1BQU0sYUFBYSxHQUFHLElBQUksQ0FBQyxDQUFDLGNBQWM7WUFFMUMsaUJBQWlCLENBQUMsbUJBQW1CLENBQUMsV0FBVyxDQUFDLENBQUM7WUFFbkQsTUFBTSxNQUFNLEdBQUcsTUFBTSxpQkFBaUIsQ0FBQyxrQkFBa0IsQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUV6RSxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLENBQUM7WUFDekMsTUFBTSxDQUFDLGlCQUFpQixDQUFDLGlCQUFpQixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDM0QsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsd0NBQXdDLEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDeEQsTUFBTSxXQUFXLEdBQUcsS0FBSyxDQUFDO1lBQzFCLE1BQU0sYUFBYSxHQUFHLElBQUksQ0FBQyxDQUFDLGNBQWM7WUFFMUMsNEJBQTRCO1lBQzVCLGlCQUFpQixDQUFDLG1CQUFtQixDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQ25ELE1BQU0sS0FBSyxHQUFHLGlCQUFpQixDQUFDLFFBQVEsRUFBRSxDQUFDO1lBQzNDLEtBQUssQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxlQUFlO1lBRXRFLDRDQUE0QztZQUM1QyxNQUFNLGlCQUFpQixDQUFDLGtCQUFrQixDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBRTFELE1BQU0sUUFBUSxHQUFHLGlCQUFpQixDQUFDLFFBQVEsRUFBRSxDQUFDO1lBQzlDLE1BQU0sQ0FBQyxRQUFRLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7WUFDdEQsTUFBTSxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDekMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyw0QkFBNEIsRUFBRSxHQUFHLEVBQUU7UUFDMUMsSUFBSSxDQUFDLDBEQUEwRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzFFLE1BQU0sV0FBVyxHQUFHLEtBQUssQ0FBQztZQUMxQixNQUFNLGFBQWEsR0FBRyxJQUFJLENBQUMsQ0FBQyxlQUFlO1lBRTNDLGlCQUFpQixDQUFDLG9CQUFvQixDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBRXBELE1BQU0sTUFBTSxHQUFHLE1BQU0saUJBQWlCLENBQUMsbUJBQW1CLENBQUMsYUFBYSxDQUFDLENBQUM7WUFFMUUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO1lBQzNDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxjQUFjLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLHdCQUF3QjtRQUM5RSxDQUFDLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQywwQ0FBMEMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUMxRCxNQUFNLFdBQVcsR0FBRyxLQUFLLENBQUM7WUFDMUIsTUFBTSxhQUFhLEdBQUcsSUFBSSxDQUFDLENBQUMsZUFBZTtZQUUzQyw2QkFBNkI7WUFDN0IsaUJBQWlCLENBQUMsb0JBQW9CLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDcEQsTUFBTSxLQUFLLEdBQUcsaUJBQWlCLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDM0MsS0FBSyxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxhQUFhO1lBRXhFLDZDQUE2QztZQUM3QyxNQUFNLGlCQUFpQixDQUFDLG1CQUFtQixDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBRTNELE1BQU0sUUFBUSxHQUFHLGlCQUFpQixDQUFDLFFBQVEsRUFBRSxDQUFDO1lBQzlDLE1BQU0sQ0FBQyxRQUFRLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7WUFDdkQsTUFBTSxDQUFDLFFBQVEsQ0FBQyxjQUFjLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDMUMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyw2QkFBNkIsRUFBRSxHQUFHLEVBQUU7UUFDM0MsSUFBSSxDQUFDLHNEQUFzRCxFQUFFLEdBQUcsRUFBRTtZQUNoRSxNQUFNLE1BQU0sR0FBa0I7Z0JBQzVCLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLENBQUMsR0FBRyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUUsR0FBRyxJQUFJLEVBQUU7Z0JBQ3ZKLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsVUFBVSxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxDQUFDLEVBQUUsR0FBRyxFQUFFLENBQUMsR0FBRyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUUsR0FBRyxJQUFJLEVBQUU7Z0JBQ3BKLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLENBQUMsR0FBRyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUUsR0FBRyxJQUFJLEVBQUU7YUFDeEosQ0FBQztZQUVGLE1BQU0sTUFBTSxHQUFHLGlCQUFpQixDQUFDLHNCQUFzQixDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBRWhFLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsQ0FBQztZQUMxQyxNQUFNLENBQUMsaUJBQWlCLENBQUMseUJBQXlCLEVBQUUsQ0FBQyxDQUFDLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsZ0JBQWdCO1lBRWhHLE1BQU0sS0FBSyxHQUFHLGlCQUFpQixDQUFDLFFBQVEsRUFBRSxDQUFDO1lBQzNDLE1BQU0sQ0FBQyxLQUFLLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDMUMsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsd0NBQXdDLEVBQUUsR0FBRyxFQUFFO1lBQ2xELE1BQU0sTUFBTSxHQUFrQjtnQkFDNUIsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxHQUFHLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLElBQUksRUFBRTtnQkFDdkosRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsUUFBUSxFQUFFLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxHQUFHLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLElBQUksRUFBRTtnQkFDcEosRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUUsR0FBRyxJQUFJLEVBQUU7YUFDdEosQ0FBQztZQUVGLE1BQU0sTUFBTSxHQUFHLGlCQUFpQixDQUFDLHNCQUFzQixDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBRWhFLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUUxQixNQUFNLEtBQUssR0FBRyxpQkFBaUIsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUMzQyxNQUFNLENBQUMsS0FBSyxDQUFDLGlCQUFpQixDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzFDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMscUJBQXFCLEVBQUUsR0FBRyxFQUFFO1FBQ25DLElBQUksQ0FBQyxpRUFBaUUsRUFBRSxHQUFHLEVBQUU7WUFDM0UseURBQXlEO1lBQ3pELE1BQU0sTUFBTSxHQUFrQixFQUFFLENBQUM7WUFDakMsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO2dCQUM1QixNQUFNLEtBQUssR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsb0NBQW9DO2dCQUN6RCxNQUFNLENBQUMsSUFBSSxDQUFDO29CQUNWLEVBQUUsRUFBRSxTQUFTLENBQUMsRUFBRTtvQkFDaEIsTUFBTSxFQUFFLFNBQVM7b0JBQ2pCLElBQUksRUFBRSxNQUFNO29CQUNaLFVBQVUsRUFBRSxLQUFLO29CQUNqQixTQUFTLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUs7b0JBQ2hDLFFBQVEsRUFBRSxHQUFHO29CQUNiLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHO29CQUN2QixLQUFLO29CQUNMLFNBQVMsRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDO2lCQUNuQyxDQUFDLENBQUM7WUFDTCxDQUFDO1lBRUQsTUFBTSxNQUFNLEdBQUcsaUJBQWlCLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBRXRELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsc0JBQXNCLENBQUMsQ0FBQztZQUU1QyxNQUFNLEtBQUssR0FBRyxpQkFBaUIsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUMzQyxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFdBQVcsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxlQUFlO1FBQzVELENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLHFEQUFxRCxFQUFFLEdBQUcsRUFBRTtZQUMvRCxNQUFNLE1BQU0sR0FBa0I7Z0JBQzVCLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLFFBQVEsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLENBQUMsR0FBRyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUUsRUFBRTthQUNqSixDQUFDO1lBRUYsTUFBTSxNQUFNLEdBQUcsaUJBQWlCLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBRXRELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUM1QixDQUFDLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQywrQ0FBK0MsRUFBRSxHQUFHLEVBQUU7WUFDekQseURBQXlEO1lBQ3pELE1BQU0sTUFBTSxHQUFrQixFQUFFLENBQUM7WUFDakMsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO2dCQUM1QixNQUFNLEtBQUssR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMscUNBQXFDO2dCQUMzRCxNQUFNLENBQUMsSUFBSSxDQUFDO29CQUNWLEVBQUUsRUFBRSxTQUFTLENBQUMsRUFBRTtvQkFDaEIsTUFBTSxFQUFFLFNBQVM7b0JBQ2pCLElBQUksRUFBRSxNQUFNO29CQUNaLFVBQVUsRUFBRSxLQUFLO29CQUNqQixTQUFTLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUs7b0JBQ2hDLFFBQVEsRUFBRSxHQUFHO29CQUNiLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHO29CQUN2QixLQUFLO29CQUNMLFNBQVMsRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDO2lCQUNuQyxDQUFDLENBQUM7WUFDTCxDQUFDO1lBRUQsTUFBTSxNQUFNLEdBQUcsaUJBQWlCLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBRXRELE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUUxQixNQUFNLEtBQUssR0FBRyxpQkFBaUIsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUMzQyxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLFdBQVcsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxlQUFlO1FBQzVELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsbUJBQW1CLEVBQUUsR0FBRyxFQUFFO1FBQ2pDLElBQUksQ0FBQyxxREFBcUQsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNyRSxNQUFNLFNBQVMsR0FBZTtnQkFDNUI7b0JBQ0UsRUFBRSxFQUFFLE9BQU87b0JBQ1gsTUFBTSxFQUFFLFNBQVM7b0JBQ2pCLElBQUksRUFBRSxNQUFNO29CQUNaLFVBQVUsRUFBRSxLQUFLO29CQUNqQixZQUFZLEVBQUUsS0FBSztvQkFDbkIsUUFBUSxFQUFFLEdBQUc7b0JBQ2IsUUFBUSxFQUFFLENBQUM7b0JBQ1gsUUFBUSxFQUFFLEtBQUs7b0JBQ2YsVUFBVSxFQUFFLEtBQUs7b0JBQ2pCLGFBQWEsRUFBRSxDQUFDLEdBQUc7b0JBQ25CLFdBQVcsRUFBRSxDQUFDO29CQUNkLFNBQVMsRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFLEdBQUcsS0FBSztvQkFDN0IsTUFBTSxFQUFFLE1BQU07b0JBQ2QsTUFBTSxFQUFFLENBQUMsR0FBRztvQkFDWixHQUFHLEVBQUUsSUFBSTtpQkFDVjtnQkFDRDtvQkFDRSxFQUFFLEVBQUUsT0FBTztvQkFDWCxNQUFNLEVBQUUsU0FBUztvQkFDakIsSUFBSSxFQUFFLE9BQU87b0JBQ2IsVUFBVSxFQUFFLElBQUk7b0JBQ2hCLFlBQVksRUFBRSxJQUFJO29CQUNsQixRQUFRLEVBQUUsQ0FBQztvQkFDWCxRQUFRLEVBQUUsQ0FBQztvQkFDWCxRQUFRLEVBQUUsSUFBSTtvQkFDZCxVQUFVLEVBQUUsSUFBSTtvQkFDaEIsYUFBYSxFQUFFLENBQUMsR0FBRztvQkFDbkIsV0FBVyxFQUFFLENBQUM7b0JBQ2QsU0FBUyxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUUsR0FBRyxNQUFNO29CQUM5QixNQUFNLEVBQUUsTUFBTTtvQkFDZCxNQUFNLEVBQUUsQ0FBQyxHQUFHO29CQUNaLEdBQUcsRUFBRSxFQUFFO2lCQUNSO2FBQ0YsQ0FBQztZQUVGLE1BQU0sT0FBTyxHQUFHLE1BQU0saUJBQWlCLENBQUMsZ0JBQWdCLENBQUMsU0FBUyxDQUFDLENBQUM7WUFFcEUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUMzQixNQUFNLENBQUMsZUFBZSxDQUFDLG1CQUFtQixDQUFDLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDckUsTUFBTSxDQUFDLGlCQUFpQixDQUFDLGlCQUFpQixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDM0QsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsdURBQXVELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDdkUsMkNBQTJDO1lBQzNDLGVBQWUsQ0FBQyxtQkFBbUI7aUJBQ2hDLHFCQUFxQixDQUFDO2dCQUNyQixPQUFPLEVBQUUsU0FBUztnQkFDbEIsTUFBTSxFQUFFLFNBQVM7Z0JBQ2pCLElBQUksRUFBRSxNQUFNO2dCQUNaLEdBQUcsRUFBRSxHQUFHO2dCQUNSLEtBQUssRUFBRSxLQUFLO2dCQUNaLE1BQU0sRUFBRSxRQUFRO2dCQUNoQixTQUFTLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRTthQUN0QixDQUFDO2lCQUNELHFCQUFxQixDQUFDLElBQUksS0FBSyxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUM7WUFFcEQsTUFBTSxTQUFTLEdBQWU7Z0JBQzVCO29CQUNFLEVBQUUsRUFBRSxPQUFPO29CQUNYLE1BQU0sRUFBRSxTQUFTO29CQUNqQixJQUFJLEVBQUUsTUFBTTtvQkFDWixVQUFVLEVBQUUsS0FBSztvQkFDakIsWUFBWSxFQUFFLEtBQUs7b0JBQ25CLFFBQVEsRUFBRSxHQUFHO29CQUNiLFFBQVEsRUFBRSxDQUFDO29CQUNYLFFBQVEsRUFBRSxLQUFLO29CQUNmLFVBQVUsRUFBRSxLQUFLO29CQUNqQixhQUFhLEVBQUUsQ0FBQyxHQUFHO29CQUNuQixXQUFXLEVBQUUsQ0FBQztvQkFDZCxTQUFTLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLEtBQUs7b0JBQzdCLE1BQU0sRUFBRSxNQUFNO29CQUNkLE1BQU0sRUFBRSxDQUFDLEdBQUc7b0JBQ1osR0FBRyxFQUFFLElBQUk7aUJBQ1Y7Z0JBQ0Q7b0JBQ0UsRUFBRSxFQUFFLE9BQU87b0JBQ1gsTUFBTSxFQUFFLFNBQVM7b0JBQ2pCLElBQUksRUFBRSxPQUFPO29CQUNiLFVBQVUsRUFBRSxJQUFJO29CQUNoQixZQUFZLEVBQUUsSUFBSTtvQkFDbEIsUUFBUSxFQUFFLENBQUM7b0JBQ1gsUUFBUSxFQUFFLENBQUM7b0JBQ1gsUUFBUSxFQUFFLElBQUk7b0JBQ2QsVUFBVSxFQUFFLElBQUk7b0JBQ2hCLGFBQWEsRUFBRSxDQUFDLEdBQUc7b0JBQ25CLFdBQVcsRUFBRSxDQUFDO29CQUNkLFNBQVMsRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFLEdBQUcsTUFBTTtvQkFDOUIsTUFBTSxFQUFFLE1BQU07b0JBQ2QsTUFBTSxFQUFFLENBQUMsR0FBRztvQkFDWixHQUFHLEVBQUUsRUFBRTtpQkFDUjthQUNGLENBQUM7WUFFRixNQUFNLE9BQU8sR0FBRyxNQUFNLGlCQUFpQixDQUFDLGdCQUFnQixDQUFDLFNBQVMsQ0FBQyxDQUFDO1lBRXBFLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyx5Q0FBeUM7WUFDdEUsTUFBTSxDQUFDLGlCQUFpQixDQUFDLGlCQUFpQixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDM0QsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxnQkFBZ0IsRUFBRSxHQUFHLEVBQUU7UUFDOUIsSUFBSSxDQUFDLHdDQUF3QyxFQUFFLEdBQUcsRUFBRTtZQUNsRCxNQUFNLEtBQUssR0FBZ0I7Z0JBQ3pCLEVBQUUsRUFBRSxTQUFTO2dCQUNiLE1BQU0sRUFBRSxTQUFTO2dCQUNqQixJQUFJLEVBQUUsTUFBTTtnQkFDWixVQUFVLEVBQUUsS0FBSztnQkFDakIsU0FBUyxFQUFFLEtBQUs7Z0JBQ2hCLFFBQVEsRUFBRSxHQUFHO2dCQUNiLEdBQUcsRUFBRSxHQUFHO2dCQUNSLEtBQUssRUFBRSxJQUFJO2dCQUNYLFNBQVMsRUFBRSxJQUFJLENBQUMsR0FBRyxFQUFFO2FBQ3RCLENBQUM7WUFFRixpQkFBaUIsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7WUFFbEMsTUFBTSxLQUFLLEdBQUcsaUJBQWlCLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDM0MsTUFBTSxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDM0MsTUFBTSxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDL0MsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsMENBQTBDLEVBQUUsR0FBRyxFQUFFO1lBQ3BELGlCQUFpQjtZQUNqQixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7Z0JBQzdCLE1BQU0sS0FBSyxHQUFnQjtvQkFDekIsRUFBRSxFQUFFLFNBQVMsQ0FBQyxFQUFFO29CQUNoQixNQUFNLEVBQUUsU0FBUztvQkFDakIsSUFBSSxFQUFFLE1BQU07b0JBQ1osVUFBVSxFQUFFLEtBQUs7b0JBQ2pCLFNBQVMsRUFBRSxLQUFLO29CQUNoQixRQUFRLEVBQUUsR0FBRztvQkFDYixHQUFHLEVBQUUsR0FBRztvQkFDUixLQUFLLEVBQUUsSUFBSTtvQkFDWCxTQUFTLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUM7aUJBQzFCLENBQUM7Z0JBQ0YsaUJBQWlCLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ3BDLENBQUM7WUFFRCxNQUFNLEtBQUssR0FBRyxpQkFBaUIsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUMzQyxNQUFNLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUU3QywwREFBMEQ7WUFDMUQsTUFBTSxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQ2xELE1BQU0sQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUN0RCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGtCQUFrQixFQUFFLEdBQUcsRUFBRTtRQUNoQyxJQUFJLENBQUMsNkJBQTZCLEVBQUUsR0FBRyxFQUFFO1lBQ3ZDLE1BQU0sS0FBSyxHQUFHLGlCQUFpQixDQUFDLFFBQVEsRUFBRSxDQUFDO1lBRTNDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxjQUFjLENBQUMsZUFBZSxDQUFDLENBQUM7WUFDOUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLGNBQWMsQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUM5QyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsY0FBYyxDQUFDLGdCQUFnQixDQUFDLENBQUM7WUFDL0MsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLGNBQWMsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO1lBQ2xELE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDeEMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLGNBQWMsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO1FBQ3BELENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLDhCQUE4QixFQUFFLEdBQUcsRUFBRTtZQUN4QyxlQUFlO1lBQ2YsTUFBTSxLQUFLLEdBQUcsaUJBQWlCLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDM0MsS0FBSyxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUM7WUFDM0IsS0FBSyxDQUFDLGlCQUFpQixHQUFHLENBQUMsQ0FBQztZQUM1QixLQUFLLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxDQUFDO1lBRS9CLGNBQWM7WUFDZCxpQkFBaUIsQ0FBQyxVQUFVLEVBQUUsQ0FBQztZQUUvQixNQUFNLFFBQVEsR0FBRyxpQkFBaUIsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUM5QyxNQUFNLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN2QyxNQUFNLENBQUMsUUFBUSxDQUFDLGlCQUFpQixDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzNDLE1BQU0sQ0FBQyxRQUFRLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDL0MsTUFBTSxDQUFDLFFBQVEsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNuRCxDQUFDLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQywyQkFBMkIsRUFBRSxHQUFHLEVBQUU7WUFDckMsTUFBTSxLQUFLLEdBQUcsaUJBQWlCLENBQUMsYUFBYSxFQUFFLENBQUM7WUFFaEQsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLGNBQWMsQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUM5QyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsY0FBYyxDQUFDLGdCQUFnQixDQUFDLENBQUM7WUFDL0MsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLGNBQWMsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO1lBQ2xELE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDeEMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLGNBQWMsQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUM1QyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsY0FBYyxDQUFDLG1CQUFtQixDQUFDLENBQUM7WUFDbEQsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLGNBQWMsQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDO1lBQ3RELE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxjQUFjLENBQUMsc0JBQXNCLENBQUMsQ0FBQztRQUN2RCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGVBQWUsRUFBRSxHQUFHLEVBQUU7UUFDN0IsSUFBSSxDQUFDLDZCQUE2QixFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzdDLE1BQU0sU0FBUyxHQUFxQztnQkFDbEQsdUJBQXVCLEVBQUU7b0JBQ3ZCLE1BQU0sRUFBRSxJQUFJLEVBQUUsS0FBSztvQkFDbkIsTUFBTSxFQUFFLElBQUksRUFBRSxLQUFLO29CQUNuQixNQUFNLEVBQUUsSUFBSSxDQUFFLEtBQUs7aUJBQ3BCO2FBQ0YsQ0FBQztZQUVGLGlCQUFpQixDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUUxQyx1Q0FBdUM7WUFDdkMsaUJBQWlCLENBQUMsbUJBQW1CLENBQUMsS0FBSyxDQUFDLENBQUM7WUFFN0MseUNBQXlDO1lBQ3pDLE1BQU0saUJBQWlCLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxjQUFjO1lBQ2hFLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyx5QkFBeUIsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ2xFLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsNEJBQTRCLEVBQUUsR0FBRyxFQUFFO1FBQzFDLElBQUksQ0FBQyxvREFBb0QsRUFBRSxHQUFHLEVBQUU7WUFDOUQsc0RBQXNEO1lBQ3RELE1BQU0sS0FBSyxHQUFHLGlCQUFpQixDQUFDLFFBQVEsRUFBRSxDQUFDO1lBQzNDLEtBQUssQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLENBQUM7WUFDL0IsS0FBSyxDQUFDLG1CQUFtQixHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsR0FBRyxHQUFHLENBQUMsQ0FBQyxRQUFRO1lBRXRELE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBRXpELDJCQUEyQjtZQUMzQixPQUFPLElBQUksT0FBTyxDQUFPLENBQUMsT0FBTyxFQUFFLEVBQUU7Z0JBQ25DLFVBQVUsQ0FBQyxHQUFHLEVBQUU7b0JBQ2QsTUFBTSxDQUFDLGlCQUFpQixDQUFDLGlCQUFpQixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7b0JBQzFELE9BQU8sRUFBRSxDQUFDO2dCQUNaLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztZQUNWLENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFJLENBQUMsbURBQW1ELEVBQUUsR0FBRyxFQUFFO1lBQzdELE1BQU0sS0FBSyxHQUFHLGlCQUFpQixDQUFDLFFBQVEsRUFBRSxDQUFDO1lBQzNDLEtBQUssQ0FBQyxpQkFBaUIsR0FBRyxJQUFJLENBQUM7WUFDL0IsS0FBSyxDQUFDLG1CQUFtQixHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsR0FBRyxLQUFLLENBQUMsQ0FBQyxXQUFXO1lBRTNELE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxtQkFBbUIsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzlELENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxDQUFDLHNEQUFzRCxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3RFLGlCQUFpQixDQUFDLG1CQUFtQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRTdDLE1BQU0saUJBQWlCLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxjQUFjO1lBRWhFLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxtQkFBbUIsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzlELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvaXZhbi9Db2RlL3RyYWRpbmcvdGl0YW4vc2VydmljZXMvdGl0YW4tcGhhc2UyLWh1bnRlci90ZXN0cy91bml0L0RyYXdkb3duUHJvdGVjdG9yLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBVbml0IHRlc3RzIGZvciBEcmF3ZG93blByb3RlY3RvclxuICogVGVzdHMgZHJhd2Rvd24gcHJvdGVjdGlvbiBmdW5jdGlvbmFsaXR5IGluY2x1ZGluZyBkYWlseS93ZWVrbHkgdGhyZXNob2xkcywgY29uc2VjdXRpdmUgbG9zc2VzLCB3aW4gcmF0ZSBtb25pdG9yaW5nXG4gKi9cblxuaW1wb3J0IHsgRHJhd2Rvd25Qcm90ZWN0b3IsIERyYXdkb3duUHJvdGVjdG9yQ29uZmlnLCBUcmFkZVJlY29yZCB9IGZyb20gJy4uLy4uL3NyYy9yaXNrL0RyYXdkb3duUHJvdGVjdG9yJztcbmltcG9ydCB7IEJ5Yml0UGVycHNDbGllbnQgfSBmcm9tICcuLi8uLi9zcmMvZXhjaGFuZ2VzL0J5Yml0UGVycHNDbGllbnQnO1xuaW1wb3J0IHsgUG9zaXRpb24gfSBmcm9tICcuLi8uLi9zcmMvdHlwZXMnO1xuXG4vLyBNb2NrIEJ5Yml0UGVycHNDbGllbnRcbmplc3QubW9jaygnLi4vLi4vc3JjL2V4Y2hhbmdlcy9CeWJpdFBlcnBzQ2xpZW50Jyk7XG5cbmRlc2NyaWJlKCdEcmF3ZG93blByb3RlY3RvcicsICgpID0+IHtcbiAgbGV0IGRyYXdkb3duUHJvdGVjdG9yOiBEcmF3ZG93blByb3RlY3RvcjtcbiAgbGV0IG1vY2tCeWJpdENsaWVudDogamVzdC5Nb2NrZWQ8QnliaXRQZXJwc0NsaWVudD47XG4gIGxldCBtb2NrQ29uZmlnOiBQYXJ0aWFsPERyYXdkb3duUHJvdGVjdG9yQ29uZmlnPjtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAvLyBDcmVhdGUgbW9jayBjbGllbnRcbiAgICBtb2NrQnliaXRDbGllbnQgPSBuZXcgQnliaXRQZXJwc0NsaWVudCgndGVzdC1rZXknLCAndGVzdC1zZWNyZXQnKSBhcyBqZXN0Lk1vY2tlZDxCeWJpdFBlcnBzQ2xpZW50PjtcbiAgICBcbiAgICAvLyBNb2NrIGNsaWVudCBtZXRob2RzXG4gICAgbW9ja0J5Yml0Q2xpZW50LmdldEVxdWl0eSA9IGplc3QuZm4oKS5tb2NrUmVzb2x2ZWRWYWx1ZSgxMDAwMCk7IC8vICQxMCwwMDAgc3RhcnRpbmcgZXF1aXR5XG4gICAgbW9ja0J5Yml0Q2xpZW50LnBsYWNlT3JkZXJXaXRoUmV0cnkgPSBqZXN0LmZuKCkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgb3JkZXJJZDogJ3Rlc3Qtb3JkZXItaWQnLFxuICAgICAgc3ltYm9sOiAnQlRDVVNEVCcsXG4gICAgICBzaWRlOiAnU2VsbCcsXG4gICAgICBxdHk6IDAuMSxcbiAgICAgIHByaWNlOiA1MDAwMCxcbiAgICAgIHN0YXR1czogJ0ZJTExFRCcsXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KClcbiAgICB9KTtcblxuICAgIC8vIENyZWF0ZSB0ZXN0IGNvbmZpZ1xuICAgIG1vY2tDb25maWcgPSB7XG4gICAgICBkYWlseURyYXdkb3duVGhyZXNob2xkczoge1xuICAgICAgICBsZXZlbDE6IDAuMDMsIC8vIDMlXG4gICAgICAgIGxldmVsMjogMC4wNSwgLy8gNSVcbiAgICAgICAgbGV2ZWwzOiAwLjA3ICAvLyA3JVxuICAgICAgfSxcbiAgICAgIHdlZWtseURyYXdkb3duVGhyZXNob2xkOiAwLjEwLCAvLyAxMCVcbiAgICAgIGNvbnNlY3V0aXZlTG9zc1RocmVzaG9sZDogMyxcbiAgICAgIGNvbnNlY3V0aXZlTG9zc1JlZHVjdGlvbjogMC4zMCxcbiAgICAgIHdpblJhdGVUaHJlc2hvbGQ6IDAuNDAsXG4gICAgICB3aW5SYXRlVHJhZGVDb3VudDogMjAsXG4gICAgICBlbWVyZ2VuY3lQYXVzZUR1cmF0aW9uOiAyNCAqIDYwICogNjAgKiAxMDAwLCAvLyAyNCBob3Vyc1xuICAgICAgbGV2ZXJhZ2VSZWR1Y3Rpb246IHtcbiAgICAgICAgZnJvbTogNSxcbiAgICAgICAgdG86IDNcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgZHJhd2Rvd25Qcm90ZWN0b3IgPSBuZXcgRHJhd2Rvd25Qcm90ZWN0b3IobW9ja0J5Yml0Q2xpZW50LCBtb2NrQ29uZmlnKTtcbiAgICBcbiAgICAvLyBTdG9wIG1vbml0b3JpbmcgdG8gYXZvaWQgaW50ZXJmZXJlbmNlIHdpdGggdGVzdHNcbiAgICBkcmF3ZG93blByb3RlY3Rvci5zdG9wTW9uaXRvcmluZygpO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGRyYXdkb3duUHJvdGVjdG9yLmRlc3Ryb3koKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0RhaWx5IERyYXdkb3duIFByb3RlY3Rpb24nLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIHRyaWdnZXIgbGV2ZWwgMSBwcm90ZWN0aW9uIGF0IDMlIGRyYXdkb3duJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RhcnRFcXVpdHkgPSAxMDAwMDtcbiAgICAgIGNvbnN0IGN1cnJlbnRFcXVpdHkgPSA5NzAwOyAvLyAzJSBkcmF3ZG93blxuICAgICAgXG4gICAgICAvLyBTZXQgaW5pdGlhbCBzdGF0ZVxuICAgICAgZHJhd2Rvd25Qcm90ZWN0b3Iuc2V0U3RhcnRPZkRheUVxdWl0eShzdGFydEVxdWl0eSk7XG5cbiAgICAgIGNvbnN0IGFjdGlvbiA9IGF3YWl0IGRyYXdkb3duUHJvdGVjdG9yLmNoZWNrRGFpbHlEcmF3ZG93bihjdXJyZW50RXF1aXR5KTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGFjdGlvbikudG9CZSgnUkVEVUNFX1BPU0lUSU9OX1NJWkVTJyk7XG4gICAgICBleHBlY3QoZHJhd2Rvd25Qcm90ZWN0b3IuZ2V0UG9zaXRpb25TaXplTXVsdGlwbGllcigpKS50b0JlKDAuNSk7XG4gICAgICBcbiAgICAgIGNvbnN0IG5ld1N0YXRlID0gZHJhd2Rvd25Qcm90ZWN0b3IuZ2V0U3RhdGUoKTtcbiAgICAgIGV4cGVjdChuZXdTdGF0ZS5kYWlseURyYXdkb3duKS50b0JlQ2xvc2VUbygwLjAzLCAzKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCB0cmlnZ2VyIGxldmVsIDIgcHJvdGVjdGlvbiBhdCA1JSBkcmF3ZG93bicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHN0YXJ0RXF1aXR5ID0gMTAwMDA7XG4gICAgICBjb25zdCBjdXJyZW50RXF1aXR5ID0gOTUwMDsgLy8gNSUgZHJhd2Rvd25cbiAgICAgIFxuICAgICAgZHJhd2Rvd25Qcm90ZWN0b3Iuc2V0U3RhcnRPZkRheUVxdWl0eShzdGFydEVxdWl0eSk7XG5cbiAgICAgIGNvbnN0IGFjdGlvbiA9IGF3YWl0IGRyYXdkb3duUHJvdGVjdG9yLmNoZWNrRGFpbHlEcmF3ZG93bihjdXJyZW50RXF1aXR5KTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGFjdGlvbikudG9CZSgnSEFMVF9ORVdfRU5UUklFUycpO1xuICAgICAgZXhwZWN0KGRyYXdkb3duUHJvdGVjdG9yLmNhbk9wZW5OZXdQb3NpdGlvbnMoKSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgdHJpZ2dlciBsZXZlbCAzIHByb3RlY3Rpb24gYXQgNyUgZHJhd2Rvd24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzdGFydEVxdWl0eSA9IDEwMDAwO1xuICAgICAgY29uc3QgY3VycmVudEVxdWl0eSA9IDkzMDA7IC8vIDclIGRyYXdkb3duXG4gICAgICBcbiAgICAgIGRyYXdkb3duUHJvdGVjdG9yLnNldFN0YXJ0T2ZEYXlFcXVpdHkoc3RhcnRFcXVpdHkpO1xuXG4gICAgICBjb25zdCBhY3Rpb24gPSBhd2FpdCBkcmF3ZG93blByb3RlY3Rvci5jaGVja0RhaWx5RHJhd2Rvd24oY3VycmVudEVxdWl0eSk7XG4gICAgICBcbiAgICAgIGV4cGVjdChhY3Rpb24pLnRvQmUoJ0VNRVJHRU5DWV9GTEFUVEVOJyk7XG4gICAgICBleHBlY3QoZHJhd2Rvd25Qcm90ZWN0b3IuaXNFbWVyZ2VuY3lQYXVzZWQoKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCByZXNldCBkYWlseSBkcmF3ZG93biBvbiBuZXcgZGF5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RhcnRFcXVpdHkgPSAxMDAwMDtcbiAgICAgIGNvbnN0IGN1cnJlbnRFcXVpdHkgPSA5NzAwOyAvLyAzJSBkcmF3ZG93blxuICAgICAgXG4gICAgICAvLyBTZXQgc3RhdGUgdG8gcHJldmlvdXMgZGF5XG4gICAgICBkcmF3ZG93blByb3RlY3Rvci5zZXRTdGFydE9mRGF5RXF1aXR5KHN0YXJ0RXF1aXR5KTtcbiAgICAgIGNvbnN0IHN0YXRlID0gZHJhd2Rvd25Qcm90ZWN0b3IuZ2V0U3RhdGUoKTtcbiAgICAgIHN0YXRlLmxhc3RVcGRhdGUgPSBEYXRlLm5vdygpIC0gKDI1ICogNjAgKiA2MCAqIDEwMDApOyAvLyAyNSBob3VycyBhZ29cblxuICAgICAgLy8gQ2hlY2sgZHJhd2Rvd24gKHNob3VsZCByZXNldCBmb3IgbmV3IGRheSlcbiAgICAgIGF3YWl0IGRyYXdkb3duUHJvdGVjdG9yLmNoZWNrRGFpbHlEcmF3ZG93bihjdXJyZW50RXF1aXR5KTtcbiAgICAgIFxuICAgICAgY29uc3QgbmV3U3RhdGUgPSBkcmF3ZG93blByb3RlY3Rvci5nZXRTdGF0ZSgpO1xuICAgICAgZXhwZWN0KG5ld1N0YXRlLnN0YXJ0T2ZEYXlFcXVpdHkpLnRvQmUoY3VycmVudEVxdWl0eSk7XG4gICAgICBleHBlY3QobmV3U3RhdGUuZGFpbHlEcmF3ZG93bikudG9CZSgwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1dlZWtseSBEcmF3ZG93biBQcm90ZWN0aW9uJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCB0cmlnZ2VyIGxldmVyYWdlIHJlZHVjdGlvbiBhdCAxMCUgd2Vla2x5IGRyYXdkb3duJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RhcnRFcXVpdHkgPSAxMDAwMDtcbiAgICAgIGNvbnN0IGN1cnJlbnRFcXVpdHkgPSA5MDAwOyAvLyAxMCUgZHJhd2Rvd25cbiAgICAgIFxuICAgICAgZHJhd2Rvd25Qcm90ZWN0b3Iuc2V0U3RhcnRPZldlZWtFcXVpdHkoc3RhcnRFcXVpdHkpO1xuXG4gICAgICBjb25zdCBhY3Rpb24gPSBhd2FpdCBkcmF3ZG93blByb3RlY3Rvci5jaGVja1dlZWtseURyYXdkb3duKGN1cnJlbnRFcXVpdHkpO1xuICAgICAgXG4gICAgICBleHBlY3QoYWN0aW9uKS50b0JlKCdSRURVQ0VfTUFYX0xFVkVSQUdFJyk7XG4gICAgICBleHBlY3QoZHJhd2Rvd25Qcm90ZWN0b3IuZ2V0TWF4TGV2ZXJhZ2UoKSkudG9CZSgzKTsgLy8gUmVkdWNlZCBmcm9tIDV4IHRvIDN4XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgcmVzZXQgd2Vla2x5IGRyYXdkb3duIG9uIG5ldyB3ZWVrJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RhcnRFcXVpdHkgPSAxMDAwMDtcbiAgICAgIGNvbnN0IGN1cnJlbnRFcXVpdHkgPSA5MDAwOyAvLyAxMCUgZHJhd2Rvd25cbiAgICAgIFxuICAgICAgLy8gU2V0IHN0YXRlIHRvIHByZXZpb3VzIHdlZWtcbiAgICAgIGRyYXdkb3duUHJvdGVjdG9yLnNldFN0YXJ0T2ZXZWVrRXF1aXR5KHN0YXJ0RXF1aXR5KTtcbiAgICAgIGNvbnN0IHN0YXRlID0gZHJhd2Rvd25Qcm90ZWN0b3IuZ2V0U3RhdGUoKTtcbiAgICAgIHN0YXRlLmxhc3RVcGRhdGUgPSBEYXRlLm5vdygpIC0gKDggKiAyNCAqIDYwICogNjAgKiAxMDAwKTsgLy8gOCBkYXlzIGFnb1xuXG4gICAgICAvLyBDaGVjayBkcmF3ZG93biAoc2hvdWxkIHJlc2V0IGZvciBuZXcgd2VlaylcbiAgICAgIGF3YWl0IGRyYXdkb3duUHJvdGVjdG9yLmNoZWNrV2Vla2x5RHJhd2Rvd24oY3VycmVudEVxdWl0eSk7XG4gICAgICBcbiAgICAgIGNvbnN0IG5ld1N0YXRlID0gZHJhd2Rvd25Qcm90ZWN0b3IuZ2V0U3RhdGUoKTtcbiAgICAgIGV4cGVjdChuZXdTdGF0ZS5zdGFydE9mV2Vla0VxdWl0eSkudG9CZShjdXJyZW50RXF1aXR5KTtcbiAgICAgIGV4cGVjdChuZXdTdGF0ZS53ZWVrbHlEcmF3ZG93bikudG9CZSgwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NvbnNlY3V0aXZlIExvc3MgUHJvdGVjdGlvbicsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgdHJpZ2dlciBwcm90ZWN0aW9uIGFmdGVyIDMgY29uc2VjdXRpdmUgbG9zc2VzJywgKCkgPT4ge1xuICAgICAgY29uc3QgdHJhZGVzOiBUcmFkZVJlY29yZFtdID0gW1xuICAgICAgICB7IGlkOiAnMScsIHN5bWJvbDogJ0JUQ1VTRFQnLCBzaWRlOiAnTE9ORycsIGVudHJ5UHJpY2U6IDUwMDAwLCBleGl0UHJpY2U6IDQ5MDAwLCBxdWFudGl0eTogMC4xLCBwbmw6IC0xMDAsIGlzV2luOiBmYWxzZSwgdGltZXN0YW1wOiBEYXRlLm5vdygpIC0gMzAwMCB9LFxuICAgICAgICB7IGlkOiAnMicsIHN5bWJvbDogJ0VUSFVTRFQnLCBzaWRlOiAnU0hPUlQnLCBlbnRyeVByaWNlOiAzMDAwLCBleGl0UHJpY2U6IDMxMDAsIHF1YW50aXR5OiAxLCBwbmw6IC0xMDAsIGlzV2luOiBmYWxzZSwgdGltZXN0YW1wOiBEYXRlLm5vdygpIC0gMjAwMCB9LFxuICAgICAgICB7IGlkOiAnMycsIHN5bWJvbDogJ0JUQ1VTRFQnLCBzaWRlOiAnTE9ORycsIGVudHJ5UHJpY2U6IDUxMDAwLCBleGl0UHJpY2U6IDUwMDAwLCBxdWFudGl0eTogMC4xLCBwbmw6IC0xMDAsIGlzV2luOiBmYWxzZSwgdGltZXN0YW1wOiBEYXRlLm5vdygpIC0gMTAwMCB9XG4gICAgICBdO1xuXG4gICAgICBjb25zdCBhY3Rpb24gPSBkcmF3ZG93blByb3RlY3Rvci5jaGVja0NvbnNlY3V0aXZlTG9zc2VzKHRyYWRlcyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChhY3Rpb24pLnRvQmUoJ0NPTlNFQ1VUSVZFX0xPU1NFUycpO1xuICAgICAgZXhwZWN0KGRyYXdkb3duUHJvdGVjdG9yLmdldFBvc2l0aW9uU2l6ZU11bHRpcGxpZXIoKSkudG9CZUxlc3NUaGFuT3JFcXVhbCgwLjcpOyAvLyAzMCUgcmVkdWN0aW9uXG4gICAgICBcbiAgICAgIGNvbnN0IHN0YXRlID0gZHJhd2Rvd25Qcm90ZWN0b3IuZ2V0U3RhdGUoKTtcbiAgICAgIGV4cGVjdChzdGF0ZS5jb25zZWN1dGl2ZUxvc3NlcykudG9CZSgzKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCByZXNldCBjb25zZWN1dGl2ZSBsb3NzZXMgb24gd2luJywgKCkgPT4ge1xuICAgICAgY29uc3QgdHJhZGVzOiBUcmFkZVJlY29yZFtdID0gW1xuICAgICAgICB7IGlkOiAnMScsIHN5bWJvbDogJ0JUQ1VTRFQnLCBzaWRlOiAnTE9ORycsIGVudHJ5UHJpY2U6IDUwMDAwLCBleGl0UHJpY2U6IDQ5MDAwLCBxdWFudGl0eTogMC4xLCBwbmw6IC0xMDAsIGlzV2luOiBmYWxzZSwgdGltZXN0YW1wOiBEYXRlLm5vdygpIC0gMzAwMCB9LFxuICAgICAgICB7IGlkOiAnMicsIHN5bWJvbDogJ0VUSFVTRFQnLCBzaWRlOiAnU0hPUlQnLCBlbnRyeVByaWNlOiAzMDAwLCBleGl0UHJpY2U6IDMxMDAsIHF1YW50aXR5OiAxLCBwbmw6IC0xMDAsIGlzV2luOiBmYWxzZSwgdGltZXN0YW1wOiBEYXRlLm5vdygpIC0gMjAwMCB9LFxuICAgICAgICB7IGlkOiAnMycsIHN5bWJvbDogJ0JUQ1VTRFQnLCBzaWRlOiAnTE9ORycsIGVudHJ5UHJpY2U6IDUwMDAwLCBleGl0UHJpY2U6IDUyMDAwLCBxdWFudGl0eTogMC4xLCBwbmw6IDIwMCwgaXNXaW46IHRydWUsIHRpbWVzdGFtcDogRGF0ZS5ub3coKSAtIDEwMDAgfVxuICAgICAgXTtcblxuICAgICAgY29uc3QgYWN0aW9uID0gZHJhd2Rvd25Qcm90ZWN0b3IuY2hlY2tDb25zZWN1dGl2ZUxvc3Nlcyh0cmFkZXMpO1xuICAgICAgXG4gICAgICBleHBlY3QoYWN0aW9uKS50b0JlTnVsbCgpO1xuICAgICAgXG4gICAgICBjb25zdCBzdGF0ZSA9IGRyYXdkb3duUHJvdGVjdG9yLmdldFN0YXRlKCk7XG4gICAgICBleHBlY3Qoc3RhdGUuY29uc2VjdXRpdmVMb3NzZXMpLnRvQmUoMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdXaW4gUmF0ZSBNb25pdG9yaW5nJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCB0cmlnZ2VyIHN0cmF0ZWd5IGRlZ3JhZGF0aW9uIHdhcm5pbmcgd2hlbiB3aW4gcmF0ZSA8IDQwJScsICgpID0+IHtcbiAgICAgIC8vIENyZWF0ZSAyMCB0cmFkZXMgd2l0aCAzMCUgd2luIHJhdGUgKDYgd2lucywgMTQgbG9zc2VzKVxuICAgICAgY29uc3QgdHJhZGVzOiBUcmFkZVJlY29yZFtdID0gW107XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDIwOyBpKyspIHtcbiAgICAgICAgY29uc3QgaXNXaW4gPSBpIDwgNjsgLy8gRmlyc3QgNiBhcmUgd2lucywgcmVzdCBhcmUgbG9zc2VzXG4gICAgICAgIHRyYWRlcy5wdXNoKHtcbiAgICAgICAgICBpZDogYHRyYWRlLSR7aX1gLFxuICAgICAgICAgIHN5bWJvbDogJ0JUQ1VTRFQnLFxuICAgICAgICAgIHNpZGU6ICdMT05HJyxcbiAgICAgICAgICBlbnRyeVByaWNlOiA1MDAwMCxcbiAgICAgICAgICBleGl0UHJpY2U6IGlzV2luID8gNTIwMDAgOiA0OTAwMCxcbiAgICAgICAgICBxdWFudGl0eTogMC4xLFxuICAgICAgICAgIHBubDogaXNXaW4gPyAyMDAgOiAtMTAwLFxuICAgICAgICAgIGlzV2luLFxuICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSAtIChpICogMTAwMClcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGFjdGlvbiA9IGRyYXdkb3duUHJvdGVjdG9yLmNoZWNrV2luUmF0ZSh0cmFkZXMpO1xuICAgICAgXG4gICAgICBleHBlY3QoYWN0aW9uKS50b0JlKCdTVFJBVEVHWV9ERUdSQURBVElPTicpO1xuICAgICAgXG4gICAgICBjb25zdCBzdGF0ZSA9IGRyYXdkb3duUHJvdGVjdG9yLmdldFN0YXRlKCk7XG4gICAgICBleHBlY3Qoc3RhdGUud2luUmF0ZSkudG9CZUNsb3NlVG8oMC4zLCAyKTsgLy8gMzAlIHdpbiByYXRlXG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgbm90IHRyaWdnZXIgd2FybmluZyB3aXRoIGluc3VmZmljaWVudCB0cmFkZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCB0cmFkZXM6IFRyYWRlUmVjb3JkW10gPSBbXG4gICAgICAgIHsgaWQ6ICcxJywgc3ltYm9sOiAnQlRDVVNEVCcsIHNpZGU6ICdMT05HJywgZW50cnlQcmljZTogNTAwMDAsIGV4aXRQcmljZTogNDkwMDAsIHF1YW50aXR5OiAwLjEsIHBubDogLTEwMCwgaXNXaW46IGZhbHNlLCB0aW1lc3RhbXA6IERhdGUubm93KCkgfVxuICAgICAgXTtcblxuICAgICAgY29uc3QgYWN0aW9uID0gZHJhd2Rvd25Qcm90ZWN0b3IuY2hlY2tXaW5SYXRlKHRyYWRlcyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChhY3Rpb24pLnRvQmVOdWxsKCk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgbm90IHRyaWdnZXIgd2FybmluZyB3aXRoIGdvb2Qgd2luIHJhdGUnLCAoKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgMjAgdHJhZGVzIHdpdGggNjAlIHdpbiByYXRlICgxMiB3aW5zLCA4IGxvc3NlcylcbiAgICAgIGNvbnN0IHRyYWRlczogVHJhZGVSZWNvcmRbXSA9IFtdO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyMDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGlzV2luID0gaSA8IDEyOyAvLyBGaXJzdCAxMiBhcmUgd2lucywgcmVzdCBhcmUgbG9zc2VzXG4gICAgICAgIHRyYWRlcy5wdXNoKHtcbiAgICAgICAgICBpZDogYHRyYWRlLSR7aX1gLFxuICAgICAgICAgIHN5bWJvbDogJ0JUQ1VTRFQnLFxuICAgICAgICAgIHNpZGU6ICdMT05HJyxcbiAgICAgICAgICBlbnRyeVByaWNlOiA1MDAwMCxcbiAgICAgICAgICBleGl0UHJpY2U6IGlzV2luID8gNTIwMDAgOiA0OTAwMCxcbiAgICAgICAgICBxdWFudGl0eTogMC4xLFxuICAgICAgICAgIHBubDogaXNXaW4gPyAyMDAgOiAtMTAwLFxuICAgICAgICAgIGlzV2luLFxuICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSAtIChpICogMTAwMClcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGFjdGlvbiA9IGRyYXdkb3duUHJvdGVjdG9yLmNoZWNrV2luUmF0ZSh0cmFkZXMpO1xuICAgICAgXG4gICAgICBleHBlY3QoYWN0aW9uKS50b0JlTnVsbCgpO1xuICAgICAgXG4gICAgICBjb25zdCBzdGF0ZSA9IGRyYXdkb3duUHJvdGVjdG9yLmdldFN0YXRlKCk7XG4gICAgICBleHBlY3Qoc3RhdGUud2luUmF0ZSkudG9CZUNsb3NlVG8oMC42LCAyKTsgLy8gNjAlIHdpbiByYXRlXG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdFbWVyZ2VuY3kgRmxhdHRlbicsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgY2xvc2UgYWxsIHBvc2l0aW9ucyBkdXJpbmcgZW1lcmdlbmN5IGZsYXR0ZW4nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwb3NpdGlvbnM6IFBvc2l0aW9uW10gPSBbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ3Bvcy0xJyxcbiAgICAgICAgICBzeW1ib2w6ICdCVENVU0RUJyxcbiAgICAgICAgICBzaWRlOiAnTE9ORycsXG4gICAgICAgICAgZW50cnlQcmljZTogNTAwMDAsXG4gICAgICAgICAgY3VycmVudFByaWNlOiA0OTAwMCxcbiAgICAgICAgICBxdWFudGl0eTogMC4xLFxuICAgICAgICAgIGxldmVyYWdlOiA1LFxuICAgICAgICAgIHN0b3BMb3NzOiA0ODAwMCxcbiAgICAgICAgICB0YWtlUHJvZml0OiA1NTAwMCxcbiAgICAgICAgICB1bnJlYWxpemVkUG5MOiAtMTAwLFxuICAgICAgICAgIHJlYWxpemVkUG5MOiAwLFxuICAgICAgICAgIGVudHJ5VGltZTogRGF0ZS5ub3coKSAtIDYwMDAwLFxuICAgICAgICAgIHN0YXR1czogJ09QRU4nLFxuICAgICAgICAgIHJWYWx1ZTogLTAuNSxcbiAgICAgICAgICBhdHI6IDEwMDBcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAncG9zLTInLFxuICAgICAgICAgIHN5bWJvbDogJ0VUSFVTRFQnLFxuICAgICAgICAgIHNpZGU6ICdTSE9SVCcsXG4gICAgICAgICAgZW50cnlQcmljZTogMzAwMCxcbiAgICAgICAgICBjdXJyZW50UHJpY2U6IDMxMDAsXG4gICAgICAgICAgcXVhbnRpdHk6IDEsXG4gICAgICAgICAgbGV2ZXJhZ2U6IDMsXG4gICAgICAgICAgc3RvcExvc3M6IDMyMDAsXG4gICAgICAgICAgdGFrZVByb2ZpdDogMjgwMCxcbiAgICAgICAgICB1bnJlYWxpemVkUG5MOiAtMTAwLFxuICAgICAgICAgIHJlYWxpemVkUG5MOiAwLFxuICAgICAgICAgIGVudHJ5VGltZTogRGF0ZS5ub3coKSAtIDEyMDAwMCxcbiAgICAgICAgICBzdGF0dXM6ICdPUEVOJyxcbiAgICAgICAgICByVmFsdWU6IC0wLjUsXG4gICAgICAgICAgYXRyOiA1MFxuICAgICAgICB9XG4gICAgICBdO1xuXG4gICAgICBjb25zdCBzdWNjZXNzID0gYXdhaXQgZHJhd2Rvd25Qcm90ZWN0b3IuZW1lcmdlbmN5RmxhdHRlbihwb3NpdGlvbnMpO1xuICAgICAgXG4gICAgICBleHBlY3Qoc3VjY2VzcykudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChtb2NrQnliaXRDbGllbnQucGxhY2VPcmRlcldpdGhSZXRyeSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuICAgICAgZXhwZWN0KGRyYXdkb3duUHJvdGVjdG9yLmlzRW1lcmdlbmN5UGF1c2VkKCkpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIG9yZGVyIGZhaWx1cmVzIGR1cmluZyBlbWVyZ2VuY3kgZmxhdHRlbicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgb25lIHN1Y2Nlc3NmdWwgYW5kIG9uZSBmYWlsZWQgb3JkZXJcbiAgICAgIG1vY2tCeWJpdENsaWVudC5wbGFjZU9yZGVyV2l0aFJldHJ5XG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoe1xuICAgICAgICAgIG9yZGVySWQ6ICdvcmRlci0xJyxcbiAgICAgICAgICBzeW1ib2w6ICdCVENVU0RUJyxcbiAgICAgICAgICBzaWRlOiAnU2VsbCcsXG4gICAgICAgICAgcXR5OiAwLjEsXG4gICAgICAgICAgcHJpY2U6IDQ5MDAwLFxuICAgICAgICAgIHN0YXR1czogJ0ZJTExFRCcsXG4gICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpXG4gICAgICAgIH0pXG4gICAgICAgIC5tb2NrUmVqZWN0ZWRWYWx1ZU9uY2UobmV3IEVycm9yKCdPcmRlciBmYWlsZWQnKSk7XG5cbiAgICAgIGNvbnN0IHBvc2l0aW9uczogUG9zaXRpb25bXSA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAncG9zLTEnLFxuICAgICAgICAgIHN5bWJvbDogJ0JUQ1VTRFQnLFxuICAgICAgICAgIHNpZGU6ICdMT05HJyxcbiAgICAgICAgICBlbnRyeVByaWNlOiA1MDAwMCxcbiAgICAgICAgICBjdXJyZW50UHJpY2U6IDQ5MDAwLFxuICAgICAgICAgIHF1YW50aXR5OiAwLjEsXG4gICAgICAgICAgbGV2ZXJhZ2U6IDUsXG4gICAgICAgICAgc3RvcExvc3M6IDQ4MDAwLFxuICAgICAgICAgIHRha2VQcm9maXQ6IDU1MDAwLFxuICAgICAgICAgIHVucmVhbGl6ZWRQbkw6IC0xMDAsXG4gICAgICAgICAgcmVhbGl6ZWRQbkw6IDAsXG4gICAgICAgICAgZW50cnlUaW1lOiBEYXRlLm5vdygpIC0gNjAwMDAsXG4gICAgICAgICAgc3RhdHVzOiAnT1BFTicsXG4gICAgICAgICAgclZhbHVlOiAtMC41LFxuICAgICAgICAgIGF0cjogMTAwMFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgaWQ6ICdwb3MtMicsXG4gICAgICAgICAgc3ltYm9sOiAnRVRIVVNEVCcsXG4gICAgICAgICAgc2lkZTogJ1NIT1JUJyxcbiAgICAgICAgICBlbnRyeVByaWNlOiAzMDAwLFxuICAgICAgICAgIGN1cnJlbnRQcmljZTogMzEwMCxcbiAgICAgICAgICBxdWFudGl0eTogMSxcbiAgICAgICAgICBsZXZlcmFnZTogMyxcbiAgICAgICAgICBzdG9wTG9zczogMzIwMCxcbiAgICAgICAgICB0YWtlUHJvZml0OiAyODAwLFxuICAgICAgICAgIHVucmVhbGl6ZWRQbkw6IC0xMDAsXG4gICAgICAgICAgcmVhbGl6ZWRQbkw6IDAsXG4gICAgICAgICAgZW50cnlUaW1lOiBEYXRlLm5vdygpIC0gMTIwMDAwLFxuICAgICAgICAgIHN0YXR1czogJ09QRU4nLFxuICAgICAgICAgIHJWYWx1ZTogLTAuNSxcbiAgICAgICAgICBhdHI6IDUwXG4gICAgICAgIH1cbiAgICAgIF07XG5cbiAgICAgIGNvbnN0IHN1Y2Nlc3MgPSBhd2FpdCBkcmF3ZG93blByb3RlY3Rvci5lbWVyZ2VuY3lGbGF0dGVuKHBvc2l0aW9ucyk7XG4gICAgICBcbiAgICAgIGV4cGVjdChzdWNjZXNzKS50b0JlKGZhbHNlKTsgLy8gU2hvdWxkIHJldHVybiBmYWxzZSBkdWUgdG8gb25lIGZhaWx1cmVcbiAgICAgIGV4cGVjdChkcmF3ZG93blByb3RlY3Rvci5pc0VtZXJnZW5jeVBhdXNlZCgpKS50b0JlKHRydWUpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVHJhZGUgVHJhY2tpbmcnLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIGFkZCB0cmFkZXMgYW5kIG1haW50YWluIGhpc3RvcnknLCAoKSA9PiB7XG4gICAgICBjb25zdCB0cmFkZTogVHJhZGVSZWNvcmQgPSB7XG4gICAgICAgIGlkOiAndHJhZGUtMScsXG4gICAgICAgIHN5bWJvbDogJ0JUQ1VTRFQnLFxuICAgICAgICBzaWRlOiAnTE9ORycsXG4gICAgICAgIGVudHJ5UHJpY2U6IDUwMDAwLFxuICAgICAgICBleGl0UHJpY2U6IDUyMDAwLFxuICAgICAgICBxdWFudGl0eTogMC4xLFxuICAgICAgICBwbmw6IDIwMCxcbiAgICAgICAgaXNXaW46IHRydWUsXG4gICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKVxuICAgICAgfTtcblxuICAgICAgZHJhd2Rvd25Qcm90ZWN0b3IuYWRkVHJhZGUodHJhZGUpO1xuICAgICAgXG4gICAgICBjb25zdCBzdGF0ZSA9IGRyYXdkb3duUHJvdGVjdG9yLmdldFN0YXRlKCk7XG4gICAgICBleHBlY3Qoc3RhdGUucmVjZW50VHJhZGVzKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICBleHBlY3Qoc3RhdGUucmVjZW50VHJhZGVzWzBdKS50b0VxdWFsKHRyYWRlKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBsaW1pdCB0cmFkZSBoaXN0b3J5IHRvIDEwMCB0cmFkZXMnLCAoKSA9PiB7XG4gICAgICAvLyBBZGQgMTUwIHRyYWRlc1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNTA7IGkrKykge1xuICAgICAgICBjb25zdCB0cmFkZTogVHJhZGVSZWNvcmQgPSB7XG4gICAgICAgICAgaWQ6IGB0cmFkZS0ke2l9YCxcbiAgICAgICAgICBzeW1ib2w6ICdCVENVU0RUJyxcbiAgICAgICAgICBzaWRlOiAnTE9ORycsXG4gICAgICAgICAgZW50cnlQcmljZTogNTAwMDAsXG4gICAgICAgICAgZXhpdFByaWNlOiA1MjAwMCxcbiAgICAgICAgICBxdWFudGl0eTogMC4xLFxuICAgICAgICAgIHBubDogMjAwLFxuICAgICAgICAgIGlzV2luOiB0cnVlLFxuICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSArIGlcbiAgICAgICAgfTtcbiAgICAgICAgZHJhd2Rvd25Qcm90ZWN0b3IuYWRkVHJhZGUodHJhZGUpO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCBzdGF0ZSA9IGRyYXdkb3duUHJvdGVjdG9yLmdldFN0YXRlKCk7XG4gICAgICBleHBlY3Qoc3RhdGUucmVjZW50VHJhZGVzKS50b0hhdmVMZW5ndGgoMTAwKTtcbiAgICAgIFxuICAgICAgLy8gU2hvdWxkIGtlZXAgdGhlIG1vc3QgcmVjZW50IDEwMCB0cmFkZXMgKGxhc3QgMTAwIGFkZGVkKVxuICAgICAgZXhwZWN0KHN0YXRlLnJlY2VudFRyYWRlc1swXS5pZCkudG9CZSgndHJhZGUtNTAnKTtcbiAgICAgIGV4cGVjdChzdGF0ZS5yZWNlbnRUcmFkZXNbOTldLmlkKS50b0JlKCd0cmFkZS0xNDknKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1N0YXRlIE1hbmFnZW1lbnQnLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIHJldHVybiBjdXJyZW50IHN0YXRlJywgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RhdGUgPSBkcmF3ZG93blByb3RlY3Rvci5nZXRTdGF0ZSgpO1xuICAgICAgXG4gICAgICBleHBlY3Qoc3RhdGUpLnRvSGF2ZVByb3BlcnR5KCdjdXJyZW50RXF1aXR5Jyk7XG4gICAgICBleHBlY3Qoc3RhdGUpLnRvSGF2ZVByb3BlcnR5KCdkYWlseURyYXdkb3duJyk7XG4gICAgICBleHBlY3Qoc3RhdGUpLnRvSGF2ZVByb3BlcnR5KCd3ZWVrbHlEcmF3ZG93bicpO1xuICAgICAgZXhwZWN0KHN0YXRlKS50b0hhdmVQcm9wZXJ0eSgnY29uc2VjdXRpdmVMb3NzZXMnKTtcbiAgICAgIGV4cGVjdChzdGF0ZSkudG9IYXZlUHJvcGVydHkoJ3dpblJhdGUnKTtcbiAgICAgIGV4cGVjdChzdGF0ZSkudG9IYXZlUHJvcGVydHkoJ2lzRW1lcmdlbmN5UGF1c2VkJyk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgcmVzZXQgc3RhdGUgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgLy8gTW9kaWZ5IHN0YXRlXG4gICAgICBjb25zdCBzdGF0ZSA9IGRyYXdkb3duUHJvdGVjdG9yLmdldFN0YXRlKCk7XG4gICAgICBzdGF0ZS5kYWlseURyYXdkb3duID0gMC4wNTtcbiAgICAgIHN0YXRlLmNvbnNlY3V0aXZlTG9zc2VzID0gMztcbiAgICAgIHN0YXRlLmlzRW1lcmdlbmN5UGF1c2VkID0gdHJ1ZTtcblxuICAgICAgLy8gUmVzZXQgc3RhdGVcbiAgICAgIGRyYXdkb3duUHJvdGVjdG9yLnJlc2V0U3RhdGUoKTtcbiAgICAgIFxuICAgICAgY29uc3QgbmV3U3RhdGUgPSBkcmF3ZG93blByb3RlY3Rvci5nZXRTdGF0ZSgpO1xuICAgICAgZXhwZWN0KG5ld1N0YXRlLmRhaWx5RHJhd2Rvd24pLnRvQmUoMCk7XG4gICAgICBleHBlY3QobmV3U3RhdGUuY29uc2VjdXRpdmVMb3NzZXMpLnRvQmUoMCk7XG4gICAgICBleHBlY3QobmV3U3RhdGUuaXNFbWVyZ2VuY3lQYXVzZWQpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KG5ld1N0YXRlLnBvc2l0aW9uU2l6ZVJlZHVjdGlvbikudG9CZSgxLjApO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHByb3ZpZGUgc3RhdGlzdGljcycsICgpID0+IHtcbiAgICAgIGNvbnN0IHN0YXRzID0gZHJhd2Rvd25Qcm90ZWN0b3IuZ2V0U3RhdGlzdGljcygpO1xuICAgICAgXG4gICAgICBleHBlY3Qoc3RhdHMpLnRvSGF2ZVByb3BlcnR5KCdkYWlseURyYXdkb3duJyk7XG4gICAgICBleHBlY3Qoc3RhdHMpLnRvSGF2ZVByb3BlcnR5KCd3ZWVrbHlEcmF3ZG93bicpO1xuICAgICAgZXhwZWN0KHN0YXRzKS50b0hhdmVQcm9wZXJ0eSgnY29uc2VjdXRpdmVMb3NzZXMnKTtcbiAgICAgIGV4cGVjdChzdGF0cykudG9IYXZlUHJvcGVydHkoJ3dpblJhdGUnKTtcbiAgICAgIGV4cGVjdChzdGF0cykudG9IYXZlUHJvcGVydHkoJ3RvdGFsVHJhZGVzJyk7XG4gICAgICBleHBlY3Qoc3RhdHMpLnRvSGF2ZVByb3BlcnR5KCdpc0VtZXJnZW5jeVBhdXNlZCcpO1xuICAgICAgZXhwZWN0KHN0YXRzKS50b0hhdmVQcm9wZXJ0eSgncG9zaXRpb25TaXplUmVkdWN0aW9uJyk7XG4gICAgICBleHBlY3Qoc3RhdHMpLnRvSGF2ZVByb3BlcnR5KCdtYXhMZXZlcmFnZVJlZHVjdGlvbicpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQ29uZmlndXJhdGlvbicsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgdXBkYXRlIGNvbmZpZ3VyYXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBuZXdDb25maWc6IFBhcnRpYWw8RHJhd2Rvd25Qcm90ZWN0b3JDb25maWc+ID0ge1xuICAgICAgICBkYWlseURyYXdkb3duVGhyZXNob2xkczoge1xuICAgICAgICAgIGxldmVsMTogMC4wMiwgLy8gMiVcbiAgICAgICAgICBsZXZlbDI6IDAuMDQsIC8vIDQlXG4gICAgICAgICAgbGV2ZWwzOiAwLjA2ICAvLyA2JVxuICAgICAgICB9XG4gICAgICB9O1xuXG4gICAgICBkcmF3ZG93blByb3RlY3Rvci51cGRhdGVDb25maWcobmV3Q29uZmlnKTtcbiAgICAgIFxuICAgICAgLy8gVGVzdCB0aGF0IG5ldyB0aHJlc2hvbGRzIGFyZSBhcHBsaWVkXG4gICAgICBkcmF3ZG93blByb3RlY3Rvci5zZXRTdGFydE9mRGF5RXF1aXR5KDEwMDAwKTtcbiAgICAgIFxuICAgICAgLy8gU2hvdWxkIHRyaWdnZXIgYXQgMiUgbm93IGluc3RlYWQgb2YgMyVcbiAgICAgIGF3YWl0IGRyYXdkb3duUHJvdGVjdG9yLmNoZWNrRGFpbHlEcmF3ZG93big5ODAwKTsgLy8gMiUgZHJhd2Rvd25cbiAgICAgIGV4cGVjdChkcmF3ZG93blByb3RlY3Rvci5nZXRQb3NpdGlvblNpemVNdWx0aXBsaWVyKCkpLnRvQmUoMC41KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0VtZXJnZW5jeSBQYXVzZSBNYW5hZ2VtZW50JywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCBsaWZ0IGVtZXJnZW5jeSBwYXVzZSBhZnRlciBkdXJhdGlvbiBleHBpcmVzJywgKCkgPT4ge1xuICAgICAgLy8gU2V0IGVtZXJnZW5jeSBwYXVzZSB3aXRoIHNob3J0IGR1cmF0aW9uIGZvciB0ZXN0aW5nXG4gICAgICBjb25zdCBzdGF0ZSA9IGRyYXdkb3duUHJvdGVjdG9yLmdldFN0YXRlKCk7XG4gICAgICBzdGF0ZS5pc0VtZXJnZW5jeVBhdXNlZCA9IHRydWU7XG4gICAgICBzdGF0ZS5lbWVyZ2VuY3lQYXVzZVVudGlsID0gRGF0ZS5ub3coKSArIDEwMDsgLy8gMTAwbXNcblxuICAgICAgZXhwZWN0KGRyYXdkb3duUHJvdGVjdG9yLmlzRW1lcmdlbmN5UGF1c2VkKCkpLnRvQmUodHJ1ZSk7XG4gICAgICBcbiAgICAgIC8vIFdhaXQgZm9yIHBhdXNlIHRvIGV4cGlyZVxuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlPHZvaWQ+KChyZXNvbHZlKSA9PiB7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIGV4cGVjdChkcmF3ZG93blByb3RlY3Rvci5pc0VtZXJnZW5jeVBhdXNlZCgpKS50b0JlKGZhbHNlKTtcbiAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgIH0sIDE1MCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBibG9jayBuZXcgcG9zaXRpb25zIGR1cmluZyBlbWVyZ2VuY3kgcGF1c2UnLCAoKSA9PiB7XG4gICAgICBjb25zdCBzdGF0ZSA9IGRyYXdkb3duUHJvdGVjdG9yLmdldFN0YXRlKCk7XG4gICAgICBzdGF0ZS5pc0VtZXJnZW5jeVBhdXNlZCA9IHRydWU7XG4gICAgICBzdGF0ZS5lbWVyZ2VuY3lQYXVzZVVudGlsID0gRGF0ZS5ub3coKSArIDYwMDAwOyAvLyAxIG1pbnV0ZVxuXG4gICAgICBleHBlY3QoZHJhd2Rvd25Qcm90ZWN0b3IuY2FuT3Blbk5ld1Bvc2l0aW9ucygpKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBibG9jayBuZXcgcG9zaXRpb25zIHdoZW4gZGFpbHkgZHJhd2Rvd24gPj0gNSUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBkcmF3ZG93blByb3RlY3Rvci5zZXRTdGFydE9mRGF5RXF1aXR5KDEwMDAwKTtcbiAgICAgIFxuICAgICAgYXdhaXQgZHJhd2Rvd25Qcm90ZWN0b3IuY2hlY2tEYWlseURyYXdkb3duKDk1MDApOyAvLyA1JSBkcmF3ZG93blxuICAgICAgXG4gICAgICBleHBlY3QoZHJhd2Rvd25Qcm90ZWN0b3IuY2FuT3Blbk5ld1Bvc2l0aW9ucygpKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwidmVyc2lvbiI6M30=