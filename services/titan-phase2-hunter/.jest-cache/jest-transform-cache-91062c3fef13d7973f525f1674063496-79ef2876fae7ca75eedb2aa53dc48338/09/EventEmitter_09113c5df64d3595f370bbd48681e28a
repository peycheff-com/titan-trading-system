53b5ab692d9afd1999c888ad39c72ccc
"use strict";
/**
 * Event System for Titan Phase 2 - The Hunter
 *
 * Provides a centralized event-driven architecture for communication
 * between different components of the Hunter system.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.hunterEvents = exports.HunterEventEmitter = void 0;
const events_1 = require("events");
/**
 * Centralized Event Emitter for the Hunter system
 *
 * This class provides a type-safe event system that allows different
 * components to communicate without tight coupling.
 */
class HunterEventEmitter extends events_1.EventEmitter {
    static instance;
    constructor() {
        super();
        // Set max listeners to handle multiple subscribers
        this.setMaxListeners(50);
    }
    /**
     * Get singleton instance
     */
    static getInstance() {
        if (!HunterEventEmitter.instance) {
            HunterEventEmitter.instance = new HunterEventEmitter();
        }
        return HunterEventEmitter.instance;
    }
    /**
     * Emit a typed event
     */
    emitEvent(event, payload) {
        return this.emit(event, payload);
    }
    /**
     * Subscribe to a typed event
     */
    onEvent(event, listener) {
        return this.on(event, listener);
    }
    /**
     * Subscribe to a typed event (once)
     */
    onceEvent(event, listener) {
        return this.once(event, listener);
    }
    /**
     * Unsubscribe from a typed event
     */
    offEvent(event, listener) {
        return this.off(event, listener);
    }
    // Convenience methods for common events
    /**
     * Emit hologram updated event
     */
    emitHologramUpdated(symbol, hologramState, previousStatus) {
        this.emitEvent('HOLOGRAM_UPDATED', {
            symbol,
            hologramState,
            previousStatus,
            timestamp: Date.now()
        });
    }
    /**
     * Emit session change event
     */
    emitSessionChange(previousSession, currentSession, asianRange) {
        this.emitEvent('SESSION_CHANGE', {
            previousSession,
            currentSession,
            asianRange,
            timestamp: Date.now()
        });
    }
    /**
     * Emit CVD absorption event
     */
    emitCVDAbsorption(symbol, absorption, poiPrice, confidence) {
        this.emitEvent('CVD_ABSORPTION', {
            symbol,
            absorption,
            poiPrice,
            confidence,
            timestamp: Date.now()
        });
    }
    /**
     * Emit CVD distribution event
     */
    emitCVDDistribution(symbol, distribution, poiPrice, confidence) {
        this.emitEvent('CVD_DISTRIBUTION', {
            symbol,
            distribution,
            poiPrice,
            confidence,
            timestamp: Date.now()
        });
    }
    /**
     * Emit signal generated event
     */
    emitSignalGenerated(signal, hologramState, sessionState, cvdConfirmation) {
        this.emitEvent('SIGNAL_GENERATED', {
            signal,
            hologramState,
            sessionState,
            cvdConfirmation,
            timestamp: Date.now()
        });
    }
    /**
     * Emit execution complete event
     */
    emitExecutionComplete(execution, signal, success, slippage) {
        this.emitEvent('EXECUTION_COMPLETE', {
            execution,
            signal,
            success,
            slippage,
            timestamp: Date.now()
        });
    }
    /**
     * Emit error event
     */
    emitError(component, error, severity = 'MEDIUM', context) {
        this.emitEvent('ERROR', {
            component,
            error,
            context,
            severity,
            timestamp: Date.now()
        });
    }
    /**
     * Emit scan complete event
     */
    emitScanComplete(symbolsScanned, aPlus, bAlignment, conflicts, duration) {
        this.emitEvent('SCAN_COMPLETE', {
            symbolsScanned,
            aPlus,
            bAlignment,
            conflicts,
            duration,
            timestamp: Date.now()
        });
    }
    /**
     * Emit Judas swing detected event
     */
    emitJudasSwing(judasSwing, sessionType, asianRange) {
        this.emitEvent('JUDAS_SWING_DETECTED', {
            judasSwing,
            sessionType,
            asianRange,
            timestamp: Date.now()
        });
    }
    /**
     * Emit POI detected event
     */
    emitPOIDetected(symbol, poiType, price, confidence, distance) {
        this.emitEvent('POI_DETECTED', {
            symbol,
            poiType,
            price,
            confidence,
            distance,
            timestamp: Date.now()
        });
    }
    /**
     * Emit risk warning event
     */
    emitRiskWarning(type, severity, value, threshold, message) {
        this.emitEvent('RISK_WARNING', {
            type,
            severity,
            value,
            threshold,
            message,
            timestamp: Date.now()
        });
    }
    /**
     * Get event statistics
     */
    getEventStats() {
        const stats = {};
        const events = this.eventNames();
        for (const event of events) {
            stats[event.toString()] = this.listenerCount(event);
        }
        return stats;
    }
    /**
     * Clear all listeners (useful for testing)
     */
    clearAllListeners() {
        this.removeAllListeners();
    }
}
exports.HunterEventEmitter = HunterEventEmitter;
// Export singleton instance
exports.hunterEvents = HunterEventEmitter.getInstance();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2l2YW4vQ29kZS90cmFkaW5nL3RpdGFuL3NlcnZpY2VzL3RpdGFuLXBoYXNlMi1odW50ZXIvc3JjL2V2ZW50cy9FdmVudEVtaXR0ZXIudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7OztHQUtHOzs7QUFFSCxtQ0FBMEQ7QUFpSTFEOzs7OztHQUtHO0FBQ0gsTUFBYSxrQkFBbUIsU0FBUSxxQkFBZ0I7SUFDOUMsTUFBTSxDQUFDLFFBQVEsQ0FBcUI7SUFFNUM7UUFDRSxLQUFLLEVBQUUsQ0FBQztRQUNSLG1EQUFtRDtRQUNuRCxJQUFJLENBQUMsZUFBZSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQzNCLENBQUM7SUFFRDs7T0FFRztJQUNILE1BQU0sQ0FBQyxXQUFXO1FBQ2hCLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUNqQyxrQkFBa0IsQ0FBQyxRQUFRLEdBQUcsSUFBSSxrQkFBa0IsRUFBRSxDQUFDO1FBQ3pELENBQUM7UUFDRCxPQUFPLGtCQUFrQixDQUFDLFFBQVEsQ0FBQztJQUNyQyxDQUFDO0lBRUQ7O09BRUc7SUFDSCxTQUFTLENBQTJCLEtBQVEsRUFBRSxPQUFvQjtRQUNoRSxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ25DLENBQUM7SUFFRDs7T0FFRztJQUNILE9BQU8sQ0FDTCxLQUFRLEVBQ1IsUUFBd0M7UUFFeEMsT0FBTyxJQUFJLENBQUMsRUFBRSxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQztJQUNsQyxDQUFDO0lBRUQ7O09BRUc7SUFDSCxTQUFTLENBQ1AsS0FBUSxFQUNSLFFBQXdDO1FBRXhDLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFDcEMsQ0FBQztJQUVEOztPQUVHO0lBQ0gsUUFBUSxDQUNOLEtBQVEsRUFDUixRQUF3QztRQUV4QyxPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxD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LENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2l2YW4vQ29kZS90cmFkaW5nL3RpdGFuL3NlcnZpY2VzL3RpdGFuLXBoYXNlMi1odW50ZXIvc3JjL2V2ZW50cy9FdmVudEVtaXR0ZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBFdmVudCBTeXN0ZW0gZm9yIFRpdGFuIFBoYXNlIDIgLSBUaGUgSHVudGVyXG4gKiBcbiAqIFByb3ZpZGVzIGEgY2VudHJhbGl6ZWQgZXZlbnQtZHJpdmVuIGFyY2hpdGVjdHVyZSBmb3IgY29tbXVuaWNhdGlvblxuICogYmV0d2VlbiBkaWZmZXJlbnQgY29tcG9uZW50cyBvZiB0aGUgSHVudGVyIHN5c3RlbS5cbiAqL1xuXG5pbXBvcnQgeyBFdmVudEVtaXR0ZXIgYXMgTm9kZUV2ZW50RW1pdHRlciB9IGZyb20gJ2V2ZW50cyc7XG5pbXBvcnQgeyBcbiAgSG9sb2dyYW1TdGF0ZSwgXG4gIFNlc3Npb25TdGF0ZSwgXG4gIEFic29ycHRpb24sIFxuICBEaXN0cmlidXRpb24sIFxuICBTaWduYWxEYXRhLCBcbiAgRXhlY3V0aW9uRGF0YSxcbiAgQXNpYW5SYW5nZSxcbiAgSnVkYXNTd2luZ1xufSBmcm9tICcuLi90eXBlcyc7XG5cbi8vIEV2ZW50IHR5cGUgZGVmaW5pdGlvbnNcbmV4cG9ydCBpbnRlcmZhY2UgRXZlbnRNYXAge1xuICAvLyBIb2xvZ3JhbSBldmVudHNcbiAgSE9MT0dSQU1fVVBEQVRFRDogSG9sb2dyYW1VcGRhdGVkRXZlbnQ7XG4gIFxuICAvLyBTZXNzaW9uIGV2ZW50c1xuICBTRVNTSU9OX0NIQU5HRTogU2Vzc2lvbkNoYW5nZUV2ZW50O1xuICBcbiAgLy8gQ1ZEIGV2ZW50c1xuICBDVkRfQUJTT1JQVElPTjogQ1ZEQWJzb3JwdGlvbkV2ZW50O1xuICBDVkRfRElTVFJJQlVUSU9OOiBDVkREaXN0cmlidXRpb25FdmVudDtcbiAgXG4gIC8vIFNpZ25hbCBldmVudHNcbiAgU0lHTkFMX0dFTkVSQVRFRDogU2lnbmFsR2VuZXJhdGVkRXZlbnQ7XG4gIFxuICAvLyBFeGVjdXRpb24gZXZlbnRzXG4gIEVYRUNVVElPTl9DT01QTEVURTogRXhlY3V0aW9uQ29tcGxldGVFdmVudDtcbiAgXG4gIC8vIEVycm9yIGV2ZW50c1xuICBFUlJPUjogRXJyb3JFdmVudDtcbiAgXG4gIC8vIEFkZGl0aW9uYWwgc3lzdGVtIGV2ZW50c1xuICBTQ0FOX0NPTVBMRVRFOiBTY2FuQ29tcGxldGVFdmVudDtcbiAgSlVEQVNfU1dJTkdfREVURUNURUQ6IEp1ZGFzU3dpbmdFdmVudDtcbiAgUE9JX0RFVEVDVEVEOiBQT0lEZXRlY3RlZEV2ZW50O1xuICBSSVNLX1dBUk5JTkc6IFJpc2tXYXJuaW5nRXZlbnQ7XG59XG5cbi8vIEV2ZW50IHBheWxvYWQgaW50ZXJmYWNlc1xuZXhwb3J0IGludGVyZmFjZSBIb2xvZ3JhbVVwZGF0ZWRFdmVudCB7XG4gIHN5bWJvbDogc3RyaW5nO1xuICBob2xvZ3JhbVN0YXRlOiBIb2xvZ3JhbVN0YXRlO1xuICBwcmV2aW91c1N0YXR1cz86IHN0cmluZztcbiAgdGltZXN0YW1wOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2Vzc2lvbkNoYW5nZUV2ZW50IHtcbiAgcHJldmlvdXNTZXNzaW9uOiBTZXNzaW9uU3RhdGU7XG4gIGN1cnJlbnRTZXNzaW9uOiBTZXNzaW9uU3RhdGU7XG4gIGFzaWFuUmFuZ2U/OiBBc2lhblJhbmdlO1xuICB0aW1lc3RhbXA6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDVkRBYnNvcnB0aW9uRXZlbnQge1xuICBzeW1ib2w6IHN0cmluZztcbiAgYWJzb3JwdGlvbjogQWJzb3JwdGlvbjtcbiAgcG9pUHJpY2U6IG51bWJlcjtcbiAgY29uZmlkZW5jZTogbnVtYmVyO1xuICB0aW1lc3RhbXA6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDVkREaXN0cmlidXRpb25FdmVudCB7XG4gIHN5bWJvbDogc3RyaW5nO1xuICBkaXN0cmlidXRpb246IERpc3RyaWJ1dGlvbjtcbiAgcG9pUHJpY2U6IG51bWJlcjtcbiAgY29uZmlkZW5jZTogbnVtYmVyO1xuICB0aW1lc3RhbXA6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTaWduYWxHZW5lcmF0ZWRFdmVudCB7XG4gIHNpZ25hbDogU2lnbmFsRGF0YTtcbiAgaG9sb2dyYW1TdGF0ZTogSG9sb2dyYW1TdGF0ZTtcbiAgc2Vzc2lvblN0YXRlOiBTZXNzaW9uU3RhdGU7XG4gIGN2ZENvbmZpcm1hdGlvbjogYm9vbGVhbjtcbiAgdGltZXN0YW1wOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRXhlY3V0aW9uQ29tcGxldGVFdmVudCB7XG4gIGV4ZWN1dGlvbjogRXhlY3V0aW9uRGF0YTtcbiAgc2lnbmFsOiBTaWduYWxEYXRhO1xuICBzdWNjZXNzOiBib29sZWFuO1xuICBzbGlwcGFnZTogbnVtYmVyO1xuICB0aW1lc3RhbXA6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFcnJvckV2ZW50IHtcbiAgY29tcG9uZW50OiBzdHJpbmc7XG4gIGVycm9yOiBFcnJvcjtcbiAgY29udGV4dD86IFJlY29yZDxzdHJpbmcsIGFueT47XG4gIHNldmVyaXR5OiAnTE9XJyB8ICdNRURJVU0nIHwgJ0hJR0gnIHwgJ0NSSVRJQ0FMJztcbiAgdGltZXN0YW1wOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2NhbkNvbXBsZXRlRXZlbnQge1xuICBzeW1ib2xzU2Nhbm5lZDogbnVtYmVyO1xuICBhUGx1czogbnVtYmVyO1xuICBiQWxpZ25tZW50OiBudW1iZXI7XG4gIGNvbmZsaWN0czogbnVtYmVyO1xuICBkdXJhdGlvbjogbnVtYmVyO1xuICB0aW1lc3RhbXA6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBKdWRhc1N3aW5nRXZlbnQge1xuICBqdWRhc1N3aW5nOiBKdWRhc1N3aW5nO1xuICBzZXNzaW9uVHlwZTogJ0xPTkRPTicgfCAnTlknO1xuICBhc2lhblJhbmdlOiBBc2lhblJhbmdlO1xuICB0aW1lc3RhbXA6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQT0lEZXRlY3RlZEV2ZW50IHtcbiAgc3ltYm9sOiBzdHJpbmc7XG4gIHBvaVR5cGU6ICdGVkcnIHwgJ09SREVSX0JMT0NLJyB8ICdMSVFVSURJVFlfUE9PTCc7XG4gIHByaWNlOiBudW1iZXI7XG4gIGNvbmZpZGVuY2U6IG51bWJlcjtcbiAgZGlzdGFuY2U6IG51bWJlcjsgLy8gRGlzdGFuY2UgZnJvbSBjdXJyZW50IHByaWNlIGluICVcbiAgdGltZXN0YW1wOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmlza1dhcm5pbmdFdmVudCB7XG4gIHR5cGU6ICdEUkFXRE9XTicgfCAnQ09SUkVMQVRJT04nIHwgJ1BPUlRGT0xJT19IRUFUJyB8ICdDT05TRUNVVElWRV9MT1NTRVMnO1xuICBzZXZlcml0eTogJ1dBUk5JTkcnIHwgJ0NSSVRJQ0FMJztcbiAgdmFsdWU6IG51bWJlcjtcbiAgdGhyZXNob2xkOiBudW1iZXI7XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgdGltZXN0YW1wOiBudW1iZXI7XG59XG5cbi8qKlxuICogQ2VudHJhbGl6ZWQgRXZlbnQgRW1pdHRlciBmb3IgdGhlIEh1bnRlciBzeXN0ZW1cbiAqIFxuICogVGhpcyBjbGFzcyBwcm92aWRlcyBhIHR5cGUtc2FmZSBldmVudCBzeXN0ZW0gdGhhdCBhbGxvd3MgZGlmZmVyZW50XG4gKiBjb21wb25lbnRzIHRvIGNvbW11bmljYXRlIHdpdGhvdXQgdGlnaHQgY291cGxpbmcuXG4gKi9cbmV4cG9ydCBjbGFzcyBIdW50ZXJFdmVudEVtaXR0ZXIgZXh0ZW5kcyBOb2RlRXZlbnRFbWl0dGVyIHtcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IEh1bnRlckV2ZW50RW1pdHRlcjtcbiAgXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKCk7XG4gICAgLy8gU2V0IG1heCBsaXN0ZW5lcnMgdG8gaGFuZGxlIG11bHRpcGxlIHN1YnNjcmliZXJzXG4gICAgdGhpcy5zZXRNYXhMaXN0ZW5lcnMoNTApO1xuICB9XG4gIFxuICAvKipcbiAgICogR2V0IHNpbmdsZXRvbiBpbnN0YW5jZVxuICAgKi9cbiAgc3RhdGljIGdldEluc3RhbmNlKCk6IEh1bnRlckV2ZW50RW1pdHRlciB7XG4gICAgaWYgKCFIdW50ZXJFdmVudEVtaXR0ZXIuaW5zdGFuY2UpIHtcbiAgICAgIEh1bnRlckV2ZW50RW1pdHRlci5pbnN0YW5jZSA9IG5ldyBIdW50ZXJFdmVudEVtaXR0ZXIoKTtcbiAgICB9XG4gICAgcmV0dXJuIEh1bnRlckV2ZW50RW1pdHRlci5pbnN0YW5jZTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIEVtaXQgYSB0eXBlZCBldmVudFxuICAgKi9cbiAgZW1pdEV2ZW50PEsgZXh0ZW5kcyBrZXlvZiBFdmVudE1hcD4oZXZlbnQ6IEssIHBheWxvYWQ6IEV2ZW50TWFwW0tdKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuZW1pdChldmVudCwgcGF5bG9hZCk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBTdWJzY3JpYmUgdG8gYSB0eXBlZCBldmVudFxuICAgKi9cbiAgb25FdmVudDxLIGV4dGVuZHMga2V5b2YgRXZlbnRNYXA+KFxuICAgIGV2ZW50OiBLLCBcbiAgICBsaXN0ZW5lcjogKHBheWxvYWQ6IEV2ZW50TWFwW0tdKSA9PiB2b2lkXG4gICk6IHRoaXMge1xuICAgIHJldHVybiB0aGlzLm9uKGV2ZW50LCBsaXN0ZW5lcik7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBTdWJzY3JpYmUgdG8gYSB0eXBlZCBldmVudCAob25jZSlcbiAgICovXG4gIG9uY2VFdmVudDxLIGV4dGVuZHMga2V5b2YgRXZlbnRNYXA+KFxuICAgIGV2ZW50OiBLLCBcbiAgICBsaXN0ZW5lcjogKHBheWxvYWQ6IEV2ZW50TWFwW0tdKSA9PiB2b2lkXG4gICk6IHRoaXMge1xuICAgIHJldHVybiB0aGlzLm9uY2UoZXZlbnQsIGxpc3RlbmVyKTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIFVuc3Vic2NyaWJlIGZyb20gYSB0eXBlZCBldmVudFxuICAgKi9cbiAgb2ZmRXZlbnQ8SyBleHRlbmRzIGtleW9mIEV2ZW50TWFwPihcbiAgICBldmVudDogSywgXG4gICAgbGlzdGVuZXI6IChwYXlsb2FkOiBFdmVudE1hcFtLXSkgPT4gdm9pZFxuICApOiB0aGlzIHtcbiAgICByZXR1cm4gdGhpcy5vZmYoZXZlbnQsIGxpc3RlbmVyKTtcbiAgfVxuICBcbiAgLy8gQ29udmVuaWVuY2UgbWV0aG9kcyBmb3IgY29tbW9uIGV2ZW50c1xuICBcbiAgLyoqXG4gICAqIEVtaXQgaG9sb2dyYW0gdXBkYXRlZCBldmVudFxuICAgKi9cbiAgZW1pdEhvbG9ncmFtVXBkYXRlZChzeW1ib2w6IHN0cmluZywgaG9sb2dyYW1TdGF0ZTogSG9sb2dyYW1TdGF0ZSwgcHJldmlvdXNTdGF0dXM/OiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLmVtaXRFdmVudCgnSE9MT0dSQU1fVVBEQVRFRCcsIHtcbiAgICAgIHN5bWJvbCxcbiAgICAgIGhvbG9ncmFtU3RhdGUsXG4gICAgICBwcmV2aW91c1N0YXR1cyxcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKVxuICAgIH0pO1xuICB9XG4gIFxuICAvKipcbiAgICogRW1pdCBzZXNzaW9uIGNoYW5nZSBldmVudFxuICAgKi9cbiAgZW1pdFNlc3Npb25DaGFuZ2UocHJldmlvdXNTZXNzaW9uOiBTZXNzaW9uU3RhdGUsIGN1cnJlbnRTZXNzaW9uOiBTZXNzaW9uU3RhdGUsIGFzaWFuUmFuZ2U/OiBBc2lhblJhbmdlKTogdm9pZCB7XG4gICAgdGhpcy5lbWl0RXZlbnQoJ1NFU1NJT05fQ0hBTkdFJywge1xuICAgICAgcHJldmlvdXNTZXNzaW9uLFxuICAgICAgY3VycmVudFNlc3Npb24sXG4gICAgICBhc2lhblJhbmdlLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpXG4gICAgfSk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBFbWl0IENWRCBhYnNvcnB0aW9uIGV2ZW50XG4gICAqL1xuICBlbWl0Q1ZEQWJzb3JwdGlvbihzeW1ib2w6IHN0cmluZywgYWJzb3JwdGlvbjogQWJzb3JwdGlvbiwgcG9pUHJpY2U6IG51bWJlciwgY29uZmlkZW5jZTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5lbWl0RXZlbnQoJ0NWRF9BQlNPUlBUSU9OJywge1xuICAgICAgc3ltYm9sLFxuICAgICAgYWJzb3JwdGlvbixcbiAgICAgIHBvaVByaWNlLFxuICAgICAgY29uZmlkZW5jZSxcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKVxuICAgIH0pO1xuICB9XG4gIFxuICAvKipcbiAgICogRW1pdCBDVkQgZGlzdHJpYnV0aW9uIGV2ZW50XG4gICAqL1xuICBlbWl0Q1ZERGlzdHJpYnV0aW9uKHN5bWJvbDogc3RyaW5nLCBkaXN0cmlidXRpb246IERpc3RyaWJ1dGlvbiwgcG9pUHJpY2U6IG51bWJlciwgY29uZmlkZW5jZTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5lbWl0RXZlbnQoJ0NWRF9ESVNUUklCVVRJT04nLCB7XG4gICAgICBzeW1ib2wsXG4gICAgICBkaXN0cmlidXRpb24sXG4gICAgICBwb2lQcmljZSxcbiAgICAgIGNvbmZpZGVuY2UsXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KClcbiAgICB9KTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIEVtaXQgc2lnbmFsIGdlbmVyYXRlZCBldmVudFxuICAgKi9cbiAgZW1pdFNpZ25hbEdlbmVyYXRlZChcbiAgICBzaWduYWw6IFNpZ25hbERhdGEsIFxuICAgIGhvbG9ncmFtU3RhdGU6IEhvbG9ncmFtU3RhdGUsIFxuICAgIHNlc3Npb25TdGF0ZTogU2Vzc2lvblN0YXRlLCBcbiAgICBjdmRDb25maXJtYXRpb246IGJvb2xlYW5cbiAgKTogdm9pZCB7XG4gICAgdGhpcy5lbWl0RXZlbnQoJ1NJR05BTF9HRU5FUkFURUQnLCB7XG4gICAgICBzaWduYWwsXG4gICAgICBob2xvZ3JhbVN0YXRlLFxuICAgICAgc2Vzc2lvblN0YXRlLFxuICAgICAgY3ZkQ29uZmlybWF0aW9uLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpXG4gICAgfSk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBFbWl0IGV4ZWN1dGlvbiBjb21wbGV0ZSBldmVudFxuICAgKi9cbiAgZW1pdEV4ZWN1dGlvbkNvbXBsZXRlKFxuICAgIGV4ZWN1dGlvbjogRXhlY3V0aW9uRGF0YSwgXG4gICAgc2lnbmFsOiBTaWduYWxEYXRhLCBcbiAgICBzdWNjZXNzOiBib29sZWFuLCBcbiAgICBzbGlwcGFnZTogbnVtYmVyXG4gICk6IHZvaWQge1xuICAgIHRoaXMuZW1pdEV2ZW50KCdFWEVDVVRJT05fQ09NUExFVEUnLCB7XG4gICAgICBleGVjdXRpb24sXG4gICAgICBzaWduYWwsXG4gICAgICBzdWNjZXNzLFxuICAgICAgc2xpcHBhZ2UsXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KClcbiAgICB9KTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIEVtaXQgZXJyb3IgZXZlbnRcbiAgICovXG4gIGVtaXRFcnJvcihcbiAgICBjb21wb25lbnQ6IHN0cmluZywgXG4gICAgZXJyb3I6IEVycm9yLCBcbiAgICBzZXZlcml0eTogJ0xPVycgfCAnTUVESVVNJyB8ICdISUdIJyB8ICdDUklUSUNBTCcgPSAnTUVESVVNJyxcbiAgICBjb250ZXh0PzogUmVjb3JkPHN0cmluZywgYW55PlxuICApOiB2b2lkIHtcbiAgICB0aGlzLmVtaXRFdmVudCgnRVJST1InLCB7XG4gICAgICBjb21wb25lbnQsXG4gICAgICBlcnJvcixcbiAgICAgIGNvbnRleHQsXG4gICAgICBzZXZlcml0eSxcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKVxuICAgIH0pO1xuICB9XG4gIFxuICAvKipcbiAgICogRW1pdCBzY2FuIGNvbXBsZXRlIGV2ZW50XG4gICAqL1xuICBlbWl0U2NhbkNvbXBsZXRlKFxuICAgIHN5bWJvbHNTY2FubmVkOiBudW1iZXIsIFxuICAgIGFQbHVzOiBudW1iZXIsIFxuICAgIGJBbGlnbm1lbnQ6IG51bWJlciwgXG4gICAgY29uZmxpY3RzOiBudW1iZXIsIFxuICAgIGR1cmF0aW9uOiBudW1iZXJcbiAgKTogdm9pZCB7XG4gICAgdGhpcy5lbWl0RXZlbnQoJ1NDQU5fQ09NUExFVEUnLCB7XG4gICAgICBzeW1ib2xzU2Nhbm5lZCxcbiAgICAgIGFQbHVzLFxuICAgICAgYkFsaWdubWVudCxcbiAgICAgIGNvbmZsaWN0cyxcbiAgICAgIGR1cmF0aW9uLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpXG4gICAgfSk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBFbWl0IEp1ZGFzIHN3aW5nIGRldGVjdGVkIGV2ZW50XG4gICAqL1xuICBlbWl0SnVkYXNTd2luZyhqdWRhc1N3aW5nOiBKdWRhc1N3aW5nLCBzZXNzaW9uVHlwZTogJ0xPTkRPTicgfCAnTlknLCBhc2lhblJhbmdlOiBBc2lhblJhbmdlKTogdm9pZCB7XG4gICAgdGhpcy5lbWl0RXZlbnQoJ0pVREFTX1NXSU5HX0RFVEVDVEVEJywge1xuICAgICAganVkYXNTd2luZyxcbiAgICAgIHNlc3Npb25UeXBlLFxuICAgICAgYXNpYW5SYW5nZSxcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKVxuICAgIH0pO1xuICB9XG4gIFxuICAvKipcbiAgICogRW1pdCBQT0kgZGV0ZWN0ZWQgZXZlbnRcbiAgICovXG4gIGVtaXRQT0lEZXRlY3RlZChcbiAgICBzeW1ib2w6IHN0cmluZywgXG4gICAgcG9pVHlwZTogJ0ZWRycgfCAnT1JERVJfQkxPQ0snIHwgJ0xJUVVJRElUWV9QT09MJywgXG4gICAgcHJpY2U6IG51bWJlciwgXG4gICAgY29uZmlkZW5jZTogbnVtYmVyLCBcbiAgICBkaXN0YW5jZTogbnVtYmVyXG4gICk6IHZvaWQge1xuICAgIHRoaXMuZW1pdEV2ZW50KCdQT0lfREVURUNURUQnLCB7XG4gICAgICBzeW1ib2wsXG4gICAgICBwb2lUeXBlLFxuICAgICAgcHJpY2UsXG4gICAgICBjb25maWRlbmNlLFxuICAgICAgZGlzdGFuY2UsXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KClcbiAgICB9KTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIEVtaXQgcmlzayB3YXJuaW5nIGV2ZW50XG4gICAqL1xuICBlbWl0Umlza1dhcm5pbmcoXG4gICAgdHlwZTogJ0RSQVdET1dOJyB8ICdDT1JSRUxBVElPTicgfCAnUE9SVEZPTElPX0hFQVQnIHwgJ0NPTlNFQ1VUSVZFX0xPU1NFUycsXG4gICAgc2V2ZXJpdHk6ICdXQVJOSU5HJyB8ICdDUklUSUNBTCcsXG4gICAgdmFsdWU6IG51bWJlcixcbiAgICB0aHJlc2hvbGQ6IG51bWJlcixcbiAgICBtZXNzYWdlOiBzdHJpbmdcbiAgKTogdm9pZCB7XG4gICAgdGhpcy5lbWl0RXZlbnQoJ1JJU0tfV0FSTklORycsIHtcbiAgICAgIHR5cGUsXG4gICAgICBzZXZlcml0eSxcbiAgICAgIHZhbHVlLFxuICAgICAgdGhyZXNob2xkLFxuICAgICAgbWVzc2FnZSxcbiAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKVxuICAgIH0pO1xuICB9XG4gIFxuICAvKipcbiAgICogR2V0IGV2ZW50IHN0YXRpc3RpY3NcbiAgICovXG4gIGdldEV2ZW50U3RhdHMoKTogUmVjb3JkPHN0cmluZywgbnVtYmVyPiB7XG4gICAgY29uc3Qgc3RhdHM6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7fTtcbiAgICBjb25zdCBldmVudHMgPSB0aGlzLmV2ZW50TmFtZXMoKTtcbiAgICBcbiAgICBmb3IgKGNvbnN0IGV2ZW50IG9mIGV2ZW50cykge1xuICAgICAgc3RhdHNbZXZlbnQudG9TdHJpbmcoKV0gPSB0aGlzLmxpc3RlbmVyQ291bnQoZXZlbnQpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gc3RhdHM7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBDbGVhciBhbGwgbGlzdGVuZXJzICh1c2VmdWwgZm9yIHRlc3RpbmcpXG4gICAqL1xuICBjbGVhckFsbExpc3RlbmVycygpOiB2b2lkIHtcbiAgICB0aGlzLnJlbW92ZUFsbExpc3RlbmVycygpO1xuICB9XG59XG5cbi8vIEV4cG9ydCBzaW5nbGV0b24gaW5zdGFuY2VcbmV4cG9ydCBjb25zdCBodW50ZXJFdmVudHMgPSBIdW50ZXJFdmVudEVtaXR0ZXIuZ2V0SW5zdGFuY2UoKTtcblxuLy8gRXhwb3J0IGV2ZW50IHR5cGVzIGZvciBleHRlcm5hbCB1c2VcbmV4cG9ydCB0eXBlIHtcbiAgRXZlbnRNYXAsXG4gIEhvbG9ncmFtVXBkYXRlZEV2ZW50LFxuICBTZXNzaW9uQ2hhbmdlRXZlbnQsXG4gIENWREFic29ycHRpb25FdmVudCxcbiAgQ1ZERGlzdHJpYnV0aW9uRXZlbnQsXG4gIFNpZ25hbEdlbmVyYXRlZEV2ZW50LFxuICBFeGVjdXRpb25Db21wbGV0ZUV2ZW50LFxuICBFcnJvckV2ZW50LFxuICBTY2FuQ29tcGxldGVFdmVudCxcbiAgSnVkYXNTd2luZ0V2ZW50LFxuICBQT0lEZXRlY3RlZEV2ZW50LFxuICBSaXNrV2FybmluZ0V2ZW50XG59OyJdLCJ2ZXJzaW9uIjozfQ==