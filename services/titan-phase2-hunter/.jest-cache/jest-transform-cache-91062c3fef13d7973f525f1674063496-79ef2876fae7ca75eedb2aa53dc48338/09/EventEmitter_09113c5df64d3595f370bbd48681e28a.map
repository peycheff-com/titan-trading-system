{"file":"/Users/ivan/Code/trading/titan/services/titan-phase2-hunter/src/events/EventEmitter.ts","mappings":"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","names":[],"sources":["/Users/ivan/Code/trading/titan/services/titan-phase2-hunter/src/events/EventEmitter.ts"],"sourcesContent":["/**\n * Event System for Titan Phase 2 - The Hunter\n * \n * Provides a centralized event-driven architecture for communication\n * between different components of the Hunter system.\n */\n\nimport { EventEmitter as NodeEventEmitter } from 'events';\nimport { \n  HologramState, \n  SessionState, \n  Absorption, \n  Distribution, \n  SignalData, \n  ExecutionData,\n  AsianRange,\n  JudasSwing\n} from '../types';\n\n// Event type definitions\nexport interface EventMap {\n  // Hologram events\n  HOLOGRAM_UPDATED: HologramUpdatedEvent;\n  \n  // Session events\n  SESSION_CHANGE: SessionChangeEvent;\n  \n  // CVD events\n  CVD_ABSORPTION: CVDAbsorptionEvent;\n  CVD_DISTRIBUTION: CVDDistributionEvent;\n  \n  // Signal events\n  SIGNAL_GENERATED: SignalGeneratedEvent;\n  \n  // Execution events\n  EXECUTION_COMPLETE: ExecutionCompleteEvent;\n  \n  // Error events\n  ERROR: ErrorEvent;\n  \n  // Additional system events\n  SCAN_COMPLETE: ScanCompleteEvent;\n  JUDAS_SWING_DETECTED: JudasSwingEvent;\n  POI_DETECTED: POIDetectedEvent;\n  RISK_WARNING: RiskWarningEvent;\n}\n\n// Event payload interfaces\nexport interface HologramUpdatedEvent {\n  symbol: string;\n  hologramState: HologramState;\n  previousStatus?: string;\n  timestamp: number;\n}\n\nexport interface SessionChangeEvent {\n  previousSession: SessionState;\n  currentSession: SessionState;\n  asianRange?: AsianRange;\n  timestamp: number;\n}\n\nexport interface CVDAbsorptionEvent {\n  symbol: string;\n  absorption: Absorption;\n  poiPrice: number;\n  confidence: number;\n  timestamp: number;\n}\n\nexport interface CVDDistributionEvent {\n  symbol: string;\n  distribution: Distribution;\n  poiPrice: number;\n  confidence: number;\n  timestamp: number;\n}\n\nexport interface SignalGeneratedEvent {\n  signal: SignalData;\n  hologramState: HologramState;\n  sessionState: SessionState;\n  cvdConfirmation: boolean;\n  timestamp: number;\n}\n\nexport interface ExecutionCompleteEvent {\n  execution: ExecutionData;\n  signal: SignalData;\n  success: boolean;\n  slippage: number;\n  timestamp: number;\n}\n\nexport interface ErrorEvent {\n  component: string;\n  error: Error;\n  context?: Record<string, any>;\n  severity: 'LOW' | 'MEDIUM' | 'HIGH' | 'CRITICAL';\n  timestamp: number;\n}\n\nexport interface ScanCompleteEvent {\n  symbolsScanned: number;\n  aPlus: number;\n  bAlignment: number;\n  conflicts: number;\n  duration: number;\n  timestamp: number;\n}\n\nexport interface JudasSwingEvent {\n  judasSwing: JudasSwing;\n  sessionType: 'LONDON' | 'NY';\n  asianRange: AsianRange;\n  timestamp: number;\n}\n\nexport interface POIDetectedEvent {\n  symbol: string;\n  poiType: 'FVG' | 'ORDER_BLOCK' | 'LIQUIDITY_POOL';\n  price: number;\n  confidence: number;\n  distance: number; // Distance from current price in %\n  timestamp: number;\n}\n\nexport interface RiskWarningEvent {\n  type: 'DRAWDOWN' | 'CORRELATION' | 'PORTFOLIO_HEAT' | 'CONSECUTIVE_LOSSES';\n  severity: 'WARNING' | 'CRITICAL';\n  value: number;\n  threshold: number;\n  message: string;\n  timestamp: number;\n}\n\n/**\n * Centralized Event Emitter for the Hunter system\n * \n * This class provides a type-safe event system that allows different\n * components to communicate without tight coupling.\n */\nexport class HunterEventEmitter extends NodeEventEmitter {\n  private static instance: HunterEventEmitter;\n  \n  constructor() {\n    super();\n    // Set max listeners to handle multiple subscribers\n    this.setMaxListeners(50);\n  }\n  \n  /**\n   * Get singleton instance\n   */\n  static getInstance(): HunterEventEmitter {\n    if (!HunterEventEmitter.instance) {\n      HunterEventEmitter.instance = new HunterEventEmitter();\n    }\n    return HunterEventEmitter.instance;\n  }\n  \n  /**\n   * Emit a typed event\n   */\n  emitEvent<K extends keyof EventMap>(event: K, payload: EventMap[K]): boolean {\n    return this.emit(event, payload);\n  }\n  \n  /**\n   * Subscribe to a typed event\n   */\n  onEvent<K extends keyof EventMap>(\n    event: K, \n    listener: (payload: EventMap[K]) => void\n  ): this {\n    return this.on(event, listener);\n  }\n  \n  /**\n   * Subscribe to a typed event (once)\n   */\n  onceEvent<K extends keyof EventMap>(\n    event: K, \n    listener: (payload: EventMap[K]) => void\n  ): this {\n    return this.once(event, listener);\n  }\n  \n  /**\n   * Unsubscribe from a typed event\n   */\n  offEvent<K extends keyof EventMap>(\n    event: K, \n    listener: (payload: EventMap[K]) => void\n  ): this {\n    return this.off(event, listener);\n  }\n  \n  // Convenience methods for common events\n  \n  /**\n   * Emit hologram updated event\n   */\n  emitHologramUpdated(symbol: string, hologramState: HologramState, previousStatus?: string): void {\n    this.emitEvent('HOLOGRAM_UPDATED', {\n      symbol,\n      hologramState,\n      previousStatus,\n      timestamp: Date.now()\n    });\n  }\n  \n  /**\n   * Emit session change event\n   */\n  emitSessionChange(previousSession: SessionState, currentSession: SessionState, asianRange?: AsianRange): void {\n    this.emitEvent('SESSION_CHANGE', {\n      previousSession,\n      currentSession,\n      asianRange,\n      timestamp: Date.now()\n    });\n  }\n  \n  /**\n   * Emit CVD absorption event\n   */\n  emitCVDAbsorption(symbol: string, absorption: Absorption, poiPrice: number, confidence: number): void {\n    this.emitEvent('CVD_ABSORPTION', {\n      symbol,\n      absorption,\n      poiPrice,\n      confidence,\n      timestamp: Date.now()\n    });\n  }\n  \n  /**\n   * Emit CVD distribution event\n   */\n  emitCVDDistribution(symbol: string, distribution: Distribution, poiPrice: number, confidence: number): void {\n    this.emitEvent('CVD_DISTRIBUTION', {\n      symbol,\n      distribution,\n      poiPrice,\n      confidence,\n      timestamp: Date.now()\n    });\n  }\n  \n  /**\n   * Emit signal generated event\n   */\n  emitSignalGenerated(\n    signal: SignalData, \n    hologramState: HologramState, \n    sessionState: SessionState, \n    cvdConfirmation: boolean\n  ): void {\n    this.emitEvent('SIGNAL_GENERATED', {\n      signal,\n      hologramState,\n      sessionState,\n      cvdConfirmation,\n      timestamp: Date.now()\n    });\n  }\n  \n  /**\n   * Emit execution complete event\n   */\n  emitExecutionComplete(\n    execution: ExecutionData, \n    signal: SignalData, \n    success: boolean, \n    slippage: number\n  ): void {\n    this.emitEvent('EXECUTION_COMPLETE', {\n      execution,\n      signal,\n      success,\n      slippage,\n      timestamp: Date.now()\n    });\n  }\n  \n  /**\n   * Emit error event\n   */\n  emitError(\n    component: string, \n    error: Error, \n    severity: 'LOW' | 'MEDIUM' | 'HIGH' | 'CRITICAL' = 'MEDIUM',\n    context?: Record<string, any>\n  ): void {\n    this.emitEvent('ERROR', {\n      component,\n      error,\n      context,\n      severity,\n      timestamp: Date.now()\n    });\n  }\n  \n  /**\n   * Emit scan complete event\n   */\n  emitScanComplete(\n    symbolsScanned: number, \n    aPlus: number, \n    bAlignment: number, \n    conflicts: number, \n    duration: number\n  ): void {\n    this.emitEvent('SCAN_COMPLETE', {\n      symbolsScanned,\n      aPlus,\n      bAlignment,\n      conflicts,\n      duration,\n      timestamp: Date.now()\n    });\n  }\n  \n  /**\n   * Emit Judas swing detected event\n   */\n  emitJudasSwing(judasSwing: JudasSwing, sessionType: 'LONDON' | 'NY', asianRange: AsianRange): void {\n    this.emitEvent('JUDAS_SWING_DETECTED', {\n      judasSwing,\n      sessionType,\n      asianRange,\n      timestamp: Date.now()\n    });\n  }\n  \n  /**\n   * Emit POI detected event\n   */\n  emitPOIDetected(\n    symbol: string, \n    poiType: 'FVG' | 'ORDER_BLOCK' | 'LIQUIDITY_POOL', \n    price: number, \n    confidence: number, \n    distance: number\n  ): void {\n    this.emitEvent('POI_DETECTED', {\n      symbol,\n      poiType,\n      price,\n      confidence,\n      distance,\n      timestamp: Date.now()\n    });\n  }\n  \n  /**\n   * Emit risk warning event\n   */\n  emitRiskWarning(\n    type: 'DRAWDOWN' | 'CORRELATION' | 'PORTFOLIO_HEAT' | 'CONSECUTIVE_LOSSES',\n    severity: 'WARNING' | 'CRITICAL',\n    value: number,\n    threshold: number,\n    message: string\n  ): void {\n    this.emitEvent('RISK_WARNING', {\n      type,\n      severity,\n      value,\n      threshold,\n      message,\n      timestamp: Date.now()\n    });\n  }\n  \n  /**\n   * Get event statistics\n   */\n  getEventStats(): Record<string, number> {\n    const stats: Record<string, number> = {};\n    const events = this.eventNames();\n    \n    for (const event of events) {\n      stats[event.toString()] = this.listenerCount(event);\n    }\n    \n    return stats;\n  }\n  \n  /**\n   * Clear all listeners (useful for testing)\n   */\n  clearAllListeners(): void {\n    this.removeAllListeners();\n  }\n}\n\n// Export singleton instance\nexport const hunterEvents = HunterEventEmitter.getInstance();\n\n// Export event types for external use\nexport type {\n  EventMap,\n  HologramUpdatedEvent,\n  SessionChangeEvent,\n  CVDAbsorptionEvent,\n  CVDDistributionEvent,\n  SignalGeneratedEvent,\n  ExecutionCompleteEvent,\n  ErrorEvent,\n  ScanCompleteEvent,\n  JudasSwingEvent,\n  POIDetectedEvent,\n  RiskWarningEvent\n};"],"version":3}