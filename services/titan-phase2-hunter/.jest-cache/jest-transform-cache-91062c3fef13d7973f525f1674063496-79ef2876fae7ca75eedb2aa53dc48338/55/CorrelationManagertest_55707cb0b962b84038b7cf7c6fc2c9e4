32d90c3d1df2d4e5b3b1829e6c26f184
"use strict";
/**
 * Unit Tests for CorrelationManager
 *
 * Tests correlation calculations, position limits, and high beta detection
 */
Object.defineProperty(exports, "__esModule", { value: true });
const CorrelationManager_1 = require("../../src/risk/CorrelationManager");
// Mock BybitPerpsClient
const mockBybitClient = {
    fetchOHLCV: jest.fn()
};
describe('CorrelationManager', () => {
    let correlationManager;
    let config;
    beforeEach(() => {
        config = {
            correlationThreshold: 0.7,
            rejectThreshold: 0.85,
            groupCorrelationThreshold: 0.5,
            maxCorrelatedExposure: 0.4,
            highBetaThreshold: 0.9,
            highBetaReduction: 0.3,
            rollingWindowHours: 24,
            updateIntervalMs: 300000
        };
        correlationManager = new CorrelationManager_1.CorrelationManager(mockBybitClient, config);
        jest.clearAllMocks();
    });
    afterEach(() => {
        correlationManager.destroy();
    });
    describe('calcCorrelation', () => {
        it('should calculate correlation between two symbols', async () => {
            // Mock price data - perfectly correlated (both go up)
            const priceData1 = Array.from({ length: 24 }, (_, i) => ({
                timestamp: Date.now() - (23 - i) * 60 * 60 * 1000,
                open: 100 + i,
                high: 105 + i,
                low: 95 + i,
                close: 100 + i,
                volume: 1000
            }));
            const priceData2 = Array.from({ length: 24 }, (_, i) => ({
                timestamp: Date.now() - (23 - i) * 60 * 60 * 1000,
                open: 200 + i * 2,
                high: 210 + i * 2,
                low: 190 + i * 2,
                close: 200 + i * 2,
                volume: 1000
            }));
            mockBybitClient.fetchOHLCV
                .mockResolvedValueOnce(priceData1)
                .mockResolvedValueOnce(priceData2);
            const correlation = await correlationManager.calcCorrelation('BTCUSDT', 'ETHUSDT');
            expect(correlation).toBeGreaterThan(0.9); // Should be highly correlated
            expect(mockBybitClient.fetchOHLCV).toHaveBeenCalledTimes(2);
        });
        it('should return 0 for insufficient data', async () => {
            // Mock insufficient data
            const shortData = Array.from({ length: 5 }, (_, i) => ({
                timestamp: Date.now() - i * 60 * 60 * 1000,
                open: 100,
                high: 105,
                low: 95,
                close: 100,
                volume: 1000
            }));
            mockBybitClient.fetchOHLCV
                .mockResolvedValueOnce(shortData)
                .mockResolvedValueOnce(shortData);
            const correlation = await correlationManager.calcCorrelation('BTCUSDT', 'ETHUSDT');
            expect(correlation).toBe(0);
        });
        it('should handle API errors gracefully', async () => {
            mockBybitClient.fetchOHLCV.mockRejectedValue(new Error('API Error'));
            const correlation = await correlationManager.calcCorrelation('BTCUSDT', 'ETHUSDT');
            expect(correlation).toBe(0);
        });
    });
    describe('checkCorrelationLimit', () => {
        const mockPositions = [
            {
                id: 'pos1',
                symbol: 'ETHUSDT',
                side: 'LONG',
                entryPrice: 2000,
                currentPrice: 2100,
                quantity: 1,
                leverage: 3,
                stopLoss: 1900,
                takeProfit: 2300,
                unrealizedPnL: 100,
                realizedPnL: 0,
                entryTime: Date.now() - 60000,
                status: 'OPEN',
                rValue: 1.5,
                atr: 50
            }
        ];
        it('should reject signal when correlation exceeds reject threshold', async () => {
            // Mock high correlation (0.9)
            jest.spyOn(correlationManager, 'calcCorrelation').mockResolvedValue(0.9);
            const result = await correlationManager.checkCorrelationLimit('BTCUSDT', mockPositions, 1000);
            expect(result.allowed).toBe(false);
            expect(result.reason).toContain('CORRELATION_REJECT');
            expect(result.correlation).toBe(0.9);
        });
        it('should reduce position size when correlation exceeds threshold', async () => {
            // Mock medium correlation (0.75)
            jest.spyOn(correlationManager, 'calcCorrelation').mockResolvedValue(0.75);
            const result = await correlationManager.checkCorrelationLimit('BTCUSDT', mockPositions, 1000);
            expect(result.allowed).toBe(true);
            expect(result.adjustedSize).toBe(500); // 50% reduction
            expect(result.reason).toContain('CORRELATION_REDUCE');
            expect(result.correlation).toBe(0.75);
        });
        it('should allow position when correlation is below threshold', async () => {
            // Mock low correlation (0.3)
            jest.spyOn(correlationManager, 'calcCorrelation').mockResolvedValue(0.3);
            const result = await correlationManager.checkCorrelationLimit('BTCUSDT', mockPositions, 1000);
            expect(result.allowed).toBe(true);
            expect(result.adjustedSize).toBeUndefined();
            expect(result.correlation).toBe(0.3);
        });
        it('should handle empty positions array', async () => {
            const result = await correlationManager.checkCorrelationLimit('BTCUSDT', [], 1000);
            expect(result.allowed).toBe(true);
            expect(result.correlation).toBe(0);
        });
    });
    describe('calcTotalCorrelatedExposure', () => {
        const mockPositions = [
            {
                id: 'pos1',
                symbol: 'BTCUSDT',
                side: 'LONG',
                entryPrice: 50000,
                currentPrice: 51000,
                quantity: 0.1,
                leverage: 3,
                stopLoss: 49000,
                takeProfit: 53000,
                unrealizedPnL: 100,
                realizedPnL: 0,
                entryTime: Date.now(),
                status: 'OPEN',
                rValue: 1.0,
                atr: 1000
            },
            {
                id: 'pos2',
                symbol: 'ETHUSDT',
                side: 'LONG',
                entryPrice: 3000,
                currentPrice: 3100,
                quantity: 1,
                leverage: 3,
                stopLoss: 2900,
                takeProfit: 3300,
                unrealizedPnL: 100,
                realizedPnL: 0,
                entryTime: Date.now(),
                status: 'OPEN',
                rValue: 1.0,
                atr: 100
            }
        ];
        it('should calculate total correlated exposure', async () => {
            // Mock correlation matrix with high correlation
            jest.spyOn(correlationManager, 'generateCorrelationMatrix').mockResolvedValue({
                symbols: ['BTCUSDT', 'ETHUSDT'],
                matrix: [
                    [1.0, 0.8],
                    [0.8, 1.0]
                ],
                timestamp: Date.now()
            });
            const totalEquity = 10000;
            const exposure = await correlationManager.calcTotalCorrelatedExposure(mockPositions, totalEquity);
            expect(exposure).toBeGreaterThan(0);
            // Exposure can be > 1 due to leverage, so just check it's a reasonable number
            expect(exposure).toBeLessThan(10); // Should be less than 10x equity
        });
        it('should return 0 for single position', async () => {
            const singlePosition = [mockPositions[0]];
            const exposure = await correlationManager.calcTotalCorrelatedExposure(singlePosition, 10000);
            expect(exposure).toBe(0);
        });
        it('should handle empty positions array', async () => {
            const exposure = await correlationManager.calcTotalCorrelatedExposure([], 10000);
            expect(exposure).toBe(0);
        });
    });
    describe('detectHighBeta', () => {
        it('should detect high beta market conditions', async () => {
            const topSymbols = ['ETHUSDT', 'ADAUSDT', 'DOTUSDT', 'LINKUSDT'];
            // Mock high BTC correlation for all symbols
            jest.spyOn(correlationManager, 'calcCorrelation').mockResolvedValue(0.95);
            const highBetaState = await correlationManager.detectHighBeta(topSymbols);
            expect(highBetaState.isHighBeta).toBe(true);
            expect(highBetaState.btcCorrelation).toBeGreaterThanOrEqual(0.9);
            expect(highBetaState.affectedSymbols).toHaveLength(4);
        });
        it('should detect normal market conditions', async () => {
            const topSymbols = ['ETHUSDT', 'ADAUSDT', 'DOTUSDT', 'LINKUSDT'];
            // Mock low BTC correlation
            jest.spyOn(correlationManager, 'calcCorrelation').mockResolvedValue(0.3);
            const highBetaState = await correlationManager.detectHighBeta(topSymbols);
            expect(highBetaState.isHighBeta).toBe(false);
            expect(highBetaState.btcCorrelation).toBeLessThan(0.9);
            expect(highBetaState.affectedSymbols).toHaveLength(0);
        });
        it('should handle empty symbols array', async () => {
            const highBetaState = await correlationManager.detectHighBeta([]);
            expect(highBetaState.isHighBeta).toBe(false);
            expect(highBetaState.btcCorrelation).toBe(0);
            expect(highBetaState.affectedSymbols).toHaveLength(0);
        });
    });
    describe('generateCorrelationMatrix', () => {
        it('should generate correlation matrix for given symbols', async () => {
            const symbols = ['BTCUSDT', 'ETHUSDT', 'ADAUSDT'];
            // Mock correlation calculations
            jest.spyOn(correlationManager, 'calcCorrelation')
                .mockResolvedValueOnce(0.8) // BTC-ETH
                .mockResolvedValueOnce(0.6) // BTC-ADA
                .mockResolvedValueOnce(0.7); // ETH-ADA
            const matrix = await correlationManager.generateCorrelationMatrix(symbols);
            expect(matrix.symbols).toEqual(symbols);
            expect(matrix.matrix).toHaveLength(3);
            expect(matrix.matrix[0]).toHaveLength(3);
            // Check diagonal is 1.0 (perfect self-correlation)
            expect(matrix.matrix[0][0]).toBe(1.0);
            expect(matrix.matrix[1][1]).toBe(1.0);
            expect(matrix.matrix[2][2]).toBe(1.0);
            // Check symmetry
            expect(matrix.matrix[0][1]).toBe(matrix.matrix[1][0]);
            expect(matrix.matrix[0][2]).toBe(matrix.matrix[2][0]);
            expect(matrix.matrix[1][2]).toBe(matrix.matrix[2][1]);
        });
        it('should handle empty symbols array', async () => {
            const matrix = await correlationManager.generateCorrelationMatrix([]);
            expect(matrix.symbols).toEqual([]);
            expect(matrix.matrix).toEqual([]);
        });
        it('should handle single symbol', async () => {
            const symbols = ['BTCUSDT'];
            const matrix = await correlationManager.generateCorrelationMatrix(symbols);
            expect(matrix.symbols).toEqual(symbols);
            expect(matrix.matrix).toEqual([[1.0]]);
        });
    });
    describe('Configuration and Statistics', () => {
        it('should update configuration', () => {
            const newConfig = { correlationThreshold: 0.8 };
            correlationManager.updateConfig(newConfig);
            // Configuration should be updated (tested through behavior)
            expect(true).toBe(true); // Placeholder assertion
        });
        it('should return statistics', () => {
            const stats = correlationManager.getStatistics();
            expect(stats).toHaveProperty('cachedPairs');
            expect(stats).toHaveProperty('cachedSymbols');
            expect(stats).toHaveProperty('highBetaActive');
            expect(stats).toHaveProperty('avgBtcCorrelation');
            expect(typeof stats.cachedPairs).toBe('number');
            expect(typeof stats.cachedSymbols).toBe('number');
            expect(typeof stats.highBetaActive).toBe('boolean');
            expect(typeof stats.avgBtcCorrelation).toBe('number');
        });
        it('should clear cache', () => {
            correlationManager.clearCache();
            const stats = correlationManager.getStatistics();
            expect(stats.cachedPairs).toBe(0);
            expect(stats.cachedSymbols).toBe(0);
            expect(stats.highBetaActive).toBe(false);
        });
    });
    describe('Event Emission', () => {
        it('should emit correlation:updated event', async () => {
            const eventSpy = jest.fn();
            correlationManager.on('correlation:updated', eventSpy);
            await correlationManager.generateCorrelationMatrix(['BTCUSDT', 'ETHUSDT']);
            expect(eventSpy).toHaveBeenCalledWith(expect.objectContaining({
                symbols: ['BTCUSDT', 'ETHUSDT'],
                matrix: expect.any(Array),
                timestamp: expect.any(Number)
            }));
        });
        it('should emit correlation:high_beta event', async () => {
            const eventSpy = jest.fn();
            correlationManager.on('correlation:high_beta', eventSpy);
            // Mock high correlation to trigger high beta
            jest.spyOn(correlationManager, 'calcCorrelation').mockResolvedValue(0.95);
            await correlationManager.detectHighBeta(['ETHUSDT']);
            expect(eventSpy).toHaveBeenCalledWith(expect.objectContaining({
                isHighBeta: true,
                btcCorrelation: expect.any(Number),
                affectedSymbols: expect.any(Array),
                timestamp: expect.any(Number)
            }));
        });
        it('should emit correlation:reject event', async () => {
            const eventSpy = jest.fn();
            correlationManager.on('correlation:reject', eventSpy);
            const mockPositions = [{
                    id: 'pos1',
                    symbol: 'ETHUSDT',
                    side: 'LONG',
                    entryPrice: 2000,
                    currentPrice: 2100,
                    quantity: 1,
                    leverage: 3,
                    stopLoss: 1900,
                    takeProfit: 2300,
                    unrealizedPnL: 100,
                    realizedPnL: 0,
                    entryTime: Date.now(),
                    status: 'OPEN',
                    rValue: 1.0,
                    atr: 50
                }];
            // Mock high correlation to trigger rejection
            jest.spyOn(correlationManager, 'calcCorrelation').mockResolvedValue(0.9);
            await correlationManager.checkCorrelationLimit('BTCUSDT', mockPositions, 1000);
            expect(eventSpy).toHaveBeenCalledWith('BTCUSDT', 0.9, 'ETHUSDT');
        });
    });
    describe('Monitoring Lifecycle', () => {
        it('should start and stop monitoring', () => {
            // Monitoring should start automatically in constructor
            expect(true).toBe(true); // Placeholder - monitoring is internal
            correlationManager.stopMonitoring();
            correlationManager.startMonitoring = jest.fn();
            // Should be able to restart
            expect(true).toBe(true); // Placeholder
        });
        it('should cleanup resources on destroy', () => {
            const stopSpy = jest.spyOn(correlationManager, 'stopMonitoring');
            const clearSpy = jest.spyOn(correlationManager, 'clearCache');
            correlationManager.destroy();
            expect(stopSpy).toHaveBeenCalled();
            expect(clearSpy).toHaveBeenCalled();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2l2YW4vQ29kZS90cmFkaW5nL3RpdGFuL3NlcnZpY2VzL3RpdGFuLXBoYXNlMi1odW50ZXIvdGVzdHMvdW5pdC9Db3JyZWxhdGlvbk1hbmFnZXIudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7R0FJRzs7QUFFSCwwRUFBaUc7QUFHakcsd0JBQXdCO0FBQ3hCLE1BQU0sZUFBZSxHQUFHO0lBQ3RCLFVBQVUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0NBQ3RCLENBQUM7QUFFRixRQUFRLENBQUMsb0JBQW9CLEVBQUUsR0FBRyxFQUFFO0lBQ2xDLElBQUksa0JBQXNDLENBQUM7SUFDM0MsSUFBSSxNQUFnQyxDQUFDO0lBRXJDLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxNQUFNLEdBQUc7WUFDUCxvQkFBb0IsRUFBRSxHQUFHO1lBQ3pCLGVBQWUsRUFBRSxJQUFJO1lBQ3JCLHlCQUF5QixFQUFFLEdBQUc7WUFDOUIscUJBQXFCLEVBQUUsR0FBRztZQUMxQixpQkFBaUIsRUFBRSxHQUFHO1lBQ3RCLGlCQUFpQixFQUFFLEdBQUc7WUFDdEIsa0JBQWtCLEVBQUUsRUFBRTtZQUN0QixnQkFBZ0IsRUFBRSxNQUFNO1NBQ3pCLENBQUM7UUFFRixrQkFBa0IsR0FBRyxJQUFJLHVDQUFrQixDQUFDLGVBQXNCLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDNUUsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBQ3ZCLENBQUMsQ0FBQyxDQUFDO0lBRUgsU0FBUyxDQUFDLEdBQUcsRUFBRTtRQUNiLGtCQUFrQixDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQy9CLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGlCQUFpQixFQUFFLEdBQUcsRUFBRTtRQUMvQixFQUFFLENBQUMsa0RBQWtELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDaEUsc0RBQXNEO1lBQ3RELE1BQU0sVUFBVSxHQUFZLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FB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QUUsQ0FBQyxxQ0FBcUMsRUFBRSxHQUFHLEVBQUU7WUFDN0MsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxrQkFBa0IsRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDO1lBQ2pFLE1BQU0sUUFBUSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsa0JBQWtCLEVBQUUsWUFBWSxDQUFDLENBQUM7WUFFOUQsa0JBQWtCLENBQUMsT0FBTyxFQUFFLENBQUM7WUFFN0IsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLGdCQUFnQixFQUFFLENBQUM7WUFDbkMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLGdCQUFnQixFQUFFLENBQUM7UUFDdEMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9pdmFuL0NvZGUvdHJhZGluZy90aXRhbi9zZXJ2aWNlcy90aXRhbi1waGFzZTItaHVudGVyL3Rlc3RzL3VuaXQvQ29ycmVsYXRpb25NYW5hZ2VyLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBVbml0IFRlc3RzIGZvciBDb3JyZWxhdGlvbk1hbmFnZXJcbiAqIFxuICogVGVzdHMgY29ycmVsYXRpb24gY2FsY3VsYXRpb25zLCBwb3NpdGlvbiBsaW1pdHMsIGFuZCBoaWdoIGJldGEgZGV0ZWN0aW9uXG4gKi9cblxuaW1wb3J0IHsgQ29ycmVsYXRpb25NYW5hZ2VyLCBDb3JyZWxhdGlvbk1hbmFnZXJDb25maWcgfSBmcm9tICcuLi8uLi9zcmMvcmlzay9Db3JyZWxhdGlvbk1hbmFnZXInO1xuaW1wb3J0IHsgUG9zaXRpb24sIE9ITENWIH0gZnJvbSAnLi4vLi4vc3JjL3R5cGVzJztcblxuLy8gTW9jayBCeWJpdFBlcnBzQ2xpZW50XG5jb25zdCBtb2NrQnliaXRDbGllbnQgPSB7XG4gIGZldGNoT0hMQ1Y6IGplc3QuZm4oKVxufTtcblxuZGVzY3JpYmUoJ0NvcnJlbGF0aW9uTWFuYWdlcicsICgpID0+IHtcbiAgbGV0IGNvcnJlbGF0aW9uTWFuYWdlcjogQ29ycmVsYXRpb25NYW5hZ2VyO1xuICBsZXQgY29uZmlnOiBDb3JyZWxhdGlvbk1hbmFnZXJDb25maWc7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgY29uZmlnID0ge1xuICAgICAgY29ycmVsYXRpb25UaHJlc2hvbGQ6IDAuNyxcbiAgICAgIHJlamVjdFRocmVzaG9sZDogMC44NSxcbiAgICAgIGdyb3VwQ29ycmVsYXRpb25UaHJlc2hvbGQ6IDAuNSxcbiAgICAgIG1heENvcnJlbGF0ZWRFeHBvc3VyZTogMC40LFxuICAgICAgaGlnaEJldGFUaHJlc2hvbGQ6IDAuOSxcbiAgICAgIGhpZ2hCZXRhUmVkdWN0aW9uOiAwLjMsXG4gICAgICByb2xsaW5nV2luZG93SG91cnM6IDI0LFxuICAgICAgdXBkYXRlSW50ZXJ2YWxNczogMzAwMDAwXG4gICAgfTtcblxuICAgIGNvcnJlbGF0aW9uTWFuYWdlciA9IG5ldyBDb3JyZWxhdGlvbk1hbmFnZXIobW9ja0J5Yml0Q2xpZW50IGFzIGFueSwgY29uZmlnKTtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBjb3JyZWxhdGlvbk1hbmFnZXIuZGVzdHJveSgpO1xuICB9KTtcblxuICBkZXNjcmliZSgnY2FsY0NvcnJlbGF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIGNvcnJlbGF0aW9uIGJldHdlZW4gdHdvIHN5bWJvbHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIHByaWNlIGRhdGEgLSBwZXJmZWN0bHkgY29ycmVsYXRlZCAoYm90aCBnbyB1cClcbiAgICAgIGNvbnN0IHByaWNlRGF0YTE6IE9ITENWW10gPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiAyNCB9LCAoXywgaSkgPT4gKHtcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpIC0gKDIzIC0gaSkgKiA2MCAqIDYwICogMTAwMCxcbiAgICAgICAgb3BlbjogMTAwICsgaSxcbiAgICAgICAgaGlnaDogMTA1ICsgaSxcbiAgICAgICAgbG93OiA5NSArIGksXG4gICAgICAgIGNsb3NlOiAxMDAgKyBpLFxuICAgICAgICB2b2x1bWU6IDEwMDBcbiAgICAgIH0pKTtcblxuICAgICAgY29uc3QgcHJpY2VEYXRhMjogT0hMQ1ZbXSA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDI0IH0sIChfLCBpKSA9PiAoe1xuICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCkgLSAoMjMgLSBpKSAqIDYwICogNjAgKiAxMDAwLFxuICAgICAgICBvcGVuOiAyMDAgKyBpICogMixcbiAgICAgICAgaGlnaDogMjEwICsgaSAqIDIsXG4gICAgICAgIGxvdzogMTkwICsgaSAqIDIsXG4gICAgICAgIGNsb3NlOiAyMDAgKyBpICogMixcbiAgICAgICAgdm9sdW1lOiAxMDAwXG4gICAgICB9KSk7XG5cbiAgICAgIG1vY2tCeWJpdENsaWVudC5mZXRjaE9ITENWXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2UocHJpY2VEYXRhMSlcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZShwcmljZURhdGEyKTtcblxuICAgICAgY29uc3QgY29ycmVsYXRpb24gPSBhd2FpdCBjb3JyZWxhdGlvbk1hbmFnZXIuY2FsY0NvcnJlbGF0aW9uKCdCVENVU0RUJywgJ0VUSFVTRFQnKTtcblxuICAgICAgZXhwZWN0KGNvcnJlbGF0aW9uKS50b0JlR3JlYXRlclRoYW4oMC45KTsgLy8gU2hvdWxkIGJlIGhpZ2hseSBjb3JyZWxhdGVkXG4gICAgICBleHBlY3QobW9ja0J5Yml0Q2xpZW50LmZldGNoT0hMQ1YpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIDAgZm9yIGluc3VmZmljaWVudCBkYXRhJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBpbnN1ZmZpY2llbnQgZGF0YVxuICAgICAgY29uc3Qgc2hvcnREYXRhOiBPSExDVltdID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogNSB9LCAoXywgaSkgPT4gKHtcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpIC0gaSAqIDYwICogNjAgKiAxMDAwLFxuICAgICAgICBvcGVuOiAxMDAsXG4gICAgICAgIGhpZ2g6IDEwNSxcbiAgICAgICAgbG93OiA5NSxcbiAgICAgICAgY2xvc2U6IDEwMCxcbiAgICAgICAgdm9sdW1lOiAxMDAwXG4gICAgICB9KSk7XG5cbiAgICAgIG1vY2tCeWJpdENsaWVudC5mZXRjaE9ITENWXG4gICAgICAgIC5tb2NrUmVzb2x2ZWRWYWx1ZU9uY2Uoc2hvcnREYXRhKVxuICAgICAgICAubW9ja1Jlc29sdmVkVmFsdWVPbmNlKHNob3J0RGF0YSk7XG5cbiAgICAgIGNvbnN0IGNvcnJlbGF0aW9uID0gYXdhaXQgY29ycmVsYXRpb25NYW5hZ2VyLmNhbGNDb3JyZWxhdGlvbignQlRDVVNEVCcsICdFVEhVU0RUJyk7XG5cbiAgICAgIGV4cGVjdChjb3JyZWxhdGlvbikudG9CZSgwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIEFQSSBlcnJvcnMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIG1vY2tCeWJpdENsaWVudC5mZXRjaE9ITENWLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignQVBJIEVycm9yJykpO1xuXG4gICAgICBjb25zdCBjb3JyZWxhdGlvbiA9IGF3YWl0IGNvcnJlbGF0aW9uTWFuYWdlci5jYWxjQ29ycmVsYXRpb24oJ0JUQ1VTRFQnLCAnRVRIVVNEVCcpO1xuXG4gICAgICBleHBlY3QoY29ycmVsYXRpb24pLnRvQmUoMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjaGVja0NvcnJlbGF0aW9uTGltaXQnLCAoKSA9PiB7XG4gICAgY29uc3QgbW9ja1Bvc2l0aW9uczogUG9zaXRpb25bXSA9IFtcbiAgICAgIHtcbiAgICAgICAgaWQ6ICdwb3MxJyxcbiAgICAgICAgc3ltYm9sOiAnRVRIVVNEVCcsXG4gICAgICAgIHNpZGU6ICdMT05HJyxcbiAgICAgICAgZW50cnlQcmljZTogMjAwMCxcbiAgICAgICAgY3VycmVudFByaWNlOiAyMTAwLFxuICAgICAgICBxdWFudGl0eTogMSxcbiAgICAgICAgbGV2ZXJhZ2U6IDMsXG4gICAgICAgIHN0b3BMb3NzOiAxOTAwLFxuICAgICAgICB0YWtlUHJvZml0OiAyMzAwLFxuICAgICAgICB1bnJlYWxpemVkUG5MOiAxMDAsXG4gICAgICAgIHJlYWxpemVkUG5MOiAwLFxuICAgICAgICBlbnRyeVRpbWU6IERhdGUubm93KCkgLSA2MDAwMCxcbiAgICAgICAgc3RhdHVzOiAnT1BFTicsXG4gICAgICAgIHJWYWx1ZTogMS41LFxuICAgICAgICBhdHI6IDUwXG4gICAgICB9XG4gICAgXTtcblxuICAgIGl0KCdzaG91bGQgcmVqZWN0IHNpZ25hbCB3aGVuIGNvcnJlbGF0aW9uIGV4Y2VlZHMgcmVqZWN0IHRocmVzaG9sZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgaGlnaCBjb3JyZWxhdGlvbiAoMC45KVxuICAgICAgamVzdC5zcHlPbihjb3JyZWxhdGlvbk1hbmFnZXIsICdjYWxjQ29ycmVsYXRpb24nKS5tb2NrUmVzb2x2ZWRWYWx1ZSgwLjkpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb3JyZWxhdGlvbk1hbmFnZXIuY2hlY2tDb3JyZWxhdGlvbkxpbWl0KCdCVENVU0RUJywgbW9ja1Bvc2l0aW9ucywgMTAwMCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuYWxsb3dlZCkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0LnJlYXNvbikudG9Db250YWluKCdDT1JSRUxBVElPTl9SRUpFQ1QnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuY29ycmVsYXRpb24pLnRvQmUoMC45KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVkdWNlIHBvc2l0aW9uIHNpemUgd2hlbiBjb3JyZWxhdGlvbiBleGNlZWRzIHRocmVzaG9sZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIE1vY2sgbWVkaXVtIGNvcnJlbGF0aW9uICgwLjc1KVxuICAgICAgamVzdC5zcHlPbihjb3JyZWxhdGlvbk1hbmFnZXIsICdjYWxjQ29ycmVsYXRpb24nKS5tb2NrUmVzb2x2ZWRWYWx1ZSgwLjc1KTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29ycmVsYXRpb25NYW5hZ2VyLmNoZWNrQ29ycmVsYXRpb25MaW1pdCgnQlRDVVNEVCcsIG1vY2tQb3NpdGlvbnMsIDEwMDApO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmFsbG93ZWQpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmFkanVzdGVkU2l6ZSkudG9CZSg1MDApOyAvLyA1MCUgcmVkdWN0aW9uXG4gICAgICBleHBlY3QocmVzdWx0LnJlYXNvbikudG9Db250YWluKCdDT1JSRUxBVElPTl9SRURVQ0UnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuY29ycmVsYXRpb24pLnRvQmUoMC43NSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGFsbG93IHBvc2l0aW9uIHdoZW4gY29ycmVsYXRpb24gaXMgYmVsb3cgdGhyZXNob2xkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTW9jayBsb3cgY29ycmVsYXRpb24gKDAuMylcbiAgICAgIGplc3Quc3B5T24oY29ycmVsYXRpb25NYW5hZ2VyLCAnY2FsY0NvcnJlbGF0aW9uJykubW9ja1Jlc29sdmVkVmFsdWUoMC4zKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29ycmVsYXRpb25NYW5hZ2VyLmNoZWNrQ29ycmVsYXRpb25MaW1pdCgnQlRDVVNEVCcsIG1vY2tQb3NpdGlvbnMsIDEwMDApO1xuXG4gICAgICBleHBlY3QocmVzdWx0LmFsbG93ZWQpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmFkanVzdGVkU2l6ZSkudG9CZVVuZGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5jb3JyZWxhdGlvbikudG9CZSgwLjMpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgcG9zaXRpb25zIGFycmF5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29ycmVsYXRpb25NYW5hZ2VyLmNoZWNrQ29ycmVsYXRpb25MaW1pdCgnQlRDVVNEVCcsIFtdLCAxMDAwKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5hbGxvd2VkKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5jb3JyZWxhdGlvbikudG9CZSgwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2NhbGNUb3RhbENvcnJlbGF0ZWRFeHBvc3VyZScsICgpID0+IHtcbiAgICBjb25zdCBtb2NrUG9zaXRpb25zOiBQb3NpdGlvbltdID0gW1xuICAgICAge1xuICAgICAgICBpZDogJ3BvczEnLFxuICAgICAgICBzeW1ib2w6ICdCVENVU0RUJyxcbiAgICAgICAgc2lkZTogJ0xPTkcnLFxuICAgICAgICBlbnRyeVByaWNlOiA1MDAwMCxcbiAgICAgICAgY3VycmVudFByaWNlOiA1MTAwMCxcbiAgICAgICAgcXVhbnRpdHk6IDAuMSxcbiAgICAgICAgbGV2ZXJhZ2U6IDMsXG4gICAgICAgIHN0b3BMb3NzOiA0OTAwMCxcbiAgICAgICAgdGFrZVByb2ZpdDogNTMwMDAsXG4gICAgICAgIHVucmVhbGl6ZWRQbkw6IDEwMCxcbiAgICAgICAgcmVhbGl6ZWRQbkw6IDAsXG4gICAgICAgIGVudHJ5VGltZTogRGF0ZS5ub3coKSxcbiAgICAgICAgc3RhdHVzOiAnT1BFTicsXG4gICAgICAgIHJWYWx1ZTogMS4wLFxuICAgICAgICBhdHI6IDEwMDBcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGlkOiAncG9zMicsXG4gICAgICAgIHN5bWJvbDogJ0VUSFVTRFQnLFxuICAgICAgICBzaWRlOiAnTE9ORycsXG4gICAgICAgIGVudHJ5UHJpY2U6IDMwMDAsXG4gICAgICAgIGN1cnJlbnRQcmljZTogMzEwMCxcbiAgICAgICAgcXVhbnRpdHk6IDEsXG4gICAgICAgIGxldmVyYWdlOiAzLFxuICAgICAgICBzdG9wTG9zczogMjkwMCxcbiAgICAgICAgdGFrZVByb2ZpdDogMzMwMCxcbiAgICAgICAgdW5yZWFsaXplZFBuTDogMTAwLFxuICAgICAgICByZWFsaXplZFBuTDogMCxcbiAgICAgICAgZW50cnlUaW1lOiBEYXRlLm5vdygpLFxuICAgICAgICBzdGF0dXM6ICdPUEVOJyxcbiAgICAgICAgclZhbHVlOiAxLjAsXG4gICAgICAgIGF0cjogMTAwXG4gICAgICB9XG4gICAgXTtcblxuICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIHRvdGFsIGNvcnJlbGF0ZWQgZXhwb3N1cmUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBNb2NrIGNvcnJlbGF0aW9uIG1hdHJpeCB3aXRoIGhpZ2ggY29ycmVsYXRpb25cbiAgICAgIGplc3Quc3B5T24oY29ycmVsYXRpb25NYW5hZ2VyLCAnZ2VuZXJhdGVDb3JyZWxhdGlvbk1hdHJpeCcpLm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgc3ltYm9sczogWydCVENVU0RUJywgJ0VUSFVTRFQnXSxcbiAgICAgICAgbWF0cml4OiBbXG4gICAgICAgICAgWzEuMCwgMC44XSxcbiAgICAgICAgICBbMC44LCAxLjBdXG4gICAgICAgIF0sXG4gICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKVxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHRvdGFsRXF1aXR5ID0gMTAwMDA7XG4gICAgICBjb25zdCBleHBvc3VyZSA9IGF3YWl0IGNvcnJlbGF0aW9uTWFuYWdlci5jYWxjVG90YWxDb3JyZWxhdGVkRXhwb3N1cmUobW9ja1Bvc2l0aW9ucywgdG90YWxFcXVpdHkpO1xuXG4gICAgICBleHBlY3QoZXhwb3N1cmUpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgIC8vIEV4cG9zdXJlIGNhbiBiZSA+IDEgZHVlIHRvIGxldmVyYWdlLCBzbyBqdXN0IGNoZWNrIGl0J3MgYSByZWFzb25hYmxlIG51bWJlclxuICAgICAgZXhwZWN0KGV4cG9zdXJlKS50b0JlTGVzc1RoYW4oMTApOyAvLyBTaG91bGQgYmUgbGVzcyB0aGFuIDEweCBlcXVpdHlcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIDAgZm9yIHNpbmdsZSBwb3NpdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHNpbmdsZVBvc2l0aW9uID0gW21vY2tQb3NpdGlvbnNbMF1dO1xuICAgICAgY29uc3QgZXhwb3N1cmUgPSBhd2FpdCBjb3JyZWxhdGlvbk1hbmFnZXIuY2FsY1RvdGFsQ29ycmVsYXRlZEV4cG9zdXJlKHNpbmdsZVBvc2l0aW9uLCAxMDAwMCk7XG5cbiAgICAgIGV4cGVjdChleHBvc3VyZSkudG9CZSgwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IHBvc2l0aW9ucyBhcnJheScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGV4cG9zdXJlID0gYXdhaXQgY29ycmVsYXRpb25NYW5hZ2VyLmNhbGNUb3RhbENvcnJlbGF0ZWRFeHBvc3VyZShbXSwgMTAwMDApO1xuXG4gICAgICBleHBlY3QoZXhwb3N1cmUpLnRvQmUoMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdkZXRlY3RIaWdoQmV0YScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGRldGVjdCBoaWdoIGJldGEgbWFya2V0IGNvbmRpdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0b3BTeW1ib2xzID0gWydFVEhVU0RUJywgJ0FEQVVTRFQnLCAnRE9UVVNEVCcsICdMSU5LVVNEVCddO1xuICAgICAgXG4gICAgICAvLyBNb2NrIGhpZ2ggQlRDIGNvcnJlbGF0aW9uIGZvciBhbGwgc3ltYm9sc1xuICAgICAgamVzdC5zcHlPbihjb3JyZWxhdGlvbk1hbmFnZXIsICdjYWxjQ29ycmVsYXRpb24nKS5tb2NrUmVzb2x2ZWRWYWx1ZSgwLjk1KTtcblxuICAgICAgY29uc3QgaGlnaEJldGFTdGF0ZSA9IGF3YWl0IGNvcnJlbGF0aW9uTWFuYWdlci5kZXRlY3RIaWdoQmV0YSh0b3BTeW1ib2xzKTtcblxuICAgICAgZXhwZWN0KGhpZ2hCZXRhU3RhdGUuaXNIaWdoQmV0YSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChoaWdoQmV0YVN0YXRlLmJ0Y0NvcnJlbGF0aW9uKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDAuOSk7XG4gICAgICBleHBlY3QoaGlnaEJldGFTdGF0ZS5hZmZlY3RlZFN5bWJvbHMpLnRvSGF2ZUxlbmd0aCg0KTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGV0ZWN0IG5vcm1hbCBtYXJrZXQgY29uZGl0aW9ucycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRvcFN5bWJvbHMgPSBbJ0VUSFVTRFQnLCAnQURBVVNEVCcsICdET1RVU0RUJywgJ0xJTktVU0RUJ107XG4gICAgICBcbiAgICAgIC8vIE1vY2sgbG93IEJUQyBjb3JyZWxhdGlvblxuICAgICAgamVzdC5zcHlPbihjb3JyZWxhdGlvbk1hbmFnZXIsICdjYWxjQ29ycmVsYXRpb24nKS5tb2NrUmVzb2x2ZWRWYWx1ZSgwLjMpO1xuXG4gICAgICBjb25zdCBoaWdoQmV0YVN0YXRlID0gYXdhaXQgY29ycmVsYXRpb25NYW5hZ2VyLmRldGVjdEhpZ2hCZXRhKHRvcFN5bWJvbHMpO1xuXG4gICAgICBleHBlY3QoaGlnaEJldGFTdGF0ZS5pc0hpZ2hCZXRhKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChoaWdoQmV0YVN0YXRlLmJ0Y0NvcnJlbGF0aW9uKS50b0JlTGVzc1RoYW4oMC45KTtcbiAgICAgIGV4cGVjdChoaWdoQmV0YVN0YXRlLmFmZmVjdGVkU3ltYm9scykudG9IYXZlTGVuZ3RoKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgc3ltYm9scyBhcnJheScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGhpZ2hCZXRhU3RhdGUgPSBhd2FpdCBjb3JyZWxhdGlvbk1hbmFnZXIuZGV0ZWN0SGlnaEJldGEoW10pO1xuXG4gICAgICBleHBlY3QoaGlnaEJldGFTdGF0ZS5pc0hpZ2hCZXRhKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChoaWdoQmV0YVN0YXRlLmJ0Y0NvcnJlbGF0aW9uKS50b0JlKDApO1xuICAgICAgZXhwZWN0KGhpZ2hCZXRhU3RhdGUuYWZmZWN0ZWRTeW1ib2xzKS50b0hhdmVMZW5ndGgoMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZW5lcmF0ZUNvcnJlbGF0aW9uTWF0cml4JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZ2VuZXJhdGUgY29ycmVsYXRpb24gbWF0cml4IGZvciBnaXZlbiBzeW1ib2xzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc3ltYm9scyA9IFsnQlRDVVNEVCcsICdFVEhVU0RUJywgJ0FEQVVTRFQnXTtcbiAgICAgIFxuICAgICAgLy8gTW9jayBjb3JyZWxhdGlvbiBjYWxjdWxhdGlvbnNcbiAgICAgIGplc3Quc3B5T24oY29ycmVsYXRpb25NYW5hZ2VyLCAnY2FsY0NvcnJlbGF0aW9uJylcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZSgwLjgpIC8vIEJUQy1FVEhcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZSgwLjYpIC8vIEJUQy1BREFcbiAgICAgICAgLm1vY2tSZXNvbHZlZFZhbHVlT25jZSgwLjcpOyAvLyBFVEgtQURBXG5cbiAgICAgIGNvbnN0IG1hdHJpeCA9IGF3YWl0IGNvcnJlbGF0aW9uTWFuYWdlci5nZW5lcmF0ZUNvcnJlbGF0aW9uTWF0cml4KHN5bWJvbHMpO1xuXG4gICAgICBleHBlY3QobWF0cml4LnN5bWJvbHMpLnRvRXF1YWwoc3ltYm9scyk7XG4gICAgICBleHBlY3QobWF0cml4Lm1hdHJpeCkudG9IYXZlTGVuZ3RoKDMpO1xuICAgICAgZXhwZWN0KG1hdHJpeC5tYXRyaXhbMF0pLnRvSGF2ZUxlbmd0aCgzKTtcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgZGlhZ29uYWwgaXMgMS4wIChwZXJmZWN0IHNlbGYtY29ycmVsYXRpb24pXG4gICAgICBleHBlY3QobWF0cml4Lm1hdHJpeFswXVswXSkudG9CZSgxLjApO1xuICAgICAgZXhwZWN0KG1hdHJpeC5tYXRyaXhbMV1bMV0pLnRvQmUoMS4wKTtcbiAgICAgIGV4cGVjdChtYXRyaXgubWF0cml4WzJdWzJdKS50b0JlKDEuMCk7XG4gICAgICBcbiAgICAgIC8vIENoZWNrIHN5bW1ldHJ5XG4gICAgICBleHBlY3QobWF0cml4Lm1hdHJpeFswXVsxXSkudG9CZShtYXRyaXgubWF0cml4WzFdWzBdKTtcbiAgICAgIGV4cGVjdChtYXRyaXgubWF0cml4WzBdWzJdKS50b0JlKG1hdHJpeC5tYXRyaXhbMl1bMF0pO1xuICAgICAgZXhwZWN0KG1hdHJpeC5tYXRyaXhbMV1bMl0pLnRvQmUobWF0cml4Lm1hdHJpeFsyXVsxXSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBzeW1ib2xzIGFycmF5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbWF0cml4ID0gYXdhaXQgY29ycmVsYXRpb25NYW5hZ2VyLmdlbmVyYXRlQ29ycmVsYXRpb25NYXRyaXgoW10pO1xuXG4gICAgICBleHBlY3QobWF0cml4LnN5bWJvbHMpLnRvRXF1YWwoW10pO1xuICAgICAgZXhwZWN0KG1hdHJpeC5tYXRyaXgpLnRvRXF1YWwoW10pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2luZ2xlIHN5bWJvbCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHN5bWJvbHMgPSBbJ0JUQ1VTRFQnXTtcbiAgICAgIGNvbnN0IG1hdHJpeCA9IGF3YWl0IGNvcnJlbGF0aW9uTWFuYWdlci5nZW5lcmF0ZUNvcnJlbGF0aW9uTWF0cml4KHN5bWJvbHMpO1xuXG4gICAgICBleHBlY3QobWF0cml4LnN5bWJvbHMpLnRvRXF1YWwoc3ltYm9scyk7XG4gICAgICBleHBlY3QobWF0cml4Lm1hdHJpeCkudG9FcXVhbChbWzEuMF1dKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NvbmZpZ3VyYXRpb24gYW5kIFN0YXRpc3RpY3MnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB1cGRhdGUgY29uZmlndXJhdGlvbicsICgpID0+IHtcbiAgICAgIGNvbnN0IG5ld0NvbmZpZyA9IHsgY29ycmVsYXRpb25UaHJlc2hvbGQ6IDAuOCB9O1xuICAgICAgY29ycmVsYXRpb25NYW5hZ2VyLnVwZGF0ZUNvbmZpZyhuZXdDb25maWcpO1xuXG4gICAgICAvLyBDb25maWd1cmF0aW9uIHNob3VsZCBiZSB1cGRhdGVkICh0ZXN0ZWQgdGhyb3VnaCBiZWhhdmlvcilcbiAgICAgIGV4cGVjdCh0cnVlKS50b0JlKHRydWUpOyAvLyBQbGFjZWhvbGRlciBhc3NlcnRpb25cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIHN0YXRpc3RpY3MnLCAoKSA9PiB7XG4gICAgICBjb25zdCBzdGF0cyA9IGNvcnJlbGF0aW9uTWFuYWdlci5nZXRTdGF0aXN0aWNzKCk7XG5cbiAgICAgIGV4cGVjdChzdGF0cykudG9IYXZlUHJvcGVydHkoJ2NhY2hlZFBhaXJzJyk7XG4gICAgICBleHBlY3Qoc3RhdHMpLnRvSGF2ZVByb3BlcnR5KCdjYWNoZWRTeW1ib2xzJyk7XG4gICAgICBleHBlY3Qoc3RhdHMpLnRvSGF2ZVByb3BlcnR5KCdoaWdoQmV0YUFjdGl2ZScpO1xuICAgICAgZXhwZWN0KHN0YXRzKS50b0hhdmVQcm9wZXJ0eSgnYXZnQnRjQ29ycmVsYXRpb24nKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHR5cGVvZiBzdGF0cy5jYWNoZWRQYWlycykudG9CZSgnbnVtYmVyJyk7XG4gICAgICBleHBlY3QodHlwZW9mIHN0YXRzLmNhY2hlZFN5bWJvbHMpLnRvQmUoJ251bWJlcicpO1xuICAgICAgZXhwZWN0KHR5cGVvZiBzdGF0cy5oaWdoQmV0YUFjdGl2ZSkudG9CZSgnYm9vbGVhbicpO1xuICAgICAgZXhwZWN0KHR5cGVvZiBzdGF0cy5hdmdCdGNDb3JyZWxhdGlvbikudG9CZSgnbnVtYmVyJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNsZWFyIGNhY2hlJywgKCkgPT4ge1xuICAgICAgY29ycmVsYXRpb25NYW5hZ2VyLmNsZWFyQ2FjaGUoKTtcbiAgICAgIFxuICAgICAgY29uc3Qgc3RhdHMgPSBjb3JyZWxhdGlvbk1hbmFnZXIuZ2V0U3RhdGlzdGljcygpO1xuICAgICAgZXhwZWN0KHN0YXRzLmNhY2hlZFBhaXJzKS50b0JlKDApO1xuICAgICAgZXhwZWN0KHN0YXRzLmNhY2hlZFN5bWJvbHMpLnRvQmUoMCk7XG4gICAgICBleHBlY3Qoc3RhdHMuaGlnaEJldGFBY3RpdmUpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRXZlbnQgRW1pc3Npb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBlbWl0IGNvcnJlbGF0aW9uOnVwZGF0ZWQgZXZlbnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBldmVudFNweSA9IGplc3QuZm4oKTtcbiAgICAgIGNvcnJlbGF0aW9uTWFuYWdlci5vbignY29ycmVsYXRpb246dXBkYXRlZCcsIGV2ZW50U3B5KTtcblxuICAgICAgYXdhaXQgY29ycmVsYXRpb25NYW5hZ2VyLmdlbmVyYXRlQ29ycmVsYXRpb25NYXRyaXgoWydCVENVU0RUJywgJ0VUSFVTRFQnXSk7XG5cbiAgICAgIGV4cGVjdChldmVudFNweSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICBzeW1ib2xzOiBbJ0JUQ1VTRFQnLCAnRVRIVVNEVCddLFxuICAgICAgICBtYXRyaXg6IGV4cGVjdC5hbnkoQXJyYXkpLFxuICAgICAgICB0aW1lc3RhbXA6IGV4cGVjdC5hbnkoTnVtYmVyKVxuICAgICAgfSkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBlbWl0IGNvcnJlbGF0aW9uOmhpZ2hfYmV0YSBldmVudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGV2ZW50U3B5ID0gamVzdC5mbigpO1xuICAgICAgY29ycmVsYXRpb25NYW5hZ2VyLm9uKCdjb3JyZWxhdGlvbjpoaWdoX2JldGEnLCBldmVudFNweSk7XG5cbiAgICAgIC8vIE1vY2sgaGlnaCBjb3JyZWxhdGlvbiB0byB0cmlnZ2VyIGhpZ2ggYmV0YVxuICAgICAgamVzdC5zcHlPbihjb3JyZWxhdGlvbk1hbmFnZXIsICdjYWxjQ29ycmVsYXRpb24nKS5tb2NrUmVzb2x2ZWRWYWx1ZSgwLjk1KTtcblxuICAgICAgYXdhaXQgY29ycmVsYXRpb25NYW5hZ2VyLmRldGVjdEhpZ2hCZXRhKFsnRVRIVVNEVCddKTtcblxuICAgICAgZXhwZWN0KGV2ZW50U3B5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgIGlzSGlnaEJldGE6IHRydWUsXG4gICAgICAgIGJ0Y0NvcnJlbGF0aW9uOiBleHBlY3QuYW55KE51bWJlciksXG4gICAgICAgIGFmZmVjdGVkU3ltYm9sczogZXhwZWN0LmFueShBcnJheSksXG4gICAgICAgIHRpbWVzdGFtcDogZXhwZWN0LmFueShOdW1iZXIpXG4gICAgICB9KSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGVtaXQgY29ycmVsYXRpb246cmVqZWN0IGV2ZW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZXZlbnRTcHkgPSBqZXN0LmZuKCk7XG4gICAgICBjb3JyZWxhdGlvbk1hbmFnZXIub24oJ2NvcnJlbGF0aW9uOnJlamVjdCcsIGV2ZW50U3B5KTtcblxuICAgICAgY29uc3QgbW9ja1Bvc2l0aW9uczogUG9zaXRpb25bXSA9IFt7XG4gICAgICAgIGlkOiAncG9zMScsXG4gICAgICAgIHN5bWJvbDogJ0VUSFVTRFQnLFxuICAgICAgICBzaWRlOiAnTE9ORycsXG4gICAgICAgIGVudHJ5UHJpY2U6IDIwMDAsXG4gICAgICAgIGN1cnJlbnRQcmljZTogMjEwMCxcbiAgICAgICAgcXVhbnRpdHk6IDEsXG4gICAgICAgIGxldmVyYWdlOiAzLFxuICAgICAgICBzdG9wTG9zczogMTkwMCxcbiAgICAgICAgdGFrZVByb2ZpdDogMjMwMCxcbiAgICAgICAgdW5yZWFsaXplZFBuTDogMTAwLFxuICAgICAgICByZWFsaXplZFBuTDogMCxcbiAgICAgICAgZW50cnlUaW1lOiBEYXRlLm5vdygpLFxuICAgICAgICBzdGF0dXM6ICdPUEVOJyxcbiAgICAgICAgclZhbHVlOiAxLjAsXG4gICAgICAgIGF0cjogNTBcbiAgICAgIH1dO1xuXG4gICAgICAvLyBNb2NrIGhpZ2ggY29ycmVsYXRpb24gdG8gdHJpZ2dlciByZWplY3Rpb25cbiAgICAgIGplc3Quc3B5T24oY29ycmVsYXRpb25NYW5hZ2VyLCAnY2FsY0NvcnJlbGF0aW9uJykubW9ja1Jlc29sdmVkVmFsdWUoMC45KTtcblxuICAgICAgYXdhaXQgY29ycmVsYXRpb25NYW5hZ2VyLmNoZWNrQ29ycmVsYXRpb25MaW1pdCgnQlRDVVNEVCcsIG1vY2tQb3NpdGlvbnMsIDEwMDApO1xuXG4gICAgICBleHBlY3QoZXZlbnRTcHkpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdCVENVU0RUJywgMC45LCAnRVRIVVNEVCcpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnTW9uaXRvcmluZyBMaWZlY3ljbGUnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzdGFydCBhbmQgc3RvcCBtb25pdG9yaW5nJywgKCkgPT4ge1xuICAgICAgLy8gTW9uaXRvcmluZyBzaG91bGQgc3RhcnQgYXV0b21hdGljYWxseSBpbiBjb25zdHJ1Y3RvclxuICAgICAgZXhwZWN0KHRydWUpLnRvQmUodHJ1ZSk7IC8vIFBsYWNlaG9sZGVyIC0gbW9uaXRvcmluZyBpcyBpbnRlcm5hbFxuXG4gICAgICBjb3JyZWxhdGlvbk1hbmFnZXIuc3RvcE1vbml0b3JpbmcoKTtcbiAgICAgIGNvcnJlbGF0aW9uTWFuYWdlci5zdGFydE1vbml0b3JpbmcgPSBqZXN0LmZuKCk7XG4gICAgICBcbiAgICAgIC8vIFNob3VsZCBiZSBhYmxlIHRvIHJlc3RhcnRcbiAgICAgIGV4cGVjdCh0cnVlKS50b0JlKHRydWUpOyAvLyBQbGFjZWhvbGRlclxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjbGVhbnVwIHJlc291cmNlcyBvbiBkZXN0cm95JywgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RvcFNweSA9IGplc3Quc3B5T24oY29ycmVsYXRpb25NYW5hZ2VyLCAnc3RvcE1vbml0b3JpbmcnKTtcbiAgICAgIGNvbnN0IGNsZWFyU3B5ID0gamVzdC5zcHlPbihjb3JyZWxhdGlvbk1hbmFnZXIsICdjbGVhckNhY2hlJyk7XG5cbiAgICAgIGNvcnJlbGF0aW9uTWFuYWdlci5kZXN0cm95KCk7XG5cbiAgICAgIGV4cGVjdChzdG9wU3B5KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QoY2xlYXJTcHkpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwidmVyc2lvbiI6M30=