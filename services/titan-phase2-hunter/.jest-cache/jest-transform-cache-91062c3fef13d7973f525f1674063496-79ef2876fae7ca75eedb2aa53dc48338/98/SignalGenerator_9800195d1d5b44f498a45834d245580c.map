{"file":"/Users/ivan/Code/trading/titan/services/titan-phase2-hunter/src/execution/SignalGenerator.ts","mappings":"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","names":[],"sources":["/Users/ivan/Code/trading/titan/services/titan-phase2-hunter/src/execution/SignalGenerator.ts"],"sourcesContent":["/**\n * Signal Generator for Titan Phase 2 - The Hunter\n * \n * Generates trading signals by combining all validation layers:\n * - Hologram alignment (A+ or B status)\n * - Session timing (Killzone requirement)\n * - Relative Strength filtering\n * - POI proximity validation\n * - CVD absorption confirmation\n */\n\nimport { \n  HologramState, \n  HologramStatus, \n  SessionState, \n  SessionType, \n  POI, \n  FVG, \n  OrderBlock, \n  LiquidityPool,\n  Absorption,\n  SignalData,\n  TrendState\n} from '../types';\nimport { HologramEngine } from '../engine/HologramEngine';\nimport { SessionProfiler } from '../engine/SessionProfiler';\nimport { InefficiencyMapper } from '../engine/InefficiencyMapper';\nimport { CVDValidator } from '../engine/CVDValidator';\n\nexport interface SignalGeneratorConfig {\n  minAlignmentScore: number; // Minimum alignment score for B signals (default: 60)\n  rsThreshold: number; // Minimum RS score magnitude (default: 0.01)\n  poiProximityPercent: number; // Max distance from POI (default: 0.5%)\n  minCVDConfidence: number; // Minimum CVD absorption confidence (default: 70)\n  requireCVDConfirmation: boolean; // Whether CVD confirmation is mandatory (default: true)\n}\n\nexport interface SignalValidationResult {\n  valid: boolean;\n  reason: string;\n  hologramValid: boolean;\n  sessionValid: boolean;\n  rsValid: boolean;\n  poiValid: boolean;\n  cvdValid: boolean;\n}\n\nexport interface SignalContext {\n  hologram: HologramState;\n  session: SessionState;\n  currentPrice: number;\n  nearbyPOIs: POI[];\n  absorption: Absorption | null;\n  atr: number; // For position sizing and stop calculation\n}\n\nexport class SignalGenerator {\n  private config: SignalGeneratorConfig;\n  private hologramEngine: HologramEngine;\n  private sessionProfiler: SessionProfiler;\n  private inefficiencyMapper: InefficiencyMapper;\n  private cvdValidator: CVDValidator;\n\n  constructor(\n    hologramEngine: HologramEngine,\n    sessionProfiler: SessionProfiler,\n    inefficiencyMapper: InefficiencyMapper,\n    cvdValidator: CVDValidator,\n    config: Partial<SignalGeneratorConfig> = {}\n  ) {\n    this.hologramEngine = hologramEngine;\n    this.sessionProfiler = sessionProfiler;\n    this.inefficiencyMapper = inefficiencyMapper;\n    this.cvdValidator = cvdValidator;\n    \n    // Set default configuration\n    this.config = {\n      minAlignmentScore: 60,\n      rsThreshold: 0.01,\n      poiProximityPercent: 0.5,\n      minCVDConfidence: 70,\n      requireCVDConfirmation: true,\n      ...config\n    };\n  }\n\n  /**\n   * Check if hologram status meets requirements for signal generation\n   * Requirements: A+ or B alignment status\n   */\n  checkHologramStatus(hologram: HologramState): boolean {\n    // Check if status is A+ or B\n    if (hologram.status !== 'A+' && hologram.status !== 'B') {\n      return false;\n    }\n\n    // Additional check: alignment score must meet minimum threshold\n    if (hologram.status === 'B' && hologram.alignmentScore < this.config.minAlignmentScore) {\n      return false;\n    }\n\n    // Check that veto logic hasn't blocked the signal\n    if (hologram.veto.vetoed) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Check if current session meets Killzone requirements\n   * Requirements: Must be London (07:00-10:00 UTC) or NY (13:00-16:00 UTC) session\n   */\n  checkSession(session: SessionState): boolean {\n    return this.sessionProfiler.isKillzone();\n  }\n\n  /**\n   * Check if RS score meets directional filter requirements\n   * Requirements: Long signals need RS > threshold, Short signals need RS < -threshold\n   */\n  checkRSScore(rsScore: number, direction: 'LONG' | 'SHORT'): boolean {\n    if (direction === 'LONG') {\n      return rsScore > this.config.rsThreshold;\n    } else {\n      return rsScore < -this.config.rsThreshold;\n    }\n  }\n\n  /**\n   * Check if current price is within proximity of relevant POIs\n   * Requirements: Price must be within 0.5% of Order Block or FVG\n   */\n  checkPOIProximity(currentPrice: number, pois: POI[], direction: 'LONG' | 'SHORT'): { valid: boolean; poi: POI | null } {\n    const proximityThreshold = this.config.poiProximityPercent / 100;\n\n    for (const poi of pois) {\n      // Skip mitigated POIs\n      if ('mitigated' in poi && poi.mitigated) continue;\n      if ('swept' in poi && poi.swept) continue;\n\n      let targetPrice: number;\n      let poiValid = false;\n\n      // Check POI type and direction compatibility\n      if ('midpoint' in poi) {\n        // FVG\n        const fvg = poi as FVG;\n        if (direction === 'LONG' && fvg.type === 'BULLISH') {\n          targetPrice = fvg.midpoint;\n          poiValid = true;\n        } else if (direction === 'SHORT' && fvg.type === 'BEARISH') {\n          targetPrice = fvg.midpoint;\n          poiValid = true;\n        }\n      } else if ('high' in poi && 'low' in poi && !('strength' in poi)) {\n        // Order Block\n        const ob = poi as OrderBlock;\n        if (direction === 'LONG' && ob.type === 'BULLISH') {\n          targetPrice = ob.low; // Enter at bottom of bullish OB\n          poiValid = true;\n        } else if (direction === 'SHORT' && ob.type === 'BEARISH') {\n          targetPrice = ob.high; // Enter at top of bearish OB\n          poiValid = true;\n        }\n      } else if ('strength' in poi) {\n        // Liquidity Pool - less precise, use for confluence only\n        const pool = poi as LiquidityPool;\n        if (direction === 'LONG' && pool.type === 'LOW') {\n          targetPrice = pool.price;\n          poiValid = true;\n        } else if (direction === 'SHORT' && pool.type === 'HIGH') {\n          targetPrice = pool.price;\n          poiValid = true;\n        }\n      }\n\n      if (poiValid) {\n        const distance = Math.abs(currentPrice - targetPrice!) / currentPrice;\n        if (distance <= proximityThreshold) {\n          return { valid: true, poi };\n        }\n      }\n    }\n\n    return { valid: false, poi: null };\n  }\n\n  /**\n   * Check if CVD absorption provides required confirmation\n   * Requirements: Must have absorption signal with sufficient confidence\n   */\n  checkCVDAbsorption(absorption: Absorption | null, direction: 'LONG' | 'SHORT'): boolean {\n    if (!this.config.requireCVDConfirmation) {\n      return true; // CVD confirmation not required\n    }\n\n    if (!absorption) {\n      return false; // No absorption detected\n    }\n\n    // Check confidence level\n    if (absorption.confidence < this.config.minCVDConfidence) {\n      return false;\n    }\n\n    // For LONG signals, we need absorption (buying pressure at lows)\n    // For SHORT signals, we need distribution (selling pressure at highs)\n    // Note: The current absorption interface only handles absorption\n    // Distribution would need to be handled separately or the interface extended\n    \n    if (direction === 'LONG') {\n      return true; // Absorption supports long entry\n    } else {\n      // For short signals, we would need distribution detection\n      // For now, we'll accept absorption as general flow confirmation\n      return true;\n    }\n  }\n\n  /**\n   * Validate all signal conditions\n   */\n  validateSignal(context: SignalContext, direction: 'LONG' | 'SHORT'): SignalValidationResult {\n    const hologramValid = this.checkHologramStatus(context.hologram);\n    const sessionValid = this.checkSession(context.session);\n    const rsValid = this.checkRSScore(context.hologram.rsScore, direction);\n    const poiResult = this.checkPOIProximity(context.currentPrice, context.nearbyPOIs, direction);\n    const cvdValid = this.checkCVDAbsorption(context.absorption, direction);\n\n    const valid = hologramValid && sessionValid && rsValid && poiResult.valid && cvdValid;\n\n    let reason = '';\n    if (!hologramValid) reason += 'Hologram status invalid. ';\n    if (!sessionValid) reason += 'Not in Killzone. ';\n    if (!rsValid) reason += 'RS score insufficient. ';\n    if (!poiResult.valid) reason += 'No POI proximity. ';\n    if (!cvdValid) reason += 'CVD confirmation missing. ';\n\n    if (valid) {\n      reason = 'All conditions met';\n    }\n\n    return {\n      valid,\n      reason: reason.trim(),\n      hologramValid,\n      sessionValid,\n      rsValid,\n      poiValid: poiResult.valid,\n      cvdValid\n    };\n  }\n\n  /**\n   * Calculate position size using Volatility-Adjusted Sizing\n   * Formula: Risk_Dollars / (ATR * Stop_Distance_Multiplier)\n   */\n  private calculatePositionSize(\n    equity: number,\n    riskPerTrade: number,\n    atr: number,\n    stopDistancePercent: number,\n    currentPrice: number,\n    leverage: number\n  ): number {\n    const riskDollars = equity * riskPerTrade;\n    const stopDistance = currentPrice * (stopDistancePercent / 100);\n    const positionSize = riskDollars / stopDistance;\n    \n    // Apply leverage constraint\n    const maxPositionValue = equity * leverage;\n    const maxPositionSize = maxPositionValue / currentPrice;\n    \n    return Math.min(positionSize, maxPositionSize);\n  }\n\n  /**\n   * Generate trading signal with all validations\n   */\n  async generateSignal(\n    symbol: string,\n    direction: 'LONG' | 'SHORT',\n    equity: number,\n    riskPerTrade: number = 0.02,\n    leverage: number = 3\n  ): Promise<SignalData | null> {\n    try {\n      // Get hologram state\n      const hologram = await this.hologramEngine.analyze(symbol);\n      \n      // Get session state\n      const session = this.sessionProfiler.getSessionState();\n      \n      // Get current price from hologram\n      const currentPrice = hologram.m15.currentPrice;\n      \n      // Get nearby POIs\n      const nearbyPOIs = await this.getNearbyPOIs(symbol, currentPrice);\n      \n      // Get CVD absorption\n      const absorption = await this.getCVDAbsorption(symbol);\n      \n      // Get ATR for position sizing (using 15m timeframe)\n      const atr = await this.calculateATR(symbol, '15m');\n      \n      // Create signal context\n      const context: SignalContext = {\n        hologram,\n        session,\n        currentPrice,\n        nearbyPOIs,\n        absorption,\n        atr\n      };\n\n      // Validate signal\n      const validation = this.validateSignal(context, direction);\n      \n      if (!validation.valid) {\n        console.log(`‚ùå Signal validation failed for ${symbol} ${direction}: ${validation.reason}`);\n        return null;\n      }\n\n      // Calculate entry, stop, and target prices\n      const { entryPrice, stopLoss, takeProfit } = this.calculatePrices(\n        currentPrice,\n        direction,\n        context.nearbyPOIs,\n        atr\n      );\n\n      // Calculate position size\n      const stopDistancePercent = Math.abs(entryPrice - stopLoss) / entryPrice * 100;\n      const positionSize = this.calculatePositionSize(\n        equity,\n        riskPerTrade,\n        atr,\n        stopDistancePercent,\n        entryPrice,\n        leverage\n      );\n\n      // Calculate confidence score\n      const confidence = this.calculateConfidence(hologram, validation, absorption);\n\n      // Create signal data\n      const signal: SignalData = {\n        symbol,\n        direction,\n        hologramStatus: hologram.status,\n        alignmentScore: hologram.alignmentScore,\n        rsScore: hologram.rsScore,\n        sessionType: session.type,\n        poiType: this.getPOIType(context.nearbyPOIs[0]),\n        cvdConfirmation: validation.cvdValid,\n        confidence,\n        entryPrice,\n        stopLoss,\n        takeProfit,\n        positionSize,\n        leverage,\n        timestamp: Date.now()\n      };\n\n      console.log(`‚úÖ Signal generated for ${symbol} ${direction}: ${hologram.status} alignment, ${confidence}% confidence`);\n      return signal;\n\n    } catch (error) {\n      console.error(`‚ùå Error generating signal for ${symbol}:`, error);\n      return null;\n    }\n  }\n\n  /**\n   * Get nearby POIs for the symbol\n   */\n  private async getNearbyPOIs(symbol: string, currentPrice: number): Promise<POI[]> {\n    // This would typically fetch from a POI cache or calculate on demand\n    // For now, we'll return an empty array as a placeholder\n    // In a real implementation, this would integrate with InefficiencyMapper\n    return [];\n  }\n\n  /**\n   * Get CVD absorption data for the symbol\n   */\n  private async getCVDAbsorption(symbol: string): Promise<Absorption | null> {\n    // This would typically fetch recent CVD data and check for absorption\n    // For now, we'll return null as a placeholder\n    // In a real implementation, this would integrate with CVDValidator\n    return null;\n  }\n\n  /**\n   * Calculate ATR for position sizing\n   */\n  private async calculateATR(symbol: string, timeframe: string, period: number = 14): Promise<number> {\n    // This would typically fetch OHLCV data and calculate ATR\n    // For now, we'll return a placeholder value\n    // In a real implementation, this would fetch data and calculate true ATR\n    return 0.02; // 2% placeholder ATR\n  }\n\n  /**\n   * Calculate entry, stop loss, and take profit prices\n   */\n  private calculatePrices(\n    currentPrice: number,\n    direction: 'LONG' | 'SHORT',\n    pois: POI[],\n    atr: number\n  ): { entryPrice: number; stopLoss: number; takeProfit: number } {\n    // Default to current price if no POI\n    let entryPrice = currentPrice;\n    \n    // Use POI price if available\n    if (pois.length > 0) {\n      const poi = pois[0];\n      if ('midpoint' in poi) {\n        entryPrice = (poi as FVG).midpoint;\n      } else if ('high' in poi && 'low' in poi && !('strength' in poi)) {\n        const ob = poi as OrderBlock;\n        entryPrice = direction === 'LONG' ? ob.low : ob.high;\n      } else if ('price' in poi) {\n        entryPrice = (poi as LiquidityPool).price;\n      }\n    }\n\n    // Calculate stop loss and take profit (3:1 R:R)\n    const stopDistance = entryPrice * 0.015; // 1.5% stop\n    const targetDistance = stopDistance * 3; // 3:1 R:R\n\n    let stopLoss: number;\n    let takeProfit: number;\n\n    if (direction === 'LONG') {\n      stopLoss = entryPrice - stopDistance;\n      takeProfit = entryPrice + targetDistance;\n    } else {\n      stopLoss = entryPrice + stopDistance;\n      takeProfit = entryPrice - targetDistance;\n    }\n\n    return { entryPrice, stopLoss, takeProfit };\n  }\n\n  /**\n   * Calculate overall signal confidence\n   */\n  private calculateConfidence(\n    hologram: HologramState,\n    validation: SignalValidationResult,\n    absorption: Absorption | null\n  ): number {\n    let confidence = hologram.alignmentScore; // Base confidence from alignment\n\n    // Bonus for A+ status\n    if (hologram.status === 'A+') {\n      confidence += 10;\n    }\n\n    // Bonus for strong RS\n    if (Math.abs(hologram.rsScore) > 0.05) {\n      confidence += 5;\n    }\n\n    // Bonus for CVD confirmation\n    if (absorption && absorption.confidence > 80) {\n      confidence += 10;\n    }\n\n    return Math.min(100, confidence);\n  }\n\n  /**\n   * Get POI type for logging\n   */\n  private getPOIType(poi: POI | undefined): 'FVG' | 'ORDER_BLOCK' | 'LIQUIDITY_POOL' {\n    if (!poi) return 'ORDER_BLOCK'; // Default\n\n    if ('midpoint' in poi) return 'FVG';\n    if ('high' in poi && 'low' in poi && !('strength' in poi)) return 'ORDER_BLOCK';\n    return 'LIQUIDITY_POOL';\n  }\n\n  /**\n   * Update configuration\n   */\n  updateConfig(newConfig: Partial<SignalGeneratorConfig>): void {\n    this.config = { ...this.config, ...newConfig };\n    console.log('üìù SignalGenerator configuration updated');\n  }\n\n  /**\n   * Get current configuration\n   */\n  getConfig(): SignalGeneratorConfig {\n    return { ...this.config };\n  }\n}"],"version":3}