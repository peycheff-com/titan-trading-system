af3d7b5986f12dbbbc34ccbabc69c436
"use strict";
/**
 * POI Map Component Tests
 * Tests for the POI Map display component
 */
Object.defineProperty(exports, "__esModule", { value: true });
const POIMap_1 = require("../../src/console/POIMap");
describe('POIMapComponent', () => {
    let component;
    beforeEach(() => {
        component = new POIMap_1.POIMapComponent();
    });
    describe('render', () => {
        it('should render header and empty lines when no POIs', () => {
            const lines = component.render();
            expect(lines).toHaveLength(9); // 1 header + 8 data lines
            expect(lines[0]).toBe('Type      Price     Dist   Conf');
            expect(lines[1]).toBe(''.padEnd(31));
        });
        it('should render POI entries correctly', () => {
            const pois = [
                {
                    id: 'OB_1',
                    type: 'ORDER_BLOCK',
                    direction: 'BULLISH',
                    price: 50000,
                    distance: 0.3,
                    confidence: 85,
                    age: 2,
                    mitigated: false,
                    strength: 90
                },
                {
                    id: 'FVG_1',
                    type: 'FVG',
                    direction: 'BEARISH',
                    price: 49500,
                    distance: -1.2,
                    confidence: 75,
                    age: 1,
                    mitigated: false,
                    strength: 80
                }
            ];
            component.updateConfig({ pois });
            const lines = component.render();
            expect(lines).toHaveLength(9);
            expect(lines[0]).toBe('Type      Price     Dist   Conf');
            expect(lines[1]).toContain('OB-BULL');
            expect(lines[1]).toContain('50,000');
            expect(lines[1]).toContain('+0.3%');
            expect(lines[1]).toContain('85%');
            expect(lines[2]).toContain('FVG-BEAR');
            expect(lines[2]).toContain('49,500');
            expect(lines[2]).toContain('-1.2%');
            expect(lines[2]).toContain('75%');
        });
        it('should sort POIs by distance (closest first)', () => {
            const pois = [
                {
                    id: 'POI_1',
                    type: 'ORDER_BLOCK',
                    direction: 'BULLISH',
                    price: 50000,
                    distance: 2.5, // Far
                    confidence: 80,
                    age: 1,
                    mitigated: false,
                    strength: 85
                },
                {
                    id: 'POI_2',
                    type: 'FVG',
                    direction: 'BEARISH',
                    price: 49800,
                    distance: 0.2, // Close
                    confidence: 90,
                    age: 0.5,
                    mitigated: false,
                    strength: 95
                }
            ];
            component.updateConfig({ pois });
            const lines = component.render();
            // FVG should be first (closer distance)
            expect(lines[1]).toContain('FVG-BEAR');
            expect(lines[1]).toContain('+0.2%');
            // Order Block should be second (farther distance)
            expect(lines[2]).toContain('OB-BULL');
            expect(lines[2]).toContain('+2.5%');
        });
        it('should limit display to 8 POIs', () => {
            const pois = Array.from({ length: 12 }, (_, i) => ({
                id: `POI_${i}`,
                type: 'ORDER_BLOCK',
                direction: 'BULLISH',
                price: 50000 + i * 100,
                distance: i * 0.1,
                confidence: 80,
                age: 1,
                mitigated: false,
                strength: 85
            }));
            component.updateConfig({ pois });
            const lines = component.render();
            expect(lines).toHaveLength(9); // 1 header + 8 data lines
            // Check that only 8 POIs are displayed (plus header)
            let nonEmptyLines = 0;
            for (let i = 1; i < lines.length; i++) {
                if (lines[i].trim() !== '') {
                    nonEmptyLines++;
                }
            }
            expect(nonEmptyLines).toBe(8);
        });
    });
    describe('color coding', () => {
        it('should use red color for very close POIs (< 0.5%)', () => {
            const pois = [
                {
                    id: 'CLOSE_POI',
                    type: 'ORDER_BLOCK',
                    direction: 'BULLISH',
                    price: 50000,
                    distance: 0.3, // < 0.5%
                    confidence: 85,
                    age: 1,
                    mitigated: false,
                    strength: 90
                }
            ];
            component.updateConfig({ pois });
            const lines = component.render();
            // Should contain red color code
            expect(lines[1]).toContain('\x1b[31m'); // Red color
        });
        it('should use yellow color for close POIs (< 2%)', () => {
            const pois = [
                {
                    id: 'CLOSE_POI',
                    type: 'ORDER_BLOCK',
                    direction: 'BULLISH',
                    price: 50000,
                    distance: 1.5, // < 2%
                    confidence: 75,
                    age: 1,
                    mitigated: false,
                    strength: 80
                }
            ];
            component.updateConfig({ pois });
            const lines = component.render();
            // Should contain yellow color code
            expect(lines[1]).toContain('\x1b[33m'); // Yellow color
        });
        it('should use white color for far POIs (>= 2%)', () => {
            const pois = [
                {
                    id: 'FAR_POI',
                    type: 'ORDER_BLOCK',
                    direction: 'BULLISH',
                    price: 50000,
                    distance: 3.0, // >= 2%
                    confidence: 70,
                    age: 1,
                    mitigated: false,
                    strength: 75
                }
            ];
            component.updateConfig({ pois });
            const lines = component.render();
            // Should contain white color code
            expect(lines[1]).toContain('\x1b[37m'); // White color
        });
    });
    describe('formatting', () => {
        it('should format POI types correctly', () => {
            const pois = [
                {
                    id: 'OB_1',
                    type: 'ORDER_BLOCK',
                    direction: 'BULLISH',
                    price: 50000,
                    distance: 0.5,
                    confidence: 80,
                    age: 1,
                    mitigated: false,
                    strength: 85
                },
                {
                    id: 'FVG_1',
                    type: 'FVG',
                    direction: 'BEARISH',
                    price: 49500,
                    distance: -0.8,
                    confidence: 75,
                    age: 1,
                    mitigated: false,
                    strength: 80
                },
                {
                    id: 'LIQ_1',
                    type: 'LIQUIDITY_POOL',
                    direction: 'BULLISH',
                    price: 50200,
                    distance: 1.2,
                    confidence: 90,
                    age: 0.5,
                    mitigated: false,
                    strength: 95,
                    volume: 1000000
                }
            ];
            component.updateConfig({ pois });
            const lines = component.render();
            expect(lines[1]).toContain('OB-BULL');
            expect(lines[2]).toContain('FVG-BEAR');
            expect(lines[3]).toContain('LIQ-BULL');
        });
        it('should format prices correctly', () => {
            const pois = [
                {
                    id: 'HIGH_PRICE',
                    type: 'ORDER_BLOCK',
                    direction: 'BULLISH',
                    price: 50000, // Should show as 50,000
                    distance: 0.5,
                    confidence: 80,
                    age: 1,
                    mitigated: false,
                    strength: 85
                },
                {
                    id: 'LOW_PRICE',
                    type: 'FVG',
                    direction: 'BEARISH',
                    price: 1.2345, // Should show as 1.23
                    distance: -0.8,
                    confidence: 75,
                    age: 1,
                    mitigated: false,
                    strength: 80
                },
                {
                    id: 'VERY_LOW_PRICE',
                    type: 'LIQUIDITY_POOL',
                    direction: 'BULLISH',
                    price: 0.001234, // Should show as 0.0012
                    distance: 1.2,
                    confidence: 90,
                    age: 0.5,
                    mitigated: false,
                    strength: 95
                }
            ];
            component.updateConfig({ pois });
            const lines = component.render();
            expect(lines[1]).toContain('50,000');
            expect(lines[2]).toContain('1.23');
            expect(lines[3]).toContain('0.0012');
        });
        it('should format distances with correct signs', () => {
            const pois = [
                {
                    id: 'POSITIVE_DIST',
                    type: 'ORDER_BLOCK',
                    direction: 'BULLISH',
                    price: 50000,
                    distance: 1.5,
                    confidence: 80,
                    age: 1,
                    mitigated: false,
                    strength: 85
                },
                {
                    id: 'NEGATIVE_DIST',
                    type: 'FVG',
                    direction: 'BEARISH',
                    price: 49500,
                    distance: -2.3,
                    confidence: 75,
                    age: 1,
                    mitigated: false,
                    strength: 80
                }
            ];
            component.updateConfig({ pois });
            const lines = component.render();
            expect(lines[1]).toContain('+1.5%');
            expect(lines[2]).toContain('-2.3%');
        });
    });
    describe('updateConfig', () => {
        it('should update POI list correctly', () => {
            const initialPOIs = [
                {
                    id: 'POI_1',
                    type: 'ORDER_BLOCK',
                    direction: 'BULLISH',
                    price: 50000,
                    distance: 1.0,
                    confidence: 80,
                    age: 1,
                    mitigated: false,
                    strength: 85
                }
            ];
            component.updateConfig({ pois: initialPOIs });
            let lines = component.render();
            expect(lines[1]).toContain('OB-BULL');
            const updatedPOIs = [
                {
                    id: 'POI_2',
                    type: 'FVG',
                    direction: 'BEARISH',
                    price: 49500,
                    distance: -0.5,
                    confidence: 90,
                    age: 0.5,
                    mitigated: false,
                    strength: 95
                }
            ];
            component.updateConfig({ pois: updatedPOIs });
            lines = component.render();
            expect(lines[1]).toContain('FVG-BEAR');
            expect(lines[1]).not.toContain('OB-BULL');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2l2YW4vQ29kZS90cmFkaW5nL3RpdGFuL3NlcnZpY2VzL3RpdGFuLXBoYXNlMi1odW50ZXIvdGVzdHMvdW5pdC9QT0lNYXAudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7OztHQUdHOztBQUVILHFEQUFxRTtBQUVyRSxRQUFRLENBQUMsaUJBQWlCLEVBQUUsR0FBRyxFQUFFO0lBQy9CLElBQUksU0FBMEIsQ0FBQztJQUUvQixVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsU0FBUyxHQUFHLElBQUksd0JBQWUsRUFBRSxDQUFDO0lBQ3BDLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLFFBQVEsRUFBRSxHQUFHLEVBQUU7UUFDdEIsRUFBRSxDQUFDLG1EQUFtRCxFQUFFLEdBQUcsRUFBRTtZQUMzRCxNQUFNLEtBQUssR0FBRyxTQUFTLENBQUMsTUFBTSxFQUFFLENBQUM7WUFFakMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLDBCQUEwQjtZQUN6RCxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGlDQUFpQyxDQUFDLENBQUM7WUFDekQsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDdkMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMscUNBQXFDLEVBQUUsR0FBRyxFQUFFO1lBQzdDLE1BQU0sSUFBSSxHQUFlO2dCQUN2QjtvQkFDRSxFQUFFLEVBQUUsTUFBTTtvQkFDVixJQUFJLEVBQUUsYUFBYTtvQkFDbkIsU0FBUyxFQUFFLFNBQVM7b0JBQ3BCLEtBQUssRUFBRSxLQUFLO29CQUNaLFFBQVEsRUFBRSxHQUFHO29CQUNiLFVBQVUsRUFBRSxFQUFFO29CQUNkLEdBQUcsRUFBRSxDQUFDO29CQUNOLFNBQVMsRUFBRSxLQUFLO29CQUNoQixRQUFR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QUFDO1lBQzlDLEtBQUssR0FBRyxTQUFTLENBQUMsTUFBTSxFQUFFLENBQUM7WUFDM0IsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUN2QyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUM1QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1VzZXJzL2l2YW4vQ29kZS90cmFkaW5nL3RpdGFuL3NlcnZpY2VzL3RpdGFuLXBoYXNlMi1odW50ZXIvdGVzdHMvdW5pdC9QT0lNYXAudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFBPSSBNYXAgQ29tcG9uZW50IFRlc3RzXG4gKiBUZXN0cyBmb3IgdGhlIFBPSSBNYXAgZGlzcGxheSBjb21wb25lbnRcbiAqL1xuXG5pbXBvcnQgeyBQT0lNYXBDb21wb25lbnQsIFBPSUVudHJ5IH0gZnJvbSAnLi4vLi4vc3JjL2NvbnNvbGUvUE9JTWFwJztcblxuZGVzY3JpYmUoJ1BPSU1hcENvbXBvbmVudCcsICgpID0+IHtcbiAgbGV0IGNvbXBvbmVudDogUE9JTWFwQ29tcG9uZW50O1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGNvbXBvbmVudCA9IG5ldyBQT0lNYXBDb21wb25lbnQoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3JlbmRlcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJlbmRlciBoZWFkZXIgYW5kIGVtcHR5IGxpbmVzIHdoZW4gbm8gUE9JcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGxpbmVzID0gY29tcG9uZW50LnJlbmRlcigpO1xuICAgICAgXG4gICAgICBleHBlY3QobGluZXMpLnRvSGF2ZUxlbmd0aCg5KTsgLy8gMSBoZWFkZXIgKyA4IGRhdGEgbGluZXNcbiAgICAgIGV4cGVjdChsaW5lc1swXSkudG9CZSgnVHlwZSAgICAgIFByaWNlICAgICBEaXN0ICAgQ29uZicpO1xuICAgICAgZXhwZWN0KGxpbmVzWzFdKS50b0JlKCcnLnBhZEVuZCgzMSkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZW5kZXIgUE9JIGVudHJpZXMgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgcG9pczogUE9JRW50cnlbXSA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnT0JfMScsXG4gICAgICAgICAgdHlwZTogJ09SREVSX0JMT0NLJyxcbiAgICAgICAgICBkaXJlY3Rpb246ICdCVUxMSVNIJyxcbiAgICAgICAgICBwcmljZTogNTAwMDAsXG4gICAgICAgICAgZGlzdGFuY2U6IDAuMyxcbiAgICAgICAgICBjb25maWRlbmNlOiA4NSxcbiAgICAgICAgICBhZ2U6IDIsXG4gICAgICAgICAgbWl0aWdhdGVkOiBmYWxzZSxcbiAgICAgICAgICBzdHJlbmd0aDogOTBcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnRlZHXzEnLFxuICAgICAgICAgIHR5cGU6ICdGVkcnLFxuICAgICAgICAgIGRpcmVjdGlvbjogJ0JFQVJJU0gnLFxuICAgICAgICAgIHByaWNlOiA0OTUwMCxcbiAgICAgICAgICBkaXN0YW5jZTogLTEuMixcbiAgICAgICAgICBjb25maWRlbmNlOiA3NSxcbiAgICAgICAgICBhZ2U6IDEsXG4gICAgICAgICAgbWl0aWdhdGVkOiBmYWxzZSxcbiAgICAgICAgICBzdHJlbmd0aDogODBcbiAgICAgICAgfVxuICAgICAgXTtcblxuICAgICAgY29tcG9uZW50LnVwZGF0ZUNvbmZpZyh7IHBvaXMgfSk7XG4gICAgICBjb25zdCBsaW5lcyA9IGNvbXBvbmVudC5yZW5kZXIoKTtcblxuICAgICAgZXhwZWN0KGxpbmVzKS50b0hhdmVMZW5ndGgoOSk7XG4gICAgICBleHBlY3QobGluZXNbMF0pLnRvQmUoJ1R5cGUgICAgICBQcmljZSAgICAgRGlzdCAgIENvbmYnKTtcbiAgICAgIGV4cGVjdChsaW5lc1sxXSkudG9Db250YWluKCdPQi1CVUxMJyk7XG4gICAgICBleHBlY3QobGluZXNbMV0pLnRvQ29udGFpbignNTAsMDAwJyk7XG4gICAgICBleHBlY3QobGluZXNbMV0pLnRvQ29udGFpbignKzAuMyUnKTtcbiAgICAgIGV4cGVjdChsaW5lc1sxXSkudG9Db250YWluKCc4NSUnKTtcbiAgICAgIGV4cGVjdChsaW5lc1syXSkudG9Db250YWluKCdGVkctQkVBUicpO1xuICAgICAgZXhwZWN0KGxpbmVzWzJdKS50b0NvbnRhaW4oJzQ5LDUwMCcpO1xuICAgICAgZXhwZWN0KGxpbmVzWzJdKS50b0NvbnRhaW4oJy0xLjIlJyk7XG4gICAgICBleHBlY3QobGluZXNbMl0pLnRvQ29udGFpbignNzUlJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNvcnQgUE9JcyBieSBkaXN0YW5jZSAoY2xvc2VzdCBmaXJzdCknLCAoKSA9PiB7XG4gICAgICBjb25zdCBwb2lzOiBQT0lFbnRyeVtdID0gW1xuICAgICAgICB7XG4gICAgICAgICAgaWQ6ICdQT0lfMScsXG4gICAgICAgICAgdHlwZTogJ09SREVSX0JMT0NLJyxcbiAgICAgICAgICBkaXJlY3Rpb246ICdCVUxMSVNIJyxcbiAgICAgICAgICBwcmljZTogNTAwMDAsXG4gICAgICAgICAgZGlzdGFuY2U6IDIuNSwgLy8gRmFyXG4gICAgICAgICAgY29uZmlkZW5jZTogODAsXG4gICAgICAgICAgYWdlOiAxLFxuICAgICAgICAgIG1pdGlnYXRlZDogZmFsc2UsXG4gICAgICAgICAgc3RyZW5ndGg6IDg1XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ1BPSV8yJyxcbiAgICAgICAgICB0eXBlOiAnRlZHJyxcbiAgICAgICAgICBkaXJlY3Rpb246ICdCRUFSSVNIJyxcbiAgICAgICAgICBwcmljZTogNDk4MDAsXG4gICAgICAgICAgZGlzdGFuY2U6IDAuMiwgLy8gQ2xvc2VcbiAgICAgICAgICBjb25maWRlbmNlOiA5MCxcbiAgICAgICAgICBhZ2U6IDAuNSxcbiAgICAgICAgICBtaXRpZ2F0ZWQ6IGZhbHNlLFxuICAgICAgICAgIHN0cmVuZ3RoOiA5NVxuICAgICAgICB9XG4gICAgICBdO1xuXG4gICAgICBjb21wb25lbnQudXBkYXRlQ29uZmlnKHsgcG9pcyB9KTtcbiAgICAgIGNvbnN0IGxpbmVzID0gY29tcG9uZW50LnJlbmRlcigpO1xuXG4gICAgICAvLyBGVkcgc2hvdWxkIGJlIGZpcnN0IChjbG9zZXIgZGlzdGFuY2UpXG4gICAgICBleHBlY3QobGluZXNbMV0pLnRvQ29udGFpbignRlZHLUJFQVInKTtcbiAgICAgIGV4cGVjdChsaW5lc1sxXSkudG9Db250YWluKCcrMC4yJScpO1xuICAgICAgLy8gT3JkZXIgQmxvY2sgc2hvdWxkIGJlIHNlY29uZCAoZmFydGhlciBkaXN0YW5jZSlcbiAgICAgIGV4cGVjdChsaW5lc1syXSkudG9Db250YWluKCdPQi1CVUxMJyk7XG4gICAgICBleHBlY3QobGluZXNbMl0pLnRvQ29udGFpbignKzIuNSUnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbGltaXQgZGlzcGxheSB0byA4IFBPSXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBwb2lzOiBQT0lFbnRyeVtdID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogMTIgfSwgKF8sIGkpID0+ICh7XG4gICAgICAgIGlkOiBgUE9JXyR7aX1gLFxuICAgICAgICB0eXBlOiAnT1JERVJfQkxPQ0snIGFzIGNvbnN0LFxuICAgICAgICBkaXJlY3Rpb246ICdCVUxMSVNIJyBhcyBjb25zdCxcbiAgICAgICAgcHJpY2U6IDUwMDAwICsgaSAqIDEwMCxcbiAgICAgICAgZGlzdGFuY2U6IGkgKiAwLjEsXG4gICAgICAgIGNvbmZpZGVuY2U6IDgwLFxuICAgICAgICBhZ2U6IDEsXG4gICAgICAgIG1pdGlnYXRlZDogZmFsc2UsXG4gICAgICAgIHN0cmVuZ3RoOiA4NVxuICAgICAgfSkpO1xuXG4gICAgICBjb21wb25lbnQudXBkYXRlQ29uZmlnKHsgcG9pcyB9KTtcbiAgICAgIGNvbnN0IGxpbmVzID0gY29tcG9uZW50LnJlbmRlcigpO1xuXG4gICAgICBleHBlY3QobGluZXMpLnRvSGF2ZUxlbmd0aCg5KTsgLy8gMSBoZWFkZXIgKyA4IGRhdGEgbGluZXNcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgdGhhdCBvbmx5IDggUE9JcyBhcmUgZGlzcGxheWVkIChwbHVzIGhlYWRlcilcbiAgICAgIGxldCBub25FbXB0eUxpbmVzID0gMDtcbiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGxpbmVzW2ldLnRyaW0oKSAhPT0gJycpIHtcbiAgICAgICAgICBub25FbXB0eUxpbmVzKys7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGV4cGVjdChub25FbXB0eUxpbmVzKS50b0JlKDgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnY29sb3IgY29kaW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdXNlIHJlZCBjb2xvciBmb3IgdmVyeSBjbG9zZSBQT0lzICg8IDAuNSUpJywgKCkgPT4ge1xuICAgICAgY29uc3QgcG9pczogUE9JRW50cnlbXSA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnQ0xPU0VfUE9JJyxcbiAgICAgICAgICB0eXBlOiAnT1JERVJfQkxPQ0snLFxuICAgICAgICAgIGRpcmVjdGlvbjogJ0JVTExJU0gnLFxuICAgICAgICAgIHByaWNlOiA1MDAwMCxcbiAgICAgICAgICBkaXN0YW5jZTogMC4zLCAvLyA8IDAuNSVcbiAgICAgICAgICBjb25maWRlbmNlOiA4NSxcbiAgICAgICAgICBhZ2U6IDEsXG4gICAgICAgICAgbWl0aWdhdGVkOiBmYWxzZSxcbiAgICAgICAgICBzdHJlbmd0aDogOTBcbiAgICAgICAgfVxuICAgICAgXTtcblxuICAgICAgY29tcG9uZW50LnVwZGF0ZUNvbmZpZyh7IHBvaXMgfSk7XG4gICAgICBjb25zdCBsaW5lcyA9IGNvbXBvbmVudC5yZW5kZXIoKTtcblxuICAgICAgLy8gU2hvdWxkIGNvbnRhaW4gcmVkIGNvbG9yIGNvZGVcbiAgICAgIGV4cGVjdChsaW5lc1sxXSkudG9Db250YWluKCdcXHgxYlszMW0nKTsgLy8gUmVkIGNvbG9yXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHVzZSB5ZWxsb3cgY29sb3IgZm9yIGNsb3NlIFBPSXMgKDwgMiUpJywgKCkgPT4ge1xuICAgICAgY29uc3QgcG9pczogUE9JRW50cnlbXSA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnQ0xPU0VfUE9JJyxcbiAgICAgICAgICB0eXBlOiAnT1JERVJfQkxPQ0snLFxuICAgICAgICAgIGRpcmVjdGlvbjogJ0JVTExJU0gnLFxuICAgICAgICAgIHByaWNlOiA1MDAwMCxcbiAgICAgICAgICBkaXN0YW5jZTogMS41LCAvLyA8IDIlXG4gICAgICAgICAgY29uZmlkZW5jZTogNzUsXG4gICAgICAgICAgYWdlOiAxLFxuICAgICAgICAgIG1pdGlnYXRlZDogZmFsc2UsXG4gICAgICAgICAgc3RyZW5ndGg6IDgwXG4gICAgICAgIH1cbiAgICAgIF07XG5cbiAgICAgIGNvbXBvbmVudC51cGRhdGVDb25maWcoeyBwb2lzIH0pO1xuICAgICAgY29uc3QgbGluZXMgPSBjb21wb25lbnQucmVuZGVyKCk7XG5cbiAgICAgIC8vIFNob3VsZCBjb250YWluIHllbGxvdyBjb2xvciBjb2RlXG4gICAgICBleHBlY3QobGluZXNbMV0pLnRvQ29udGFpbignXFx4MWJbMzNtJyk7IC8vIFllbGxvdyBjb2xvclxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB1c2Ugd2hpdGUgY29sb3IgZm9yIGZhciBQT0lzICg+PSAyJSknLCAoKSA9PiB7XG4gICAgICBjb25zdCBwb2lzOiBQT0lFbnRyeVtdID0gW1xuICAgICAgICB7XG4gICAgICAgICAgaWQ6ICdGQVJfUE9JJyxcbiAgICAgICAgICB0eXBlOiAnT1JERVJfQkxPQ0snLFxuICAgICAgICAgIGRpcmVjdGlvbjogJ0JVTExJU0gnLFxuICAgICAgICAgIHByaWNlOiA1MDAwMCxcbiAgICAgICAgICBkaXN0YW5jZTogMy4wLCAvLyA+PSAyJVxuICAgICAgICAgIGNvbmZpZGVuY2U6IDcwLFxuICAgICAgICAgIGFnZTogMSxcbiAgICAgICAgICBtaXRpZ2F0ZWQ6IGZhbHNlLFxuICAgICAgICAgIHN0cmVuZ3RoOiA3NVxuICAgICAgICB9XG4gICAgICBdO1xuXG4gICAgICBjb21wb25lbnQudXBkYXRlQ29uZmlnKHsgcG9pcyB9KTtcbiAgICAgIGNvbnN0IGxpbmVzID0gY29tcG9uZW50LnJlbmRlcigpO1xuXG4gICAgICAvLyBTaG91bGQgY29udGFpbiB3aGl0ZSBjb2xvciBjb2RlXG4gICAgICBleHBlY3QobGluZXNbMV0pLnRvQ29udGFpbignXFx4MWJbMzdtJyk7IC8vIFdoaXRlIGNvbG9yXG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdmb3JtYXR0aW5nJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgZm9ybWF0IFBPSSB0eXBlcyBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBwb2lzOiBQT0lFbnRyeVtdID0gW1xuICAgICAgICB7XG4gICAgICAgICAgaWQ6ICdPQl8xJyxcbiAgICAgICAgICB0eXBlOiAnT1JERVJfQkxPQ0snLFxuICAgICAgICAgIGRpcmVjdGlvbjogJ0JVTExJU0gnLFxuICAgICAgICAgIHByaWNlOiA1MDAwMCxcbiAgICAgICAgICBkaXN0YW5jZTogMC41LFxuICAgICAgICAgIGNvbmZpZGVuY2U6IDgwLFxuICAgICAgICAgIGFnZTogMSxcbiAgICAgICAgICBtaXRpZ2F0ZWQ6IGZhbHNlLFxuICAgICAgICAgIHN0cmVuZ3RoOiA4NVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgaWQ6ICdGVkdfMScsXG4gICAgICAgICAgdHlwZTogJ0ZWRycsXG4gICAgICAgICAgZGlyZWN0aW9uOiAnQkVBUklTSCcsXG4gICAgICAgICAgcHJpY2U6IDQ5NTAwLFxuICAgICAgICAgIGRpc3RhbmNlOiAtMC44LFxuICAgICAgICAgIGNvbmZpZGVuY2U6IDc1LFxuICAgICAgICAgIGFnZTogMSxcbiAgICAgICAgICBtaXRpZ2F0ZWQ6IGZhbHNlLFxuICAgICAgICAgIHN0cmVuZ3RoOiA4MFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgaWQ6ICdMSVFfMScsXG4gICAgICAgICAgdHlwZTogJ0xJUVVJRElUWV9QT09MJyxcbiAgICAgICAgICBkaXJlY3Rpb246ICdCVUxMSVNIJyxcbiAgICAgICAgICBwcmljZTogNTAyMDAsXG4gICAgICAgICAgZGlzdGFuY2U6IDEuMixcbiAgICAgICAgICBjb25maWRlbmNlOiA5MCxcbiAgICAgICAgICBhZ2U6IDAuNSxcbiAgICAgICAgICBtaXRpZ2F0ZWQ6IGZhbHNlLFxuICAgICAgICAgIHN0cmVuZ3RoOiA5NSxcbiAgICAgICAgICB2b2x1bWU6IDEwMDAwMDBcbiAgICAgICAgfVxuICAgICAgXTtcblxuICAgICAgY29tcG9uZW50LnVwZGF0ZUNvbmZpZyh7IHBvaXMgfSk7XG4gICAgICBjb25zdCBsaW5lcyA9IGNvbXBvbmVudC5yZW5kZXIoKTtcblxuICAgICAgZXhwZWN0KGxpbmVzWzFdKS50b0NvbnRhaW4oJ09CLUJVTEwnKTtcbiAgICAgIGV4cGVjdChsaW5lc1syXSkudG9Db250YWluKCdGVkctQkVBUicpO1xuICAgICAgZXhwZWN0KGxpbmVzWzNdKS50b0NvbnRhaW4oJ0xJUS1CVUxMJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZvcm1hdCBwcmljZXMgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgcG9pczogUE9JRW50cnlbXSA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnSElHSF9QUklDRScsXG4gICAgICAgICAgdHlwZTogJ09SREVSX0JMT0NLJyxcbiAgICAgICAgICBkaXJlY3Rpb246ICdCVUxMSVNIJyxcbiAgICAgICAgICBwcmljZTogNTAwMDAsIC8vIFNob3VsZCBzaG93IGFzIDUwLDAwMFxuICAgICAgICAgIGRpc3RhbmNlOiAwLjUsXG4gICAgICAgICAgY29uZmlkZW5jZTogODAsXG4gICAgICAgICAgYWdlOiAxLFxuICAgICAgICAgIG1pdGlnYXRlZDogZmFsc2UsXG4gICAgICAgICAgc3RyZW5ndGg6IDg1XG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ0xPV19QUklDRScsXG4gICAgICAgICAgdHlwZTogJ0ZWRycsXG4gICAgICAgICAgZGlyZWN0aW9uOiAnQkVBUklTSCcsXG4gICAgICAgICAgcHJpY2U6IDEuMjM0NSwgLy8gU2hvdWxkIHNob3cgYXMgMS4yM1xuICAgICAgICAgIGRpc3RhbmNlOiAtMC44LFxuICAgICAgICAgIGNvbmZpZGVuY2U6IDc1LFxuICAgICAgICAgIGFnZTogMSxcbiAgICAgICAgICBtaXRpZ2F0ZWQ6IGZhbHNlLFxuICAgICAgICAgIHN0cmVuZ3RoOiA4MFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgaWQ6ICdWRVJZX0xPV19QUklDRScsXG4gICAgICAgICAgdHlwZTogJ0xJUVVJRElUWV9QT09MJyxcbiAgICAgICAgICBkaXJlY3Rpb246ICdCVUxMSVNIJyxcbiAgICAgICAgICBwcmljZTogMC4wMDEyMzQsIC8vIFNob3VsZCBzaG93IGFzIDAuMDAxMlxuICAgICAgICAgIGRpc3RhbmNlOiAxLjIsXG4gICAgICAgICAgY29uZmlkZW5jZTogOTAsXG4gICAgICAgICAgYWdlOiAwLjUsXG4gICAgICAgICAgbWl0aWdhdGVkOiBmYWxzZSxcbiAgICAgICAgICBzdHJlbmd0aDogOTVcbiAgICAgICAgfVxuICAgICAgXTtcblxuICAgICAgY29tcG9uZW50LnVwZGF0ZUNvbmZpZyh7IHBvaXMgfSk7XG4gICAgICBjb25zdCBsaW5lcyA9IGNvbXBvbmVudC5yZW5kZXIoKTtcblxuICAgICAgZXhwZWN0KGxpbmVzWzFdKS50b0NvbnRhaW4oJzUwLDAwMCcpO1xuICAgICAgZXhwZWN0KGxpbmVzWzJdKS50b0NvbnRhaW4oJzEuMjMnKTtcbiAgICAgIGV4cGVjdChsaW5lc1szXSkudG9Db250YWluKCcwLjAwMTInKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZm9ybWF0IGRpc3RhbmNlcyB3aXRoIGNvcnJlY3Qgc2lnbnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBwb2lzOiBQT0lFbnRyeVtdID0gW1xuICAgICAgICB7XG4gICAgICAgICAgaWQ6ICdQT1NJVElWRV9ESVNUJyxcbiAgICAgICAgICB0eXBlOiAnT1JERVJfQkxPQ0snLFxuICAgICAgICAgIGRpcmVjdGlvbjogJ0JVTExJU0gnLFxuICAgICAgICAgIHByaWNlOiA1MDAwMCxcbiAgICAgICAgICBkaXN0YW5jZTogMS41LFxuICAgICAgICAgIGNvbmZpZGVuY2U6IDgwLFxuICAgICAgICAgIGFnZTogMSxcbiAgICAgICAgICBtaXRpZ2F0ZWQ6IGZhbHNlLFxuICAgICAgICAgIHN0cmVuZ3RoOiA4NVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgaWQ6ICdORUdBVElWRV9ESVNUJyxcbiAgICAgICAgICB0eXBlOiAnRlZHJyxcbiAgICAgICAgICBkaXJlY3Rpb246ICdCRUFSSVNIJyxcbiAgICAgICAgICBwcmljZTogNDk1MDAsXG4gICAgICAgICAgZGlzdGFuY2U6IC0yLjMsXG4gICAgICAgICAgY29uZmlkZW5jZTogNzUsXG4gICAgICAgICAgYWdlOiAxLFxuICAgICAgICAgIG1pdGlnYXRlZDogZmFsc2UsXG4gICAgICAgICAgc3RyZW5ndGg6IDgwXG4gICAgICAgIH1cbiAgICAgIF07XG5cbiAgICAgIGNvbXBvbmVudC51cGRhdGVDb25maWcoeyBwb2lzIH0pO1xuICAgICAgY29uc3QgbGluZXMgPSBjb21wb25lbnQucmVuZGVyKCk7XG5cbiAgICAgIGV4cGVjdChsaW5lc1sxXSkudG9Db250YWluKCcrMS41JScpO1xuICAgICAgZXhwZWN0KGxpbmVzWzJdKS50b0NvbnRhaW4oJy0yLjMlJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd1cGRhdGVDb25maWcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB1cGRhdGUgUE9JIGxpc3QgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgaW5pdGlhbFBPSXM6IFBPSUVudHJ5W10gPSBbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ1BPSV8xJyxcbiAgICAgICAgICB0eXBlOiAnT1JERVJfQkxPQ0snLFxuICAgICAgICAgIGRpcmVjdGlvbjogJ0JVTExJU0gnLFxuICAgICAgICAgIHByaWNlOiA1MDAwMCxcbiAgICAgICAgICBkaXN0YW5jZTogMS4wLFxuICAgICAgICAgIGNvbmZpZGVuY2U6IDgwLFxuICAgICAgICAgIGFnZTogMSxcbiAgICAgICAgICBtaXRpZ2F0ZWQ6IGZhbHNlLFxuICAgICAgICAgIHN0cmVuZ3RoOiA4NVxuICAgICAgICB9XG4gICAgICBdO1xuXG4gICAgICBjb21wb25lbnQudXBkYXRlQ29uZmlnKHsgcG9pczogaW5pdGlhbFBPSXMgfSk7XG4gICAgICBsZXQgbGluZXMgPSBjb21wb25lbnQucmVuZGVyKCk7XG4gICAgICBleHBlY3QobGluZXNbMV0pLnRvQ29udGFpbignT0ItQlVMTCcpO1xuXG4gICAgICBjb25zdCB1cGRhdGVkUE9JczogUE9JRW50cnlbXSA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnUE9JXzInLFxuICAgICAgICAgIHR5cGU6ICdGVkcnLFxuICAgICAgICAgIGRpcmVjdGlvbjogJ0JFQVJJU0gnLFxuICAgICAgICAgIHByaWNlOiA0OTUwMCxcbiAgICAgICAgICBkaXN0YW5jZTogLTAuNSxcbiAgICAgICAgICBjb25maWRlbmNlOiA5MCxcbiAgICAgICAgICBhZ2U6IDAuNSxcbiAgICAgICAgICBtaXRpZ2F0ZWQ6IGZhbHNlLFxuICAgICAgICAgIHN0cmVuZ3RoOiA5NVxuICAgICAgICB9XG4gICAgICBdO1xuXG4gICAgICBjb21wb25lbnQudXBkYXRlQ29uZmlnKHsgcG9pczogdXBkYXRlZFBPSXMgfSk7XG4gICAgICBsaW5lcyA9IGNvbXBvbmVudC5yZW5kZXIoKTtcbiAgICAgIGV4cGVjdChsaW5lc1sxXSkudG9Db250YWluKCdGVkctQkVBUicpO1xuICAgICAgZXhwZWN0KGxpbmVzWzFdKS5ub3QudG9Db250YWluKCdPQi1CVUxMJyk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sInZlcnNpb24iOjN9