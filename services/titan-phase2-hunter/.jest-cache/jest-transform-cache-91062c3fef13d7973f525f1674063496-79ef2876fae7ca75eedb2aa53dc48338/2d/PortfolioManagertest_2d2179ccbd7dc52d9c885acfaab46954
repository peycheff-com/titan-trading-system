c3b9913baed6fefec63f756bff49861a
"use strict";
/**
 * Unit tests for PortfolioManager
 * Tests multi-symbol portfolio management functionality
 */
Object.defineProperty(exports, "__esModule", { value: true });
const PortfolioManager_1 = require("../../src/risk/PortfolioManager");
describe('PortfolioManager', () => {
    let portfolioManager;
    let mockPositions;
    let mockSignals;
    beforeEach(() => {
        // Create portfolio manager with test config
        const config = {
            maxTotalExposure: 2.0, // 200% of equity
            maxConcurrentPositions: 5,
            baseRiskPercent: 0.02, // 2%
            maxPortfolioHeat: 0.15, // 15%
            directionalBiasThreshold: 0.6, // 60%
            directionalBiasReduction: 0.2, // 20%
            alignmentScoreWeight: 0.7, // 70%
            rsScoreWeight: 0.3, // 30%
            maxSignalsToRank: 10
        };
        portfolioManager = new PortfolioManager_1.PortfolioManager(config);
        // Create mock positions
        mockPositions = [
            {
                id: 'pos-1',
                symbol: 'BTCUSDT',
                side: 'LONG',
                entryPrice: 50000,
                currentPrice: 51000,
                quantity: 0.1,
                leverage: 3,
                stopLoss: 49250, // 1.5% stop
                takeProfit: 52250, // 4.5% target
                unrealizedPnL: 100,
                realizedPnL: 0,
                entryTime: Date.now() - (24 * 60 * 60 * 1000), // 24 hours ago
                status: 'OPEN',
                rValue: 1.33, // (51000-50000)/(50000-49250) = 1.33R
                atr: 1000
            },
            {
                id: 'pos-2',
                symbol: 'ETHUSDT',
                side: 'LONG',
                entryPrice: 3000,
                currentPrice: 3100,
                quantity: 1,
                leverage: 4,
                stopLoss: 2955, // 1.5% stop
                takeProfit: 3135, // 4.5% target
                unrealizedPnL: 100,
                realizedPnL: 0,
                entryTime: Date.now() - (12 * 60 * 60 * 1000), // 12 hours ago
                status: 'OPEN',
                rValue: 2.22, // (3100-3000)/(3000-2955) = 2.22R
                atr: 50
            }
        ];
        // Create mock signals with hologram states
        mockSignals = [
            {
                signal: {
                    symbol: 'ADAUSDT',
                    direction: 'LONG',
                    hologramStatus: 'A+',
                    alignmentScore: 95,
                    rsScore: 0.05,
                    sessionType: 'LONDON',
                    poiType: 'ORDER_BLOCK',
                    cvdConfirmation: true,
                    confidence: 90,
                    entryPrice: 0.5,
                    stopLoss: 0.4925,
                    takeProfit: 0.5225,
                    positionSize: 1000,
                    leverage: 3,
                    timestamp: Date.now()
                },
                hologramState: {
                    symbol: 'ADAUSDT',
                    timestamp: Date.now(),
                    daily: {},
                    h4: {},
                    m15: {},
                    alignmentScore: 95,
                    status: 'A+',
                    veto: { vetoed: false, reason: null, direction: null },
                    rsScore: 0.05
                }
            },
            {
                signal: {
                    symbol: 'SOLUSDT',
                    direction: 'SHORT',
                    hologramStatus: 'B',
                    alignmentScore: 75,
                    rsScore: -0.03,
                    sessionType: 'NY',
                    poiType: 'FVG',
                    cvdConfirmation: true,
                    confidence: 80,
                    entryPrice: 100,
                    stopLoss: 101.5,
                    takeProfit: 95.5,
                    positionSize: 10,
                    leverage: 4,
                    timestamp: Date.now()
                },
                hologramState: {
                    symbol: 'SOLUSDT',
                    timestamp: Date.now(),
                    daily: {},
                    h4: {},
                    m15: {},
                    alignmentScore: 75,
                    status: 'B',
                    veto: { vetoed: false, reason: null, direction: null },
                    rsScore: -0.03
                }
            }
        ];
    });
    afterEach(() => {
        portfolioManager.destroy();
    });
    describe('calcTotalExposure', () => {
        it('should calculate total exposure correctly', () => {
            const totalEquity = 10000;
            const exposure = portfolioManager.calcTotalExposure(mockPositions, totalEquity);
            // Position 1: 0.1 * 51000 * 3 = 15300
            // Position 2: 1 * 3100 * 4 = 12400
            // Total: 27700, Exposure: 27700/10000 = 2.77 (277%)
            // Capped at 2.0 (200%)
            expect(exposure).toBe(2.0);
        });
        it('should return 0 for zero equity', () => {
            const exposure = portfolioManager.calcTotalExposure(mockPositions, 0);
            expect(exposure).toBe(0);
        });
        it('should handle empty positions', () => {
            const exposure = portfolioManager.calcTotalExposure([], 10000);
            expect(exposure).toBe(0);
        });
    });
    describe('enforceMaxPositions', () => {
        it('should allow new position when under limit', () => {
            const canOpen = portfolioManager.enforceMaxPositions(mockPositions);
            expect(canOpen).toBe(true); // 2 positions < 5 limit
        });
        it('should reject new position when at limit', () => {
            // Create 5 positions to hit the limit
            const maxPositions = Array(5).fill(null).map((_, i) => ({
                ...mockPositions[0],
                id: `pos-${i}`,
                status: 'OPEN'
            }));
            const canOpen = portfolioManager.enforceMaxPositions(maxPositions);
            expect(canOpen).toBe(false);
        });
        it('should only count open positions', () => {
            const positionsWithClosed = [
                ...mockPositions,
                { ...mockPositions[0], id: 'pos-3', status: 'CLOSED' },
                { ...mockPositions[0], id: 'pos-4', status: 'CLOSED' }
            ];
            const canOpen = portfolioManager.enforceMaxPositions(positionsWithClosed);
            expect(canOpen).toBe(true); // Only 2 open positions
        });
    });
    describe('allocateRiskPerTrade', () => {
        it('should allocate risk dynamically based on open positions', () => {
            const totalEquity = 10000;
            const allocation = portfolioManager.allocateRiskPerTrade(totalEquity, mockPositions);
            // Base risk: 2%, Open positions: 2, Adjusted: 2% / (2+1) = 0.67%
            expect(allocation.baseRiskPerTrade).toBe(0.02);
            expect(allocation.adjustedRiskPerTrade).toBeCloseTo(0.0067, 4);
            expect(allocation.maxPositionSize).toBeCloseTo(4467, 0); // (10000 * 0.0067) / 0.015
            expect(allocation.recommendedLeverage).toBeGreaterThan(1);
            expect(allocation.recommendedLeverage).toBeLessThanOrEqual(5);
        });
        it('should handle no open positions', () => {
            const totalEquity = 10000;
            const allocation = portfolioManager.allocateRiskPerTrade(totalEquity, []);
            // No positions: 2% / 1 = 2%
            expect(allocation.adjustedRiskPerTrade).toBe(0.02);
        });
    });
    describe('rankSignals', () => {
        it('should rank signals by composite score', () => {
            const ranked = portfolioManager.rankSignals(mockSignals);
            expect(ranked).toHaveLength(2);
            expect(ranked[0].rank).toBe(1);
            expect(ranked[1].rank).toBe(2);
            // First signal should have higher composite score (A+ with 95 alignment)
            expect(ranked[0].compositeScore).toBeGreaterThan(ranked[1].compositeScore);
            expect(ranked[0].signal.symbol).toBe('ADAUSDT');
        });
        it('should limit to top 3 signals', () => {
            // Add more signals
            const moreSignals = [
                ...mockSignals,
                ...Array(5).fill(null).map((_, i) => ({
                    signal: { ...mockSignals[0].signal, symbol: `TEST${i}USDT` },
                    hologramState: { ...mockSignals[0].hologramState, alignmentScore: 60 - i }
                }))
            ];
            const ranked = portfolioManager.rankSignals(moreSignals);
            expect(ranked).toHaveLength(3); // Limited to top 3
        });
        it('should handle empty signals array', () => {
            const ranked = portfolioManager.rankSignals([]);
            expect(ranked).toHaveLength(0);
        });
    });
    describe('checkPortfolioHeat', () => {
        it('should calculate portfolio heat correctly', () => {
            const totalEquity = 10000;
            const canTrade = portfolioManager.checkPortfolioHeat(mockPositions, totalEquity);
            // Position 1 risk: (50000-49250) * 0.1 = 75
            // Position 2 risk: (3000-2955) * 1 = 45
            // Total risk: 120, Heat: 120/10000 = 1.2% < 15%
            expect(canTrade).toBe(true);
        });
        it('should reject when portfolio heat exceeds limit', () => {
            // Create high-risk positions
            const highRiskPositions = mockPositions.map(pos => ({
                ...pos,
                quantity: pos.quantity * 50 // Increase quantity to increase risk
            }));
            const totalEquity = 1000; // Small equity to increase heat percentage
            const canTrade = portfolioManager.checkPortfolioHeat(highRiskPositions, totalEquity);
            expect(canTrade).toBe(false);
        });
        it('should return false for zero equity', () => {
            const canTrade = portfolioManager.checkPortfolioHeat(mockPositions, 0);
            expect(canTrade).toBe(false);
        });
    });
    describe('adjustForDirectionalBias', () => {
        it('should not adjust when no directional bias', () => {
            // Mixed positions (1 LONG, 1 SHORT)
            const mixedPositions = [
                mockPositions[0], // LONG
                { ...mockPositions[1], side: 'SHORT' } // SHORT
            ];
            const adjustedSize = portfolioManager.adjustForDirectionalBias(mixedPositions, 'LONG', 1000);
            expect(adjustedSize).toBe(1000); // No adjustment
        });
        it('should reduce position size when adding to directional bias', () => {
            // All LONG positions (100% bias)
            const longPositions = mockPositions; // Both are LONG
            const adjustedSize = portfolioManager.adjustForDirectionalBias(longPositions, 'LONG', 1000);
            // Should reduce by 20%: 1000 * (1 - 0.2) = 800
            expect(adjustedSize).toBe(800);
        });
        it('should not adjust when going against directional bias', () => {
            // All LONG positions
            const longPositions = mockPositions; // Both are LONG
            const adjustedSize = portfolioManager.adjustForDirectionalBias(longPositions, 'SHORT', 1000);
            expect(adjustedSize).toBe(1000); // No adjustment when going against bias
        });
        it('should handle empty positions', () => {
            const adjustedSize = portfolioManager.adjustForDirectionalBias([], 'LONG', 1000);
            expect(adjustedSize).toBe(1000); // No adjustment with no positions
        });
    });
    describe('updatePortfolioState', () => {
        it('should update portfolio state correctly', () => {
            const totalEquity = 10000;
            portfolioManager.updatePortfolioState(mockPositions, totalEquity);
            const state = portfolioManager.getPortfolioState();
            expect(state.totalEquity).toBe(totalEquity);
            expect(state.openPositions).toHaveLength(2);
            expect(state.directionalBias).toBe('LONG'); // Both positions are LONG
            expect(state.biasPercentage).toBe(1.0); // 100% LONG
            expect(state.totalUnrealizedPnL).toBe(200); // 100 + 100
            expect(state.totalRealizedPnL).toBe(0);
        });
        it('should detect neutral bias with mixed positions', () => {
            const mixedPositions = [
                mockPositions[0], // LONG
                { ...mockPositions[1], side: 'SHORT' } // SHORT
            ];
            portfolioManager.updatePortfolioState(mixedPositions, 10000);
            const state = portfolioManager.getPortfolioState();
            expect(state.directionalBias).toBe('NEUTRAL');
            expect(state.biasPercentage).toBe(0);
        });
    });
    describe('canAcceptSignal', () => {
        beforeEach(() => {
            // Add positions to portfolio manager
            mockPositions.forEach(pos => portfolioManager.addPosition(pos));
            portfolioManager.updatePortfolioState(mockPositions, 10000);
        });
        it('should accept signal when all limits are within bounds', () => {
            const canAccept = portfolioManager.canAcceptSignal(mockSignals[0].signal, mockSignals[0].hologramState, 10000);
            expect(canAccept).toBe(true);
        });
        it('should reject signal when position limit exceeded', () => {
            // Add more positions to hit the limit
            for (let i = 3; i <= 5; i++) {
                portfolioManager.addPosition({
                    ...mockPositions[0],
                    id: `pos-${i}`,
                    status: 'OPEN'
                });
            }
            const canAccept = portfolioManager.canAcceptSignal(mockSignals[0].signal, mockSignals[0].hologramState, 10000);
            expect(canAccept).toBe(false);
        });
    });
    describe('getPortfolioStatistics', () => {
        beforeEach(() => {
            mockPositions.forEach(pos => portfolioManager.addPosition(pos));
            portfolioManager.updatePortfolioState(mockPositions, 10000);
        });
        it('should return correct portfolio statistics', () => {
            const stats = portfolioManager.getPortfolioStatistics();
            expect(stats.totalPositions).toBe(2);
            expect(stats.openPositions).toBe(2);
            expect(stats.exposureUtilization).toBeGreaterThan(0);
            expect(stats.heatUtilization).toBeGreaterThan(0);
            expect(stats.positionUtilization).toBe(0.4); // 2/5 = 0.4
            expect(stats.avgPositionSize).toBeGreaterThan(0);
            expect(stats.largestPosition).toBeGreaterThan(0);
            expect(stats.directionalBias).toContain('LONG');
            expect(stats.totalPnL).toBe(200);
        });
    });
    describe('position management', () => {
        it('should add and remove positions correctly', () => {
            const position = mockPositions[0];
            portfolioManager.addPosition(position);
            expect(portfolioManager.getAllPositions()).toHaveLength(1);
            portfolioManager.removePosition(position.id);
            expect(portfolioManager.getAllPositions()).toHaveLength(0);
        });
        it('should update positions correctly', () => {
            const position = mockPositions[0];
            portfolioManager.addPosition(position);
            const updatedPosition = { ...position, currentPrice: 52000 };
            portfolioManager.updatePosition(updatedPosition);
            const retrieved = portfolioManager.getAllPositions()[0];
            expect(retrieved.currentPrice).toBe(52000);
        });
        it('should get open positions only', () => {
            const openPosition = mockPositions[0];
            const closedPosition = { ...mockPositions[1], status: 'CLOSED' };
            portfolioManager.addPosition(openPosition);
            portfolioManager.addPosition(closedPosition);
            const openPositions = portfolioManager.getOpenPositions();
            expect(openPositions).toHaveLength(1);
            expect(openPositions[0].status).toBe('OPEN');
        });
        it('should clear all positions', () => {
            mockPositions.forEach(pos => portfolioManager.addPosition(pos));
            expect(portfolioManager.getAllPositions()).toHaveLength(2);
            portfolioManager.clearPositions();
            expect(portfolioManager.getAllPositions()).toHaveLength(0);
        });
    });
    describe('configuration', () => {
        it('should update configuration correctly', () => {
            const newConfig = { maxConcurrentPositions: 10 };
            portfolioManager.updateConfig(newConfig);
            // Test that new config is applied
            const positions = Array(8).fill(null).map((_, i) => ({
                ...mockPositions[0],
                id: `pos-${i}`,
                status: 'OPEN'
            }));
            const canOpen = portfolioManager.enforceMaxPositions(positions);
            expect(canOpen).toBe(true); // Should allow since limit is now 10
        });
    });
    describe('event emission', () => {
        it('should emit portfolio updated event', (done) => {
            portfolioManager.on('portfolio:updated', (state) => {
                expect(state.totalEquity).toBe(10000);
                expect(state.openPositions).toHaveLength(2);
                done();
            });
            portfolioManager.updatePortfolioState(mockPositions, 10000);
        });
        it('should emit signal rejected event', (done) => {
            portfolioManager.on('portfolio:signal_rejected', (signal, reason) => {
                expect(signal.symbol).toBe('ADAUSDT');
                expect(reason).toBe('POSITION_LIMIT_EXCEEDED');
                done();
            });
            // Add positions to hit limit
            for (let i = 1; i <= 5; i++) {
                portfolioManager.addPosition({
                    ...mockPositions[0],
                    id: `pos-${i}`,
                    status: 'OPEN'
                });
            }
            portfolioManager.canAcceptSignal(mockSignals[0].signal, mockSignals[0].hologramState, 10000);
        });
        it('should emit directional bias event', (done) => {
            portfolioManager.on('portfolio:directional_bias', (bias, percentage) => {
                expect(bias).toBe('LONG');
                expect(percentage).toBe(1.0);
                done();
            });
            portfolioManager.adjustForDirectionalBias(mockPositions, 'LONG', 1000);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2l2YW4vQ29kZS90cmFkaW5nL3RpdGFuL3NlcnZpY2VzL3RpdGFuLXBoYXNlMi1odW50ZXIvdGVzdHMvdW5pdC9Qb3J0Zm9saW9NYW5hZ2VyLnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7R0FHRzs7QUFFSCxzRUFBMkY7QUFHM0YsUUFBUSxDQUFDLGtCQUFrQixFQUFFLEdBQUcsRUFBRTtJQUNoQyxJQUFJLGdCQUFrQyxDQUFDO0lBQ3ZDLElBQUksYUFBeUIsQ0FBQztJQUM5QixJQUFJLFdBQXdFLENBQUM7SUFFN0UsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNkLDRDQUE0QztRQUM1QyxNQUFNLE1BQU0sR0FBb0M7WUFDOUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFLGlCQUFpQjtZQUN4QyxzQkFBc0IsRUFBRSxDQUFDO1lBQ3pCLGVBQWUsRUFBRSxJQUFJLEVBQUUsS0FBSztZQUM1QixnQkFBZ0IsRUFBRSxJQUFJLEVBQUUsTUFBTTtZQUM5Qix3QkFBd0IsRUFBRSxHQUFHLEVBQUUsTUFBTTtZQUNyQyx3QkFBd0IsRUFBRSxHQUFHLEVBQUUsTUFBTTtZQUNyQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUUsTUFBTTtZQUNqQyxhQUFhLEVBQUUsR0FBRyxFQUFFLE1BQU07WUFDMUIsZ0JBQWdCLEVBQUUsRUFBRTtTQUNyQixDQUFDO1FBRUYsZ0JBQWdCLEdBQUcsSUFBSSxtQ0FBZ0IsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUVoRCx3QkFBd0I7UUFDeEIsYUFBYSxHQUFHO1lBQ2Q7Z0JBQ0UsRUFBRSxFQUFFLE9BQU87Z0JBQ1gsTUFBTSxFQUFFLFNBQVM7Z0JBQ2pCLElBQUksRUFBRSxNQUFNO2dCQUNaLFVBQVUsRUFBRSxLQUFLO2dCQUNqQixZQUFZLEVBQUUsS0FBSztnQkFDbkIsUUFBUSxFQUFFLEdBQUc7Z0JBQ2IsUUFBUSxFQUFFLENBQUM7Z0JBQ1gsUUFBUSxFQUFFLEtBQUssRUFBRSxZQUFZO2dCQUM3QixVQUFVLEVBQUUsS0FBSyxFQUFFLGNBQWM7Z0JBQ2pDLGFB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RTtZQUNoRCxnQkFBZ0IsQ0FBQyxFQUFFLENBQUMsNEJBQTRCLEVBQUUsQ0FBQyxJQUFJLEVBQUUsVUFBVSxFQUFFLEVBQUU7Z0JBQ3JFLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7Z0JBQzFCLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBQzdCLElBQUksRUFBRSxDQUFDO1lBQ1QsQ0FBQyxDQUFDLENBQUM7WUFFSCxnQkFBZ0IsQ0FBQyx3QkFBd0IsQ0FBQyxhQUFhLEVBQUUsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3pFLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvaXZhbi9Db2RlL3RyYWRpbmcvdGl0YW4vc2VydmljZXMvdGl0YW4tcGhhc2UyLWh1bnRlci90ZXN0cy91bml0L1BvcnRmb2xpb01hbmFnZXIudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFVuaXQgdGVzdHMgZm9yIFBvcnRmb2xpb01hbmFnZXJcbiAqIFRlc3RzIG11bHRpLXN5bWJvbCBwb3J0Zm9saW8gbWFuYWdlbWVudCBmdW5jdGlvbmFsaXR5XG4gKi9cblxuaW1wb3J0IHsgUG9ydGZvbGlvTWFuYWdlciwgUG9ydGZvbGlvTWFuYWdlckNvbmZpZyB9IGZyb20gJy4uLy4uL3NyYy9yaXNrL1BvcnRmb2xpb01hbmFnZXInO1xuaW1wb3J0IHsgUG9zaXRpb24sIFNpZ25hbERhdGEsIEhvbG9ncmFtU3RhdGUgfSBmcm9tICcuLi8uLi9zcmMvdHlwZXMnO1xuXG5kZXNjcmliZSgnUG9ydGZvbGlvTWFuYWdlcicsICgpID0+IHtcbiAgbGV0IHBvcnRmb2xpb01hbmFnZXI6IFBvcnRmb2xpb01hbmFnZXI7XG4gIGxldCBtb2NrUG9zaXRpb25zOiBQb3NpdGlvbltdO1xuICBsZXQgbW9ja1NpZ25hbHM6IEFycmF5PHsgc2lnbmFsOiBTaWduYWxEYXRhOyBob2xvZ3JhbVN0YXRlOiBIb2xvZ3JhbVN0YXRlIH0+O1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIC8vIENyZWF0ZSBwb3J0Zm9saW8gbWFuYWdlciB3aXRoIHRlc3QgY29uZmlnXG4gICAgY29uc3QgY29uZmlnOiBQYXJ0aWFsPFBvcnRmb2xpb01hbmFnZXJDb25maWc+ID0ge1xuICAgICAgbWF4VG90YWxFeHBvc3VyZTogMi4wLCAvLyAyMDAlIG9mIGVxdWl0eVxuICAgICAgbWF4Q29uY3VycmVudFBvc2l0aW9uczogNSxcbiAgICAgIGJhc2VSaXNrUGVyY2VudDogMC4wMiwgLy8gMiVcbiAgICAgIG1heFBvcnRmb2xpb0hlYXQ6IDAuMTUsIC8vIDE1JVxuICAgICAgZGlyZWN0aW9uYWxCaWFzVGhyZXNob2xkOiAwLjYsIC8vIDYwJVxuICAgICAgZGlyZWN0aW9uYWxCaWFzUmVkdWN0aW9uOiAwLjIsIC8vIDIwJVxuICAgICAgYWxpZ25tZW50U2NvcmVXZWlnaHQ6IDAuNywgLy8gNzAlXG4gICAgICByc1Njb3JlV2VpZ2h0OiAwLjMsIC8vIDMwJVxuICAgICAgbWF4U2lnbmFsc1RvUmFuazogMTBcbiAgICB9O1xuXG4gICAgcG9ydGZvbGlvTWFuYWdlciA9IG5ldyBQb3J0Zm9saW9NYW5hZ2VyKGNvbmZpZyk7XG5cbiAgICAvLyBDcmVhdGUgbW9jayBwb3NpdGlvbnNcbiAgICBtb2NrUG9zaXRpb25zID0gW1xuICAgICAge1xuICAgICAgICBpZDogJ3Bvcy0xJyxcbiAgICAgICAgc3ltYm9sOiAnQlRDVVNEVCcsXG4gICAgICAgIHNpZGU6ICdMT05HJyxcbiAgICAgICAgZW50cnlQcmljZTogNTAwMDAsXG4gICAgICAgIGN1cnJlbnRQcmljZTogNTEwMDAsXG4gICAgICAgIHF1YW50aXR5OiAwLjEsXG4gICAgICAgIGxldmVyYWdlOiAzLFxuICAgICAgICBzdG9wTG9zczogNDkyNTAsIC8vIDEuNSUgc3RvcFxuICAgICAgICB0YWtlUHJvZml0OiA1MjI1MCwgLy8gNC41JSB0YXJnZXRcbiAgICAgICAgdW5yZWFsaXplZFBuTDogMTAwLFxuICAgICAgICByZWFsaXplZFBuTDogMCxcbiAgICAgICAgZW50cnlUaW1lOiBEYXRlLm5vdygpIC0gKDI0ICogNjAgKiA2MCAqIDEwMDApLCAvLyAyNCBob3VycyBhZ29cbiAgICAgICAgc3RhdHVzOiAnT1BFTicsXG4gICAgICAgIHJWYWx1ZTogMS4zMywgLy8gKDUxMDAwLTUwMDAwKS8oNTAwMDAtNDkyNTApID0gMS4zM1JcbiAgICAgICAgYXRyOiAxMDAwXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBpZDogJ3Bvcy0yJyxcbiAgICAgICAgc3ltYm9sOiAnRVRIVVNEVCcsXG4gICAgICAgIHNpZGU6ICdMT05HJyxcbiAgICAgICAgZW50cnlQcmljZTogMzAwMCxcbiAgICAgICAgY3VycmVudFByaWNlOiAzMTAwLFxuICAgICAgICBxdWFudGl0eTogMSxcbiAgICAgICAgbGV2ZXJhZ2U6IDQsXG4gICAgICAgIHN0b3BMb3NzOiAyOTU1LCAvLyAxLjUlIHN0b3BcbiAgICAgICAgdGFrZVByb2ZpdDogMzEzNSwgLy8gNC41JSB0YXJnZXRcbiAgICAgICAgdW5yZWFsaXplZFBuTDogMTAwLFxuICAgICAgICByZWFsaXplZFBuTDogMCxcbiAgICAgICAgZW50cnlUaW1lOiBEYXRlLm5vdygpIC0gKDEyICogNjAgKiA2MCAqIDEwMDApLCAvLyAxMiBob3VycyBhZ29cbiAgICAgICAgc3RhdHVzOiAnT1BFTicsXG4gICAgICAgIHJWYWx1ZTogMi4yMiwgLy8gKDMxMDAtMzAwMCkvKDMwMDAtMjk1NSkgPSAyLjIyUlxuICAgICAgICBhdHI6IDUwXG4gICAgICB9XG4gICAgXTtcblxuICAgIC8vIENyZWF0ZSBtb2NrIHNpZ25hbHMgd2l0aCBob2xvZ3JhbSBzdGF0ZXNcbiAgICBtb2NrU2lnbmFscyA9IFtcbiAgICAgIHtcbiAgICAgICAgc2lnbmFsOiB7XG4gICAgICAgICAgc3ltYm9sOiAnQURBVVNEVCcsXG4gICAgICAgICAgZGlyZWN0aW9uOiAnTE9ORycsXG4gICAgICAgICAgaG9sb2dyYW1TdGF0dXM6ICdBKycsXG4gICAgICAgICAgYWxpZ25tZW50U2NvcmU6IDk1LFxuICAgICAgICAgIHJzU2NvcmU6IDAuMDUsXG4gICAgICAgICAgc2Vzc2lvblR5cGU6ICdMT05ET04nLFxuICAgICAgICAgIHBvaVR5cGU6ICdPUkRFUl9CTE9DSycsXG4gICAgICAgICAgY3ZkQ29uZmlybWF0aW9uOiB0cnVlLFxuICAgICAgICAgIGNvbmZpZGVuY2U6IDkwLFxuICAgICAgICAgIGVudHJ5UHJpY2U6IDAuNSxcbiAgICAgICAgICBzdG9wTG9zczogMC40OTI1LFxuICAgICAgICAgIHRha2VQcm9maXQ6IDAuNTIyNSxcbiAgICAgICAgICBwb3NpdGlvblNpemU6IDEwMDAsXG4gICAgICAgICAgbGV2ZXJhZ2U6IDMsXG4gICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpXG4gICAgICAgIH0sXG4gICAgICAgIGhvbG9ncmFtU3RhdGU6IHtcbiAgICAgICAgICBzeW1ib2w6ICdBREFVU0RUJyxcbiAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgICAgZGFpbHk6IHt9IGFzIGFueSxcbiAgICAgICAgICBoNDoge30gYXMgYW55LFxuICAgICAgICAgIG0xNToge30gYXMgYW55LFxuICAgICAgICAgIGFsaWdubWVudFNjb3JlOiA5NSxcbiAgICAgICAgICBzdGF0dXM6ICdBKycsXG4gICAgICAgICAgdmV0bzogeyB2ZXRvZWQ6IGZhbHNlLCByZWFzb246IG51bGwsIGRpcmVjdGlvbjogbnVsbCB9LFxuICAgICAgICAgIHJzU2NvcmU6IDAuMDVcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgc2lnbmFsOiB7XG4gICAgICAgICAgc3ltYm9sOiAnU09MVVNEVCcsXG4gICAgICAgICAgZGlyZWN0aW9uOiAnU0hPUlQnLFxuICAgICAgICAgIGhvbG9ncmFtU3RhdHVzOiAnQicsXG4gICAgICAgICAgYWxpZ25tZW50U2NvcmU6IDc1LFxuICAgICAgICAgIHJzU2NvcmU6IC0wLjAzLFxuICAgICAgICAgIHNlc3Npb25UeXBlOiAnTlknLFxuICAgICAgICAgIHBvaVR5cGU6ICdGVkcnLFxuICAgICAgICAgIGN2ZENvbmZpcm1hdGlvbjogdHJ1ZSxcbiAgICAgICAgICBjb25maWRlbmNlOiA4MCxcbiAgICAgICAgICBlbnRyeVByaWNlOiAxMDAsXG4gICAgICAgICAgc3RvcExvc3M6IDEwMS41LFxuICAgICAgICAgIHRha2VQcm9maXQ6IDk1LjUsXG4gICAgICAgICAgcG9zaXRpb25TaXplOiAxMCxcbiAgICAgICAgICBsZXZlcmFnZTogNCxcbiAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KClcbiAgICAgICAgfSxcbiAgICAgICAgaG9sb2dyYW1TdGF0ZToge1xuICAgICAgICAgIHN5bWJvbDogJ1NPTFVTRFQnLFxuICAgICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgICBkYWlseToge30gYXMgYW55LFxuICAgICAgICAgIGg0OiB7fSBhcyBhbnksXG4gICAgICAgICAgbTE1OiB7fSBhcyBhbnksXG4gICAgICAgICAgYWxpZ25tZW50U2NvcmU6IDc1LFxuICAgICAgICAgIHN0YXR1czogJ0InLFxuICAgICAgICAgIHZldG86IHsgdmV0b2VkOiBmYWxzZSwgcmVhc29uOiBudWxsLCBkaXJlY3Rpb246IG51bGwgfSxcbiAgICAgICAgICByc1Njb3JlOiAtMC4wM1xuICAgICAgICB9XG4gICAgICB9XG4gICAgXTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBwb3J0Zm9saW9NYW5hZ2VyLmRlc3Ryb3koKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2NhbGNUb3RhbEV4cG9zdXJlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY2FsY3VsYXRlIHRvdGFsIGV4cG9zdXJlIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIGNvbnN0IHRvdGFsRXF1aXR5ID0gMTAwMDA7XG4gICAgICBjb25zdCBleHBvc3VyZSA9IHBvcnRmb2xpb01hbmFnZXIuY2FsY1RvdGFsRXhwb3N1cmUobW9ja1Bvc2l0aW9ucywgdG90YWxFcXVpdHkpO1xuICAgICAgXG4gICAgICAvLyBQb3NpdGlvbiAxOiAwLjEgKiA1MTAwMCAqIDMgPSAxNTMwMFxuICAgICAgLy8gUG9zaXRpb24gMjogMSAqIDMxMDAgKiA0ID0gMTI0MDBcbiAgICAgIC8vIFRvdGFsOiAyNzcwMCwgRXhwb3N1cmU6IDI3NzAwLzEwMDAwID0gMi43NyAoMjc3JSlcbiAgICAgIC8vIENhcHBlZCBhdCAyLjAgKDIwMCUpXG4gICAgICBleHBlY3QoZXhwb3N1cmUpLnRvQmUoMi4wKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIDAgZm9yIHplcm8gZXF1aXR5JywgKCkgPT4ge1xuICAgICAgY29uc3QgZXhwb3N1cmUgPSBwb3J0Zm9saW9NYW5hZ2VyLmNhbGNUb3RhbEV4cG9zdXJlKG1vY2tQb3NpdGlvbnMsIDApO1xuICAgICAgZXhwZWN0KGV4cG9zdXJlKS50b0JlKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgcG9zaXRpb25zJywgKCkgPT4ge1xuICAgICAgY29uc3QgZXhwb3N1cmUgPSBwb3J0Zm9saW9NYW5hZ2VyLmNhbGNUb3RhbEV4cG9zdXJlKFtdLCAxMDAwMCk7XG4gICAgICBleHBlY3QoZXhwb3N1cmUpLnRvQmUoMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdlbmZvcmNlTWF4UG9zaXRpb25zJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYWxsb3cgbmV3IHBvc2l0aW9uIHdoZW4gdW5kZXIgbGltaXQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBjYW5PcGVuID0gcG9ydGZvbGlvTWFuYWdlci5lbmZvcmNlTWF4UG9zaXRpb25zKG1vY2tQb3NpdGlvbnMpO1xuICAgICAgZXhwZWN0KGNhbk9wZW4pLnRvQmUodHJ1ZSk7IC8vIDIgcG9zaXRpb25zIDwgNSBsaW1pdFxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgbmV3IHBvc2l0aW9uIHdoZW4gYXQgbGltaXQnLCAoKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgNSBwb3NpdGlvbnMgdG8gaGl0IHRoZSBsaW1pdFxuICAgICAgY29uc3QgbWF4UG9zaXRpb25zID0gQXJyYXkoNSkuZmlsbChudWxsKS5tYXAoKF8sIGkpID0+ICh7XG4gICAgICAgIC4uLm1vY2tQb3NpdGlvbnNbMF0sXG4gICAgICAgIGlkOiBgcG9zLSR7aX1gLFxuICAgICAgICBzdGF0dXM6ICdPUEVOJyBhcyBjb25zdFxuICAgICAgfSkpO1xuICAgICAgXG4gICAgICBjb25zdCBjYW5PcGVuID0gcG9ydGZvbGlvTWFuYWdlci5lbmZvcmNlTWF4UG9zaXRpb25zKG1heFBvc2l0aW9ucyk7XG4gICAgICBleHBlY3QoY2FuT3BlbikudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG9ubHkgY291bnQgb3BlbiBwb3NpdGlvbnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBwb3NpdGlvbnNXaXRoQ2xvc2VkID0gW1xuICAgICAgICAuLi5tb2NrUG9zaXRpb25zLFxuICAgICAgICB7IC4uLm1vY2tQb3NpdGlvbnNbMF0sIGlkOiAncG9zLTMnLCBzdGF0dXM6ICdDTE9TRUQnIGFzIGNvbnN0IH0sXG4gICAgICAgIHsgLi4ubW9ja1Bvc2l0aW9uc1swXSwgaWQ6ICdwb3MtNCcsIHN0YXR1czogJ0NMT1NFRCcgYXMgY29uc3QgfVxuICAgICAgXTtcbiAgICAgIFxuICAgICAgY29uc3QgY2FuT3BlbiA9IHBvcnRmb2xpb01hbmFnZXIuZW5mb3JjZU1heFBvc2l0aW9ucyhwb3NpdGlvbnNXaXRoQ2xvc2VkKTtcbiAgICAgIGV4cGVjdChjYW5PcGVuKS50b0JlKHRydWUpOyAvLyBPbmx5IDIgb3BlbiBwb3NpdGlvbnNcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2FsbG9jYXRlUmlza1BlclRyYWRlJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYWxsb2NhdGUgcmlzayBkeW5hbWljYWxseSBiYXNlZCBvbiBvcGVuIHBvc2l0aW9ucycsICgpID0+IHtcbiAgICAgIGNvbnN0IHRvdGFsRXF1aXR5ID0gMTAwMDA7XG4gICAgICBjb25zdCBhbGxvY2F0aW9uID0gcG9ydGZvbGlvTWFuYWdlci5hbGxvY2F0ZVJpc2tQZXJUcmFkZSh0b3RhbEVxdWl0eSwgbW9ja1Bvc2l0aW9ucyk7XG4gICAgICBcbiAgICAgIC8vIEJhc2UgcmlzazogMiUsIE9wZW4gcG9zaXRpb25zOiAyLCBBZGp1c3RlZDogMiUgLyAoMisxKSA9IDAuNjclXG4gICAgICBleHBlY3QoYWxsb2NhdGlvbi5iYXNlUmlza1BlclRyYWRlKS50b0JlKDAuMDIpO1xuICAgICAgZXhwZWN0KGFsbG9jYXRpb24uYWRqdXN0ZWRSaXNrUGVyVHJhZGUpLnRvQmVDbG9zZVRvKDAuMDA2NywgNCk7XG4gICAgICBleHBlY3QoYWxsb2NhdGlvbi5tYXhQb3NpdGlvblNpemUpLnRvQmVDbG9zZVRvKDQ0NjcsIDApOyAvLyAoMTAwMDAgKiAwLjAwNjcpIC8gMC4wMTVcbiAgICAgIGV4cGVjdChhbGxvY2F0aW9uLnJlY29tbWVuZGVkTGV2ZXJhZ2UpLnRvQmVHcmVhdGVyVGhhbigxKTtcbiAgICAgIGV4cGVjdChhbGxvY2F0aW9uLnJlY29tbWVuZGVkTGV2ZXJhZ2UpLnRvQmVMZXNzVGhhbk9yRXF1YWwoNSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBubyBvcGVuIHBvc2l0aW9ucycsICgpID0+IHtcbiAgICAgIGNvbnN0IHRvdGFsRXF1aXR5ID0gMTAwMDA7XG4gICAgICBjb25zdCBhbGxvY2F0aW9uID0gcG9ydGZvbGlvTWFuYWdlci5hbGxvY2F0ZVJpc2tQZXJUcmFkZSh0b3RhbEVxdWl0eSwgW10pO1xuICAgICAgXG4gICAgICAvLyBObyBwb3NpdGlvbnM6IDIlIC8gMSA9IDIlXG4gICAgICBleHBlY3QoYWxsb2NhdGlvbi5hZGp1c3RlZFJpc2tQZXJUcmFkZSkudG9CZSgwLjAyKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3JhbmtTaWduYWxzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmFuayBzaWduYWxzIGJ5IGNvbXBvc2l0ZSBzY29yZScsICgpID0+IHtcbiAgICAgIGNvbnN0IHJhbmtlZCA9IHBvcnRmb2xpb01hbmFnZXIucmFua1NpZ25hbHMobW9ja1NpZ25hbHMpO1xuICAgICAgXG4gICAgICBleHBlY3QocmFua2VkKS50b0hhdmVMZW5ndGgoMik7XG4gICAgICBleHBlY3QocmFua2VkWzBdLnJhbmspLnRvQmUoMSk7XG4gICAgICBleHBlY3QocmFua2VkWzFdLnJhbmspLnRvQmUoMik7XG4gICAgICBcbiAgICAgIC8vIEZpcnN0IHNpZ25hbCBzaG91bGQgaGF2ZSBoaWdoZXIgY29tcG9zaXRlIHNjb3JlIChBKyB3aXRoIDk1IGFsaWdubWVudClcbiAgICAgIGV4cGVjdChyYW5rZWRbMF0uY29tcG9zaXRlU2NvcmUpLnRvQmVHcmVhdGVyVGhhbihyYW5rZWRbMV0uY29tcG9zaXRlU2NvcmUpO1xuICAgICAgZXhwZWN0KHJhbmtlZFswXS5zaWduYWwuc3ltYm9sKS50b0JlKCdBREFVU0RUJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGxpbWl0IHRvIHRvcCAzIHNpZ25hbHMnLCAoKSA9PiB7XG4gICAgICAvLyBBZGQgbW9yZSBzaWduYWxzXG4gICAgICBjb25zdCBtb3JlU2lnbmFscyA9IFtcbiAgICAgICAgLi4ubW9ja1NpZ25hbHMsXG4gICAgICAgIC4uLkFycmF5KDUpLmZpbGwobnVsbCkubWFwKChfLCBpKSA9PiAoe1xuICAgICAgICAgIHNpZ25hbDogeyAuLi5tb2NrU2lnbmFsc1swXS5zaWduYWwsIHN5bWJvbDogYFRFU1Qke2l9VVNEVGAgfSxcbiAgICAgICAgICBob2xvZ3JhbVN0YXRlOiB7IC4uLm1vY2tTaWduYWxzWzBdLmhvbG9ncmFtU3RhdGUsIGFsaWdubWVudFNjb3JlOiA2MCAtIGkgfVxuICAgICAgICB9KSlcbiAgICAgIF07XG4gICAgICBcbiAgICAgIGNvbnN0IHJhbmtlZCA9IHBvcnRmb2xpb01hbmFnZXIucmFua1NpZ25hbHMobW9yZVNpZ25hbHMpO1xuICAgICAgZXhwZWN0KHJhbmtlZCkudG9IYXZlTGVuZ3RoKDMpOyAvLyBMaW1pdGVkIHRvIHRvcCAzXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlbXB0eSBzaWduYWxzIGFycmF5JywgKCkgPT4ge1xuICAgICAgY29uc3QgcmFua2VkID0gcG9ydGZvbGlvTWFuYWdlci5yYW5rU2lnbmFscyhbXSk7XG4gICAgICBleHBlY3QocmFua2VkKS50b0hhdmVMZW5ndGgoMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjaGVja1BvcnRmb2xpb0hlYXQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgcG9ydGZvbGlvIGhlYXQgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgdG90YWxFcXVpdHkgPSAxMDAwMDtcbiAgICAgIGNvbnN0IGNhblRyYWRlID0gcG9ydGZvbGlvTWFuYWdlci5jaGVja1BvcnRmb2xpb0hlYXQobW9ja1Bvc2l0aW9ucywgdG90YWxFcXVpdHkpO1xuICAgICAgXG4gICAgICAvLyBQb3NpdGlvbiAxIHJpc2s6ICg1MDAwMC00OTI1MCkgKiAwLjEgPSA3NVxuICAgICAgLy8gUG9zaXRpb24gMiByaXNrOiAoMzAwMC0yOTU1KSAqIDEgPSA0NVxuICAgICAgLy8gVG90YWwgcmlzazogMTIwLCBIZWF0OiAxMjAvMTAwMDAgPSAxLjIlIDwgMTUlXG4gICAgICBleHBlY3QoY2FuVHJhZGUpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCB3aGVuIHBvcnRmb2xpbyBoZWF0IGV4Y2VlZHMgbGltaXQnLCAoKSA9PiB7XG4gICAgICAvLyBDcmVhdGUgaGlnaC1yaXNrIHBvc2l0aW9uc1xuICAgICAgY29uc3QgaGlnaFJpc2tQb3NpdGlvbnMgPSBtb2NrUG9zaXRpb25zLm1hcChwb3MgPT4gKHtcbiAgICAgICAgLi4ucG9zLFxuICAgICAgICBxdWFudGl0eTogcG9zLnF1YW50aXR5ICogNTAgLy8gSW5jcmVhc2UgcXVhbnRpdHkgdG8gaW5jcmVhc2Ugcmlza1xuICAgICAgfSkpO1xuICAgICAgXG4gICAgICBjb25zdCB0b3RhbEVxdWl0eSA9IDEwMDA7IC8vIFNtYWxsIGVxdWl0eSB0byBpbmNyZWFzZSBoZWF0IHBlcmNlbnRhZ2VcbiAgICAgIGNvbnN0IGNhblRyYWRlID0gcG9ydGZvbGlvTWFuYWdlci5jaGVja1BvcnRmb2xpb0hlYXQoaGlnaFJpc2tQb3NpdGlvbnMsIHRvdGFsRXF1aXR5KTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGNhblRyYWRlKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGZhbHNlIGZvciB6ZXJvIGVxdWl0eScsICgpID0+IHtcbiAgICAgIGNvbnN0IGNhblRyYWRlID0gcG9ydGZvbGlvTWFuYWdlci5jaGVja1BvcnRmb2xpb0hlYXQobW9ja1Bvc2l0aW9ucywgMCk7XG4gICAgICBleHBlY3QoY2FuVHJhZGUpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnYWRqdXN0Rm9yRGlyZWN0aW9uYWxCaWFzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgbm90IGFkanVzdCB3aGVuIG5vIGRpcmVjdGlvbmFsIGJpYXMnLCAoKSA9PiB7XG4gICAgICAvLyBNaXhlZCBwb3NpdGlvbnMgKDEgTE9ORywgMSBTSE9SVClcbiAgICAgIGNvbnN0IG1peGVkUG9zaXRpb25zID0gW1xuICAgICAgICBtb2NrUG9zaXRpb25zWzBdLCAvLyBMT05HXG4gICAgICAgIHsgLi4ubW9ja1Bvc2l0aW9uc1sxXSwgc2lkZTogJ1NIT1JUJyBhcyBjb25zdCB9IC8vIFNIT1JUXG4gICAgICBdO1xuICAgICAgXG4gICAgICBjb25zdCBhZGp1c3RlZFNpemUgPSBwb3J0Zm9saW9NYW5hZ2VyLmFkanVzdEZvckRpcmVjdGlvbmFsQmlhcyhcbiAgICAgICAgbWl4ZWRQb3NpdGlvbnMsIFxuICAgICAgICAnTE9ORycsIFxuICAgICAgICAxMDAwXG4gICAgICApO1xuICAgICAgXG4gICAgICBleHBlY3QoYWRqdXN0ZWRTaXplKS50b0JlKDEwMDApOyAvLyBObyBhZGp1c3RtZW50XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlZHVjZSBwb3NpdGlvbiBzaXplIHdoZW4gYWRkaW5nIHRvIGRpcmVjdGlvbmFsIGJpYXMnLCAoKSA9PiB7XG4gICAgICAvLyBBbGwgTE9ORyBwb3NpdGlvbnMgKDEwMCUgYmlhcylcbiAgICAgIGNvbnN0IGxvbmdQb3NpdGlvbnMgPSBtb2NrUG9zaXRpb25zOyAvLyBCb3RoIGFyZSBMT05HXG4gICAgICBcbiAgICAgIGNvbnN0IGFkanVzdGVkU2l6ZSA9IHBvcnRmb2xpb01hbmFnZXIuYWRqdXN0Rm9yRGlyZWN0aW9uYWxCaWFzKFxuICAgICAgICBsb25nUG9zaXRpb25zLCBcbiAgICAgICAgJ0xPTkcnLCBcbiAgICAgICAgMTAwMFxuICAgICAgKTtcbiAgICAgIFxuICAgICAgLy8gU2hvdWxkIHJlZHVjZSBieSAyMCU6IDEwMDAgKiAoMSAtIDAuMikgPSA4MDBcbiAgICAgIGV4cGVjdChhZGp1c3RlZFNpemUpLnRvQmUoODAwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgbm90IGFkanVzdCB3aGVuIGdvaW5nIGFnYWluc3QgZGlyZWN0aW9uYWwgYmlhcycsICgpID0+IHtcbiAgICAgIC8vIEFsbCBMT05HIHBvc2l0aW9uc1xuICAgICAgY29uc3QgbG9uZ1Bvc2l0aW9ucyA9IG1vY2tQb3NpdGlvbnM7IC8vIEJvdGggYXJlIExPTkdcbiAgICAgIFxuICAgICAgY29uc3QgYWRqdXN0ZWRTaXplID0gcG9ydGZvbGlvTWFuYWdlci5hZGp1c3RGb3JEaXJlY3Rpb25hbEJpYXMoXG4gICAgICAgIGxvbmdQb3NpdGlvbnMsIFxuICAgICAgICAnU0hPUlQnLCBcbiAgICAgICAgMTAwMFxuICAgICAgKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGFkanVzdGVkU2l6ZSkudG9CZSgxMDAwKTsgLy8gTm8gYWRqdXN0bWVudCB3aGVuIGdvaW5nIGFnYWluc3QgYmlhc1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgcG9zaXRpb25zJywgKCkgPT4ge1xuICAgICAgY29uc3QgYWRqdXN0ZWRTaXplID0gcG9ydGZvbGlvTWFuYWdlci5hZGp1c3RGb3JEaXJlY3Rpb25hbEJpYXMoW10sICdMT05HJywgMTAwMCk7XG4gICAgICBleHBlY3QoYWRqdXN0ZWRTaXplKS50b0JlKDEwMDApOyAvLyBObyBhZGp1c3RtZW50IHdpdGggbm8gcG9zaXRpb25zXG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd1cGRhdGVQb3J0Zm9saW9TdGF0ZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHVwZGF0ZSBwb3J0Zm9saW8gc3RhdGUgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgdG90YWxFcXVpdHkgPSAxMDAwMDtcbiAgICAgIHBvcnRmb2xpb01hbmFnZXIudXBkYXRlUG9ydGZvbGlvU3RhdGUobW9ja1Bvc2l0aW9ucywgdG90YWxFcXVpdHkpO1xuICAgICAgXG4gICAgICBjb25zdCBzdGF0ZSA9IHBvcnRmb2xpb01hbmFnZXIuZ2V0UG9ydGZvbGlvU3RhdGUoKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHN0YXRlLnRvdGFsRXF1aXR5KS50b0JlKHRvdGFsRXF1aXR5KTtcbiAgICAgIGV4cGVjdChzdGF0ZS5vcGVuUG9zaXRpb25zKS50b0hhdmVMZW5ndGgoMik7XG4gICAgICBleHBlY3Qoc3RhdGUuZGlyZWN0aW9uYWxCaWFzKS50b0JlKCdMT05HJyk7IC8vIEJvdGggcG9zaXRpb25zIGFyZSBMT05HXG4gICAgICBleHBlY3Qoc3RhdGUuYmlhc1BlcmNlbnRhZ2UpLnRvQmUoMS4wKTsgLy8gMTAwJSBMT05HXG4gICAgICBleHBlY3Qoc3RhdGUudG90YWxVbnJlYWxpemVkUG5MKS50b0JlKDIwMCk7IC8vIDEwMCArIDEwMFxuICAgICAgZXhwZWN0KHN0YXRlLnRvdGFsUmVhbGl6ZWRQbkwpLnRvQmUoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRldGVjdCBuZXV0cmFsIGJpYXMgd2l0aCBtaXhlZCBwb3NpdGlvbnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBtaXhlZFBvc2l0aW9ucyA9IFtcbiAgICAgICAgbW9ja1Bvc2l0aW9uc1swXSwgLy8gTE9OR1xuICAgICAgICB7IC4uLm1vY2tQb3NpdGlvbnNbMV0sIHNpZGU6ICdTSE9SVCcgYXMgY29uc3QgfSAvLyBTSE9SVFxuICAgICAgXTtcbiAgICAgIFxuICAgICAgcG9ydGZvbGlvTWFuYWdlci51cGRhdGVQb3J0Zm9saW9TdGF0ZShtaXhlZFBvc2l0aW9ucywgMTAwMDApO1xuICAgICAgY29uc3Qgc3RhdGUgPSBwb3J0Zm9saW9NYW5hZ2VyLmdldFBvcnRmb2xpb1N0YXRlKCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChzdGF0ZS5kaXJlY3Rpb25hbEJpYXMpLnRvQmUoJ05FVVRSQUwnKTtcbiAgICAgIGV4cGVjdChzdGF0ZS5iaWFzUGVyY2VudGFnZSkudG9CZSgwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2NhbkFjY2VwdFNpZ25hbCcsICgpID0+IHtcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIC8vIEFkZCBwb3NpdGlvbnMgdG8gcG9ydGZvbGlvIG1hbmFnZXJcbiAgICAgIG1vY2tQb3NpdGlvbnMuZm9yRWFjaChwb3MgPT4gcG9ydGZvbGlvTWFuYWdlci5hZGRQb3NpdGlvbihwb3MpKTtcbiAgICAgIHBvcnRmb2xpb01hbmFnZXIudXBkYXRlUG9ydGZvbGlvU3RhdGUobW9ja1Bvc2l0aW9ucywgMTAwMDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBhY2NlcHQgc2lnbmFsIHdoZW4gYWxsIGxpbWl0cyBhcmUgd2l0aGluIGJvdW5kcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGNhbkFjY2VwdCA9IHBvcnRmb2xpb01hbmFnZXIuY2FuQWNjZXB0U2lnbmFsKFxuICAgICAgICBtb2NrU2lnbmFsc1swXS5zaWduYWwsXG4gICAgICAgIG1vY2tTaWduYWxzWzBdLmhvbG9ncmFtU3RhdGUsXG4gICAgICAgIDEwMDAwXG4gICAgICApO1xuICAgICAgXG4gICAgICBleHBlY3QoY2FuQWNjZXB0KS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3Qgc2lnbmFsIHdoZW4gcG9zaXRpb24gbGltaXQgZXhjZWVkZWQnLCAoKSA9PiB7XG4gICAgICAvLyBBZGQgbW9yZSBwb3NpdGlvbnMgdG8gaGl0IHRoZSBsaW1pdFxuICAgICAgZm9yIChsZXQgaSA9IDM7IGkgPD0gNTsgaSsrKSB7XG4gICAgICAgIHBvcnRmb2xpb01hbmFnZXIuYWRkUG9zaXRpb24oe1xuICAgICAgICAgIC4uLm1vY2tQb3NpdGlvbnNbMF0sXG4gICAgICAgICAgaWQ6IGBwb3MtJHtpfWAsXG4gICAgICAgICAgc3RhdHVzOiAnT1BFTidcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IGNhbkFjY2VwdCA9IHBvcnRmb2xpb01hbmFnZXIuY2FuQWNjZXB0U2lnbmFsKFxuICAgICAgICBtb2NrU2lnbmFsc1swXS5zaWduYWwsXG4gICAgICAgIG1vY2tTaWduYWxzWzBdLmhvbG9ncmFtU3RhdGUsXG4gICAgICAgIDEwMDAwXG4gICAgICApO1xuICAgICAgXG4gICAgICBleHBlY3QoY2FuQWNjZXB0KS50b0JlKGZhbHNlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldFBvcnRmb2xpb1N0YXRpc3RpY3MnLCAoKSA9PiB7XG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICBtb2NrUG9zaXRpb25zLmZvckVhY2gocG9zID0+IHBvcnRmb2xpb01hbmFnZXIuYWRkUG9zaXRpb24ocG9zKSk7XG4gICAgICBwb3J0Zm9saW9NYW5hZ2VyLnVwZGF0ZVBvcnRmb2xpb1N0YXRlKG1vY2tQb3NpdGlvbnMsIDEwMDAwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3QgcG9ydGZvbGlvIHN0YXRpc3RpY3MnLCAoKSA9PiB7XG4gICAgICBjb25zdCBzdGF0cyA9IHBvcnRmb2xpb01hbmFnZXIuZ2V0UG9ydGZvbGlvU3RhdGlzdGljcygpO1xuICAgICAgXG4gICAgICBleHBlY3Qoc3RhdHMudG90YWxQb3NpdGlvbnMpLnRvQmUoMik7XG4gICAgICBleHBlY3Qoc3RhdHMub3BlblBvc2l0aW9ucykudG9CZSgyKTtcbiAgICAgIGV4cGVjdChzdGF0cy5leHBvc3VyZVV0aWxpemF0aW9uKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICBleHBlY3Qoc3RhdHMuaGVhdFV0aWxpemF0aW9uKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICBleHBlY3Qoc3RhdHMucG9zaXRpb25VdGlsaXphdGlvbikudG9CZSgwLjQpOyAvLyAyLzUgPSAwLjRcbiAgICAgIGV4cGVjdChzdGF0cy5hdmdQb3NpdGlvblNpemUpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgIGV4cGVjdChzdGF0cy5sYXJnZXN0UG9zaXRpb24pLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgIGV4cGVjdChzdGF0cy5kaXJlY3Rpb25hbEJpYXMpLnRvQ29udGFpbignTE9ORycpO1xuICAgICAgZXhwZWN0KHN0YXRzLnRvdGFsUG5MKS50b0JlKDIwMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdwb3NpdGlvbiBtYW5hZ2VtZW50JywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgYWRkIGFuZCByZW1vdmUgcG9zaXRpb25zIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIGNvbnN0IHBvc2l0aW9uID0gbW9ja1Bvc2l0aW9uc1swXTtcbiAgICAgIFxuICAgICAgcG9ydGZvbGlvTWFuYWdlci5hZGRQb3NpdGlvbihwb3NpdGlvbik7XG4gICAgICBleHBlY3QocG9ydGZvbGlvTWFuYWdlci5nZXRBbGxQb3NpdGlvbnMoKSkudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgXG4gICAgICBwb3J0Zm9saW9NYW5hZ2VyLnJlbW92ZVBvc2l0aW9uKHBvc2l0aW9uLmlkKTtcbiAgICAgIGV4cGVjdChwb3J0Zm9saW9NYW5hZ2VyLmdldEFsbFBvc2l0aW9ucygpKS50b0hhdmVMZW5ndGgoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHVwZGF0ZSBwb3NpdGlvbnMgY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgcG9zaXRpb24gPSBtb2NrUG9zaXRpb25zWzBdO1xuICAgICAgcG9ydGZvbGlvTWFuYWdlci5hZGRQb3NpdGlvbihwb3NpdGlvbik7XG4gICAgICBcbiAgICAgIGNvbnN0IHVwZGF0ZWRQb3NpdGlvbiA9IHsgLi4ucG9zaXRpb24sIGN1cnJlbnRQcmljZTogNTIwMDAgfTtcbiAgICAgIHBvcnRmb2xpb01hbmFnZXIudXBkYXRlUG9zaXRpb24odXBkYXRlZFBvc2l0aW9uKTtcbiAgICAgIFxuICAgICAgY29uc3QgcmV0cmlldmVkID0gcG9ydGZvbGlvTWFuYWdlci5nZXRBbGxQb3NpdGlvbnMoKVswXTtcbiAgICAgIGV4cGVjdChyZXRyaWV2ZWQuY3VycmVudFByaWNlKS50b0JlKDUyMDAwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ2V0IG9wZW4gcG9zaXRpb25zIG9ubHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBvcGVuUG9zaXRpb24gPSBtb2NrUG9zaXRpb25zWzBdO1xuICAgICAgY29uc3QgY2xvc2VkUG9zaXRpb24gPSB7IC4uLm1vY2tQb3NpdGlvbnNbMV0sIHN0YXR1czogJ0NMT1NFRCcgYXMgY29uc3QgfTtcbiAgICAgIFxuICAgICAgcG9ydGZvbGlvTWFuYWdlci5hZGRQb3NpdGlvbihvcGVuUG9zaXRpb24pO1xuICAgICAgcG9ydGZvbGlvTWFuYWdlci5hZGRQb3NpdGlvbihjbG9zZWRQb3NpdGlvbik7XG4gICAgICBcbiAgICAgIGNvbnN0IG9wZW5Qb3NpdGlvbnMgPSBwb3J0Zm9saW9NYW5hZ2VyLmdldE9wZW5Qb3NpdGlvbnMoKTtcbiAgICAgIGV4cGVjdChvcGVuUG9zaXRpb25zKS50b0hhdmVMZW5ndGgoMSk7XG4gICAgICBleHBlY3Qob3BlblBvc2l0aW9uc1swXS5zdGF0dXMpLnRvQmUoJ09QRU4nKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2xlYXIgYWxsIHBvc2l0aW9ucycsICgpID0+IHtcbiAgICAgIG1vY2tQb3NpdGlvbnMuZm9yRWFjaChwb3MgPT4gcG9ydGZvbGlvTWFuYWdlci5hZGRQb3NpdGlvbihwb3MpKTtcbiAgICAgIGV4cGVjdChwb3J0Zm9saW9NYW5hZ2VyLmdldEFsbFBvc2l0aW9ucygpKS50b0hhdmVMZW5ndGgoMik7XG4gICAgICBcbiAgICAgIHBvcnRmb2xpb01hbmFnZXIuY2xlYXJQb3NpdGlvbnMoKTtcbiAgICAgIGV4cGVjdChwb3J0Zm9saW9NYW5hZ2VyLmdldEFsbFBvc2l0aW9ucygpKS50b0hhdmVMZW5ndGgoMCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjb25maWd1cmF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdXBkYXRlIGNvbmZpZ3VyYXRpb24gY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgbmV3Q29uZmlnID0geyBtYXhDb25jdXJyZW50UG9zaXRpb25zOiAxMCB9O1xuICAgICAgcG9ydGZvbGlvTWFuYWdlci51cGRhdGVDb25maWcobmV3Q29uZmlnKTtcbiAgICAgIFxuICAgICAgLy8gVGVzdCB0aGF0IG5ldyBjb25maWcgaXMgYXBwbGllZFxuICAgICAgY29uc3QgcG9zaXRpb25zID0gQXJyYXkoOCkuZmlsbChudWxsKS5tYXAoKF8sIGkpID0+ICh7XG4gICAgICAgIC4uLm1vY2tQb3NpdGlvbnNbMF0sXG4gICAgICAgIGlkOiBgcG9zLSR7aX1gLFxuICAgICAgICBzdGF0dXM6ICdPUEVOJyBhcyBjb25zdFxuICAgICAgfSkpO1xuICAgICAgXG4gICAgICBjb25zdCBjYW5PcGVuID0gcG9ydGZvbGlvTWFuYWdlci5lbmZvcmNlTWF4UG9zaXRpb25zKHBvc2l0aW9ucyk7XG4gICAgICBleHBlY3QoY2FuT3BlbikudG9CZSh0cnVlKTsgLy8gU2hvdWxkIGFsbG93IHNpbmNlIGxpbWl0IGlzIG5vdyAxMFxuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZXZlbnQgZW1pc3Npb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBlbWl0IHBvcnRmb2xpbyB1cGRhdGVkIGV2ZW50JywgKGRvbmUpID0+IHtcbiAgICAgIHBvcnRmb2xpb01hbmFnZXIub24oJ3BvcnRmb2xpbzp1cGRhdGVkJywgKHN0YXRlKSA9PiB7XG4gICAgICAgIGV4cGVjdChzdGF0ZS50b3RhbEVxdWl0eSkudG9CZSgxMDAwMCk7XG4gICAgICAgIGV4cGVjdChzdGF0ZS5vcGVuUG9zaXRpb25zKS50b0hhdmVMZW5ndGgoMik7XG4gICAgICAgIGRvbmUoKTtcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBwb3J0Zm9saW9NYW5hZ2VyLnVwZGF0ZVBvcnRmb2xpb1N0YXRlKG1vY2tQb3NpdGlvbnMsIDEwMDAwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZW1pdCBzaWduYWwgcmVqZWN0ZWQgZXZlbnQnLCAoZG9uZSkgPT4ge1xuICAgICAgcG9ydGZvbGlvTWFuYWdlci5vbigncG9ydGZvbGlvOnNpZ25hbF9yZWplY3RlZCcsIChzaWduYWwsIHJlYXNvbikgPT4ge1xuICAgICAgICBleHBlY3Qoc2lnbmFsLnN5bWJvbCkudG9CZSgnQURBVVNEVCcpO1xuICAgICAgICBleHBlY3QocmVhc29uKS50b0JlKCdQT1NJVElPTl9MSU1JVF9FWENFRURFRCcpO1xuICAgICAgICBkb25lKCk7XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgLy8gQWRkIHBvc2l0aW9ucyB0byBoaXQgbGltaXRcbiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IDU7IGkrKykge1xuICAgICAgICBwb3J0Zm9saW9NYW5hZ2VyLmFkZFBvc2l0aW9uKHtcbiAgICAgICAgICAuLi5tb2NrUG9zaXRpb25zWzBdLFxuICAgICAgICAgIGlkOiBgcG9zLSR7aX1gLFxuICAgICAgICAgIHN0YXR1czogJ09QRU4nXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgXG4gICAgICBwb3J0Zm9saW9NYW5hZ2VyLmNhbkFjY2VwdFNpZ25hbChcbiAgICAgICAgbW9ja1NpZ25hbHNbMF0uc2lnbmFsLFxuICAgICAgICBtb2NrU2lnbmFsc1swXS5ob2xvZ3JhbVN0YXRlLFxuICAgICAgICAxMDAwMFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZW1pdCBkaXJlY3Rpb25hbCBiaWFzIGV2ZW50JywgKGRvbmUpID0+IHtcbiAgICAgIHBvcnRmb2xpb01hbmFnZXIub24oJ3BvcnRmb2xpbzpkaXJlY3Rpb25hbF9iaWFzJywgKGJpYXMsIHBlcmNlbnRhZ2UpID0+IHtcbiAgICAgICAgZXhwZWN0KGJpYXMpLnRvQmUoJ0xPTkcnKTtcbiAgICAgICAgZXhwZWN0KHBlcmNlbnRhZ2UpLnRvQmUoMS4wKTtcbiAgICAgICAgZG9uZSgpO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIHBvcnRmb2xpb01hbmFnZXIuYWRqdXN0Rm9yRGlyZWN0aW9uYWxCaWFzKG1vY2tQb3NpdGlvbnMsICdMT05HJywgMTAwMCk7XG4gICAgfSk7XG4gIH0pO1xufSk7Il0sInZlcnNpb24iOjN9