95f65ea7849320e19c84447fa4d681c3
"use strict";
/**
 * Unit Tests for SessionProfiler
 *
 * Tests session identification, Asian range storage, Judas Swing detection,
 * killzone checking, and session transition events.
 *
 * Requirements: 2.1-2.7 (Session Profiler)
 */
Object.defineProperty(exports, "__esModule", { value: true });
const SessionProfiler_1 = require("../../src/engine/SessionProfiler");
describe('SessionProfiler', () => {
    let profiler;
    let originalDate;
    beforeEach(() => {
        profiler = new SessionProfiler_1.SessionProfiler();
        originalDate = global.Date;
    });
    afterEach(() => {
        global.Date = originalDate;
    });
    // Helper function to mock UTC time
    const mockUTCTime = (hour, minute = 0) => {
        const mockDate = new Date();
        mockDate.getUTCHours = jest.fn().mockReturnValue(hour);
        mockDate.getUTCMinutes = jest.fn().mockReturnValue(minute);
        global.Date = jest.fn(() => mockDate);
        global.Date.now = originalDate.now;
    };
    // Helper function to create OHLCV data
    const createOHLCV = (timestamp, high, low) => ({
        timestamp,
        open: (high + low) / 2,
        high,
        low,
        close: (high + low) / 2,
        volume: 1000
    });
    describe('getSessionState', () => {
        it('should identify Asian session (00:00-06:00 UTC)', () => {
            mockUTCTime(3, 30); // 03:30 UTC
            const sessionState = profiler.getSessionState();
            expect(sessionState.type).toBe('ASIAN');
            expect(sessionState.startTime).toBe(0);
            expect(sessionState.endTime).toBe(6);
            expect(sessionState.timeRemaining).toBe(2.5); // 6 - 3.5
        });
        it('should identify London session (07:00-10:00 UTC)', () => {
            mockUTCTime(8, 15); // 08:15 UTC
            const sessionState = profiler.getSessionState();
            expect(sessionState.type).toBe('LONDON');
            expect(sessionState.startTime).toBe(7);
            expect(sessionState.endTime).toBe(10);
            expect(sessionState.timeRemaining).toBe(1.75); // 10 - 8.25
        });
        it('should identify NY session (13:00-16:00 UTC)', () => {
            mockUTCTime(14, 45); // 14:45 UTC
            const sessionState = profiler.getSessionState();
            expect(sessionState.type).toBe('NY');
            expect(sessionState.startTime).toBe(13);
            expect(sessionState.endTime).toBe(16);
            expect(sessionState.timeRemaining).toBe(1.25); // 16 - 14.75
        });
        it('should identify Dead Zone (21:00-01:00 UTC)', () => {
            mockUTCTime(23, 0); // 23:00 UTC
            const sessionState = profiler.getSessionState();
            expect(sessionState.type).toBe('DEAD_ZONE');
            expect(sessionState.startTime).toBe(21);
            expect(sessionState.endTime).toBe(1);
            expect(sessionState.timeRemaining).toBe(2); // (24 - 23) + 1
        });
        it('should identify Dead Zone early morning (00:30 UTC)', () => {
            mockUTCTime(0, 30); // 00:30 UTC (but not Asian session)
            // Mock to return DEAD_ZONE for this specific time
            const sessionState = profiler.getSessionState();
            // At 00:30, it should be Asian session, not Dead Zone
            expect(sessionState.type).toBe('ASIAN');
        });
        it('should handle Dead Zone early morning correctly', () => {
            mockUTCTime(22, 30); // 22:30 UTC (Dead Zone)
            const sessionState = profiler.getSessionState();
            expect(sessionState.type).toBe('DEAD_ZONE');
            expect(sessionState.timeRemaining).toBe(2.5); // (24 - 22.5) + 1
        });
    });
    describe('storeAsianRange', () => {
        it('should store Asian range from OHLCV data', () => {
            const asianData = [
                createOHLCV(new Date('2024-01-01T02:00:00Z').getTime(), 50100, 49900), // Asian session
                createOHLCV(new Date('2024-01-01T04:00:00Z').getTime(), 50200, 49800), // Asian session
                createOHLCV(new Date('2024-01-01T08:00:00Z').getTime(), 50300, 49700), // London session (should be ignored)
            ];
            profiler.storeAsianRange(asianData);
            const asianRange = profiler.getAsianRange();
            expect(asianRange).not.toBeNull();
            expect(asianRange.high).toBe(50200); // Highest during Asian session
            expect(asianRange.low).toBe(49800); // Lowest during Asian session
        });
        it('should handle empty OHLCV data', () => {
            profiler.storeAsianRange([]);
            const asianRange = profiler.getAsianRange();
            expect(asianRange).toBeNull();
        });
        it('should ignore non-Asian session data', () => {
            const nonAsianData = [
                createOHLCV(new Date('2024-01-01T08:00:00Z').getTime(), 50300, 49700), // London
                createOHLCV(new Date('2024-01-01T14:00:00Z').getTime(), 50400, 49600), // NY
            ];
            profiler.storeAsianRange(nonAsianData);
            const asianRange = profiler.getAsianRange();
            expect(asianRange).toBeNull();
        });
    });
    describe('detectJudasSwing', () => {
        beforeEach(() => {
            // Set up Asian range for testing
            const asianData = [
                createOHLCV(new Date('2024-01-01T02:00:00Z').getTime(), 50100, 49900),
            ];
            profiler.storeAsianRange(asianData);
        });
        it('should detect Asian High sweep during London session', () => {
            const currentPrice = 50150; // Above Asian High (50100)
            const judasSwing = profiler.detectJudasSwing(currentPrice, 'LONDON');
            expect(judasSwing).not.toBeNull();
            expect(judasSwing.type).toBe('SWEEP_HIGH');
            expect(judasSwing.sweptPrice).toBe(50100);
            expect(judasSwing.reversalPrice).toBe(49900);
            expect(judasSwing.direction).toBe('SHORT');
            expect(judasSwing.confidence).toBe(75);
        });
        it('should detect Asian Low sweep during London session', () => {
            const currentPrice = 49850; // Below Asian Low (49900)
            const judasSwing = profiler.detectJudasSwing(currentPrice, 'LONDON');
            expect(judasSwing).not.toBeNull();
            expect(judasSwing.type).toBe('SWEEP_LOW');
            expect(judasSwing.sweptPrice).toBe(49900);
            expect(judasSwing.reversalPrice).toBe(50100);
            expect(judasSwing.direction).toBe('LONG');
            expect(judasSwing.confidence).toBe(75);
        });
        it('should not detect Judas Swing when price is within Asian range', () => {
            const currentPrice = 50000; // Within Asian range
            const judasSwing = profiler.detectJudasSwing(currentPrice, 'LONDON');
            expect(judasSwing).toBeNull();
        });
        it('should not detect Judas Swing during Asian session', () => {
            const currentPrice = 50150; // Above Asian High
            const judasSwing = profiler.detectJudasSwing(currentPrice, 'ASIAN');
            expect(judasSwing).toBeNull();
        });
        it('should detect London range sweep during NY session', () => {
            // Set up London range
            const londonData = [
                createOHLCV(new Date('2024-01-01T08:00:00Z').getTime(), 50300, 49700),
            ];
            profiler.updateLondonRange(londonData);
            const currentPrice = 50350; // Above London High
            const judasSwing = profiler.detectJudasSwing(currentPrice, 'NY');
            expect(judasSwing).not.toBeNull();
            expect(judasSwing.type).toBe('SWEEP_HIGH');
            expect(judasSwing.sweptPrice).toBe(50300);
            expect(judasSwing.direction).toBe('SHORT');
            expect(judasSwing.confidence).toBe(80); // Higher confidence for NY
        });
    });
    describe('isKillzone', () => {
        it('should return true during London session', () => {
            mockUTCTime(8, 30); // London session
            const isKillzone = profiler.isKillzone();
            expect(isKillzone).toBe(true);
        });
        it('should return true during NY session', () => {
            mockUTCTime(14, 30); // NY session
            const isKillzone = profiler.isKillzone();
            expect(isKillzone).toBe(true);
        });
        it('should return false during Asian session', () => {
            mockUTCTime(3, 30); // Asian session
            const isKillzone = profiler.isKillzone();
            expect(isKillzone).toBe(false);
        });
        it('should return false during Dead Zone', () => {
            mockUTCTime(22, 30); // Dead Zone
            const isKillzone = profiler.isKillzone();
            expect(isKillzone).toBe(false);
        });
    });
    describe('shouldDisableNewEntries', () => {
        it('should return true during Dead Zone', () => {
            mockUTCTime(22, 30); // Dead Zone
            const shouldDisable = profiler.shouldDisableNewEntries();
            expect(shouldDisable).toBe(true);
        });
        it('should return false during killzones', () => {
            mockUTCTime(8, 30); // London session
            const shouldDisable = profiler.shouldDisableNewEntries();
            expect(shouldDisable).toBe(false);
        });
    });
    describe('updateLondonRange', () => {
        it('should store London range from OHLCV data', () => {
            const londonData = [
                createOHLCV(new Date('2024-01-01T08:00:00Z').getTime(), 50300, 49700), // London session
                createOHLCV(new Date('2024-01-01T09:00:00Z').getTime(), 50250, 49750), // London session
                createOHLCV(new Date('2024-01-01T14:00:00Z').getTime(), 50400, 49600), // NY session (should be ignored)
            ];
            profiler.updateLondonRange(londonData);
            const londonRange = profiler.getLondonRange();
            expect(londonRange).not.toBeNull();
            expect(londonRange.high).toBe(50300); // Highest during London session
            expect(londonRange.low).toBe(49700); // Lowest during London session
        });
        it('should ignore non-London session data', () => {
            const nonLondonData = [
                createOHLCV(new Date('2024-01-01T02:00:00Z').getTime(), 50100, 49900), // Asian
                createOHLCV(new Date('2024-01-01T14:00:00Z').getTime(), 50400, 49600), // NY
            ];
            profiler.updateLondonRange(nonLondonData);
            const londonRange = profiler.getLondonRange();
            expect(londonRange).toBeNull();
        });
    });
    describe('session transition events', () => {
        it('should emit SESSION_CHANGE event on session transition', (done) => {
            mockUTCTime(8, 0); // London session
            // First call to establish current session
            profiler.getSessionState();
            // Set up event listener
            profiler.once('SESSION_CHANGE', (event) => {
                expect(event.previousSession).toBe('LONDON');
                expect(event.newSession).toBe('NY');
                expect(event.timestamp).toBeGreaterThan(0);
                done();
            });
            // Change to NY session
            mockUTCTime(14, 0);
            profiler.getSessionState();
        });
        it('should emit LONDON_OPEN event when transitioning to London', (done) => {
            mockUTCTime(5, 0); // Asian session
            profiler.getSessionState();
            profiler.once('LONDON_OPEN', (event) => {
                expect(event.timestamp).toBeGreaterThan(0);
                done();
            });
            // Transition to London
            mockUTCTime(8, 0);
            profiler.getSessionState();
        });
        it('should emit NY_OPEN event when transitioning to NY', (done) => {
            mockUTCTime(8, 0); // London session
            profiler.getSessionState();
            profiler.once('NY_OPEN', (event) => {
                expect(event.timestamp).toBeGreaterThan(0);
                done();
            });
            // Transition to NY
            mockUTCTime(14, 0);
            profiler.getSessionState();
        });
        it('should emit DEAD_ZONE_START event when transitioning to Dead Zone', (done) => {
            mockUTCTime(15, 0); // NY session
            profiler.getSessionState();
            profiler.once('DEAD_ZONE_START', (event) => {
                expect(event.timestamp).toBeGreaterThan(0);
                done();
            });
            // Transition to Dead Zone
            mockUTCTime(22, 0);
            profiler.getSessionState();
        });
    });
    describe('getSessionStats', () => {
        it('should return comprehensive session statistics', () => {
            mockUTCTime(8, 30); // London session
            // Set up ranges - use a direct timestamp for 2 AM UTC
            const timestamp2AM = Date.UTC(2024, 0, 1, 2, 0, 0); // January 1, 2024, 2:00 AM UTC
            const asianData = [
                createOHLCV(timestamp2AM, 50100, 49900),
            ];
            // Debug the Asian data
            expect(new Date(asianData[0].timestamp).getUTCHours()).toBe(2);
            profiler.storeAsianRange(asianData);
            const asianRangeAfterStore = profiler.getAsianRange();
            // This should not be null if storeAsianRange worked
            expect(asianRangeAfterStore).not.toBeNull();
            const timestamp8AM = Date.UTC(2024, 0, 1, 8, 0, 0); // January 1, 2024, 8:00 AM UTC
            const londonData = [
                createOHLCV(timestamp8AM, 50300, 49700),
            ];
            profiler.updateLondonRange(londonData);
            const stats = profiler.getSessionStats();
            expect(stats.currentSession).toBe('LONDON');
            expect(stats.timeRemaining).toBe(1.5); // 10 - 8.5
            expect(stats.asianRange).toEqual({
                high: 50100,
                low: 49900,
                timestamp: expect.any(Number)
            });
            expect(stats.londonRange).toEqual({
                high: 50300,
                low: 49700,
                timestamp: expect.any(Number)
            });
            expect(stats.isKillzone).toBe(true);
        });
    });
    describe('edge cases', () => {
        it('should handle session boundary correctly (exactly 06:00 UTC)', () => {
            mockUTCTime(6, 0); // Exactly 06:00 UTC
            const sessionState = profiler.getSessionState();
            // At exactly 06:00, it should not be Asian session anymore
            expect(sessionState.type).not.toBe('ASIAN');
        });
        it('should handle session boundary correctly (exactly 07:00 UTC)', () => {
            mockUTCTime(7, 0); // Exactly 07:00 UTC
            const sessionState = profiler.getSessionState();
            expect(sessionState.type).toBe('LONDON');
            expect(sessionState.timeRemaining).toBe(3); // 10 - 7
        });
        it('should handle midnight transition correctly', () => {
            mockUTCTime(0, 30); // 00:30 UTC
            const sessionState = profiler.getSessionState();
            expect(sessionState.type).toBe('ASIAN');
            expect(sessionState.timeRemaining).toBe(5.5); // 6 - 0.5
        });
        it('should not emit duplicate session change events', () => {
            mockUTCTime(8, 0); // London session
            let eventCount = 0;
            profiler.on('SESSION_CHANGE', () => {
                eventCount++;
            });
            // Multiple calls to same session should not emit multiple events
            profiler.getSessionState();
            profiler.getSessionState();
            profiler.getSessionState();
            expect(eventCount).toBe(0); // No events since no transition occurred
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2l2YW4vQ29kZS90cmFkaW5nL3RpdGFuL3NlcnZpY2VzL3RpdGFuLXBoYXNlMi1odW50ZXIvdGVzdHMvdW5pdC9TZXNzaW9uUHJvZmlsZXIudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7R0FPRzs7QUFFSCxzRUFBbUU7QUFHbkUsUUFBUSxDQUFDLGlCQUFpQixFQUFFLEdBQUcsRUFBRTtJQUMvQixJQUFJLFFBQXlCLENBQUM7SUFDOUIsSUFBSSxZQUE2QixDQUFDO0lBRWxDLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxRQUFRLEdBQUcsSUFBSSxpQ0FBZSxFQUFFLENBQUM7UUFDakMsWUFBWSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUM7SUFDN0IsQ0FBQyxDQUFDLENBQUM7SUFFSCxTQUFTLENBQUMsR0FBRyxFQUFFO1FBQ2IsTUFBTSxDQUFDLElBQUksR0FBRyxZQUFZLENBQUM7SUFDN0IsQ0FBQyxDQUFDLENBQUM7SUFFSCxtQ0FBbUM7SUFDbkMsTUFBTSxXQUFXLEdBQUcsQ0FBQyxJQUFZLEVBQUUsU0FBaUIsQ0FBQyxFQUFFLEVBQUU7UUFDdkQsTUFBTSxRQUFRLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUM1QixRQUFRLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDdkQsUUFBUSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUMsRUFBRSxFQUFFLENBQUMsZUFBZSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQzNELE1BQU0sQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxRQUFRLENBQVEsQ0FBQztRQUM3QyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsR0FBRyxZQUFZLENBQUMsR0FBRyxDQUFDO0lBQ3JDLENBQUMsQ0FBQztJQUVGLHVDQUF1QztJQUN2QyxNQUFNLFdBQVcsR0FBRyxDQUFDLFNBQWlCLEVBQUUsSUFBWSxFQUFFLEdB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LENBQUM7WUFDOUMsTUFBTSxDQUFDLFVBQVcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDNUMsTUFBTSxDQUFDLFVBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDMUMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMscURBQXFELEVBQUUsR0FBRyxFQUFFO1lBQzdELE1BQU0sWUFBWSxHQUFHLEtBQUssQ0FBQyxDQUFDLDBCQUEwQjtZQUV0RCxNQUFNLFVBQVUsR0FBRyxRQUFRLENBQUMsZ0JBQWdCLENBQUMsWUFBWSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1lBRXJFLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDbEMsTUFBTSxDQUFDLFVBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDM0MsTUFBTSxDQUFDLFVBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDM0MsTUFBTSxDQUFDLFVBQVcsQ0FBQyxhQUFhLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDOUMsTUFBTSxDQUFDLFVBQVcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDM0MsTUFBTSxDQUFDLFVBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDMUMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsZ0VBQWdFLEVBQUUsR0FBRyxFQUFFO1lBQ3hFLE1BQU0sWUFBWSxHQUFHLEtBQUssQ0FBQyxDQUFDLHFCQUFxQjtZQUVqRCxNQUFNLFVBQVUsR0FBRyxRQUFRLENBQUMsZ0JBQWdCLENBQUMsWUFBWSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1lBRXJFLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxRQUFRLEVB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W10sInNvdXJjZXMiOlsiL1VzZXJzL2l2YW4vQ29kZS90cmFkaW5nL3RpdGFuL3NlcnZpY2VzL3RpdGFuLXBoYXNlMi1odW50ZXIvdGVzdHMvdW5pdC9TZXNzaW9uUHJvZmlsZXIudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFVuaXQgVGVzdHMgZm9yIFNlc3Npb25Qcm9maWxlclxuICogXG4gKiBUZXN0cyBzZXNzaW9uIGlkZW50aWZpY2F0aW9uLCBBc2lhbiByYW5nZSBzdG9yYWdlLCBKdWRhcyBTd2luZyBkZXRlY3Rpb24sXG4gKiBraWxsem9uZSBjaGVja2luZywgYW5kIHNlc3Npb24gdHJhbnNpdGlvbiBldmVudHMuXG4gKiBcbiAqIFJlcXVpcmVtZW50czogMi4xLTIuNyAoU2Vzc2lvbiBQcm9maWxlcilcbiAqL1xuXG5pbXBvcnQgeyBTZXNzaW9uUHJvZmlsZXIgfSBmcm9tICcuLi8uLi9zcmMvZW5naW5lL1Nlc3Npb25Qcm9maWxlcic7XG5pbXBvcnQgeyBTZXNzaW9uVHlwZSwgU2Vzc2lvblN0YXRlLCBBc2lhblJhbmdlLCBKdWRhc1N3aW5nLCBPSExDViB9IGZyb20gJy4uLy4uL3NyYy90eXBlcy9pbmRleCc7XG5cbmRlc2NyaWJlKCdTZXNzaW9uUHJvZmlsZXInLCAoKSA9PiB7XG4gIGxldCBwcm9maWxlcjogU2Vzc2lvblByb2ZpbGVyO1xuICBsZXQgb3JpZ2luYWxEYXRlOiBEYXRlQ29uc3RydWN0b3I7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgcHJvZmlsZXIgPSBuZXcgU2Vzc2lvblByb2ZpbGVyKCk7XG4gICAgb3JpZ2luYWxEYXRlID0gZ2xvYmFsLkRhdGU7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgZ2xvYmFsLkRhdGUgPSBvcmlnaW5hbERhdGU7XG4gIH0pO1xuXG4gIC8vIEhlbHBlciBmdW5jdGlvbiB0byBtb2NrIFVUQyB0aW1lXG4gIGNvbnN0IG1vY2tVVENUaW1lID0gKGhvdXI6IG51bWJlciwgbWludXRlOiBudW1iZXIgPSAwKSA9PiB7XG4gICAgY29uc3QgbW9ja0RhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIG1vY2tEYXRlLmdldFVUQ0hvdXJzID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShob3VyKTtcbiAgICBtb2NrRGF0ZS5nZXRVVENNaW51dGVzID0gamVzdC5mbigpLm1vY2tSZXR1cm5WYWx1ZShtaW51dGUpO1xuICAgIGdsb2JhbC5EYXRlID0gamVzdC5mbigoKSA9PiBtb2NrRGF0ZSkgYXMgYW55O1xuICAgIGdsb2JhbC5EYXRlLm5vdyA9IG9yaWdpbmFsRGF0ZS5ub3c7XG4gIH07XG5cbiAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGNyZWF0ZSBPSExDViBkYXRhXG4gIGNvbnN0IGNyZWF0ZU9ITENWID0gKHRpbWVzdGFtcDogbnVtYmVyLCBoaWdoOiBudW1iZXIsIGxvdzogbnVtYmVyKTogT0hMQ1YgPT4gKHtcbiAgICB0aW1lc3RhbXAsXG4gICAgb3BlbjogKGhpZ2ggKyBsb3cpIC8gMixcbiAgICBoaWdoLFxuICAgIGxvdyxcbiAgICBjbG9zZTogKGhpZ2ggKyBsb3cpIC8gMixcbiAgICB2b2x1bWU6IDEwMDBcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldFNlc3Npb25TdGF0ZScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGlkZW50aWZ5IEFzaWFuIHNlc3Npb24gKDAwOjAwLTA2OjAwIFVUQyknLCAoKSA9PiB7XG4gICAgICBtb2NrVVRDVGltZSgzLCAzMCk7IC8vIDAzOjMwIFVUQ1xuXG4gICAgICBjb25zdCBzZXNzaW9uU3RhdGUgPSBwcm9maWxlci5nZXRTZXNzaW9uU3RhdGUoKTtcblxuICAgICAgZXhwZWN0KHNlc3Npb25TdGF0ZS50eXBlKS50b0JlKCdBU0lBTicpO1xuICAgICAgZXhwZWN0KHNlc3Npb25TdGF0ZS5zdGFydFRpbWUpLnRvQmUoMCk7XG4gICAgICBleHBlY3Qoc2Vzc2lvblN0YXRlLmVuZFRpbWUpLnRvQmUoNik7XG4gICAgICBleHBlY3Qoc2Vzc2lvblN0YXRlLnRpbWVSZW1haW5pbmcpLnRvQmUoMi41KTsgLy8gNiAtIDMuNVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBpZGVudGlmeSBMb25kb24gc2Vzc2lvbiAoMDc6MDAtMTA6MDAgVVRDKScsICgpID0+IHtcbiAgICAgIG1vY2tVVENUaW1lKDgsIDE1KTsgLy8gMDg6MTUgVVRDXG5cbiAgICAgIGNvbnN0IHNlc3Npb25TdGF0ZSA9IHByb2ZpbGVyLmdldFNlc3Npb25TdGF0ZSgpO1xuXG4gICAgICBleHBlY3Qoc2Vzc2lvblN0YXRlLnR5cGUpLnRvQmUoJ0xPTkRPTicpO1xuICAgICAgZXhwZWN0KHNlc3Npb25TdGF0ZS5zdGFydFRpbWUpLnRvQmUoNyk7XG4gICAgICBleHBlY3Qoc2Vzc2lvblN0YXRlLmVuZFRpbWUpLnRvQmUoMTApO1xuICAgICAgZXhwZWN0KHNlc3Npb25TdGF0ZS50aW1lUmVtYWluaW5nKS50b0JlKDEuNzUpOyAvLyAxMCAtIDguMjVcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaWRlbnRpZnkgTlkgc2Vzc2lvbiAoMTM6MDAtMTY6MDAgVVRDKScsICgpID0+IHtcbiAgICAgIG1vY2tVVENUaW1lKDE0LCA0NSk7IC8vIDE0OjQ1IFVUQ1xuXG4gICAgICBjb25zdCBzZXNzaW9uU3RhdGUgPSBwcm9maWxlci5nZXRTZXNzaW9uU3RhdGUoKTtcblxuICAgICAgZXhwZWN0KHNlc3Npb25TdGF0ZS50eXBlKS50b0JlKCdOWScpO1xuICAgICAgZXhwZWN0KHNlc3Npb25TdGF0ZS5zdGFydFRpbWUpLnRvQmUoMTMpO1xuICAgICAgZXhwZWN0KHNlc3Npb25TdGF0ZS5lbmRUaW1lKS50b0JlKDE2KTtcbiAgICAgIGV4cGVjdChzZXNzaW9uU3RhdGUudGltZVJlbWFpbmluZykudG9CZSgxLjI1KTsgLy8gMTYgLSAxNC43NVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBpZGVudGlmeSBEZWFkIFpvbmUgKDIxOjAwLTAxOjAwIFVUQyknLCAoKSA9PiB7XG4gICAgICBtb2NrVVRDVGltZSgyMywgMCk7IC8vIDIzOjAwIFVUQ1xuXG4gICAgICBjb25zdCBzZXNzaW9uU3RhdGUgPSBwcm9maWxlci5nZXRTZXNzaW9uU3RhdGUoKTtcblxuICAgICAgZXhwZWN0KHNlc3Npb25TdGF0ZS50eXBlKS50b0JlKCdERUFEX1pPTkUnKTtcbiAgICAgIGV4cGVjdChzZXNzaW9uU3RhdGUuc3RhcnRUaW1lKS50b0JlKDIxKTtcbiAgICAgIGV4cGVjdChzZXNzaW9uU3RhdGUuZW5kVGltZSkudG9CZSgxKTtcbiAgICAgIGV4cGVjdChzZXNzaW9uU3RhdGUudGltZVJlbWFpbmluZykudG9CZSgyKTsgLy8gKDI0IC0gMjMpICsgMVxuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBpZGVudGlmeSBEZWFkIFpvbmUgZWFybHkgbW9ybmluZyAoMDA6MzAgVVRDKScsICgpID0+IHtcbiAgICAgIG1vY2tVVENUaW1lKDAsIDMwKTsgLy8gMDA6MzAgVVRDIChidXQgbm90IEFzaWFuIHNlc3Npb24pXG4gICAgICBcbiAgICAgIC8vIE1vY2sgdG8gcmV0dXJuIERFQURfWk9ORSBmb3IgdGhpcyBzcGVjaWZpYyB0aW1lXG4gICAgICBjb25zdCBzZXNzaW9uU3RhdGUgPSBwcm9maWxlci5nZXRTZXNzaW9uU3RhdGUoKTtcbiAgICAgIFxuICAgICAgLy8gQXQgMDA6MzAsIGl0IHNob3VsZCBiZSBBc2lhbiBzZXNzaW9uLCBub3QgRGVhZCBab25lXG4gICAgICBleHBlY3Qoc2Vzc2lvblN0YXRlLnR5cGUpLnRvQmUoJ0FTSUFOJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBEZWFkIFpvbmUgZWFybHkgbW9ybmluZyBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBtb2NrVVRDVGltZSgyMiwgMzApOyAvLyAyMjozMCBVVEMgKERlYWQgWm9uZSlcblxuICAgICAgY29uc3Qgc2Vzc2lvblN0YXRlID0gcHJvZmlsZXIuZ2V0U2Vzc2lvblN0YXRlKCk7XG5cbiAgICAgIGV4cGVjdChzZXNzaW9uU3RhdGUudHlwZSkudG9CZSgnREVBRF9aT05FJyk7XG4gICAgICBleHBlY3Qoc2Vzc2lvblN0YXRlLnRpbWVSZW1haW5pbmcpLnRvQmUoMi41KTsgLy8gKDI0IC0gMjIuNSkgKyAxXG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdzdG9yZUFzaWFuUmFuZ2UnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzdG9yZSBBc2lhbiByYW5nZSBmcm9tIE9ITENWIGRhdGEnLCAoKSA9PiB7XG4gICAgICBjb25zdCBhc2lhbkRhdGE6IE9ITENWW10gPSBbXG4gICAgICAgIGNyZWF0ZU9ITENWKG5ldyBEYXRlKCcyMDI0LTAxLTAxVDAyOjAwOjAwWicpLmdldFRpbWUoKSwgNTAxMDAsIDQ5OTAwKSwgLy8gQXNpYW4gc2Vzc2lvblxuICAgICAgICBjcmVhdGVPSExDVihuZXcgRGF0ZSgnMjAyNC0wMS0wMVQwNDowMDowMFonKS5nZXRUaW1lKCksIDUwMjAwLCA0OTgwMCksIC8vIEFzaWFuIHNlc3Npb25cbiAgICAgICAgY3JlYXRlT0hMQ1YobmV3IERhdGUoJzIwMjQtMDEtMDFUMDg6MDA6MDBaJykuZ2V0VGltZSgpLCA1MDMwMCwgNDk3MDApLCAvLyBMb25kb24gc2Vzc2lvbiAoc2hvdWxkIGJlIGlnbm9yZWQpXG4gICAgICBdO1xuXG4gICAgICBwcm9maWxlci5zdG9yZUFzaWFuUmFuZ2UoYXNpYW5EYXRhKTtcblxuICAgICAgY29uc3QgYXNpYW5SYW5nZSA9IHByb2ZpbGVyLmdldEFzaWFuUmFuZ2UoKTtcbiAgICAgIGV4cGVjdChhc2lhblJhbmdlKS5ub3QudG9CZU51bGwoKTtcbiAgICAgIGV4cGVjdChhc2lhblJhbmdlIS5oaWdoKS50b0JlKDUwMjAwKTsgLy8gSGlnaGVzdCBkdXJpbmcgQXNpYW4gc2Vzc2lvblxuICAgICAgZXhwZWN0KGFzaWFuUmFuZ2UhLmxvdykudG9CZSg0OTgwMCk7ICAvLyBMb3dlc3QgZHVyaW5nIEFzaWFuIHNlc3Npb25cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGVtcHR5IE9ITENWIGRhdGEnLCAoKSA9PiB7XG4gICAgICBwcm9maWxlci5zdG9yZUFzaWFuUmFuZ2UoW10pO1xuXG4gICAgICBjb25zdCBhc2lhblJhbmdlID0gcHJvZmlsZXIuZ2V0QXNpYW5SYW5nZSgpO1xuICAgICAgZXhwZWN0KGFzaWFuUmFuZ2UpLnRvQmVOdWxsKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGlnbm9yZSBub24tQXNpYW4gc2Vzc2lvbiBkYXRhJywgKCkgPT4ge1xuICAgICAgY29uc3Qgbm9uQXNpYW5EYXRhOiBPSExDVltdID0gW1xuICAgICAgICBjcmVhdGVPSExDVihuZXcgRGF0ZSgnMjAyNC0wMS0wMVQwODowMDowMFonKS5nZXRUaW1lKCksIDUwMzAwLCA0OTcwMCksIC8vIExvbmRvblxuICAgICAgICBjcmVhdGVPSExDVihuZXcgRGF0ZSgnMjAyNC0wMS0wMVQxNDowMDowMFonKS5nZXRUaW1lKCksIDUwNDAwLCA0OTYwMCksIC8vIE5ZXG4gICAgICBdO1xuXG4gICAgICBwcm9maWxlci5zdG9yZUFzaWFuUmFuZ2Uobm9uQXNpYW5EYXRhKTtcblxuICAgICAgY29uc3QgYXNpYW5SYW5nZSA9IHByb2ZpbGVyLmdldEFzaWFuUmFuZ2UoKTtcbiAgICAgIGV4cGVjdChhc2lhblJhbmdlKS50b0JlTnVsbCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZGV0ZWN0SnVkYXNTd2luZycsICgpID0+IHtcbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIC8vIFNldCB1cCBBc2lhbiByYW5nZSBmb3IgdGVzdGluZ1xuICAgICAgY29uc3QgYXNpYW5EYXRhOiBPSExDVltdID0gW1xuICAgICAgICBjcmVhdGVPSExDVihuZXcgRGF0ZSgnMjAyNC0wMS0wMVQwMjowMDowMFonKS5nZXRUaW1lKCksIDUwMTAwLCA0OTkwMCksXG4gICAgICBdO1xuICAgICAgcHJvZmlsZXIuc3RvcmVBc2lhblJhbmdlKGFzaWFuRGF0YSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGRldGVjdCBBc2lhbiBIaWdoIHN3ZWVwIGR1cmluZyBMb25kb24gc2Vzc2lvbicsICgpID0+IHtcbiAgICAgIGNvbnN0IGN1cnJlbnRQcmljZSA9IDUwMTUwOyAvLyBBYm92ZSBBc2lhbiBIaWdoICg1MDEwMClcbiAgICAgIFxuICAgICAgY29uc3QganVkYXNTd2luZyA9IHByb2ZpbGVyLmRldGVjdEp1ZGFzU3dpbmcoY3VycmVudFByaWNlLCAnTE9ORE9OJyk7XG5cbiAgICAgIGV4cGVjdChqdWRhc1N3aW5nKS5ub3QudG9CZU51bGwoKTtcbiAgICAgIGV4cGVjdChqdWRhc1N3aW5nIS50eXBlKS50b0JlKCdTV0VFUF9ISUdIJyk7XG4gICAgICBleHBlY3QoanVkYXNTd2luZyEuc3dlcHRQcmljZSkudG9CZSg1MDEwMCk7XG4gICAgICBleHBlY3QoanVkYXNTd2luZyEucmV2ZXJzYWxQcmljZSkudG9CZSg0OTkwMCk7XG4gICAgICBleHBlY3QoanVkYXNTd2luZyEuZGlyZWN0aW9uKS50b0JlKCdTSE9SVCcpO1xuICAgICAgZXhwZWN0KGp1ZGFzU3dpbmchLmNvbmZpZGVuY2UpLnRvQmUoNzUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBkZXRlY3QgQXNpYW4gTG93IHN3ZWVwIGR1cmluZyBMb25kb24gc2Vzc2lvbicsICgpID0+IHtcbiAgICAgIGNvbnN0IGN1cnJlbnRQcmljZSA9IDQ5ODUwOyAvLyBCZWxvdyBBc2lhbiBMb3cgKDQ5OTAwKVxuICAgICAgXG4gICAgICBjb25zdCBqdWRhc1N3aW5nID0gcHJvZmlsZXIuZGV0ZWN0SnVkYXNTd2luZyhjdXJyZW50UHJpY2UsICdMT05ET04nKTtcblxuICAgICAgZXhwZWN0KGp1ZGFzU3dpbmcpLm5vdC50b0JlTnVsbCgpO1xuICAgICAgZXhwZWN0KGp1ZGFzU3dpbmchLnR5cGUpLnRvQmUoJ1NXRUVQX0xPVycpO1xuICAgICAgZXhwZWN0KGp1ZGFzU3dpbmchLnN3ZXB0UHJpY2UpLnRvQmUoNDk5MDApO1xuICAgICAgZXhwZWN0KGp1ZGFzU3dpbmchLnJldmVyc2FsUHJpY2UpLnRvQmUoNTAxMDApO1xuICAgICAgZXhwZWN0KGp1ZGFzU3dpbmchLmRpcmVjdGlvbikudG9CZSgnTE9ORycpO1xuICAgICAgZXhwZWN0KGp1ZGFzU3dpbmchLmNvbmZpZGVuY2UpLnRvQmUoNzUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBub3QgZGV0ZWN0IEp1ZGFzIFN3aW5nIHdoZW4gcHJpY2UgaXMgd2l0aGluIEFzaWFuIHJhbmdlJywgKCkgPT4ge1xuICAgICAgY29uc3QgY3VycmVudFByaWNlID0gNTAwMDA7IC8vIFdpdGhpbiBBc2lhbiByYW5nZVxuICAgICAgXG4gICAgICBjb25zdCBqdWRhc1N3aW5nID0gcHJvZmlsZXIuZGV0ZWN0SnVkYXNTd2luZyhjdXJyZW50UHJpY2UsICdMT05ET04nKTtcblxuICAgICAgZXhwZWN0KGp1ZGFzU3dpbmcpLnRvQmVOdWxsKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCBkZXRlY3QgSnVkYXMgU3dpbmcgZHVyaW5nIEFzaWFuIHNlc3Npb24nLCAoKSA9PiB7XG4gICAgICBjb25zdCBjdXJyZW50UHJpY2UgPSA1MDE1MDsgLy8gQWJvdmUgQXNpYW4gSGlnaFxuICAgICAgXG4gICAgICBjb25zdCBqdWRhc1N3aW5nID0gcHJvZmlsZXIuZGV0ZWN0SnVkYXNTd2luZyhjdXJyZW50UHJpY2UsICdBU0lBTicpO1xuXG4gICAgICBleHBlY3QoanVkYXNTd2luZykudG9CZU51bGwoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZGV0ZWN0IExvbmRvbiByYW5nZSBzd2VlcCBkdXJpbmcgTlkgc2Vzc2lvbicsICgpID0+IHtcbiAgICAgIC8vIFNldCB1cCBMb25kb24gcmFuZ2VcbiAgICAgIGNvbnN0IGxvbmRvbkRhdGE6IE9ITENWW10gPSBbXG4gICAgICAgIGNyZWF0ZU9ITENWKG5ldyBEYXRlKCcyMDI0LTAxLTAxVDA4OjAwOjAwWicpLmdldFRpbWUoKSwgNTAzMDAsIDQ5NzAwKSxcbiAgICAgIF07XG4gICAgICBwcm9maWxlci51cGRhdGVMb25kb25SYW5nZShsb25kb25EYXRhKTtcblxuICAgICAgY29uc3QgY3VycmVudFByaWNlID0gNTAzNTA7IC8vIEFib3ZlIExvbmRvbiBIaWdoXG4gICAgICBcbiAgICAgIGNvbnN0IGp1ZGFzU3dpbmcgPSBwcm9maWxlci5kZXRlY3RKdWRhc1N3aW5nKGN1cnJlbnRQcmljZSwgJ05ZJyk7XG5cbiAgICAgIGV4cGVjdChqdWRhc1N3aW5nKS5ub3QudG9CZU51bGwoKTtcbiAgICAgIGV4cGVjdChqdWRhc1N3aW5nIS50eXBlKS50b0JlKCdTV0VFUF9ISUdIJyk7XG4gICAgICBleHBlY3QoanVkYXNTd2luZyEuc3dlcHRQcmljZSkudG9CZSg1MDMwMCk7XG4gICAgICBleHBlY3QoanVkYXNTd2luZyEuZGlyZWN0aW9uKS50b0JlKCdTSE9SVCcpO1xuICAgICAgZXhwZWN0KGp1ZGFzU3dpbmchLmNvbmZpZGVuY2UpLnRvQmUoODApOyAvLyBIaWdoZXIgY29uZmlkZW5jZSBmb3IgTllcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2lzS2lsbHpvbmUnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gdHJ1ZSBkdXJpbmcgTG9uZG9uIHNlc3Npb24nLCAoKSA9PiB7XG4gICAgICBtb2NrVVRDVGltZSg4LCAzMCk7IC8vIExvbmRvbiBzZXNzaW9uXG5cbiAgICAgIGNvbnN0IGlzS2lsbHpvbmUgPSBwcm9maWxlci5pc0tpbGx6b25lKCk7XG5cbiAgICAgIGV4cGVjdChpc0tpbGx6b25lKS50b0JlKHRydWUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gdHJ1ZSBkdXJpbmcgTlkgc2Vzc2lvbicsICgpID0+IHtcbiAgICAgIG1vY2tVVENUaW1lKDE0LCAzMCk7IC8vIE5ZIHNlc3Npb25cblxuICAgICAgY29uc3QgaXNLaWxsem9uZSA9IHByb2ZpbGVyLmlzS2lsbHpvbmUoKTtcblxuICAgICAgZXhwZWN0KGlzS2lsbHpvbmUpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBmYWxzZSBkdXJpbmcgQXNpYW4gc2Vzc2lvbicsICgpID0+IHtcbiAgICAgIG1vY2tVVENUaW1lKDMsIDMwKTsgLy8gQXNpYW4gc2Vzc2lvblxuXG4gICAgICBjb25zdCBpc0tpbGx6b25lID0gcHJvZmlsZXIuaXNLaWxsem9uZSgpO1xuXG4gICAgICBleHBlY3QoaXNLaWxsem9uZSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBmYWxzZSBkdXJpbmcgRGVhZCBab25lJywgKCkgPT4ge1xuICAgICAgbW9ja1VUQ1RpbWUoMjIsIDMwKTsgLy8gRGVhZCBab25lXG5cbiAgICAgIGNvbnN0IGlzS2lsbHpvbmUgPSBwcm9maWxlci5pc0tpbGx6b25lKCk7XG5cbiAgICAgIGV4cGVjdChpc0tpbGx6b25lKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3Nob3VsZERpc2FibGVOZXdFbnRyaWVzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIHRydWUgZHVyaW5nIERlYWQgWm9uZScsICgpID0+IHtcbiAgICAgIG1vY2tVVENUaW1lKDIyLCAzMCk7IC8vIERlYWQgWm9uZVxuXG4gICAgICBjb25zdCBzaG91bGREaXNhYmxlID0gcHJvZmlsZXIuc2hvdWxkRGlzYWJsZU5ld0VudHJpZXMoKTtcblxuICAgICAgZXhwZWN0KHNob3VsZERpc2FibGUpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBmYWxzZSBkdXJpbmcga2lsbHpvbmVzJywgKCkgPT4ge1xuICAgICAgbW9ja1VUQ1RpbWUoOCwgMzApOyAvLyBMb25kb24gc2Vzc2lvblxuXG4gICAgICBjb25zdCBzaG91bGREaXNhYmxlID0gcHJvZmlsZXIuc2hvdWxkRGlzYWJsZU5ld0VudHJpZXMoKTtcblxuICAgICAgZXhwZWN0KHNob3VsZERpc2FibGUpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgndXBkYXRlTG9uZG9uUmFuZ2UnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzdG9yZSBMb25kb24gcmFuZ2UgZnJvbSBPSExDViBkYXRhJywgKCkgPT4ge1xuICAgICAgY29uc3QgbG9uZG9uRGF0YTogT0hMQ1ZbXSA9IFtcbiAgICAgICAgY3JlYXRlT0hMQ1YobmV3IERhdGUoJzIwMjQtMDEtMDFUMDg6MDA6MDBaJykuZ2V0VGltZSgpLCA1MDMwMCwgNDk3MDApLCAvLyBMb25kb24gc2Vzc2lvblxuICAgICAgICBjcmVhdGVPSExDVihuZXcgRGF0ZSgnMjAyNC0wMS0wMVQwOTowMDowMFonKS5nZXRUaW1lKCksIDUwMjUwLCA0OTc1MCksIC8vIExvbmRvbiBzZXNzaW9uXG4gICAgICAgIGNyZWF0ZU9ITENWKG5ldyBEYXRlKCcyMDI0LTAxLTAxVDE0OjAwOjAwWicpLmdldFRpbWUoKSwgNTA0MDAsIDQ5NjAwKSwgLy8gTlkgc2Vzc2lvbiAoc2hvdWxkIGJlIGlnbm9yZWQpXG4gICAgICBdO1xuXG4gICAgICBwcm9maWxlci51cGRhdGVMb25kb25SYW5nZShsb25kb25EYXRhKTtcblxuICAgICAgY29uc3QgbG9uZG9uUmFuZ2UgPSBwcm9maWxlci5nZXRMb25kb25SYW5nZSgpO1xuICAgICAgZXhwZWN0KGxvbmRvblJhbmdlKS5ub3QudG9CZU51bGwoKTtcbiAgICAgIGV4cGVjdChsb25kb25SYW5nZSEuaGlnaCkudG9CZSg1MDMwMCk7IC8vIEhpZ2hlc3QgZHVyaW5nIExvbmRvbiBzZXNzaW9uXG4gICAgICBleHBlY3QobG9uZG9uUmFuZ2UhLmxvdykudG9CZSg0OTcwMCk7ICAvLyBMb3dlc3QgZHVyaW5nIExvbmRvbiBzZXNzaW9uXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGlnbm9yZSBub24tTG9uZG9uIHNlc3Npb24gZGF0YScsICgpID0+IHtcbiAgICAgIGNvbnN0IG5vbkxvbmRvbkRhdGE6IE9ITENWW10gPSBbXG4gICAgICAgIGNyZWF0ZU9ITENWKG5ldyBEYXRlKCcyMDI0LTAxLTAxVDAyOjAwOjAwWicpLmdldFRpbWUoKSwgNTAxMDAsIDQ5OTAwKSwgLy8gQXNpYW5cbiAgICAgICAgY3JlYXRlT0hMQ1YobmV3IERhdGUoJzIwMjQtMDEtMDFUMTQ6MDA6MDBaJykuZ2V0VGltZSgpLCA1MDQwMCwgNDk2MDApLCAvLyBOWVxuICAgICAgXTtcblxuICAgICAgcHJvZmlsZXIudXBkYXRlTG9uZG9uUmFuZ2Uobm9uTG9uZG9uRGF0YSk7XG5cbiAgICAgIGNvbnN0IGxvbmRvblJhbmdlID0gcHJvZmlsZXIuZ2V0TG9uZG9uUmFuZ2UoKTtcbiAgICAgIGV4cGVjdChsb25kb25SYW5nZSkudG9CZU51bGwoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3Nlc3Npb24gdHJhbnNpdGlvbiBldmVudHMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBlbWl0IFNFU1NJT05fQ0hBTkdFIGV2ZW50IG9uIHNlc3Npb24gdHJhbnNpdGlvbicsIChkb25lKSA9PiB7XG4gICAgICBtb2NrVVRDVGltZSg4LCAwKTsgLy8gTG9uZG9uIHNlc3Npb25cbiAgICAgIFxuICAgICAgLy8gRmlyc3QgY2FsbCB0byBlc3RhYmxpc2ggY3VycmVudCBzZXNzaW9uXG4gICAgICBwcm9maWxlci5nZXRTZXNzaW9uU3RhdGUoKTtcblxuICAgICAgLy8gU2V0IHVwIGV2ZW50IGxpc3RlbmVyXG4gICAgICBwcm9maWxlci5vbmNlKCdTRVNTSU9OX0NIQU5HRScsIChldmVudCkgPT4ge1xuICAgICAgICBleHBlY3QoZXZlbnQucHJldmlvdXNTZXNzaW9uKS50b0JlKCdMT05ET04nKTtcbiAgICAgICAgZXhwZWN0KGV2ZW50Lm5ld1Nlc3Npb24pLnRvQmUoJ05ZJyk7XG4gICAgICAgIGV4cGVjdChldmVudC50aW1lc3RhbXApLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICAgICAgZG9uZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENoYW5nZSB0byBOWSBzZXNzaW9uXG4gICAgICBtb2NrVVRDVGltZSgxNCwgMCk7XG4gICAgICBwcm9maWxlci5nZXRTZXNzaW9uU3RhdGUoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZW1pdCBMT05ET05fT1BFTiBldmVudCB3aGVuIHRyYW5zaXRpb25pbmcgdG8gTG9uZG9uJywgKGRvbmUpID0+IHtcbiAgICAgIG1vY2tVVENUaW1lKDUsIDApOyAvLyBBc2lhbiBzZXNzaW9uXG4gICAgICBwcm9maWxlci5nZXRTZXNzaW9uU3RhdGUoKTtcblxuICAgICAgcHJvZmlsZXIub25jZSgnTE9ORE9OX09QRU4nLCAoZXZlbnQpID0+IHtcbiAgICAgICAgZXhwZWN0KGV2ZW50LnRpbWVzdGFtcCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgICBkb25lKCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gVHJhbnNpdGlvbiB0byBMb25kb25cbiAgICAgIG1vY2tVVENUaW1lKDgsIDApO1xuICAgICAgcHJvZmlsZXIuZ2V0U2Vzc2lvblN0YXRlKCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGVtaXQgTllfT1BFTiBldmVudCB3aGVuIHRyYW5zaXRpb25pbmcgdG8gTlknLCAoZG9uZSkgPT4ge1xuICAgICAgbW9ja1VUQ1RpbWUoOCwgMCk7IC8vIExvbmRvbiBzZXNzaW9uXG4gICAgICBwcm9maWxlci5nZXRTZXNzaW9uU3RhdGUoKTtcblxuICAgICAgcHJvZmlsZXIub25jZSgnTllfT1BFTicsIChldmVudCkgPT4ge1xuICAgICAgICBleHBlY3QoZXZlbnQudGltZXN0YW1wKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICAgIGRvbmUoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBUcmFuc2l0aW9uIHRvIE5ZXG4gICAgICBtb2NrVVRDVGltZSgxNCwgMCk7XG4gICAgICBwcm9maWxlci5nZXRTZXNzaW9uU3RhdGUoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZW1pdCBERUFEX1pPTkVfU1RBUlQgZXZlbnQgd2hlbiB0cmFuc2l0aW9uaW5nIHRvIERlYWQgWm9uZScsIChkb25lKSA9PiB7XG4gICAgICBtb2NrVVRDVGltZSgxNSwgMCk7IC8vIE5ZIHNlc3Npb25cbiAgICAgIHByb2ZpbGVyLmdldFNlc3Npb25TdGF0ZSgpO1xuXG4gICAgICBwcm9maWxlci5vbmNlKCdERUFEX1pPTkVfU1RBUlQnLCAoZXZlbnQpID0+IHtcbiAgICAgICAgZXhwZWN0KGV2ZW50LnRpbWVzdGFtcCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgICAgICBkb25lKCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gVHJhbnNpdGlvbiB0byBEZWFkIFpvbmVcbiAgICAgIG1vY2tVVENUaW1lKDIyLCAwKTtcbiAgICAgIHByb2ZpbGVyLmdldFNlc3Npb25TdGF0ZSgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0U2Vzc2lvblN0YXRzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvbXByZWhlbnNpdmUgc2Vzc2lvbiBzdGF0aXN0aWNzJywgKCkgPT4ge1xuICAgICAgbW9ja1VUQ1RpbWUoOCwgMzApOyAvLyBMb25kb24gc2Vzc2lvblxuICAgICAgXG4gICAgICAvLyBTZXQgdXAgcmFuZ2VzIC0gdXNlIGEgZGlyZWN0IHRpbWVzdGFtcCBmb3IgMiBBTSBVVENcbiAgICAgIGNvbnN0IHRpbWVzdGFtcDJBTSA9IERhdGUuVVRDKDIwMjQsIDAsIDEsIDIsIDAsIDApOyAvLyBKYW51YXJ5IDEsIDIwMjQsIDI6MDAgQU0gVVRDXG4gICAgICBjb25zdCBhc2lhbkRhdGE6IE9ITENWW10gPSBbXG4gICAgICAgIGNyZWF0ZU9ITENWKHRpbWVzdGFtcDJBTSwgNTAxMDAsIDQ5OTAwKSxcbiAgICAgIF07XG4gICAgICBcbiAgICAgIC8vIERlYnVnIHRoZSBBc2lhbiBkYXRhXG4gICAgICBleHBlY3QobmV3IERhdGUoYXNpYW5EYXRhWzBdLnRpbWVzdGFtcCkuZ2V0VVRDSG91cnMoKSkudG9CZSgyKTtcbiAgICAgIFxuICAgICAgcHJvZmlsZXIuc3RvcmVBc2lhblJhbmdlKGFzaWFuRGF0YSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGFzaWFuUmFuZ2VBZnRlclN0b3JlID0gcHJvZmlsZXIuZ2V0QXNpYW5SYW5nZSgpO1xuICAgICAgXG4gICAgICAvLyBUaGlzIHNob3VsZCBub3QgYmUgbnVsbCBpZiBzdG9yZUFzaWFuUmFuZ2Ugd29ya2VkXG4gICAgICBleHBlY3QoYXNpYW5SYW5nZUFmdGVyU3RvcmUpLm5vdC50b0JlTnVsbCgpO1xuICAgICAgXG4gICAgICBjb25zdCB0aW1lc3RhbXA4QU0gPSBEYXRlLlVUQygyMDI0LCAwLCAxLCA4LCAwLCAwKTsgLy8gSmFudWFyeSAxLCAyMDI0LCA4OjAwIEFNIFVUQ1xuICAgICAgY29uc3QgbG9uZG9uRGF0YTogT0hMQ1ZbXSA9IFtcbiAgICAgICAgY3JlYXRlT0hMQ1YodGltZXN0YW1wOEFNLCA1MDMwMCwgNDk3MDApLFxuICAgICAgXTtcbiAgICAgIHByb2ZpbGVyLnVwZGF0ZUxvbmRvblJhbmdlKGxvbmRvbkRhdGEpO1xuXG4gICAgICBjb25zdCBzdGF0cyA9IHByb2ZpbGVyLmdldFNlc3Npb25TdGF0cygpO1xuXG4gICAgICBleHBlY3Qoc3RhdHMuY3VycmVudFNlc3Npb24pLnRvQmUoJ0xPTkRPTicpO1xuICAgICAgZXhwZWN0KHN0YXRzLnRpbWVSZW1haW5pbmcpLnRvQmUoMS41KTsgLy8gMTAgLSA4LjVcbiAgICAgIGV4cGVjdChzdGF0cy5hc2lhblJhbmdlKS50b0VxdWFsKHtcbiAgICAgICAgaGlnaDogNTAxMDAsXG4gICAgICAgIGxvdzogNDk5MDAsXG4gICAgICAgIHRpbWVzdGFtcDogZXhwZWN0LmFueShOdW1iZXIpXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChzdGF0cy5sb25kb25SYW5nZSkudG9FcXVhbCh7XG4gICAgICAgIGhpZ2g6IDUwMzAwLFxuICAgICAgICBsb3c6IDQ5NzAwLFxuICAgICAgICB0aW1lc3RhbXA6IGV4cGVjdC5hbnkoTnVtYmVyKVxuICAgICAgfSk7XG4gICAgICBleHBlY3Qoc3RhdHMuaXNLaWxsem9uZSkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2VkZ2UgY2FzZXMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2Vzc2lvbiBib3VuZGFyeSBjb3JyZWN0bHkgKGV4YWN0bHkgMDY6MDAgVVRDKScsICgpID0+IHtcbiAgICAgIG1vY2tVVENUaW1lKDYsIDApOyAvLyBFeGFjdGx5IDA2OjAwIFVUQ1xuXG4gICAgICBjb25zdCBzZXNzaW9uU3RhdGUgPSBwcm9maWxlci5nZXRTZXNzaW9uU3RhdGUoKTtcblxuICAgICAgLy8gQXQgZXhhY3RseSAwNjowMCwgaXQgc2hvdWxkIG5vdCBiZSBBc2lhbiBzZXNzaW9uIGFueW1vcmVcbiAgICAgIGV4cGVjdChzZXNzaW9uU3RhdGUudHlwZSkubm90LnRvQmUoJ0FTSUFOJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBzZXNzaW9uIGJvdW5kYXJ5IGNvcnJlY3RseSAoZXhhY3RseSAwNzowMCBVVEMpJywgKCkgPT4ge1xuICAgICAgbW9ja1VUQ1RpbWUoNywgMCk7IC8vIEV4YWN0bHkgMDc6MDAgVVRDXG5cbiAgICAgIGNvbnN0IHNlc3Npb25TdGF0ZSA9IHByb2ZpbGVyLmdldFNlc3Npb25TdGF0ZSgpO1xuXG4gICAgICBleHBlY3Qoc2Vzc2lvblN0YXRlLnR5cGUpLnRvQmUoJ0xPTkRPTicpO1xuICAgICAgZXhwZWN0KHNlc3Npb25TdGF0ZS50aW1lUmVtYWluaW5nKS50b0JlKDMpOyAvLyAxMCAtIDdcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1pZG5pZ2h0IHRyYW5zaXRpb24gY29ycmVjdGx5JywgKCkgPT4ge1xuICAgICAgbW9ja1VUQ1RpbWUoMCwgMzApOyAvLyAwMDozMCBVVENcblxuICAgICAgY29uc3Qgc2Vzc2lvblN0YXRlID0gcHJvZmlsZXIuZ2V0U2Vzc2lvblN0YXRlKCk7XG5cbiAgICAgIGV4cGVjdChzZXNzaW9uU3RhdGUudHlwZSkudG9CZSgnQVNJQU4nKTtcbiAgICAgIGV4cGVjdChzZXNzaW9uU3RhdGUudGltZVJlbWFpbmluZykudG9CZSg1LjUpOyAvLyA2IC0gMC41XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCBlbWl0IGR1cGxpY2F0ZSBzZXNzaW9uIGNoYW5nZSBldmVudHMnLCAoKSA9PiB7XG4gICAgICBtb2NrVVRDVGltZSg4LCAwKTsgLy8gTG9uZG9uIHNlc3Npb25cbiAgICAgIFxuICAgICAgbGV0IGV2ZW50Q291bnQgPSAwO1xuICAgICAgcHJvZmlsZXIub24oJ1NFU1NJT05fQ0hBTkdFJywgKCkgPT4ge1xuICAgICAgICBldmVudENvdW50Kys7XG4gICAgICB9KTtcblxuICAgICAgLy8gTXVsdGlwbGUgY2FsbHMgdG8gc2FtZSBzZXNzaW9uIHNob3VsZCBub3QgZW1pdCBtdWx0aXBsZSBldmVudHNcbiAgICAgIHByb2ZpbGVyLmdldFNlc3Npb25TdGF0ZSgpO1xuICAgICAgcHJvZmlsZXIuZ2V0U2Vzc2lvblN0YXRlKCk7XG4gICAgICBwcm9maWxlci5nZXRTZXNzaW9uU3RhdGUoKTtcblxuICAgICAgZXhwZWN0KGV2ZW50Q291bnQpLnRvQmUoMCk7IC8vIE5vIGV2ZW50cyBzaW5jZSBubyB0cmFuc2l0aW9uIG9jY3VycmVkXG4gICAgfSk7XG4gIH0pO1xufSk7Il0sInZlcnNpb24iOjN9