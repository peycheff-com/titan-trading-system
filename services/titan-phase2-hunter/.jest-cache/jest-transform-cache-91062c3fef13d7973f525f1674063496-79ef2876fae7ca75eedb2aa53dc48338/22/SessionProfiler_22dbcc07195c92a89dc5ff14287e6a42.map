{"file":"/Users/ivan/Code/trading/titan/services/titan-phase2-hunter/src/engine/SessionProfiler.ts","mappings":"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","names":[],"sources":["/Users/ivan/Code/trading/titan/services/titan-phase2-hunter/src/engine/SessionProfiler.ts"],"sourcesContent":["/**\n * SessionProfiler - Time & Price Dynamics Engine\n * \n * Exploits the \"Judas Swing\" (false moves) at London/NY opens to catch \n * manipulation-to-distribution transitions. Identifies session-based \n * trading opportunities and manages time-based logic.\n * \n * Requirements: 2.1-2.7 (Session Profiler)\n */\n\nimport { EventEmitter } from 'events';\nimport { \n  SessionType, \n  SessionState, \n  AsianRange, \n  JudasSwing,\n  OHLCV \n} from '../types';\n\nexport class SessionProfiler extends EventEmitter {\n  private asianRange: AsianRange | null = null;\n  private londonRange: { high: number; low: number; timestamp: number } | null = null;\n  private currentSession: SessionState | null = null;\n\n  constructor() {\n    super();\n  }\n\n  /**\n   * Get current session state based on UTC time\n   * Requirements: 2.1 (Session identification)\n   */\n  getSessionState(): SessionState {\n    const now = new Date();\n    const utcHour = now.getUTCHours();\n    const utcMinute = now.getUTCMinutes();\n    const currentTime = utcHour + utcMinute / 60;\n\n    let sessionType: SessionType;\n    let startTime: number;\n    let endTime: number;\n\n    // Asian session: 00:00 - 06:00 UTC (Accumulation phase)\n    if (currentTime >= 0 && currentTime < 6) {\n      sessionType = 'ASIAN';\n      startTime = 0;\n      endTime = 6;\n    }\n    // London session: 07:00 - 10:00 UTC (Manipulation phase)\n    else if (currentTime >= 7 && currentTime < 10) {\n      sessionType = 'LONDON';\n      startTime = 7;\n      endTime = 10;\n    }\n    // NY session: 13:00 - 16:00 UTC (Distribution phase)\n    else if (currentTime >= 13 && currentTime < 16) {\n      sessionType = 'NY';\n      startTime = 13;\n      endTime = 16;\n    }\n    // Dead Zone: 21:00 - 01:00 UTC (Low volume)\n    else {\n      sessionType = 'DEAD_ZONE';\n      startTime = 21;\n      endTime = 1; // Next day\n    }\n\n    // Calculate time remaining in current session\n    let timeRemaining: number;\n    if (sessionType === 'DEAD_ZONE') {\n      // Handle overnight session\n      if (currentTime >= 21) {\n        timeRemaining = (24 - currentTime) + 1; // Until 01:00 next day\n      } else {\n        timeRemaining = 1 - currentTime; // Until 01:00\n      }\n    } else {\n      timeRemaining = endTime - currentTime;\n    }\n\n    const sessionState: SessionState = {\n      type: sessionType,\n      startTime,\n      endTime,\n      timeRemaining: Math.max(0, timeRemaining)\n    };\n\n    // Check for session transition\n    if (!this.currentSession || this.currentSession.type !== sessionType) {\n      this.handleSessionTransition(sessionState);\n    }\n\n    this.currentSession = sessionState;\n    return sessionState;\n  }\n\n  /**\n   * Check if current time is within tradeable killzone\n   * Requirements: 2.6 (Killzone checking)\n   */\n  isKillzone(): boolean {\n    const sessionState = this.getSessionState();\n    \n    // Only London and NY sessions are killzones\n    return sessionState.type === 'LONDON' || sessionState.type === 'NY';\n  }\n\n  /**\n   * Handle session transition and emit events\n   * Requirements: 2.7 (Session transition events)\n   */\n  private handleSessionTransition(newSession: SessionState): void {\n    const previousSession = this.currentSession?.type;\n    \n    // Emit session change event with reference levels\n    this.emit('SESSION_CHANGE', {\n      previousSession,\n      newSession: newSession.type,\n      asianRange: this.asianRange,\n      londonRange: this.londonRange,\n      timestamp: Date.now()\n    });\n  }\n}"],"version":3}