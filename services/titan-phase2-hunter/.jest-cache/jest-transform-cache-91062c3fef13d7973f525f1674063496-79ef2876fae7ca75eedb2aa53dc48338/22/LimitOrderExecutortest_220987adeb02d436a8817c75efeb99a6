2242b5711a5aed9ad4cf2659b9e23ea9
"use strict";
/**
 * Unit Tests for LimitOrderExecutor
 *
 * Tests core functionality including:
 * - Position sizing calculation
 * - Stop and target calculation
 * - ATR calculation
 * - Order monitoring logic
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock BybitPerpsClient
jest.mock('../../src/exchanges/BybitPerpsClient');
const LimitOrderExecutor_1 = require("../../src/execution/LimitOrderExecutor");
const BybitPerpsClient_1 = require("../../src/exchanges/BybitPerpsClient");
describe('LimitOrderExecutor', () => {
    let executor;
    let mockBybitClient;
    beforeEach(() => {
        mockBybitClient = new BybitPerpsClient_1.BybitPerpsClient('test-key', 'test-secret');
        executor = new LimitOrderExecutor_1.LimitOrderExecutor(mockBybitClient);
    });
    afterEach(() => {
        executor.destroy();
    });
    describe('setStopAndTarget', () => {
        it('should calculate correct stop and target for LONG position', () => {
            const entryPrice = 50000;
            const direction = 'LONG';
            const result = executor.setStopAndTarget(entryPrice, direction);
            // 1.5% stop loss below entry
            expect(result.stopLoss).toBeCloseTo(50000 * (1 - 0.015), 2); // 49250
            // 4.5% take profit above entry
            expect(result.takeProfit).toBeCloseTo(50000 * (1 + 0.045), 2); // 52250
            // Verify 3:1 risk-reward ratio
            const risk = entryPrice - result.stopLoss;
            const reward = result.takeProfit - entryPrice;
            const riskRewardRatio = reward / risk;
            expect(riskRewardRatio).toBeCloseTo(3, 1);
        });
        it('should calculate correct stop and target for SHORT position', () => {
            const entryPrice = 50000;
            const direction = 'SHORT';
            const result = executor.setStopAndTarget(entryPrice, direction);
            // 1.5% stop loss above entry
            expect(result.stopLoss).toBeCloseTo(50000 * (1 + 0.015), 2); // 50750
            // 4.5% take profit below entry
            expect(result.takeProfit).toBeCloseTo(50000 * (1 - 0.045), 2); // 47750
            // Verify 3:1 risk-reward ratio
            const risk = result.stopLoss - entryPrice;
            const reward = entryPrice - result.takeProfit;
            const riskRewardRatio = reward / risk;
            expect(riskRewardRatio).toBeCloseTo(3, 1);
        });
    });
    describe('calcPositionSize', () => {
        beforeEach(() => {
            // Mock OHLCV data for ATR calculation
            const mockCandles = [];
            for (let i = 0; i < 20; i++) {
                mockCandles.push({
                    timestamp: Date.now() - (i * 3600000), // 1 hour intervals
                    open: 50000 + Math.random() * 1000,
                    high: 50500 + Math.random() * 1000,
                    low: 49500 + Math.random() * 1000,
                    close: 50000 + Math.random() * 1000,
                    volume: 1000000
                });
            }
            mockBybitClient.fetchOHLCV.mockResolvedValue(mockCandles);
        });
        it('should calculate position size based on volatility and risk', async () => {
            const symbol = 'BTCUSDT';
            const entryPrice = 50000;
            const equity = 10000; // $10,000 equity
            const leverage = 3;
            const positionSize = await executor.calcPositionSize(symbol, entryPrice, equity, leverage);
            expect(positionSize).toBeGreaterThan(0);
            expect(positionSize).toBeGreaterThan(0.001); // Minimum position size
            expect(mockBybitClient.fetchOHLCV).toHaveBeenCalledWith(symbol, '1h', 24);
        });
        it('should handle insufficient candle data', async () => {
            const symbol = 'BTCUSDT';
            const entryPrice = 50000;
            const equity = 10000;
            const leverage = 3;
            // Mock insufficient data
            mockBybitClient.fetchOHLCV.mockResolvedValue([]);
            await expect(executor.calcPositionSize(symbol, entryPrice, equity, leverage))
                .rejects.toThrow('Insufficient candle data for ATR calculation');
        });
    });
    describe('cancelIfPriceMoves', () => {
        it('should cancel order when price moves > 0.2%', async () => {
            const orderId = 'test-order-123';
            const symbol = 'BTCUSDT';
            const entryPrice = 50000;
            const orderBlock = {
                type: 'BULLISH',
                high: 50100,
                low: 49900,
                barIndex: 100,
                timestamp: Date.now(),
                mitigated: false,
                confidence: 90
            };
            // Start monitoring the order
            executor['startOrderMonitoring'](orderId, symbol, entryPrice, orderBlock);
            // Mock successful cancellation
            mockBybitClient.cancelOrder.mockResolvedValue(true);
            // Price moves 0.3% away (should trigger cancellation)
            const currentPrice = 50150; // 0.3% above entry
            const result = await executor.cancelIfPriceMoves(orderId, currentPrice);
            expect(result).toBe(true);
            expect(mockBybitClient.cancelOrder).toHaveBeenCalledWith(orderId, symbol);
        });
        it('should not cancel order when price moves < 0.2%', async () => {
            const orderId = 'test-order-123';
            const symbol = 'BTCUSDT';
            const entryPrice = 50000;
            const orderBlock = {
                type: 'BULLISH',
                high: 50100,
                low: 49900,
                barIndex: 100,
                timestamp: Date.now(),
                mitigated: false,
                confidence: 90
            };
            // Start monitoring the order
            executor['startOrderMonitoring'](orderId, symbol, entryPrice, orderBlock);
            // Price moves 0.1% away (should not trigger cancellation)
            const currentPrice = 50050; // 0.1% above entry
            const result = await executor.cancelIfPriceMoves(orderId, currentPrice);
            expect(result).toBe(false);
            expect(mockBybitClient.cancelOrder).not.toHaveBeenCalled();
        });
    });
    describe('cancelIfLevelFails', () => {
        it('should cancel bullish order when price wicks below OB low > 0.5%', async () => {
            const orderId = 'test-order-123';
            const symbol = 'BTCUSDT';
            const entryPrice = 49900;
            const orderBlock = {
                type: 'BULLISH',
                high: 50100,
                low: 49900,
                barIndex: 100,
                timestamp: Date.now(),
                mitigated: false,
                confidence: 90
            };
            // Start monitoring the order
            executor['startOrderMonitoring'](orderId, symbol, entryPrice, orderBlock);
            // Mock successful cancellation
            mockBybitClient.cancelOrder.mockResolvedValue(true);
            // Current candle wicks 0.6% below OB low
            const currentCandle = {
                timestamp: Date.now(),
                open: 49900,
                high: 50000,
                low: 49600, // 0.6% below OB low (49900)
                close: 49800,
                volume: 1000000
            };
            const result = await executor.cancelIfLevelFails(orderId, currentCandle);
            expect(result).toBe(true);
            expect(mockBybitClient.cancelOrder).toHaveBeenCalledWith(orderId, symbol);
        });
        it('should cancel bearish order when price wicks above OB high > 0.5%', async () => {
            const orderId = 'test-order-123';
            const symbol = 'BTCUSDT';
            const entryPrice = 50100;
            const orderBlock = {
                type: 'BEARISH',
                high: 50100,
                low: 49900,
                barIndex: 100,
                timestamp: Date.now(),
                mitigated: false,
                confidence: 90
            };
            // Start monitoring the order
            executor['startOrderMonitoring'](orderId, symbol, entryPrice, orderBlock);
            // Mock successful cancellation
            mockBybitClient.cancelOrder.mockResolvedValue(true);
            // Current candle wicks 0.6% above OB high
            const currentCandle = {
                timestamp: Date.now(),
                open: 50100,
                high: 50400, // 0.6% above OB high (50100)
                low: 50000,
                close: 50200,
                volume: 1000000
            };
            const result = await executor.cancelIfLevelFails(orderId, currentCandle);
            expect(result).toBe(true);
            expect(mockBybitClient.cancelOrder).toHaveBeenCalledWith(orderId, symbol);
        });
        it('should not cancel order when wick is < 0.5%', async () => {
            const orderId = 'test-order-123';
            const symbol = 'BTCUSDT';
            const entryPrice = 49900;
            const orderBlock = {
                type: 'BULLISH',
                high: 50100,
                low: 49900,
                barIndex: 100,
                timestamp: Date.now(),
                mitigated: false,
                confidence: 90
            };
            // Start monitoring the order
            executor['startOrderMonitoring'](orderId, symbol, entryPrice, orderBlock);
            // Current candle wicks 0.3% below OB low (should not cancel)
            const currentCandle = {
                timestamp: Date.now(),
                open: 49900,
                high: 50000,
                low: 49750, // 0.3% below OB low
                close: 49800,
                volume: 1000000
            };
            const result = await executor.cancelIfLevelFails(orderId, currentCandle);
            expect(result).toBe(false);
            expect(mockBybitClient.cancelOrder).not.toHaveBeenCalled();
        });
    });
    describe('placePostOnlyOrder', () => {
        it('should place Post-Only order at Order Block level', async () => {
            const signal = {
                symbol: 'BTCUSDT',
                direction: 'LONG',
                hologramStatus: 'A+',
                alignmentScore: 85,
                rsScore: 0.05,
                sessionType: 'LONDON',
                poiType: 'ORDER_BLOCK',
                cvdConfirmation: true,
                confidence: 90,
                entryPrice: 49900,
                stopLoss: 49250,
                takeProfit: 52250,
                positionSize: 0.1,
                leverage: 3,
                timestamp: Date.now()
            };
            const orderBlock = {
                type: 'BULLISH',
                high: 50100,
                low: 49900,
                barIndex: 100,
                timestamp: Date.now(),
                mitigated: false,
                confidence: 90
            };
            const equity = 10000;
            // Mock successful order placement
            mockBybitClient.placeOrderWithRetry.mockResolvedValue({
                orderId: 'test-order-123',
                symbol: 'BTCUSDT',
                side: 'Buy',
                qty: 0.1,
                price: 49900,
                status: 'NEW',
                timestamp: Date.now()
            });
            // Mock OHLCV data for position sizing
            const mockCandles = [];
            for (let i = 0; i < 20; i++) {
                mockCandles.push({
                    timestamp: Date.now() - (i * 3600000),
                    open: 50000,
                    high: 50500,
                    low: 49500,
                    close: 50000,
                    volume: 1000000
                });
            }
            mockBybitClient.fetchOHLCV.mockResolvedValue(mockCandles);
            const result = await executor.placePostOnlyOrder(signal, orderBlock, equity);
            expect(result.success).toBe(true);
            expect(result.orderId).toBe('test-order-123');
            expect(mockBybitClient.placeOrderWithRetry).toHaveBeenCalledWith(expect.objectContaining({
                phase: 'phase2',
                symbol: 'BTCUSDT',
                side: 'Buy',
                type: 'POST_ONLY',
                price: 49900, // Order Block low for LONG
                leverage: 3
            }), 2 // maxRetries
            );
        });
        it('should place SHORT order at Order Block high', async () => {
            const signal = {
                symbol: 'BTCUSDT',
                direction: 'SHORT',
                hologramStatus: 'A+',
                alignmentScore: 85,
                rsScore: -0.05,
                sessionType: 'NY',
                poiType: 'ORDER_BLOCK',
                cvdConfirmation: true,
                confidence: 90,
                entryPrice: 50100,
                stopLoss: 50750,
                takeProfit: 47750,
                positionSize: 0.1,
                leverage: 3,
                timestamp: Date.now()
            };
            const orderBlock = {
                type: 'BEARISH',
                high: 50100,
                low: 49900,
                barIndex: 100,
                timestamp: Date.now(),
                mitigated: false,
                confidence: 90
            };
            const equity = 10000;
            // Mock successful order placement
            mockBybitClient.placeOrderWithRetry.mockResolvedValue({
                orderId: 'test-order-456',
                symbol: 'BTCUSDT',
                side: 'Sell',
                qty: 0.1,
                price: 50100,
                status: 'NEW',
                timestamp: Date.now()
            });
            // Mock OHLCV data for position sizing
            const mockCandles = [];
            for (let i = 0; i < 20; i++) {
                mockCandles.push({
                    timestamp: Date.now() - (i * 3600000),
                    open: 50000,
                    high: 50500,
                    low: 49500,
                    close: 50000,
                    volume: 1000000
                });
            }
            mockBybitClient.fetchOHLCV.mockResolvedValue(mockCandles);
            const result = await executor.placePostOnlyOrder(signal, orderBlock, equity);
            expect(result.success).toBe(true);
            expect(result.orderId).toBe('test-order-456');
            expect(mockBybitClient.placeOrderWithRetry).toHaveBeenCalledWith(expect.objectContaining({
                phase: 'phase2',
                symbol: 'BTCUSDT',
                side: 'Sell',
                type: 'POST_ONLY',
                price: 50100, // Order Block high for SHORT
                leverage: 3
            }), 2 // maxRetries
            );
        });
    });
    describe('ATR calculation', () => {
        it('should calculate ATR correctly', () => {
            // Create test candles with known True Range values
            const candles = [
                { timestamp: 1, open: 100, high: 110, low: 95, close: 105, volume: 1000 },
                { timestamp: 2, open: 105, high: 115, low: 100, close: 110, volume: 1000 }, // TR = max(15, 10, 5) = 15
                { timestamp: 3, open: 110, high: 120, low: 105, close: 115, volume: 1000 }, // TR = max(15, 10, 5) = 15
                { timestamp: 4, open: 115, high: 125, low: 110, close: 120, volume: 1000 }, // TR = max(15, 10, 5) = 15
            ];
            // Use private method via bracket notation
            const atr = executor['calculateATR'](candles, 3);
            // ATR should be average of last 3 True Ranges = (15 + 15 + 15) / 3 = 15
            expect(atr).toBe(15);
        });
        it('should throw error for insufficient data', () => {
            const candles = [
                { timestamp: 1, open: 100, high: 110, low: 95, close: 105, volume: 1000 }
            ];
            expect(() => {
                executor['calculateATR'](candles, 14);
            }).toThrow('Insufficient data for ATR calculation');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2l2YW4vQ29kZS90cmFkaW5nL3RpdGFuL3NlcnZpY2VzL3RpdGFuLXBoYXNlMi1odW50ZXIvdGVzdHMvdW5pdC9MaW1pdE9yZGVyRXhlY3V0b3IudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7O0dBUUc7O0FBTUgsd0JBQXdCO0FBQ3hCLElBQUksQ0FBQyxJQUFJLENBQUMsc0NBQXNDLENBQUMsQ0FBQztBQUxsRCwrRUFBNEU7QUFDNUUsMkVBQXdFO0FBTXhFLFFBQVEsQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUU7SUFDbEMsSUFBSSxRQUE0QixDQUFDO0lBQ2pDLElBQUksZUFBOEMsQ0FBQztJQUVuRCxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsZUFBZSxHQUFHLElBQUksbUNBQWdCLENBQUMsVUFBVSxFQUFFLGFBQWEsQ0FBa0MsQ0FBQztRQUNuRyxRQUFRLEdBQUcsSUFBSSx1Q0FBa0IsQ0FBQyxlQUFlLENBQUMsQ0FBQztJQUNyRCxDQUFDLENBQUMsQ0FBQztJQUVILFNBQVMsQ0FBQyxHQUFHLEVBQUU7UUFDYixRQUFRLENBQUMsT0FBTyxFQUFFLENBQUM7SUFDckIsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxFQUFFO1FBQ2hDLEVBQUUsQ0FBQyw0REFBNEQsRUFBRSxHQUFHLEVBQUU7WUFDcEUsTUFBTSxVQUFVLEdBQUcsS0FBSyxDQUFDO1lBQ3pCLE1BQU0sU0FBUyxHQUFHLE1BQU0sQ0FBQztZQUV6QixNQUFNLE1BQU0sR0FBRyxRQUFRLENBQUMsZ0JBQWdCLENBQUMsVUFBVSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1lBRWhFLDZCQUE2QjtZQUM3QixNQUFNLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRO1lBRXJFLCtCQUErQjtZQUMvQixNQUFNLENBQUMsTUFBTSxD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dXJjZXMiOlsiL1VzZXJzL2l2YW4vQ29kZS90cmFkaW5nL3RpdGFuL3NlcnZpY2VzL3RpdGFuLXBoYXNlMi1odW50ZXIvdGVzdHMvdW5pdC9MaW1pdE9yZGVyRXhlY3V0b3IudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFVuaXQgVGVzdHMgZm9yIExpbWl0T3JkZXJFeGVjdXRvclxuICogXG4gKiBUZXN0cyBjb3JlIGZ1bmN0aW9uYWxpdHkgaW5jbHVkaW5nOlxuICogLSBQb3NpdGlvbiBzaXppbmcgY2FsY3VsYXRpb25cbiAqIC0gU3RvcCBhbmQgdGFyZ2V0IGNhbGN1bGF0aW9uXG4gKiAtIEFUUiBjYWxjdWxhdGlvblxuICogLSBPcmRlciBtb25pdG9yaW5nIGxvZ2ljXG4gKi9cblxuaW1wb3J0IHsgTGltaXRPcmRlckV4ZWN1dG9yIH0gZnJvbSAnLi4vLi4vc3JjL2V4ZWN1dGlvbi9MaW1pdE9yZGVyRXhlY3V0b3InO1xuaW1wb3J0IHsgQnliaXRQZXJwc0NsaWVudCB9IGZyb20gJy4uLy4uL3NyYy9leGNoYW5nZXMvQnliaXRQZXJwc0NsaWVudCc7XG5pbXBvcnQgeyBPSExDViwgT3JkZXJCbG9jaywgU2lnbmFsRGF0YSB9IGZyb20gJy4uLy4uL3NyYy90eXBlcyc7XG5cbi8vIE1vY2sgQnliaXRQZXJwc0NsaWVudFxuamVzdC5tb2NrKCcuLi8uLi9zcmMvZXhjaGFuZ2VzL0J5Yml0UGVycHNDbGllbnQnKTtcblxuZGVzY3JpYmUoJ0xpbWl0T3JkZXJFeGVjdXRvcicsICgpID0+IHtcbiAgbGV0IGV4ZWN1dG9yOiBMaW1pdE9yZGVyRXhlY3V0b3I7XG4gIGxldCBtb2NrQnliaXRDbGllbnQ6IGplc3QuTW9ja2VkPEJ5Yml0UGVycHNDbGllbnQ+O1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIG1vY2tCeWJpdENsaWVudCA9IG5ldyBCeWJpdFBlcnBzQ2xpZW50KCd0ZXN0LWtleScsICd0ZXN0LXNlY3JldCcpIGFzIGplc3QuTW9ja2VkPEJ5Yml0UGVycHNDbGllbnQ+O1xuICAgIGV4ZWN1dG9yID0gbmV3IExpbWl0T3JkZXJFeGVjdXRvcihtb2NrQnliaXRDbGllbnQpO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIGV4ZWN1dG9yLmRlc3Ryb3koKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3NldFN0b3BBbmRUYXJnZXQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgY29ycmVjdCBzdG9wIGFuZCB0YXJnZXQgZm9yIExPTkcgcG9zaXRpb24nLCAoKSA9PiB7XG4gICAgICBjb25zdCBlbnRyeVByaWNlID0gNTAwMDA7XG4gICAgICBjb25zdCBkaXJlY3Rpb24gPSAnTE9ORyc7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGV4ZWN1dG9yLnNldFN0b3BBbmRUYXJnZXQoZW50cnlQcmljZSwgZGlyZWN0aW9uKTtcblxuICAgICAgLy8gMS41JSBzdG9wIGxvc3MgYmVsb3cgZW50cnlcbiAgICAgIGV4cGVjdChyZXN1bHQuc3RvcExvc3MpLnRvQmVDbG9zZVRvKDUwMDAwICogKDEgLSAwLjAxNSksIDIpOyAvLyA0OTI1MFxuICAgICAgXG4gICAgICAvLyA0LjUlIHRha2UgcHJvZml0IGFib3ZlIGVudHJ5XG4gICAgICBleHBlY3QocmVzdWx0LnRha2VQcm9maXQpLnRvQmVDbG9zZVRvKDUwMDAwICogKDEgKyAwLjA0NSksIDIpOyAvLyA1MjI1MFxuICAgICAgXG4gICAgICAvLyBWZXJpZnkgMzoxIHJpc2stcmV3YXJkIHJhdGlvXG4gICAgICBjb25zdCByaXNrID0gZW50cnlQcmljZSAtIHJlc3VsdC5zdG9wTG9zcztcbiAgICAgIGNvbnN0IHJld2FyZCA9IHJlc3VsdC50YWtlUHJvZml0IC0gZW50cnlQcmljZTtcbiAgICAgIGNvbnN0IHJpc2tSZXdhcmRSYXRpbyA9IHJld2FyZCAvIHJpc2s7XG4gICAgICBcbiAgICAgIGV4cGVjdChyaXNrUmV3YXJkUmF0aW8pLnRvQmVDbG9zZVRvKDMsIDEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgY29ycmVjdCBzdG9wIGFuZCB0YXJnZXQgZm9yIFNIT1JUIHBvc2l0aW9uJywgKCkgPT4ge1xuICAgICAgY29uc3QgZW50cnlQcmljZSA9IDUwMDAwO1xuICAgICAgY29uc3QgZGlyZWN0aW9uID0gJ1NIT1JUJztcblxuICAgICAgY29uc3QgcmVzdWx0ID0gZXhlY3V0b3Iuc2V0U3RvcEFuZFRhcmdldChlbnRyeVByaWNlLCBkaXJlY3Rpb24pO1xuXG4gICAgICAvLyAxLjUlIHN0b3AgbG9zcyBhYm92ZSBlbnRyeVxuICAgICAgZXhwZWN0KHJlc3VsdC5zdG9wTG9zcykudG9CZUNsb3NlVG8oNTAwMDAgKiAoMSArIDAuMDE1KSwgMik7IC8vIDUwNzUwXG4gICAgICBcbiAgICAgIC8vIDQuNSUgdGFrZSBwcm9maXQgYmVsb3cgZW50cnlcbiAgICAgIGV4cGVjdChyZXN1bHQudGFrZVByb2ZpdCkudG9CZUNsb3NlVG8oNTAwMDAgKiAoMSAtIDAuMDQ1KSwgMik7IC8vIDQ3NzUwXG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSAzOjEgcmlzay1yZXdhcmQgcmF0aW9cbiAgICAgIGNvbnN0IHJpc2sgPSByZXN1bHQuc3RvcExvc3MgLSBlbnRyeVByaWNlO1xuICAgICAgY29uc3QgcmV3YXJkID0gZW50cnlQcmljZSAtIHJlc3VsdC50YWtlUHJvZml0O1xuICAgICAgY29uc3Qgcmlza1Jld2FyZFJhdGlvID0gcmV3YXJkIC8gcmlzaztcbiAgICAgIFxuICAgICAgZXhwZWN0KHJpc2tSZXdhcmRSYXRpbykudG9CZUNsb3NlVG8oMywgMSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjYWxjUG9zaXRpb25TaXplJywgKCkgPT4ge1xuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgLy8gTW9jayBPSExDViBkYXRhIGZvciBBVFIgY2FsY3VsYXRpb25cbiAgICAgIGNvbnN0IG1vY2tDYW5kbGVzOiBPSExDVltdID0gW107XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDIwOyBpKyspIHtcbiAgICAgICAgbW9ja0NhbmRsZXMucHVzaCh7XG4gICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpIC0gKGkgKiAzNjAwMDAwKSwgLy8gMSBob3VyIGludGVydmFsc1xuICAgICAgICAgIG9wZW46IDUwMDAwICsgTWF0aC5yYW5kb20oKSAqIDEwMDAsXG4gICAgICAgICAgaGlnaDogNTA1MDAgKyBNYXRoLnJhbmRvbSgpICogMTAwMCxcbiAgICAgICAgICBsb3c6IDQ5NTAwICsgTWF0aC5yYW5kb20oKSAqIDEwMDAsXG4gICAgICAgICAgY2xvc2U6IDUwMDAwICsgTWF0aC5yYW5kb20oKSAqIDEwMDAsXG4gICAgICAgICAgdm9sdW1lOiAxMDAwMDAwXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgXG4gICAgICBtb2NrQnliaXRDbGllbnQuZmV0Y2hPSExDVi5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrQ2FuZGxlcyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNhbGN1bGF0ZSBwb3NpdGlvbiBzaXplIGJhc2VkIG9uIHZvbGF0aWxpdHkgYW5kIHJpc2snLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzeW1ib2wgPSAnQlRDVVNEVCc7XG4gICAgICBjb25zdCBlbnRyeVByaWNlID0gNTAwMDA7XG4gICAgICBjb25zdCBlcXVpdHkgPSAxMDAwMDsgLy8gJDEwLDAwMCBlcXVpdHlcbiAgICAgIGNvbnN0IGxldmVyYWdlID0gMztcblxuICAgICAgY29uc3QgcG9zaXRpb25TaXplID0gYXdhaXQgZXhlY3V0b3IuY2FsY1Bvc2l0aW9uU2l6ZShzeW1ib2wsIGVudHJ5UHJpY2UsIGVxdWl0eSwgbGV2ZXJhZ2UpO1xuXG4gICAgICBleHBlY3QocG9zaXRpb25TaXplKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICBleHBlY3QocG9zaXRpb25TaXplKS50b0JlR3JlYXRlclRoYW4oMC4wMDEpOyAvLyBNaW5pbXVtIHBvc2l0aW9uIHNpemVcbiAgICAgIGV4cGVjdChtb2NrQnliaXRDbGllbnQuZmV0Y2hPSExDVikudG9IYXZlQmVlbkNhbGxlZFdpdGgoc3ltYm9sLCAnMWgnLCAyNCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBpbnN1ZmZpY2llbnQgY2FuZGxlIGRhdGEnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzeW1ib2wgPSAnQlRDVVNEVCc7XG4gICAgICBjb25zdCBlbnRyeVByaWNlID0gNTAwMDA7XG4gICAgICBjb25zdCBlcXVpdHkgPSAxMDAwMDtcbiAgICAgIGNvbnN0IGxldmVyYWdlID0gMztcblxuICAgICAgLy8gTW9jayBpbnN1ZmZpY2llbnQgZGF0YVxuICAgICAgbW9ja0J5Yml0Q2xpZW50LmZldGNoT0hMQ1YubW9ja1Jlc29sdmVkVmFsdWUoW10pO1xuXG4gICAgICBhd2FpdCBleHBlY3QoZXhlY3V0b3IuY2FsY1Bvc2l0aW9uU2l6ZShzeW1ib2wsIGVudHJ5UHJpY2UsIGVxdWl0eSwgbGV2ZXJhZ2UpKVxuICAgICAgICAucmVqZWN0cy50b1Rocm93KCdJbnN1ZmZpY2llbnQgY2FuZGxlIGRhdGEgZm9yIEFUUiBjYWxjdWxhdGlvbicpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnY2FuY2VsSWZQcmljZU1vdmVzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY2FuY2VsIG9yZGVyIHdoZW4gcHJpY2UgbW92ZXMgPiAwLjIlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgb3JkZXJJZCA9ICd0ZXN0LW9yZGVyLTEyMyc7XG4gICAgICBjb25zdCBzeW1ib2wgPSAnQlRDVVNEVCc7XG4gICAgICBjb25zdCBlbnRyeVByaWNlID0gNTAwMDA7XG4gICAgICBjb25zdCBvcmRlckJsb2NrOiBPcmRlckJsb2NrID0ge1xuICAgICAgICB0eXBlOiAnQlVMTElTSCcsXG4gICAgICAgIGhpZ2g6IDUwMTAwLFxuICAgICAgICBsb3c6IDQ5OTAwLFxuICAgICAgICBiYXJJbmRleDogMTAwLFxuICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgIG1pdGlnYXRlZDogZmFsc2UsXG4gICAgICAgIGNvbmZpZGVuY2U6IDkwXG4gICAgICB9O1xuXG4gICAgICAvLyBTdGFydCBtb25pdG9yaW5nIHRoZSBvcmRlclxuICAgICAgZXhlY3V0b3JbJ3N0YXJ0T3JkZXJNb25pdG9yaW5nJ10ob3JkZXJJZCwgc3ltYm9sLCBlbnRyeVByaWNlLCBvcmRlckJsb2NrKTtcblxuICAgICAgLy8gTW9jayBzdWNjZXNzZnVsIGNhbmNlbGxhdGlvblxuICAgICAgbW9ja0J5Yml0Q2xpZW50LmNhbmNlbE9yZGVyLm1vY2tSZXNvbHZlZFZhbHVlKHRydWUpO1xuXG4gICAgICAvLyBQcmljZSBtb3ZlcyAwLjMlIGF3YXkgKHNob3VsZCB0cmlnZ2VyIGNhbmNlbGxhdGlvbilcbiAgICAgIGNvbnN0IGN1cnJlbnRQcmljZSA9IDUwMTUwOyAvLyAwLjMlIGFib3ZlIGVudHJ5XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBleGVjdXRvci5jYW5jZWxJZlByaWNlTW92ZXMob3JkZXJJZCwgY3VycmVudFByaWNlKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChtb2NrQnliaXRDbGllbnQuY2FuY2VsT3JkZXIpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKG9yZGVySWQsIHN5bWJvbCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIG5vdCBjYW5jZWwgb3JkZXIgd2hlbiBwcmljZSBtb3ZlcyA8IDAuMiUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBvcmRlcklkID0gJ3Rlc3Qtb3JkZXItMTIzJztcbiAgICAgIGNvbnN0IHN5bWJvbCA9ICdCVENVU0RUJztcbiAgICAgIGNvbnN0IGVudHJ5UHJpY2UgPSA1MDAwMDtcbiAgICAgIGNvbnN0IG9yZGVyQmxvY2s6IE9yZGVyQmxvY2sgPSB7XG4gICAgICAgIHR5cGU6ICdCVUxMSVNIJyxcbiAgICAgICAgaGlnaDogNTAxMDAsXG4gICAgICAgIGxvdzogNDk5MDAsXG4gICAgICAgIGJhckluZGV4OiAxMDAsXG4gICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgbWl0aWdhdGVkOiBmYWxzZSxcbiAgICAgICAgY29uZmlkZW5jZTogOTBcbiAgICAgIH07XG5cbiAgICAgIC8vIFN0YXJ0IG1vbml0b3JpbmcgdGhlIG9yZGVyXG4gICAgICBleGVjdXRvclsnc3RhcnRPcmRlck1vbml0b3JpbmcnXShvcmRlcklkLCBzeW1ib2wsIGVudHJ5UHJpY2UsIG9yZGVyQmxvY2spO1xuXG4gICAgICAvLyBQcmljZSBtb3ZlcyAwLjElIGF3YXkgKHNob3VsZCBub3QgdHJpZ2dlciBjYW5jZWxsYXRpb24pXG4gICAgICBjb25zdCBjdXJyZW50UHJpY2UgPSA1MDA1MDsgLy8gMC4xJSBhYm92ZSBlbnRyeVxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZXhlY3V0b3IuY2FuY2VsSWZQcmljZU1vdmVzKG9yZGVySWQsIGN1cnJlbnRQcmljZSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KG1vY2tCeWJpdENsaWVudC5jYW5jZWxPcmRlcikubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2NhbmNlbElmTGV2ZWxGYWlscycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGNhbmNlbCBidWxsaXNoIG9yZGVyIHdoZW4gcHJpY2Ugd2lja3MgYmVsb3cgT0IgbG93ID4gMC41JScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG9yZGVySWQgPSAndGVzdC1vcmRlci0xMjMnO1xuICAgICAgY29uc3Qgc3ltYm9sID0gJ0JUQ1VTRFQnO1xuICAgICAgY29uc3QgZW50cnlQcmljZSA9IDQ5OTAwO1xuICAgICAgY29uc3Qgb3JkZXJCbG9jazogT3JkZXJCbG9jayA9IHtcbiAgICAgICAgdHlwZTogJ0JVTExJU0gnLFxuICAgICAgICBoaWdoOiA1MDEwMCxcbiAgICAgICAgbG93OiA0OTkwMCxcbiAgICAgICAgYmFySW5kZXg6IDEwMCxcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICBtaXRpZ2F0ZWQ6IGZhbHNlLFxuICAgICAgICBjb25maWRlbmNlOiA5MFxuICAgICAgfTtcblxuICAgICAgLy8gU3RhcnQgbW9uaXRvcmluZyB0aGUgb3JkZXJcbiAgICAgIGV4ZWN1dG9yWydzdGFydE9yZGVyTW9uaXRvcmluZyddKG9yZGVySWQsIHN5bWJvbCwgZW50cnlQcmljZSwgb3JkZXJCbG9jayk7XG5cbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBjYW5jZWxsYXRpb25cbiAgICAgIG1vY2tCeWJpdENsaWVudC5jYW5jZWxPcmRlci5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKTtcblxuICAgICAgLy8gQ3VycmVudCBjYW5kbGUgd2lja3MgMC42JSBiZWxvdyBPQiBsb3dcbiAgICAgIGNvbnN0IGN1cnJlbnRDYW5kbGU6IE9ITENWID0ge1xuICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgIG9wZW46IDQ5OTAwLFxuICAgICAgICBoaWdoOiA1MDAwMCxcbiAgICAgICAgbG93OiA0OTYwMCwgLy8gMC42JSBiZWxvdyBPQiBsb3cgKDQ5OTAwKVxuICAgICAgICBjbG9zZTogNDk4MDAsXG4gICAgICAgIHZvbHVtZTogMTAwMDAwMFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZXhlY3V0b3IuY2FuY2VsSWZMZXZlbEZhaWxzKG9yZGVySWQsIGN1cnJlbnRDYW5kbGUpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KG1vY2tCeWJpdENsaWVudC5jYW5jZWxPcmRlcikudG9IYXZlQmVlbkNhbGxlZFdpdGgob3JkZXJJZCwgc3ltYm9sKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY2FuY2VsIGJlYXJpc2ggb3JkZXIgd2hlbiBwcmljZSB3aWNrcyBhYm92ZSBPQiBoaWdoID4gMC41JScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IG9yZGVySWQgPSAndGVzdC1vcmRlci0xMjMnO1xuICAgICAgY29uc3Qgc3ltYm9sID0gJ0JUQ1VTRFQnO1xuICAgICAgY29uc3QgZW50cnlQcmljZSA9IDUwMTAwO1xuICAgICAgY29uc3Qgb3JkZXJCbG9jazogT3JkZXJCbG9jayA9IHtcbiAgICAgICAgdHlwZTogJ0JFQVJJU0gnLFxuICAgICAgICBoaWdoOiA1MDEwMCxcbiAgICAgICAgbG93OiA0OTkwMCxcbiAgICAgICAgYmFySW5kZXg6IDEwMCxcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICBtaXRpZ2F0ZWQ6IGZhbHNlLFxuICAgICAgICBjb25maWRlbmNlOiA5MFxuICAgICAgfTtcblxuICAgICAgLy8gU3RhcnQgbW9uaXRvcmluZyB0aGUgb3JkZXJcbiAgICAgIGV4ZWN1dG9yWydzdGFydE9yZGVyTW9uaXRvcmluZyddKG9yZGVySWQsIHN5bWJvbCwgZW50cnlQcmljZSwgb3JkZXJCbG9jayk7XG5cbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBjYW5jZWxsYXRpb25cbiAgICAgIG1vY2tCeWJpdENsaWVudC5jYW5jZWxPcmRlci5tb2NrUmVzb2x2ZWRWYWx1ZSh0cnVlKTtcblxuICAgICAgLy8gQ3VycmVudCBjYW5kbGUgd2lja3MgMC42JSBhYm92ZSBPQiBoaWdoXG4gICAgICBjb25zdCBjdXJyZW50Q2FuZGxlOiBPSExDViA9IHtcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICBvcGVuOiA1MDEwMCxcbiAgICAgICAgaGlnaDogNTA0MDAsIC8vIDAuNiUgYWJvdmUgT0IgaGlnaCAoNTAxMDApXG4gICAgICAgIGxvdzogNTAwMDAsXG4gICAgICAgIGNsb3NlOiA1MDIwMCxcbiAgICAgICAgdm9sdW1lOiAxMDAwMDAwXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBleGVjdXRvci5jYW5jZWxJZkxldmVsRmFpbHMob3JkZXJJZCwgY3VycmVudENhbmRsZSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QobW9ja0J5Yml0Q2xpZW50LmNhbmNlbE9yZGVyKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChvcmRlcklkLCBzeW1ib2wpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBub3QgY2FuY2VsIG9yZGVyIHdoZW4gd2ljayBpcyA8IDAuNSUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBvcmRlcklkID0gJ3Rlc3Qtb3JkZXItMTIzJztcbiAgICAgIGNvbnN0IHN5bWJvbCA9ICdCVENVU0RUJztcbiAgICAgIGNvbnN0IGVudHJ5UHJpY2UgPSA0OTkwMDtcbiAgICAgIGNvbnN0IG9yZGVyQmxvY2s6IE9yZGVyQmxvY2sgPSB7XG4gICAgICAgIHR5cGU6ICdCVUxMSVNIJyxcbiAgICAgICAgaGlnaDogNTAxMDAsXG4gICAgICAgIGxvdzogNDk5MDAsXG4gICAgICAgIGJhckluZGV4OiAxMDAsXG4gICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKSxcbiAgICAgICAgbWl0aWdhdGVkOiBmYWxzZSxcbiAgICAgICAgY29uZmlkZW5jZTogOTBcbiAgICAgIH07XG5cbiAgICAgIC8vIFN0YXJ0IG1vbml0b3JpbmcgdGhlIG9yZGVyXG4gICAgICBleGVjdXRvclsnc3RhcnRPcmRlck1vbml0b3JpbmcnXShvcmRlcklkLCBzeW1ib2wsIGVudHJ5UHJpY2UsIG9yZGVyQmxvY2spO1xuXG4gICAgICAvLyBDdXJyZW50IGNhbmRsZSB3aWNrcyAwLjMlIGJlbG93IE9CIGxvdyAoc2hvdWxkIG5vdCBjYW5jZWwpXG4gICAgICBjb25zdCBjdXJyZW50Q2FuZGxlOiBPSExDViA9IHtcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICBvcGVuOiA0OTkwMCxcbiAgICAgICAgaGlnaDogNTAwMDAsXG4gICAgICAgIGxvdzogNDk3NTAsIC8vIDAuMyUgYmVsb3cgT0IgbG93XG4gICAgICAgIGNsb3NlOiA0OTgwMCxcbiAgICAgICAgdm9sdW1lOiAxMDAwMDAwXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBleGVjdXRvci5jYW5jZWxJZkxldmVsRmFpbHMob3JkZXJJZCwgY3VycmVudENhbmRsZSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KG1vY2tCeWJpdENsaWVudC5jYW5jZWxPcmRlcikubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3BsYWNlUG9zdE9ubHlPcmRlcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHBsYWNlIFBvc3QtT25seSBvcmRlciBhdCBPcmRlciBCbG9jayBsZXZlbCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHNpZ25hbDogU2lnbmFsRGF0YSA9IHtcbiAgICAgICAgc3ltYm9sOiAnQlRDVVNEVCcsXG4gICAgICAgIGRpcmVjdGlvbjogJ0xPTkcnLFxuICAgICAgICBob2xvZ3JhbVN0YXR1czogJ0ErJyxcbiAgICAgICAgYWxpZ25tZW50U2NvcmU6IDg1LFxuICAgICAgICByc1Njb3JlOiAwLjA1LFxuICAgICAgICBzZXNzaW9uVHlwZTogJ0xPTkRPTicsXG4gICAgICAgIHBvaVR5cGU6ICdPUkRFUl9CTE9DSycsXG4gICAgICAgIGN2ZENvbmZpcm1hdGlvbjogdHJ1ZSxcbiAgICAgICAgY29uZmlkZW5jZTogOTAsXG4gICAgICAgIGVudHJ5UHJpY2U6IDQ5OTAwLFxuICAgICAgICBzdG9wTG9zczogNDkyNTAsXG4gICAgICAgIHRha2VQcm9maXQ6IDUyMjUwLFxuICAgICAgICBwb3NpdGlvblNpemU6IDAuMSxcbiAgICAgICAgbGV2ZXJhZ2U6IDMsXG4gICAgICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKVxuICAgICAgfTtcblxuICAgICAgY29uc3Qgb3JkZXJCbG9jazogT3JkZXJCbG9jayA9IHtcbiAgICAgICAgdHlwZTogJ0JVTExJU0gnLFxuICAgICAgICBoaWdoOiA1MDEwMCxcbiAgICAgICAgbG93OiA0OTkwMCxcbiAgICAgICAgYmFySW5kZXg6IDEwMCxcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICBtaXRpZ2F0ZWQ6IGZhbHNlLFxuICAgICAgICBjb25maWRlbmNlOiA5MFxuICAgICAgfTtcblxuICAgICAgY29uc3QgZXF1aXR5ID0gMTAwMDA7XG5cbiAgICAgIC8vIE1vY2sgc3VjY2Vzc2Z1bCBvcmRlciBwbGFjZW1lbnRcbiAgICAgIG1vY2tCeWJpdENsaWVudC5wbGFjZU9yZGVyV2l0aFJldHJ5Lm1vY2tSZXNvbHZlZFZhbHVlKHtcbiAgICAgICAgb3JkZXJJZDogJ3Rlc3Qtb3JkZXItMTIzJyxcbiAgICAgICAgc3ltYm9sOiAnQlRDVVNEVCcsXG4gICAgICAgIHNpZGU6ICdCdXknLFxuICAgICAgICBxdHk6IDAuMSxcbiAgICAgICAgcHJpY2U6IDQ5OTAwLFxuICAgICAgICBzdGF0dXM6ICdORVcnLFxuICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KClcbiAgICAgIH0pO1xuXG4gICAgICAvLyBNb2NrIE9ITENWIGRhdGEgZm9yIHBvc2l0aW9uIHNpemluZ1xuICAgICAgY29uc3QgbW9ja0NhbmRsZXM6IE9ITENWW10gPSBbXTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMjA7IGkrKykge1xuICAgICAgICBtb2NrQ2FuZGxlcy5wdXNoKHtcbiAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCkgLSAoaSAqIDM2MDAwMDApLFxuICAgICAgICAgIG9wZW46IDUwMDAwLFxuICAgICAgICAgIGhpZ2g6IDUwNTAwLFxuICAgICAgICAgIGxvdzogNDk1MDAsXG4gICAgICAgICAgY2xvc2U6IDUwMDAwLFxuICAgICAgICAgIHZvbHVtZTogMTAwMDAwMFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIG1vY2tCeWJpdENsaWVudC5mZXRjaE9ITENWLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tDYW5kbGVzKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZXhlY3V0b3IucGxhY2VQb3N0T25seU9yZGVyKHNpZ25hbCwgb3JkZXJCbG9jaywgZXF1aXR5KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5vcmRlcklkKS50b0JlKCd0ZXN0LW9yZGVyLTEyMycpO1xuICAgICAgZXhwZWN0KG1vY2tCeWJpdENsaWVudC5wbGFjZU9yZGVyV2l0aFJldHJ5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIHBoYXNlOiAncGhhc2UyJyxcbiAgICAgICAgICBzeW1ib2w6ICdCVENVU0RUJyxcbiAgICAgICAgICBzaWRlOiAnQnV5JyxcbiAgICAgICAgICB0eXBlOiAnUE9TVF9PTkxZJyxcbiAgICAgICAgICBwcmljZTogNDk5MDAsIC8vIE9yZGVyIEJsb2NrIGxvdyBmb3IgTE9OR1xuICAgICAgICAgIGxldmVyYWdlOiAzXG4gICAgICAgIH0pLFxuICAgICAgICAyIC8vIG1heFJldHJpZXNcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHBsYWNlIFNIT1JUIG9yZGVyIGF0IE9yZGVyIEJsb2NrIGhpZ2gnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBzaWduYWw6IFNpZ25hbERhdGEgPSB7XG4gICAgICAgIHN5bWJvbDogJ0JUQ1VTRFQnLFxuICAgICAgICBkaXJlY3Rpb246ICdTSE9SVCcsXG4gICAgICAgIGhvbG9ncmFtU3RhdHVzOiAnQSsnLFxuICAgICAgICBhbGlnbm1lbnRTY29yZTogODUsXG4gICAgICAgIHJzU2NvcmU6IC0wLjA1LFxuICAgICAgICBzZXNzaW9uVHlwZTogJ05ZJyxcbiAgICAgICAgcG9pVHlwZTogJ09SREVSX0JMT0NLJyxcbiAgICAgICAgY3ZkQ29uZmlybWF0aW9uOiB0cnVlLFxuICAgICAgICBjb25maWRlbmNlOiA5MCxcbiAgICAgICAgZW50cnlQcmljZTogNTAxMDAsXG4gICAgICAgIHN0b3BMb3NzOiA1MDc1MCxcbiAgICAgICAgdGFrZVByb2ZpdDogNDc3NTAsXG4gICAgICAgIHBvc2l0aW9uU2l6ZTogMC4xLFxuICAgICAgICBsZXZlcmFnZTogMyxcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBvcmRlckJsb2NrOiBPcmRlckJsb2NrID0ge1xuICAgICAgICB0eXBlOiAnQkVBUklTSCcsXG4gICAgICAgIGhpZ2g6IDUwMTAwLFxuICAgICAgICBsb3c6IDQ5OTAwLFxuICAgICAgICBiYXJJbmRleDogMTAwLFxuICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgIG1pdGlnYXRlZDogZmFsc2UsXG4gICAgICAgIGNvbmZpZGVuY2U6IDkwXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBlcXVpdHkgPSAxMDAwMDtcblxuICAgICAgLy8gTW9jayBzdWNjZXNzZnVsIG9yZGVyIHBsYWNlbWVudFxuICAgICAgbW9ja0J5Yml0Q2xpZW50LnBsYWNlT3JkZXJXaXRoUmV0cnkubW9ja1Jlc29sdmVkVmFsdWUoe1xuICAgICAgICBvcmRlcklkOiAndGVzdC1vcmRlci00NTYnLFxuICAgICAgICBzeW1ib2w6ICdCVENVU0RUJyxcbiAgICAgICAgc2lkZTogJ1NlbGwnLFxuICAgICAgICBxdHk6IDAuMSxcbiAgICAgICAgcHJpY2U6IDUwMTAwLFxuICAgICAgICBzdGF0dXM6ICdORVcnLFxuICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KClcbiAgICAgIH0pO1xuXG4gICAgICAvLyBNb2NrIE9ITENWIGRhdGEgZm9yIHBvc2l0aW9uIHNpemluZ1xuICAgICAgY29uc3QgbW9ja0NhbmRsZXM6IE9ITENWW10gPSBbXTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMjA7IGkrKykge1xuICAgICAgICBtb2NrQ2FuZGxlcy5wdXNoKHtcbiAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCkgLSAoaSAqIDM2MDAwMDApLFxuICAgICAgICAgIG9wZW46IDUwMDAwLFxuICAgICAgICAgIGhpZ2g6IDUwNTAwLFxuICAgICAgICAgIGxvdzogNDk1MDAsXG4gICAgICAgICAgY2xvc2U6IDUwMDAwLFxuICAgICAgICAgIHZvbHVtZTogMTAwMDAwMFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIG1vY2tCeWJpdENsaWVudC5mZXRjaE9ITENWLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tDYW5kbGVzKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZXhlY3V0b3IucGxhY2VQb3N0T25seU9yZGVyKHNpZ25hbCwgb3JkZXJCbG9jaywgZXF1aXR5KTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5zdWNjZXNzKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5vcmRlcklkKS50b0JlKCd0ZXN0LW9yZGVyLTQ1NicpO1xuICAgICAgZXhwZWN0KG1vY2tCeWJpdENsaWVudC5wbGFjZU9yZGVyV2l0aFJldHJ5KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgZXhwZWN0Lm9iamVjdENvbnRhaW5pbmcoe1xuICAgICAgICAgIHBoYXNlOiAncGhhc2UyJyxcbiAgICAgICAgICBzeW1ib2w6ICdCVENVU0RUJyxcbiAgICAgICAgICBzaWRlOiAnU2VsbCcsXG4gICAgICAgICAgdHlwZTogJ1BPU1RfT05MWScsXG4gICAgICAgICAgcHJpY2U6IDUwMTAwLCAvLyBPcmRlciBCbG9jayBoaWdoIGZvciBTSE9SVFxuICAgICAgICAgIGxldmVyYWdlOiAzXG4gICAgICAgIH0pLFxuICAgICAgICAyIC8vIG1heFJldHJpZXNcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdBVFIgY2FsY3VsYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBjYWxjdWxhdGUgQVRSIGNvcnJlY3RseScsICgpID0+IHtcbiAgICAgIC8vIENyZWF0ZSB0ZXN0IGNhbmRsZXMgd2l0aCBrbm93biBUcnVlIFJhbmdlIHZhbHVlc1xuICAgICAgY29uc3QgY2FuZGxlczogT0hMQ1ZbXSA9IFtcbiAgICAgICAgeyB0aW1lc3RhbXA6IDEsIG9wZW46IDEwMCwgaGlnaDogMTEwLCBsb3c6IDk1LCBjbG9zZTogMTA1LCB2b2x1bWU6IDEwMDAgfSxcbiAgICAgICAgeyB0aW1lc3RhbXA6IDIsIG9wZW46IDEwNSwgaGlnaDogMTE1LCBsb3c6IDEwMCwgY2xvc2U6IDExMCwgdm9sdW1lOiAxMDAwIH0sIC8vIFRSID0gbWF4KDE1LCAxMCwgNSkgPSAxNVxuICAgICAgICB7IHRpbWVzdGFtcDogMywgb3BlbjogMTEwLCBoaWdoOiAxMjAsIGxvdzogMTA1LCBjbG9zZTogMTE1LCB2b2x1bWU6IDEwMDAgfSwgLy8gVFIgPSBtYXgoMTUsIDEwLCA1KSA9IDE1XG4gICAgICAgIHsgdGltZXN0YW1wOiA0LCBvcGVuOiAxMTUsIGhpZ2g6IDEyNSwgbG93OiAxMTAsIGNsb3NlOiAxMjAsIHZvbHVtZTogMTAwMCB9LCAvLyBUUiA9IG1heCgxNSwgMTAsIDUpID0gMTVcbiAgICAgIF07XG5cbiAgICAgIC8vIFVzZSBwcml2YXRlIG1ldGhvZCB2aWEgYnJhY2tldCBub3RhdGlvblxuICAgICAgY29uc3QgYXRyID0gZXhlY3V0b3JbJ2NhbGN1bGF0ZUFUUiddKGNhbmRsZXMsIDMpO1xuXG4gICAgICAvLyBBVFIgc2hvdWxkIGJlIGF2ZXJhZ2Ugb2YgbGFzdCAzIFRydWUgUmFuZ2VzID0gKDE1ICsgMTUgKyAxNSkgLyAzID0gMTVcbiAgICAgIGV4cGVjdChhdHIpLnRvQmUoMTUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB0aHJvdyBlcnJvciBmb3IgaW5zdWZmaWNpZW50IGRhdGEnLCAoKSA9PiB7XG4gICAgICBjb25zdCBjYW5kbGVzOiBPSExDVltdID0gW1xuICAgICAgICB7IHRpbWVzdGFtcDogMSwgb3BlbjogMTAwLCBoaWdoOiAxMTAsIGxvdzogOTUsIGNsb3NlOiAxMDUsIHZvbHVtZTogMTAwMCB9XG4gICAgICBdO1xuXG4gICAgICBleHBlY3QoKCkgPT4ge1xuICAgICAgICBleGVjdXRvclsnY2FsY3VsYXRlQVRSJ10oY2FuZGxlcywgMTQpO1xuICAgICAgfSkudG9UaHJvdygnSW5zdWZmaWNpZW50IGRhdGEgZm9yIEFUUiBjYWxjdWxhdGlvbicpO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==