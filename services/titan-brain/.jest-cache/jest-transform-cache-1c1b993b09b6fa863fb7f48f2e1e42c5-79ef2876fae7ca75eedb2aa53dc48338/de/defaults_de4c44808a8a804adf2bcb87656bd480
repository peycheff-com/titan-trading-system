df656710699b4b8ee4f773f190ee70c8
"use strict";
/**
 * Default Configuration for Titan Brain
 * Contains all default values for the system
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.defaultConfig = void 0;
exports.loadConfigFromEnv = loadConfigFromEnv;
exports.mergeConfig = mergeConfig;
const index_js_1 = require("../types/index.js");
exports.defaultConfig = {
    brain: {
        signalTimeout: 100, // 100ms max latency
        metricUpdateInterval: 60000, // 1 minute
        dashboardCacheTTL: 5000, // 5 seconds
        maxQueueSize: 100,
    },
    allocationEngine: {
        transitionPoints: {
            startP2: 1500, // Phase 2 starts at $1,500
            fullP2: 5000, // Phase 2 full allocation at $5,000
            startP3: 25000, // Phase 3 starts at $25,000
        },
        leverageCaps: {
            [index_js_1.EquityTier.MICRO]: 20, // < $1,500: 20x max
            [index_js_1.EquityTier.SMALL]: 10, // $1,500 - $5,000: 10x max
            [index_js_1.EquityTier.MEDIUM]: 5, // $5,000 - $25,000: 5x max
            [index_js_1.EquityTier.LARGE]: 3, // $25,000 - $50,000: 3x max
            [index_js_1.EquityTier.INSTITUTIONAL]: 2, // > $50,000: 2x max
        },
    },
    performanceTracker: {
        windowDays: 7,
        minTradeCount: 10,
        malusMultiplier: 0.5,
        bonusMultiplier: 1.2,
        malusThreshold: 0,
        bonusThreshold: 2.0,
    },
    riskGuardian: {
        maxCorrelation: 0.8,
        correlationPenalty: 0.5, // 50% size reduction
        betaUpdateInterval: 300000, // 5 minutes
        correlationUpdateInterval: 300000, // 5 minutes
    },
    capitalFlow: {
        sweepThreshold: 1.2, // 20% excess triggers sweep
        reserveLimit: 200, // $200 minimum
        sweepSchedule: '0 0 * * *', // Daily at midnight UTC
        maxRetries: 3,
        retryBaseDelay: 1000, // 1 second
    },
    circuitBreaker: {
        maxDailyDrawdown: 0.15, // 15%
        minEquity: 150, // $150 (75% of $200 starting)
        consecutiveLossLimit: 3,
        consecutiveLossWindow: 3600000, // 1 hour
        cooldownMinutes: 30,
    },
    database: {
        host: 'localhost',
        port: 5432,
        database: 'titan_brain',
        user: 'postgres',
        password: 'postgres',
        maxConnections: 20,
        idleTimeout: 30000,
    },
    redis: {
        url: 'redis://localhost:6379',
        maxRetries: 3,
        retryDelay: 1000,
    },
    server: {
        host: '0.0.0.0',
        port: 3100,
        corsOrigins: ['http://localhost:3000'],
    },
    notifications: {
        telegram: {
            enabled: false,
        },
        email: {
            enabled: false,
        },
    },
};
/**
 * Load configuration from environment variables
 */
function loadConfigFromEnv() {
    const config = {};
    // Database config from env
    if (process.env.DB_HOST) {
        config.database = {
            ...exports.defaultConfig.database,
            host: process.env.DB_HOST,
            port: parseInt(process.env.DB_PORT || '5432'),
            database: process.env.DB_NAME || 'titan_brain',
            user: process.env.DB_USER || 'postgres',
            password: process.env.DB_PASSWORD || 'postgres',
        };
    }
    // Redis config from env
    if (process.env.REDIS_URL) {
        config.redis = {
            ...exports.defaultConfig.redis,
            url: process.env.REDIS_URL,
        };
    }
    // Server config from env
    if (process.env.SERVER_PORT) {
        config.server = {
            ...exports.defaultConfig.server,
            host: process.env.SERVER_HOST || '0.0.0.0',
            port: parseInt(process.env.SERVER_PORT),
        };
    }
    // Telegram notifications from env
    if (process.env.TELEGRAM_BOT_TOKEN && process.env.TELEGRAM_CHAT_ID) {
        config.notifications = {
            ...exports.defaultConfig.notifications,
            telegram: {
                enabled: true,
                botToken: process.env.TELEGRAM_BOT_TOKEN,
                chatId: process.env.TELEGRAM_CHAT_ID,
            },
        };
    }
    return config;
}
/**
 * Merge configurations with defaults
 */
function mergeConfig(partial) {
    return {
        brain: { ...exports.defaultConfig.brain, ...partial.brain },
        allocationEngine: {
            ...exports.defaultConfig.allocationEngine,
            ...partial.allocationEngine,
        },
        performanceTracker: {
            ...exports.defaultConfig.performanceTracker,
            ...partial.performanceTracker,
        },
        riskGuardian: { ...exports.defaultConfig.riskGuardian, ...partial.riskGuardian },
        capitalFlow: { ...exports.defaultConfig.capitalFlow, ...partial.capitalFlow },
        circuitBreaker: {
            ...exports.defaultConfig.circuitBreaker,
            ...partial.circuitBreaker,
        },
        database: { ...exports.defaultConfig.database, ...partial.database },
        redis: { ...exports.defaultConfig.redis, ...partial.redis },
        server: { ...exports.defaultConfig.server, ...partial.server },
        notifications: {
            ...exports.defaultConfig.notifications,
            ...partial.notifications,
        },
    };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2l2YW4vQ29kZS90cmFkaW5nL3RpdGFuL3NlcnZpY2VzL3RpdGFuLWJyYWluL3NyYy9jb25maWcvZGVmYXVsdHMudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7R0FHRzs7O0FBOEZILDhDQTZDQztBQUtELGtDQTJCQztBQXpLRCxnREFBaUU7QUFFcEQsUUFBQSxhQUFhLEdBQXFCO0lBQzdDLEtBQUssRUFBRTtRQUNMLGFBQWEsRUFBRSxHQUFHLEVBQUUsb0JBQW9CO1FBQ3hDLG9CQUFvQixFQUFFLEtBQUssRUFBRSxXQUFXO1FBQ3hDLGlCQUFpQixFQUFFLElBQUksRUFBRSxZQUFZO1FBQ3JDLFlBQVksRUFBRSxHQUFHO0tBQ2xCO0lBRUQsZ0JBQWdCLEVBQUU7UUFDaEIsZ0JBQWdCLEVBQUU7WUFDaEIsT0FBTyxFQUFFLElBQUksRUFBRywyQkFBMkI7WUFDM0MsTUFBTSxFQUFFLElBQUksRUFBSSxvQ0FBb0M7WUFDcEQsT0FBTyxFQUFFLEtBQUssRUFBRSw0QkFBNEI7U0FDN0M7UUFDRCxZQUFZLEVBQUU7WUFDWixDQUFDLHFCQUFVLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFTLG9CQUFvQjtZQUNuRCxDQUFDLHFCQUFVLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxFQUFTLDJCQUEyQjtZQUMxRCxDQUFDLHFCQUFVLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxFQUFTLDJCQUEyQjtZQUMxRCxDQUFDLHFCQUFVLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFVLDRCQUE0QjtZQUMzRCxDQUFDLHFCQUFVLENBQUMsYUFBYSxDQUFDLEVBQUUsQ0FBQyxFQUFFLG9CQUFvQjtTQUNwRDtLQUNGO0lBRUQsa0JBQWtCLEVBQUU7UUFDbEIsVUFBVSxFQUFFLENBQUM7UUFDYixhQUFhLEVBQUUsRUFBRTtRQUNqQixlQUFlLEVBQUUsR0FBRztRQUNwQixlQUFlLEVBQUUsR0FBRztRQUNwQixjQUFjLEVBQUUsQ0FBQztRQUNqQixjQUFjLEVBQUUsR0FBRztLQUNwQjtJQUVE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QUUsR0FBRyxxQkFBYSxDQUFDLEtBQUssRUFBRSxHQUFHLE9BQU8sQ0FBQyxLQUFLLEVBQUU7UUFDbkQsTUFBTSxFQUFFLEVBQUUsR0FBRyxxQkFBYSxDQUFDLE1BQU0sRUFBRSxHQUFHLE9BQU8sQ0FBQyxNQUFNLEVBQUU7UUFDdEQsYUFBYSxFQUFFO1lBQ2IsR0FBRyxxQkFBYSxDQUFDLGFBQWE7WUFDOUIsR0FBRyxPQUFPLENBQUMsYUFBYTtTQUN6QjtLQUNGLENBQUM7QUFDSixDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9pdmFuL0NvZGUvdHJhZGluZy90aXRhbi9zZXJ2aWNlcy90aXRhbi1icmFpbi9zcmMvY29uZmlnL2RlZmF1bHRzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogRGVmYXVsdCBDb25maWd1cmF0aW9uIGZvciBUaXRhbiBCcmFpblxuICogQ29udGFpbnMgYWxsIGRlZmF1bHQgdmFsdWVzIGZvciB0aGUgc3lzdGVtXG4gKi9cblxuaW1wb3J0IHsgVGl0YW5CcmFpbkNvbmZpZywgRXF1aXR5VGllciB9IGZyb20gJy4uL3R5cGVzL2luZGV4LmpzJztcblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRDb25maWc6IFRpdGFuQnJhaW5Db25maWcgPSB7XG4gIGJyYWluOiB7XG4gICAgc2lnbmFsVGltZW91dDogMTAwLCAvLyAxMDBtcyBtYXggbGF0ZW5jeVxuICAgIG1ldHJpY1VwZGF0ZUludGVydmFsOiA2MDAwMCwgLy8gMSBtaW51dGVcbiAgICBkYXNoYm9hcmRDYWNoZVRUTDogNTAwMCwgLy8gNSBzZWNvbmRzXG4gICAgbWF4UXVldWVTaXplOiAxMDAsXG4gIH0sXG5cbiAgYWxsb2NhdGlvbkVuZ2luZToge1xuICAgIHRyYW5zaXRpb25Qb2ludHM6IHtcbiAgICAgIHN0YXJ0UDI6IDE1MDAsICAvLyBQaGFzZSAyIHN0YXJ0cyBhdCAkMSw1MDBcbiAgICAgIGZ1bGxQMjogNTAwMCwgICAvLyBQaGFzZSAyIGZ1bGwgYWxsb2NhdGlvbiBhdCAkNSwwMDBcbiAgICAgIHN0YXJ0UDM6IDI1MDAwLCAvLyBQaGFzZSAzIHN0YXJ0cyBhdCAkMjUsMDAwXG4gICAgfSxcbiAgICBsZXZlcmFnZUNhcHM6IHtcbiAgICAgIFtFcXVpdHlUaWVyLk1JQ1JPXTogMjAsICAgICAgICAvLyA8ICQxLDUwMDogMjB4IG1heFxuICAgICAgW0VxdWl0eVRpZXIuU01BTExdOiAxMCwgICAgICAgIC8vICQxLDUwMCAtICQ1LDAwMDogMTB4IG1heFxuICAgICAgW0VxdWl0eVRpZXIuTUVESVVNXTogNSwgICAgICAgIC8vICQ1LDAwMCAtICQyNSwwMDA6IDV4IG1heFxuICAgICAgW0VxdWl0eVRpZXIuTEFSR0VdOiAzLCAgICAgICAgIC8vICQyNSwwMDAgLSAkNTAsMDAwOiAzeCBtYXhcbiAgICAgIFtFcXVpdHlUaWVyLklOU1RJVFVUSU9OQUxdOiAyLCAvLyA+ICQ1MCwwMDA6IDJ4IG1heFxuICAgIH0sXG4gIH0sXG5cbiAgcGVyZm9ybWFuY2VUcmFja2VyOiB7XG4gICAgd2luZG93RGF5czogNyxcbiAgICBtaW5UcmFkZUNvdW50OiAxMCxcbiAgICBtYWx1c011bHRpcGxpZXI6IDAuNSxcbiAgICBib251c011bHRpcGxpZXI6IDEuMixcbiAgICBtYWx1c1RocmVzaG9sZDogMCxcbiAgICBib251c1RocmVzaG9sZDogMi4wLFxuICB9LFxuXG4gIHJpc2tHdWFyZGlhbjoge1xuICAgIG1heENvcnJlbGF0aW9uOiAwLjgsXG4gICAgY29ycmVsYXRpb25QZW5hbHR5OiAwLjUsIC8vIDUwJSBzaXplIHJlZHVjdGlvblxuICAgIGJldGFVcGRhdGVJbnRlcnZhbDogMzAwMDAwLCAvLyA1IG1pbnV0ZXNcbiAgICBjb3JyZWxhdGlvblVwZGF0ZUludGVydmFsOiAzMDAwMDAsIC8vIDUgbWludXRlc1xuICB9LFxuXG4gIGNhcGl0YWxGbG93OiB7XG4gICAgc3dlZXBUaHJlc2hvbGQ6IDEuMiwgLy8gMjAlIGV4Y2VzcyB0cmlnZ2VycyBzd2VlcFxuICAgIHJlc2VydmVMaW1pdDogMjAwLCAvLyAkMjAwIG1pbmltdW1cbiAgICBzd2VlcFNjaGVkdWxlOiAnMCAwICogKiAqJywgLy8gRGFpbHkgYXQgbWlkbmlnaHQgVVRDXG4gICAgbWF4UmV0cmllczogMyxcbiAgICByZXRyeUJhc2VEZWxheTogMTAwMCwgLy8gMSBzZWNvbmRcbiAgfSxcblxuICBjaXJjdWl0QnJlYWtlcjoge1xuICAgIG1heERhaWx5RHJhd2Rvd246IDAuMTUsIC8vIDE1JVxuICAgIG1pbkVxdWl0eTogMTUwLCAvLyAkMTUwICg3NSUgb2YgJDIwMCBzdGFydGluZylcbiAgICBjb25zZWN1dGl2ZUxvc3NMaW1pdDogMyxcbiAgICBjb25zZWN1dGl2ZUxvc3NXaW5kb3c6IDM2MDAwMDAsIC8vIDEgaG91clxuICAgIGNvb2xkb3duTWludXRlczogMzAsXG4gIH0sXG5cbiAgZGF0YWJhc2U6IHtcbiAgICBob3N0OiAnbG9jYWxob3N0JyxcbiAgICBwb3J0OiA1NDMyLFxuICAgIGRhdGFiYXNlOiAndGl0YW5fYnJhaW4nLFxuICAgIHVzZXI6ICdwb3N0Z3JlcycsXG4gICAgcGFzc3dvcmQ6ICdwb3N0Z3JlcycsXG4gICAgbWF4Q29ubmVjdGlvbnM6IDIwLFxuICAgIGlkbGVUaW1lb3V0OiAzMDAwMCxcbiAgfSxcblxuICByZWRpczoge1xuICAgIHVybDogJ3JlZGlzOi8vbG9jYWxob3N0OjYzNzknLFxuICAgIG1heFJldHJpZXM6IDMsXG4gICAgcmV0cnlEZWxheTogMTAwMCxcbiAgfSxcblxuICBzZXJ2ZXI6IHtcbiAgICBob3N0OiAnMC4wLjAuMCcsXG4gICAgcG9ydDogMzEwMCxcbiAgICBjb3JzT3JpZ2luczogWydodHRwOi8vbG9jYWxob3N0OjMwMDAnXSxcbiAgfSxcblxuICBub3RpZmljYXRpb25zOiB7XG4gICAgdGVsZWdyYW06IHtcbiAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgIH0sXG4gICAgZW1haWw6IHtcbiAgICAgIGVuYWJsZWQ6IGZhbHNlLFxuICAgIH0sXG4gIH0sXG59O1xuXG4vKipcbiAqIExvYWQgY29uZmlndXJhdGlvbiBmcm9tIGVudmlyb25tZW50IHZhcmlhYmxlc1xuICovXG5leHBvcnQgZnVuY3Rpb24gbG9hZENvbmZpZ0Zyb21FbnYoKTogUGFydGlhbDxUaXRhbkJyYWluQ29uZmlnPiB7XG4gIGNvbnN0IGNvbmZpZzogUGFydGlhbDxUaXRhbkJyYWluQ29uZmlnPiA9IHt9O1xuXG4gIC8vIERhdGFiYXNlIGNvbmZpZyBmcm9tIGVudlxuICBpZiAocHJvY2Vzcy5lbnYuREJfSE9TVCkge1xuICAgIGNvbmZpZy5kYXRhYmFzZSA9IHtcbiAgICAgIC4uLmRlZmF1bHRDb25maWcuZGF0YWJhc2UsXG4gICAgICBob3N0OiBwcm9jZXNzLmVudi5EQl9IT1NULFxuICAgICAgcG9ydDogcGFyc2VJbnQocHJvY2Vzcy5lbnYuREJfUE9SVCB8fCAnNTQzMicpLFxuICAgICAgZGF0YWJhc2U6IHByb2Nlc3MuZW52LkRCX05BTUUgfHwgJ3RpdGFuX2JyYWluJyxcbiAgICAgIHVzZXI6IHByb2Nlc3MuZW52LkRCX1VTRVIgfHwgJ3Bvc3RncmVzJyxcbiAgICAgIHBhc3N3b3JkOiBwcm9jZXNzLmVudi5EQl9QQVNTV09SRCB8fCAncG9zdGdyZXMnLFxuICAgIH07XG4gIH1cblxuICAvLyBSZWRpcyBjb25maWcgZnJvbSBlbnZcbiAgaWYgKHByb2Nlc3MuZW52LlJFRElTX1VSTCkge1xuICAgIGNvbmZpZy5yZWRpcyA9IHtcbiAgICAgIC4uLmRlZmF1bHRDb25maWcucmVkaXMsXG4gICAgICB1cmw6IHByb2Nlc3MuZW52LlJFRElTX1VSTCxcbiAgICB9O1xuICB9XG5cbiAgLy8gU2VydmVyIGNvbmZpZyBmcm9tIGVudlxuICBpZiAocHJvY2Vzcy5lbnYuU0VSVkVSX1BPUlQpIHtcbiAgICBjb25maWcuc2VydmVyID0ge1xuICAgICAgLi4uZGVmYXVsdENvbmZpZy5zZXJ2ZXIsXG4gICAgICBob3N0OiBwcm9jZXNzLmVudi5TRVJWRVJfSE9TVCB8fCAnMC4wLjAuMCcsXG4gICAgICBwb3J0OiBwYXJzZUludChwcm9jZXNzLmVudi5TRVJWRVJfUE9SVCksXG4gICAgfTtcbiAgfVxuXG4gIC8vIFRlbGVncmFtIG5vdGlmaWNhdGlvbnMgZnJvbSBlbnZcbiAgaWYgKHByb2Nlc3MuZW52LlRFTEVHUkFNX0JPVF9UT0tFTiAmJiBwcm9jZXNzLmVudi5URUxFR1JBTV9DSEFUX0lEKSB7XG4gICAgY29uZmlnLm5vdGlmaWNhdGlvbnMgPSB7XG4gICAgICAuLi5kZWZhdWx0Q29uZmlnLm5vdGlmaWNhdGlvbnMsXG4gICAgICB0ZWxlZ3JhbToge1xuICAgICAgICBlbmFibGVkOiB0cnVlLFxuICAgICAgICBib3RUb2tlbjogcHJvY2Vzcy5lbnYuVEVMRUdSQU1fQk9UX1RPS0VOLFxuICAgICAgICBjaGF0SWQ6IHByb2Nlc3MuZW52LlRFTEVHUkFNX0NIQVRfSUQsXG4gICAgICB9LFxuICAgIH07XG4gIH1cblxuICByZXR1cm4gY29uZmlnO1xufVxuXG4vKipcbiAqIE1lcmdlIGNvbmZpZ3VyYXRpb25zIHdpdGggZGVmYXVsdHNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1lcmdlQ29uZmlnKFxuICBwYXJ0aWFsOiBQYXJ0aWFsPFRpdGFuQnJhaW5Db25maWc+XG4pOiBUaXRhbkJyYWluQ29uZmlnIHtcbiAgcmV0dXJuIHtcbiAgICBicmFpbjogeyAuLi5kZWZhdWx0Q29uZmlnLmJyYWluLCAuLi5wYXJ0aWFsLmJyYWluIH0sXG4gICAgYWxsb2NhdGlvbkVuZ2luZToge1xuICAgICAgLi4uZGVmYXVsdENvbmZpZy5hbGxvY2F0aW9uRW5naW5lLFxuICAgICAgLi4ucGFydGlhbC5hbGxvY2F0aW9uRW5naW5lLFxuICAgIH0sXG4gICAgcGVyZm9ybWFuY2VUcmFja2VyOiB7XG4gICAgICAuLi5kZWZhdWx0Q29uZmlnLnBlcmZvcm1hbmNlVHJhY2tlcixcbiAgICAgIC4uLnBhcnRpYWwucGVyZm9ybWFuY2VUcmFja2VyLFxuICAgIH0sXG4gICAgcmlza0d1YXJkaWFuOiB7IC4uLmRlZmF1bHRDb25maWcucmlza0d1YXJkaWFuLCAuLi5wYXJ0aWFsLnJpc2tHdWFyZGlhbiB9LFxuICAgIGNhcGl0YWxGbG93OiB7IC4uLmRlZmF1bHRDb25maWcuY2FwaXRhbEZsb3csIC4uLnBhcnRpYWwuY2FwaXRhbEZsb3cgfSxcbiAgICBjaXJjdWl0QnJlYWtlcjoge1xuICAgICAgLi4uZGVmYXVsdENvbmZpZy5jaXJjdWl0QnJlYWtlcixcbiAgICAgIC4uLnBhcnRpYWwuY2lyY3VpdEJyZWFrZXIsXG4gICAgfSxcbiAgICBkYXRhYmFzZTogeyAuLi5kZWZhdWx0Q29uZmlnLmRhdGFiYXNlLCAuLi5wYXJ0aWFsLmRhdGFiYXNlIH0sXG4gICAgcmVkaXM6IHsgLi4uZGVmYXVsdENvbmZpZy5yZWRpcywgLi4ucGFydGlhbC5yZWRpcyB9LFxuICAgIHNlcnZlcjogeyAuLi5kZWZhdWx0Q29uZmlnLnNlcnZlciwgLi4ucGFydGlhbC5zZXJ2ZXIgfSxcbiAgICBub3RpZmljYXRpb25zOiB7XG4gICAgICAuLi5kZWZhdWx0Q29uZmlnLm5vdGlmaWNhdGlvbnMsXG4gICAgICAuLi5wYXJ0aWFsLm5vdGlmaWNhdGlvbnMsXG4gICAgfSxcbiAgfTtcbn1cbiJdLCJ2ZXJzaW9uIjozfQ==