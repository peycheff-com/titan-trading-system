{"file":"/Users/ivan/Code/trading/titan/services/titan-brain/tests/property/SecurityAuditLogger.property.test.ts","mappings":"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","names":[],"sources":["/Users/ivan/Code/trading/titan/services/titan-brain/tests/property/SecurityAuditLogger.property.test.ts"],"sourcesContent":["/**\n * Property-based tests for SecurityAuditLogger\n * \n * Property 9: Audit Trail Integrity\n * Validates: Requirements 6.5\n * \n * Tests that all security events are properly logged and audit trails maintain integrity\n */\n\nimport fc from 'fast-check';\nimport { SecurityAuditLogger, SecurityEventType, SecuritySeverity } from '../../src/security/SecurityAuditLogger.js';\nimport { readFileSync, existsSync, rmSync, mkdirSync } from 'fs';\nimport { join } from 'path';\n\ndescribe('SecurityAuditLogger Property Tests', () => {\n  const testLogDir = './test-logs/security';\n  let auditLogger: SecurityAuditLogger;\n\n  beforeEach(() => {\n    // Clean up test directory\n    if (existsSync(testLogDir)) {\n      rmSync(testLogDir, { recursive: true, force: true });\n    }\n    mkdirSync(testLogDir, { recursive: true });\n\n    // Create fresh audit logger for each test\n    auditLogger = new SecurityAuditLogger({\n      logDirectory: testLogDir,\n      maxLogFileSize: 1024 * 1024, // 1MB for testing\n      retentionDays: 30,\n      enableThreatDetection: false, // Disable for most tests to avoid complexity\n      alertThresholds: {\n        authFailuresPerMinute: 5,\n        validationFailuresPerMinute: 20,\n        suspiciousActivityPerHour: 10\n      }\n    });\n  });\n\n  afterEach(() => {\n    // Clean up test directory\n    if (existsSync(testLogDir)) {\n      rmSync(testLogDir, { recursive: true, force: true });\n    }\n  });\n\n  /**\n   * Property: All security events must be logged to audit trail\n   * \n   * For any valid security event, it must be written to the audit log file\n   * and be retrievable with all original data intact.\n   */\n  test('Property: All security events are logged to audit trail', () => {\n    fc.assert(\n      fc.property(\n        // Generate valid security event data\n        fc.record({\n          eventType: fc.constantFrom(\n            'AUTH_SUCCESS', 'AUTH_FAILURE', 'VALIDATION_FAILURE', \n            'HMAC_FAILURE', 'RATE_LIMIT_EXCEEDED', 'SUSPICIOUS_ACTIVITY',\n            'PRIVILEGE_ESCALATION', 'DATA_ACCESS', 'CONFIG_CHANGE', 'EMERGENCY_ACTION'\n          ) as fc.Arbitrary<SecurityEventType>,\n          severity: fc.constantFrom('INFO', 'WARNING', 'CRITICAL') as fc.Arbitrary<SecuritySeverity>,\n          clientIp: fc.ipV4(),\n          userAgent: fc.option(fc.string({ minLength: 1, maxLength: 200 }), { nil: undefined }),\n          operatorId: fc.option(fc.string({ minLength: 1, maxLength: 50 }), { nil: undefined }),\n          endpoint: fc.option(fc.webPath(), { nil: undefined }),\n          method: fc.option(fc.constantFrom('GET', 'POST', 'PUT', 'DELETE'), { nil: undefined }),\n          details: fc.record({\n            action: fc.string({ minLength: 1, maxLength: 100 }),\n            additionalData: fc.option(fc.string({ maxLength: 500 }), { nil: undefined })\n          }),\n          correlationId: fc.option(fc.uuid(), { nil: undefined })\n        }),\n        (eventData) => {\n          // Log the security event\n          auditLogger.logSecurityEvent(eventData);\n\n          // Get today's log file\n          const today = new Date().toISOString().split('T')[0];\n          const logFile = join(testLogDir, `security-audit-${today}.jsonl`);\n\n          // Verify log file exists\n          expect(existsSync(logFile)).toBe(true);\n\n          // Read and parse log file\n          const logContent = readFileSync(logFile, 'utf8');\n          const logLines = logContent.trim().split('\\n');\n          \n          // Should have at least one log entry\n          expect(logLines.length).toBeGreaterThan(0);\n\n          // Parse the last log entry (most recent)\n          const lastLogEntry = JSON.parse(logLines[logLines.length - 1]);\n\n          // Verify all required fields are present\n          expect(lastLogEntry).toHaveProperty('timestamp');\n          expect(lastLogEntry).toHaveProperty('eventType');\n          expect(lastLogEntry).toHaveProperty('severity');\n          expect(lastLogEntry).toHaveProperty('clientIp');\n          expect(lastLogEntry).toHaveProperty('details');\n\n          // Verify data integrity\n          expect(lastLogEntry.eventType).toBe(eventData.eventType);\n          expect(lastLogEntry.severity).toBe(eventData.severity);\n          expect(lastLogEntry.clientIp).toBe(eventData.clientIp);\n          expect(lastLogEntry.details).toEqual(eventData.details);\n\n          // Verify optional fields if present\n          if (eventData.userAgent) {\n            expect(lastLogEntry.userAgent).toBe(eventData.userAgent);\n          }\n          if (eventData.operatorId) {\n            expect(lastLogEntry.operatorId).toBe(eventData.operatorId);\n          }\n          if (eventData.endpoint) {\n            expect(lastLogEntry.endpoint).toBe(eventData.endpoint);\n          }\n          if (eventData.method) {\n            expect(lastLogEntry.method).toBe(eventData.method);\n          }\n          if (eventData.correlationId) {\n            expect(lastLogEntry.correlationId).toBe(eventData.correlationId);\n          }\n\n          // Verify timestamp is valid ISO string\n          expect(() => new Date(lastLogEntry.timestamp)).not.toThrow();\n          expect(new Date(lastLogEntry.timestamp).toISOString()).toBe(lastLogEntry.timestamp);\n        }\n      ),\n      { numRuns: 50 }\n    );\n  });\n\n  /**\n   * Property: Audit trail maintains chronological order\n   * \n   * Events logged in sequence must appear in the audit trail in the same order\n   * with monotonically increasing timestamps.\n   */\n  test('Property: Audit trail maintains chronological order', () => {\n    fc.assert(\n      fc.property(\n        // Generate array of security events\n        fc.array(\n          fc.record({\n            eventType: fc.constantFrom('AUTH_SUCCESS', 'DATA_ACCESS', 'CONFIG_CHANGE') as fc.Arbitrary<SecurityEventType>,\n            severity: fc.constantFrom('INFO', 'WARNING') as fc.Arbitrary<SecuritySeverity>,\n            clientIp: fc.ipV4(),\n            details: fc.record({\n              action: fc.string({ minLength: 1, maxLength: 50 })\n            })\n          }),\n          { minLength: 2, maxLength: 10 }\n        ),\n        (events) => {\n          // Log all events in sequence\n          events.forEach(event => {\n            auditLogger.logSecurityEvent(event);\n            // Small delay to ensure different timestamps\n            const start = Date.now();\n            while (Date.now() - start < 2) { /* busy wait */ }\n          });\n\n          // Read log file\n          const today = new Date().toISOString().split('T')[0];\n          const logFile = join(testLogDir, `security-audit-${today}.jsonl`);\n          const logContent = readFileSync(logFile, 'utf8');\n          const logLines = logContent.trim().split('\\n');\n\n          // Should have at least as many entries as events\n          expect(logLines.length).toBeGreaterThanOrEqual(events.length);\n\n          // Get the last N entries (corresponding to our events)\n          const relevantEntries = logLines.slice(-events.length);\n          const parsedEntries = relevantEntries.map(line => JSON.parse(line));\n\n          // Verify chronological order\n          for (let i = 1; i < parsedEntries.length; i++) {\n            const prevTimestamp = new Date(parsedEntries[i - 1].timestamp);\n            const currTimestamp = new Date(parsedEntries[i].timestamp);\n            \n            // Current timestamp should be >= previous timestamp\n            expect(currTimestamp.getTime()).toBeGreaterThanOrEqual(prevTimestamp.getTime());\n          }\n\n          // Verify event data matches in order\n          for (let i = 0; i < events.length; i++) {\n            expect(parsedEntries[i].eventType).toBe(events[i].eventType);\n            expect(parsedEntries[i].severity).toBe(events[i].severity);\n            expect(parsedEntries[i].clientIp).toBe(events[i].clientIp);\n          }\n        }\n      ),\n      { numRuns: 20 }\n    );\n  });\n\n  /**\n   * Property: Threat detection patterns are consistently applied\n   * \n   * Any input containing threat patterns must trigger suspicious activity logging\n   * in addition to the original event.\n   */\n  test('Property: Threat detection patterns are consistently applied', () => {\n    // Create a separate audit logger with threat detection enabled for this test\n    const threatDetectionLogger = new SecurityAuditLogger({\n      logDirectory: testLogDir,\n      maxLogFileSize: 1024 * 1024,\n      retentionDays: 30,\n      enableThreatDetection: true,\n      alertThresholds: {\n        authFailuresPerMinute: 5,\n        validationFailuresPerMinute: 20,\n        suspiciousActivityPerHour: 10\n      }\n    });\n\n    fc.assert(\n      fc.property(\n        fc.record({\n          baseEvent: fc.record({\n            eventType: fc.constantFrom('VALIDATION_FAILURE', 'DATA_ACCESS') as fc.Arbitrary<SecurityEventType>,\n            severity: fc.constantFrom('WARNING', 'INFO') as fc.Arbitrary<SecuritySeverity>,\n            clientIp: fc.ipV4(),\n            endpoint: fc.webPath()\n          }),\n          threatPattern: fc.constantFrom(\n            'union select * from users', // SQL injection\n            '<script>alert(\"xss\")</script>', // XSS\n            '../../../etc/passwd', // Path traversal\n            'rm -rf /', // Command injection\n            'x'.repeat(15000) // Excessive size\n          )\n        }),\n        ({ baseEvent, threatPattern }) => {\n          // Create event with threat pattern in details\n          const eventWithThreat = {\n            ...baseEvent,\n            details: {\n              action: 'test_action',\n              userInput: threatPattern,\n              additionalData: 'normal data'\n            }\n          };\n\n          // Log the event\n          threatDetectionLogger.logSecurityEvent(eventWithThreat);\n\n          // Read log file\n          const today = new Date().toISOString().split('T')[0];\n          const logFile = join(testLogDir, `security-audit-${today}.jsonl`);\n          const logContent = readFileSync(logFile, 'utf8');\n          const logLines = logContent.trim().split('\\n');\n\n          // Should have at least 2 entries: original event + suspicious activity\n          expect(logLines.length).toBeGreaterThanOrEqual(2);\n\n          const parsedEntries = logLines.map(line => JSON.parse(line));\n\n          // Find the original event\n          const originalEvent = parsedEntries.find(entry => \n            entry.eventType === baseEvent.eventType &&\n            entry.clientIp === baseEvent.clientIp\n          );\n          expect(originalEvent).toBeDefined();\n\n          // Find the suspicious activity event\n          const suspiciousEvent = parsedEntries.find(entry => \n            entry.eventType === 'SUSPICIOUS_ACTIVITY' &&\n            entry.clientIp === baseEvent.clientIp\n          );\n          expect(suspiciousEvent).toBeDefined();\n\n          // Verify suspicious event details\n          expect(suspiciousEvent.severity).toBe('CRITICAL');\n          expect(suspiciousEvent.details.action).toBe('suspicious_activity');\n          expect(suspiciousEvent.details).toHaveProperty('threatPattern');\n          expect(suspiciousEvent.details).toHaveProperty('description');\n          expect(suspiciousEvent.details.originalEventType).toBe(baseEvent.eventType);\n        }\n      ),\n      { numRuns: 10 } // Reduced runs for this complex test\n    );\n  });\n\n  /**\n   * Property: Alert thresholds trigger appropriate responses\n   * \n   * When event counts exceed configured thresholds within time windows,\n   * appropriate alerts must be triggered and logged.\n   */\n  test('Property: Alert thresholds trigger appropriate responses', () => {\n    fc.assert(\n      fc.property(\n        fc.record({\n          clientIp: fc.ipV4(),\n          eventCount: fc.integer({ min: 6, max: 15 }), // Above threshold of 5\n          eventType: fc.constantFrom('AUTH_FAILURE', 'VALIDATION_FAILURE') as fc.Arbitrary<SecurityEventType>\n        }),\n        ({ clientIp, eventCount, eventType }) => {\n          // Log multiple events of the same type from same IP\n          for (let i = 0; i < eventCount; i++) {\n            if (eventType === 'AUTH_FAILURE') {\n              auditLogger.logAuthenticationFailure(\n                clientIp,\n                `user_${i}`,\n                'invalid_credentials',\n                '/api/auth'\n              );\n            } else {\n              auditLogger.logValidationFailure(\n                clientIp,\n                '/api/signal',\n                [`validation_error_${i}`]\n              );\n            }\n          }\n\n          // Read log file\n          const today = new Date().toISOString().split('T')[0];\n          const logFile = join(testLogDir, `security-audit-${today}.jsonl`);\n          const logContent = readFileSync(logFile, 'utf8');\n          const logLines = logContent.trim().split('\\n');\n\n          const parsedEntries = logLines.map(line => JSON.parse(line));\n\n          // Count events of the specified type from the client IP\n          const eventsFromIp = parsedEntries.filter(entry => \n            entry.eventType === eventType && entry.clientIp === clientIp\n          );\n\n          // Should have logged all events\n          expect(eventsFromIp.length).toBe(eventCount);\n\n          // Since we exceeded threshold (5), there should be additional log entries\n          // indicating the alert was triggered (logged as errors)\n          // This is implementation-specific - the alert is logged via structured logger\n          // For this test, we verify that the threshold was indeed exceeded\n          expect(eventCount).toBeGreaterThan(5);\n        }\n      ),\n      { numRuns: 15 }\n    );\n  });\n\n  /**\n   * Property: Audit log format is consistent and parseable\n   * \n   * All audit log entries must be valid JSON with consistent structure\n   * and all required fields present.\n   */\n  test('Property: Audit log format is consistent and parseable', () => {\n    fc.assert(\n      fc.property(\n        fc.array(\n          fc.record({\n            eventType: fc.constantFrom(\n              'AUTH_SUCCESS', 'AUTH_FAILURE', 'VALIDATION_FAILURE',\n              'HMAC_FAILURE', 'SUSPICIOUS_ACTIVITY', 'DATA_ACCESS'\n            ) as fc.Arbitrary<SecurityEventType>,\n            severity: fc.constantFrom('INFO', 'WARNING', 'CRITICAL') as fc.Arbitrary<SecuritySeverity>,\n            clientIp: fc.ipV4(),\n            details: fc.record({\n              action: fc.string({ minLength: 1, maxLength: 100 }),\n              data: fc.option(fc.string({ maxLength: 200 }))\n            })\n          }),\n          { minLength: 1, maxLength: 20 }\n        ),\n        (events) => {\n          // Log all events\n          events.forEach(event => auditLogger.logSecurityEvent(event));\n\n          // Read log file\n          const today = new Date().toISOString().split('T')[0];\n          const logFile = join(testLogDir, `security-audit-${today}.jsonl`);\n          const logContent = readFileSync(logFile, 'utf8');\n          const logLines = logContent.trim().split('\\n').filter(line => line.length > 0);\n\n          // Every line should be valid JSON\n          logLines.forEach(line => {\n            expect(() => JSON.parse(line)).not.toThrow();\n            \n            const entry = JSON.parse(line);\n            \n            // Verify required fields\n            expect(entry).toHaveProperty('timestamp');\n            expect(entry).toHaveProperty('eventType');\n            expect(entry).toHaveProperty('severity');\n            expect(entry).toHaveProperty('clientIp');\n            expect(entry).toHaveProperty('details');\n\n            // Verify field types\n            expect(typeof entry.timestamp).toBe('string');\n            expect(typeof entry.eventType).toBe('string');\n            expect(typeof entry.severity).toBe('string');\n            expect(typeof entry.clientIp).toBe('string');\n            expect(typeof entry.details).toBe('object');\n\n            // Verify timestamp is valid ISO string\n            expect(() => new Date(entry.timestamp)).not.toThrow();\n            expect(new Date(entry.timestamp).toISOString()).toBe(entry.timestamp);\n\n            // Verify enum values\n            expect(['AUTH_SUCCESS', 'AUTH_FAILURE', 'VALIDATION_FAILURE', 'HMAC_FAILURE', \n                    'RATE_LIMIT_EXCEEDED', 'SUSPICIOUS_ACTIVITY', 'PRIVILEGE_ESCALATION', \n                    'DATA_ACCESS', 'CONFIG_CHANGE', 'EMERGENCY_ACTION']).toContain(entry.eventType);\n            expect(['INFO', 'WARNING', 'CRITICAL']).toContain(entry.severity);\n          });\n        }\n      ),\n      { numRuns: 25 }\n    );\n  });\n\n  /**\n   * Property: Security statistics accurately reflect logged events\n   * \n   * The getSecurityStatistics method must return counts that match\n   * the actual events logged within the specified time range.\n   */\n  test('Property: Security statistics accurately reflect logged events', () => {\n    fc.assert(\n      fc.property(\n        fc.record({\n          clientIp: fc.ipV4(),\n          authFailures: fc.integer({ min: 1, max: 10 }),\n          validationFailures: fc.integer({ min: 1, max: 10 })\n        }),\n        ({ clientIp, authFailures, validationFailures }) => {\n          // Log authentication failures\n          for (let i = 0; i < authFailures; i++) {\n            auditLogger.logAuthenticationFailure(\n              clientIp,\n              `user_${i}`,\n              'invalid_password',\n              '/api/auth'\n            );\n          }\n\n          // Log validation failures\n          for (let i = 0; i < validationFailures; i++) {\n            auditLogger.logValidationFailure(\n              clientIp,\n              '/api/signal',\n              [`error_${i}`]\n            );\n          }\n\n          // Get statistics\n          const stats = auditLogger.getSecurityStatistics(1); // Last 1 hour\n\n          // Verify counts match what we logged\n          const authFailureKey = `auth_failure_${clientIp}`;\n          const validationFailureKey = `validation_failure_${clientIp}`;\n\n          if (stats[authFailureKey]) {\n            expect(stats[authFailureKey]).toBe(authFailures);\n          }\n          if (stats[validationFailureKey]) {\n            expect(stats[validationFailureKey]).toBe(validationFailures);\n          }\n\n          // Statistics should only contain non-negative numbers\n          Object.values(stats).forEach(count => {\n            expect(typeof count).toBe('number');\n            expect(count).toBeGreaterThanOrEqual(0);\n          });\n        }\n      ),\n      { numRuns: 20 }\n    );\n  });\n});"],"version":3}