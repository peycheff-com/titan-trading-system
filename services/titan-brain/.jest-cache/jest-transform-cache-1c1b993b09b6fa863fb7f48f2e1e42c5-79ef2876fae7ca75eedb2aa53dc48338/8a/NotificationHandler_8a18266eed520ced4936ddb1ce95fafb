15ab47f9a095de5ce667ba83840b3081
"use strict";
/**
 * Notification Handler Implementation
 * Bridges the CircuitBreaker NotificationHandler interface with the NotificationService
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.TitanNotificationHandler = void 0;
/**
 * Concrete implementation of NotificationHandler that uses NotificationService
 */
class TitanNotificationHandler {
    notificationService;
    constructor(notificationService) {
        this.notificationService = notificationService;
    }
    /**
     * Send emergency notification for circuit breaker
     * Implementation of NotificationHandler interface
     */
    async sendEmergencyNotification(reason, equity) {
        const data = {
            reason,
            equity,
            drawdown: 0, // Will be calculated by the service
            triggeredAt: Date.now(),
        };
        await this.notificationService.sendCircuitBreakerNotification(data);
    }
    /**
     * Send high correlation warning
     * Requirement 6.5: Display warning when correlation exceeds threshold
     */
    async sendHighCorrelationWarning(correlationScore, threshold, affectedPositions) {
        const data = {
            correlationScore,
            threshold,
            affectedPositions,
        };
        await this.notificationService.sendHighCorrelationWarning(data);
    }
    /**
     * Send sweep notification
     * Requirement 4.7: Log all sweep transactions
     */
    async sendSweepNotification(amount, fromWallet, toWallet, reason, newBalance) {
        const data = {
            amount,
            fromWallet,
            toWallet,
            reason,
            newBalance,
        };
        await this.notificationService.sendSweepNotification(data);
    }
    /**
     * Send veto notification to phases
     * Requirement 7.6: Notify originating phase when signal is vetoed
     */
    async sendVetoNotification(phaseId, signalId, symbol, reason, requestedSize) {
        const data = {
            phaseId,
            signalId,
            symbol,
            reason,
            requestedSize,
        };
        await this.notificationService.sendVetoNotification(data);
    }
    /**
     * Send system error notification
     */
    async sendSystemError(error, context) {
        await this.notificationService.sendSystemError(error, context);
    }
    /**
     * Test all notification channels
     */
    async testNotifications() {
        return await this.notificationService.testNotifications();
    }
    /**
     * Update notification configuration
     */
    updateConfig(config) {
        this.notificationService.updateConfig(config);
    }
}
exports.TitanNotificationHandler = TitanNotificationHandler;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2l2YW4vQ29kZS90cmFkaW5nL3RpdGFuL3NlcnZpY2VzL3RpdGFuLWJyYWluL3NyYy9zZXJ2ZXIvTm90aWZpY2F0aW9uSGFuZGxlci50cyIsIm1hcHBpbmdzIjoiO0FBQUE7OztHQUdHOzs7QUFZSDs7R0FFRztBQUNILE1BQWEsd0JBQXdCO0lBQzNCLG1CQUFtQixDQUFzQjtJQUVqRCxZQUFZLG1CQUF3QztRQUNsRCxJQUFJLENBQUMsbUJBQW1CLEdBQUcsbUJBQW1CLENBQUM7SUFDakQsQ0FBQztJQUVEOzs7T0FHRztJQUNILEtBQUssQ0FBQyx5QkFBeUIsQ0FBQyxNQUFjLEVBQUUsTUFBYztRQUM1RCxNQUFNLElBQUksR0FBK0I7WUFDdkMsTUFBTTtZQUNOLE1BQU07WUFDTixRQUFRLEVBQUUsQ0FBQyxFQUFFLG9DQUFvQztZQUNqRCxXQUFXLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRTtTQUN4QixDQUFDO1FBRUYsTUFBTSxJQUFJLENBQUMsbUJBQW1CLENBQUMsOEJBQThCLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDdEUsQ0FBQztJQUVEOzs7T0FHRztJQUNILEtBQUssQ0FBQywwQkFBMEIsQ0FDOUIsZ0JBQXdCLEVBQ3hCLFNBQWlCLEVBQ2pCLGlCQUEyQjtRQUUzQixNQUFNLElBQUksR0FBZ0M7WUFDeEMsZ0JBQWdCO1lBQ2hCLFNBQVM7WUFDVCxpQkFBaUI7U0FDbEIsQ0FBQztRQUVGLE1BQU0sSUFBSSxDQUFDLG1CQUFtQixDQUFDLDBCQUEwQixDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2xFLENBQUM7SUFFRDs7O09BR0c7SUFDSCxLQUFLLENBQUMscUJBQXFCLENBQ3pCLE1BQWMsRUFDZCxVQUFrQixFQUNsQixRQUFnQixFQUNoQixNQUFjLEVBQ2QsVUFBa0I7UUFFbEIsTUFBTSxJQUFJLEdBQXNCO1lBQzlCLE1BQU07WUFDTixVQUFVO1lBQ1YsUUFBUTtZQUNSLE1BQU07WUFDTixVQUFVO1NBQ1gsQ0FBQztRQUVGLE1BQU0sSUFBSSxDQUFDLG1CQUFtQixDQUFDLHFCQUFxQixDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzdELENBQUM7SUFFRDs7O09BR0c7SUFDSCxLQUFLLENBQUMsb0JBQW9CLENBQ3hCLE9BQWdCLEVBQ2hCLFFBQWdCLEVBQ2hCLE1BQWMsRUFDZCxNQUFjLEVBQ2QsYUFBcUI7UUFFckIsTUFBTSxJQUFJLEdBQXFCO1lBQzdCLE9BQU87WUFDUCxRQUFRO1lBQ1IsTUFBTTtZQUNOLE1BQU07WUFDTixhQUFhO1NBQ2QsQ0FBQztRQUVGLE1BQU0sSUFBSSxDQUFDLG1CQUFtQixDQUFDLG9CQUFvQixDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzVELENBQUM7SUFFRDs7T0FFRztJQUNILEtBQUssQ0FBQyxlQUFlLENBQUMsS0FBYSxFQUFFLE9BQTZCO1FBQ2hFLE1BQU0sSUFBSSxDQUFDLG1CQUFtQixDQUFDLGVBQWUsQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDakUsQ0FBQztJQUVEOztPQUVHO0lBQ0gsS0FBSyxDQUFDLGlCQUFpQjtRQUNyQixPQUFPLE1BQU0sSUFBSSxDQUFDLG1CQUFtQixDQUFDLGlCQUFpQixFQUFFLENBQUM7SUFDNUQsQ0FBQztJQUVEOztPQUVHO0lBQ0gsWUFBWSxDQUFDLE1BQVc7UUFDdEIsSUFBSSxDQUFDLG1CQUFtQixDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNoRCxDQUFDO0NBQ0Y7QUF4R0QsNERBd0dDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9pdmFuL0NvZGUvdHJhZGluZy90aXRhbi9zZXJ2aWNlcy90aXRhbi1icmFpbi9zcmMvc2VydmVyL05vdGlmaWNhdGlvbkhhbmRsZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBOb3RpZmljYXRpb24gSGFuZGxlciBJbXBsZW1lbnRhdGlvblxuICogQnJpZGdlcyB0aGUgQ2lyY3VpdEJyZWFrZXIgTm90aWZpY2F0aW9uSGFuZGxlciBpbnRlcmZhY2Ugd2l0aCB0aGUgTm90aWZpY2F0aW9uU2VydmljZVxuICovXG5cbmltcG9ydCB7IE5vdGlmaWNhdGlvbkhhbmRsZXIgfSBmcm9tICcuLi9lbmdpbmUvQ2lyY3VpdEJyZWFrZXIuanMnO1xuaW1wb3J0IHsgXG4gIE5vdGlmaWNhdGlvblNlcnZpY2UsIFxuICBDaXJjdWl0QnJlYWtlck5vdGlmaWNhdGlvbixcbiAgSGlnaENvcnJlbGF0aW9uTm90aWZpY2F0aW9uLFxuICBTd2VlcE5vdGlmaWNhdGlvbixcbiAgVmV0b05vdGlmaWNhdGlvbixcbn0gZnJvbSAnLi9Ob3RpZmljYXRpb25TZXJ2aWNlLmpzJztcbmltcG9ydCB7IFBoYXNlSWQgfSBmcm9tICcuLi90eXBlcy9wZXJmb3JtYW5jZS5qcyc7XG5cbi8qKlxuICogQ29uY3JldGUgaW1wbGVtZW50YXRpb24gb2YgTm90aWZpY2F0aW9uSGFuZGxlciB0aGF0IHVzZXMgTm90aWZpY2F0aW9uU2VydmljZVxuICovXG5leHBvcnQgY2xhc3MgVGl0YW5Ob3RpZmljYXRpb25IYW5kbGVyIGltcGxlbWVudHMgTm90aWZpY2F0aW9uSGFuZGxlciB7XG4gIHByaXZhdGUgbm90aWZpY2F0aW9uU2VydmljZTogTm90aWZpY2F0aW9uU2VydmljZTtcblxuICBjb25zdHJ1Y3Rvcihub3RpZmljYXRpb25TZXJ2aWNlOiBOb3RpZmljYXRpb25TZXJ2aWNlKSB7XG4gICAgdGhpcy5ub3RpZmljYXRpb25TZXJ2aWNlID0gbm90aWZpY2F0aW9uU2VydmljZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZW5kIGVtZXJnZW5jeSBub3RpZmljYXRpb24gZm9yIGNpcmN1aXQgYnJlYWtlclxuICAgKiBJbXBsZW1lbnRhdGlvbiBvZiBOb3RpZmljYXRpb25IYW5kbGVyIGludGVyZmFjZVxuICAgKi9cbiAgYXN5bmMgc2VuZEVtZXJnZW5jeU5vdGlmaWNhdGlvbihyZWFzb246IHN0cmluZywgZXF1aXR5OiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBkYXRhOiBDaXJjdWl0QnJlYWtlck5vdGlmaWNhdGlvbiA9IHtcbiAgICAgIHJlYXNvbixcbiAgICAgIGVxdWl0eSxcbiAgICAgIGRyYXdkb3duOiAwLCAvLyBXaWxsIGJlIGNhbGN1bGF0ZWQgYnkgdGhlIHNlcnZpY2VcbiAgICAgIHRyaWdnZXJlZEF0OiBEYXRlLm5vdygpLFxuICAgIH07XG5cbiAgICBhd2FpdCB0aGlzLm5vdGlmaWNhdGlvblNlcnZpY2Uuc2VuZENpcmN1aXRCcmVha2VyTm90aWZpY2F0aW9uKGRhdGEpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNlbmQgaGlnaCBjb3JyZWxhdGlvbiB3YXJuaW5nXG4gICAqIFJlcXVpcmVtZW50IDYuNTogRGlzcGxheSB3YXJuaW5nIHdoZW4gY29ycmVsYXRpb24gZXhjZWVkcyB0aHJlc2hvbGRcbiAgICovXG4gIGFzeW5jIHNlbmRIaWdoQ29ycmVsYXRpb25XYXJuaW5nKFxuICAgIGNvcnJlbGF0aW9uU2NvcmU6IG51bWJlcixcbiAgICB0aHJlc2hvbGQ6IG51bWJlcixcbiAgICBhZmZlY3RlZFBvc2l0aW9uczogc3RyaW5nW11cbiAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgZGF0YTogSGlnaENvcnJlbGF0aW9uTm90aWZpY2F0aW9uID0ge1xuICAgICAgY29ycmVsYXRpb25TY29yZSxcbiAgICAgIHRocmVzaG9sZCxcbiAgICAgIGFmZmVjdGVkUG9zaXRpb25zLFxuICAgIH07XG5cbiAgICBhd2FpdCB0aGlzLm5vdGlmaWNhdGlvblNlcnZpY2Uuc2VuZEhpZ2hDb3JyZWxhdGlvbldhcm5pbmcoZGF0YSk7XG4gIH1cblxuICAvKipcbiAgICogU2VuZCBzd2VlcCBub3RpZmljYXRpb25cbiAgICogUmVxdWlyZW1lbnQgNC43OiBMb2cgYWxsIHN3ZWVwIHRyYW5zYWN0aW9uc1xuICAgKi9cbiAgYXN5bmMgc2VuZFN3ZWVwTm90aWZpY2F0aW9uKFxuICAgIGFtb3VudDogbnVtYmVyLFxuICAgIGZyb21XYWxsZXQ6IHN0cmluZyxcbiAgICB0b1dhbGxldDogc3RyaW5nLFxuICAgIHJlYXNvbjogc3RyaW5nLFxuICAgIG5ld0JhbGFuY2U6IG51bWJlclxuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBkYXRhOiBTd2VlcE5vdGlmaWNhdGlvbiA9IHtcbiAgICAgIGFtb3VudCxcbiAgICAgIGZyb21XYWxsZXQsXG4gICAgICB0b1dhbGxldCxcbiAgICAgIHJlYXNvbixcbiAgICAgIG5ld0JhbGFuY2UsXG4gICAgfTtcblxuICAgIGF3YWl0IHRoaXMubm90aWZpY2F0aW9uU2VydmljZS5zZW5kU3dlZXBOb3RpZmljYXRpb24oZGF0YSk7XG4gIH1cblxuICAvKipcbiAgICogU2VuZCB2ZXRvIG5vdGlmaWNhdGlvbiB0byBwaGFzZXNcbiAgICogUmVxdWlyZW1lbnQgNy42OiBOb3RpZnkgb3JpZ2luYXRpbmcgcGhhc2Ugd2hlbiBzaWduYWwgaXMgdmV0b2VkXG4gICAqL1xuICBhc3luYyBzZW5kVmV0b05vdGlmaWNhdGlvbihcbiAgICBwaGFzZUlkOiBQaGFzZUlkLFxuICAgIHNpZ25hbElkOiBzdHJpbmcsXG4gICAgc3ltYm9sOiBzdHJpbmcsXG4gICAgcmVhc29uOiBzdHJpbmcsXG4gICAgcmVxdWVzdGVkU2l6ZTogbnVtYmVyXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGRhdGE6IFZldG9Ob3RpZmljYXRpb24gPSB7XG4gICAgICBwaGFzZUlkLFxuICAgICAgc2lnbmFsSWQsXG4gICAgICBzeW1ib2wsXG4gICAgICByZWFzb24sXG4gICAgICByZXF1ZXN0ZWRTaXplLFxuICAgIH07XG5cbiAgICBhd2FpdCB0aGlzLm5vdGlmaWNhdGlvblNlcnZpY2Uuc2VuZFZldG9Ob3RpZmljYXRpb24oZGF0YSk7XG4gIH1cblxuICAvKipcbiAgICogU2VuZCBzeXN0ZW0gZXJyb3Igbm90aWZpY2F0aW9uXG4gICAqL1xuICBhc3luYyBzZW5kU3lzdGVtRXJyb3IoZXJyb3I6IHN0cmluZywgY29udGV4dD86IFJlY29yZDxzdHJpbmcsIGFueT4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBhd2FpdCB0aGlzLm5vdGlmaWNhdGlvblNlcnZpY2Uuc2VuZFN5c3RlbUVycm9yKGVycm9yLCBjb250ZXh0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUZXN0IGFsbCBub3RpZmljYXRpb24gY2hhbm5lbHNcbiAgICovXG4gIGFzeW5jIHRlc3ROb3RpZmljYXRpb25zKCk6IFByb21pc2U8eyB0ZWxlZ3JhbTogYm9vbGVhbjsgZW1haWw6IGJvb2xlYW4gfT4ge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLm5vdGlmaWNhdGlvblNlcnZpY2UudGVzdE5vdGlmaWNhdGlvbnMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgbm90aWZpY2F0aW9uIGNvbmZpZ3VyYXRpb25cbiAgICovXG4gIHVwZGF0ZUNvbmZpZyhjb25maWc6IGFueSk6IHZvaWQge1xuICAgIHRoaXMubm90aWZpY2F0aW9uU2VydmljZS51cGRhdGVDb25maWcoY29uZmlnKTtcbiAgfVxufSJdLCJ2ZXJzaW9uIjozfQ==