8b24537fc40fd7f3886868006af63c69
"use strict";
/**
 * InputValidator Tests
 *
 * Tests for input validation and sanitization functionality
 */
Object.defineProperty(exports, "__esModule", { value: true });
const InputValidator_js_1 = require("../../src/security/InputValidator.js");
describe('InputValidator', () => {
    describe('String Validation', () => {
        it('should validate required strings', () => {
            const result = InputValidator_js_1.InputValidator.validateString('test', 'field', { required: true });
            expect(result.isValid).toBe(true);
            expect(result.sanitizedValue).toBe('test');
        });
        it('should reject empty required strings', () => {
            const result = InputValidator_js_1.InputValidator.validateString('', 'field', { required: true });
            expect(result.isValid).toBe(false);
            expect(result.errors).toContain('field is required');
        });
        it('should validate string length', () => {
            const result = InputValidator_js_1.InputValidator.validateString('ab', 'field', { minLength: 3, maxLength: 10 });
            expect(result.isValid).toBe(false);
            expect(result.errors).toContain('field must be at least 3 characters long');
        });
        it('should validate against pattern', () => {
            const result = InputValidator_js_1.InputValidator.validateString('invalid!', 'field', { pattern: /^[a-zA-Z0-9]+$/ });
            expect(result.isValid).toBe(false);
            expect(result.errors).toContain('field format is invalid');
        });
        it('should validate allowed values', () => {
            const result = InputValidator_js_1.InputValidator.validateString('invalid', 'field', { allowedValues: ['valid1', 'valid2'] });
            expect(result.isValid).toBe(false);
            expect(result.errors).toContain('field must be one of: valid1, valid2');
        });
        it('should sanitize strings when requested', () => {
            const result = InputValidator_js_1.InputValidator.validateString('  test\x00string  ', 'field', { sanitize: true });
            expect(result.isValid).toBe(true);
            expect(result.sanitizedValue).toBe('teststring');
        });
    });
    describe('Number Validation', () => {
        it('should validate numbers', () => {
            const result = InputValidator_js_1.InputValidator.validateNumber(42, 'field', { required: true });
            expect(result.isValid).toBe(true);
            expect(result.sanitizedValue).toBe(42);
        });
        it('should convert string numbers', () => {
            const result = InputValidator_js_1.InputValidator.validateNumber('42.5', 'field', { required: true });
            expect(result.isValid).toBe(true);
            expect(result.sanitizedValue).toBe(42.5);
        });
        it('should reject invalid number strings', () => {
            const result = InputValidator_js_1.InputValidator.validateNumber('not-a-number', 'field', { required: true });
            expect(result.isValid).toBe(false);
            expect(result.errors).toContain('field must be a valid number');
        });
        it('should validate number ranges', () => {
            const result = InputValidator_js_1.InputValidator.validateNumber(150, 'field', { min: 0, max: 100 });
            expect(result.isValid).toBe(false);
            expect(result.errors).toContain('field must be at most 100');
        });
        it('should reject infinity and NaN', () => {
            const result1 = InputValidator_js_1.InputValidator.validateNumber(Infinity, 'field', { required: true });
            expect(result1.isValid).toBe(false);
            expect(result1.errors).toContain('field must be a finite number');
            const result2 = InputValidator_js_1.InputValidator.validateNumber(NaN, 'field', { required: true });
            expect(result2.isValid).toBe(false);
            expect(result2.errors).toContain('field must be a finite number');
        });
    });
    describe('Boolean Validation', () => {
        it('should validate boolean values', () => {
            const result = InputValidator_js_1.InputValidator.validateBoolean(true, 'field', { required: true });
            expect(result.isValid).toBe(true);
            expect(result.sanitizedValue).toBe(true);
        });
        it('should convert string booleans', () => {
            const result1 = InputValidator_js_1.InputValidator.validateBoolean('true', 'field', { required: true });
            expect(result1.isValid).toBe(true);
            expect(result1.sanitizedValue).toBe(true);
            const result2 = InputValidator_js_1.InputValidator.validateBoolean('false', 'field', { required: true });
            expect(result2.isValid).toBe(true);
            expect(result2.sanitizedValue).toBe(false);
        });
        it('should convert number booleans', () => {
            const result1 = InputValidator_js_1.InputValidator.validateBoolean(1, 'field', { required: true });
            expect(result1.isValid).toBe(true);
            expect(result1.sanitizedValue).toBe(true);
            const result2 = InputValidator_js_1.InputValidator.validateBoolean(0, 'field', { required: true });
            expect(result2.isValid).toBe(true);
            expect(result2.sanitizedValue).toBe(false);
        });
    });
    describe('Trading-Specific Validations', () => {
        it('should validate signal IDs', () => {
            const result1 = InputValidator_js_1.InputValidator.validateSignalId('valid-signal_123');
            expect(result1.isValid).toBe(true);
            const result2 = InputValidator_js_1.InputValidator.validateSignalId('invalid signal!');
            expect(result2.isValid).toBe(false);
            expect(result2.errors).toContain('signalId format is invalid');
        });
        it('should validate phase IDs', () => {
            const result1 = InputValidator_js_1.InputValidator.validatePhaseId('phase1');
            expect(result1.isValid).toBe(true);
            const result2 = InputValidator_js_1.InputValidator.validatePhaseId('invalid-phase');
            expect(result2.isValid).toBe(false);
            expect(result2.errors).toContain('phaseId must be one of: phase1, phase2, phase3');
        });
        it('should validate trading symbols', () => {
            const result1 = InputValidator_js_1.InputValidator.validateSymbol('BTCUSDT');
            expect(result1.isValid).toBe(true);
            const result2 = InputValidator_js_1.InputValidator.validateSymbol('btc-usdt');
            expect(result2.isValid).toBe(false);
            expect(result2.errors).toContain('symbol format is invalid');
        });
        it('should validate trade sides', () => {
            const result1 = InputValidator_js_1.InputValidator.validateSide('BUY');
            expect(result1.isValid).toBe(true);
            const result2 = InputValidator_js_1.InputValidator.validateSide('LONG');
            expect(result2.isValid).toBe(false);
            expect(result2.errors).toContain('side must be one of: BUY, SELL');
        });
        it('should validate position sizes', () => {
            const result1 = InputValidator_js_1.InputValidator.validatePositionSize(0.1);
            expect(result1.isValid).toBe(true);
            const result2 = InputValidator_js_1.InputValidator.validatePositionSize(-1);
            expect(result2.isValid).toBe(false);
            expect(result2.errors).toContain('requestedSize must be at least 0.000001');
            const result3 = InputValidator_js_1.InputValidator.validatePositionSize(2000000);
            expect(result3.isValid).toBe(false);
            expect(result3.errors).toContain('requestedSize must be at most 1000000');
        });
        it('should validate leverage', () => {
            const result1 = InputValidator_js_1.InputValidator.validateLeverage(20);
            expect(result1.isValid).toBe(true);
            const result2 = InputValidator_js_1.InputValidator.validateLeverage(150);
            expect(result2.isValid).toBe(false);
            expect(result2.errors).toContain('leverage must be at most 100');
        });
    });
    describe('Allocation Weights Validation', () => {
        it('should validate correct allocation weights', () => {
            const allocation = { w1: 0.5, w2: 0.3, w3: 0.2 };
            const result = InputValidator_js_1.InputValidator.validateAllocationWeights(allocation);
            expect(result.isValid).toBe(true);
            expect(result.sanitizedValue).toEqual(allocation);
        });
        it('should reject allocation weights that do not sum to 1.0', () => {
            const allocation = { w1: 0.5, w2: 0.3, w3: 0.3 }; // Sum = 1.1
            const result = InputValidator_js_1.InputValidator.validateAllocationWeights(allocation);
            expect(result.isValid).toBe(false);
            expect(result.errors).toContain('allocation weights must sum to 1.0, got 1.100');
        });
        it('should reject negative allocation weights', () => {
            const allocation = { w1: -0.1, w2: 0.6, w3: 0.5 };
            const result = InputValidator_js_1.InputValidator.validateAllocationWeights(allocation);
            expect(result.isValid).toBe(false);
            expect(result.errors).toContain('w1 must be at least 0');
        });
        it('should reject allocation weights greater than 1.0', () => {
            const allocation = { w1: 1.5, w2: 0, w3: 0 };
            const result = InputValidator_js_1.InputValidator.validateAllocationWeights(allocation);
            expect(result.isValid).toBe(false);
            expect(result.errors).toContain('w1 must be at most 1');
        });
    });
    describe('Signal Request Validation', () => {
        it('should validate complete signal request', () => {
            const signalRequest = {
                signalId: 'test-signal-123',
                phaseId: 'phase1',
                symbol: 'BTCUSDT',
                side: 'BUY',
                requestedSize: 0.1,
                leverage: 20,
                timestamp: Date.now()
            };
            const result = InputValidator_js_1.InputValidator.validateSignalRequest(signalRequest);
            expect(result.isValid).toBe(true);
            expect(result.sanitizedValue).toMatchObject({
                signalId: 'test-signal-123',
                phaseId: 'phase1',
                symbol: 'BTCUSDT',
                side: 'BUY',
                requestedSize: 0.1,
                leverage: 20
            });
        });
        it('should reject invalid signal request', () => {
            const signalRequest = {
                signalId: '',
                phaseId: 'invalid-phase',
                symbol: 'btc',
                side: 'LONG',
                requestedSize: -1
            };
            const result = InputValidator_js_1.InputValidator.validateSignalRequest(signalRequest);
            expect(result.isValid).toBe(false);
            expect(result.errors.length).toBeGreaterThan(0);
        });
        it('should handle missing optional fields', () => {
            const signalRequest = {
                signalId: 'test-signal-123',
                phaseId: 'phase1',
                symbol: 'BTCUSDT',
                side: 'BUY',
                requestedSize: 0.1
                // leverage and timestamp are optional
            };
            const result = InputValidator_js_1.InputValidator.validateSignalRequest(signalRequest);
            expect(result.isValid).toBe(true);
        });
    });
    describe('Permissions Validation', () => {
        it('should validate correct permissions', () => {
            const permissions = ['override:create', 'breaker:reset'];
            const result = InputValidator_js_1.InputValidator.validatePermissions(permissions);
            expect(result.isValid).toBe(true);
            expect(result.sanitizedValue).toEqual(permissions);
        });
        it('should reject invalid permissions', () => {
            const permissions = ['invalid:permission', 'override:create'];
            const result = InputValidator_js_1.InputValidator.validatePermissions(permissions);
            expect(result.isValid).toBe(false);
            expect(result.errors).toContain('permission must be one of: override:create, override:deactivate, breaker:reset, operator:create, config:update');
        });
        it('should reject empty permissions array', () => {
            const result = InputValidator_js_1.InputValidator.validatePermissions([]);
            expect(result.isValid).toBe(false);
            expect(result.errors).toContain('permissions must have at least 1 items');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2l2YW4vQ29kZS90cmFkaW5nL3RpdGFuL3NlcnZpY2VzL3RpdGFuLWJyYWluL3Rlc3RzL3VuaXQvSW5wdXRWYWxpZGF0b3IudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7R0FJRzs7QUFFSCw0RUFBc0U7QUFFdEUsUUFBUSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRTtJQUM5QixRQUFRLENBQUMsbUJBQW1CLEVBQUUsR0FBRyxFQUFFO1FBQ2pDLEVBQUUsQ0FBQyxrQ0FBa0MsRUFBRSxHQUFHLEVBQUU7WUFDMUMsTUFBTSxNQUFNLEdBQUcsa0NBQWMsQ0FBQyxjQUFjLENBQUMsTUFBTSxFQUFFLE9BQU8sRUFBRSxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO1lBQ2xGLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2xDLE1BQU0sQ0FBQyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQzdDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHNDQUFzQyxFQUFFLEdBQUcsRUFBRTtZQUM5QyxNQUFNLE1BQU0sR0FBRyxrQ0FBYyxDQUFDLGNBQWMsQ0FBQyxFQUFFLEVBQUUsT0FBTyxFQUFFLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7WUFDOUUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDbkMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsbUJBQW1CLENBQUMsQ0FBQztRQUN2RCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywrQkFBK0IsRUFBRSxHQUFHLEVBQUU7WUFDdkMsTUFBTSxNQUFNLEdBQUcsa0NBQWMsQ0FBQyxjQUFjLENBQUMsSUFBSSxFQUFFLE9BQU8sRUFBRSxFQUFFLFNBQVMsRUFBRSxDQUFDLEVBQUUsU0FBUyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDN0YsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDbkMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsMENBQTBDLENBQUMsQ0FBQztRQUM5RSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxpQ0FBaUMsRUFBRSxHQUFHLEVBQUU7WUFDekMsTUFBTSxNQUFNLEdBQUcsa0NBQWMsQ0FBQyxjQUFjLENBQUMsVUFBVSxFQUFFLE9BQU8sRUFBRSxFQUFFLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxDQUFDLENBQUM7WUFDakcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDbkMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMseUJBQXlCLENBQUMsQ0FBQztRQUM3RCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxnQ0FBZ0MsRUFBRSxHQUFHLEVBQUU7WUFDeEMsTUFBTSxNQUFNLEdBQUcsa0NBQWMsQ0FBQyxjQUFjLENBQUMsU0FBUyxFQUFFLE9BQU8sRUFBRSxFQUFFLGFBQWEsRUFBRSxDQUFDLFFBQVEsRUFBRSxRQUFRLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDMUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDbkMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsc0NBQXNDLENBQUMsQ0FBQztRQUMxRSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx3Q0FBd0MsRUFBRSxHQUFHLEVBQUU7WUFDaEQsTUFBTSxNQUFNLEdBQUcsa0NBQWMsQ0FBQyxjQUFjLENBQUMsb0JBQW9CLEVBQUUsT0FBTyxFQUFFLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7WUFDaEcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDbkQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUU7UUFDakMsRUFBRSxDQUFDLHlCQUF5QixFQUFFLEdBQUcsRUFBRTtZQUNqQyxNQUFNLE1BQU0sR0FBRyxrQ0FBYyxDQUFDLGNBQWMsQ0FBQyxFQUFFLEVBQUUsT0FBTyxFQUFFLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7WUFDOUUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDekMsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsK0JBQStCLEVBQUUsR0FBRyxFQUFFO1lBQ3ZDLE1BQU0sTUFBTSxHQUFHLGtDQUFjLENBQUMsY0FBYyxDQUFDLE1BQU0sRUFBRSxPQUFPLEVBQUUsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztZQUNsRixNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNsQyxNQUFNLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMzQyxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxzQ0FBc0MsRUFBRSxHQUFHLEVBQUU7WUFDOUMsTUFBTSxNQUFNLEdBQUcsa0NBQWMsQ0FBQyxjQUFjLENBQUMsY0FBYyxFQUFFLE9BQU8sRUFBRSxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO1lBQzFGLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ25DLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsU0FBUyxDQUFDLDhCQUE4QixDQUFDLENBQUM7UUFDbEUsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsK0JBQStCLEVBQUUsR0FBRyxFQUFFO1lBQ3ZDLE1BQU0sTUFBTSxHQUFHLGtDQUFjLENBQUMsY0FBYyxDQUFDLEdBQUcsRUFBRSxPQUFPLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO1lBQ2pGLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ25DLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsU0FBUyxDQUFDLDJCQUEyQixDQUFDLENBQUM7UUFDL0QsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsZ0NBQWdDLEVBQUUsR0FBRyxFQUFFO1lBQ3hDLE1BQU0sT0FBTyxHQUFHLGtDQUFjLENBQUMsY0FBYyxDQUFDLFFBQVEsRUFBRSxPQUFPLEVBQUUsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztZQUNyRixNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNwQyxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLFNBQVMsQ0FBQywrQkFBK0IsQ0FBQyxDQUFDO1lBRWxFLE1BQU0sT0FBTyxHQUFHLGtDQUFjLENBQUMsY0FBYyxDQUFDLEdBQUcsRUFBRSxPQUFPLEVBQUUsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztZQUNoRixNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNwQyxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLFNBQVMsQ0FBQywrQkFBK0IsQ0FBQyxDQUFDO1FBQ3BFLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsb0JBQW9CLEVBQUUsR0FBRyxFQUFFO1FBQ2xDLEVBQUUsQ0FBQyxnQ0FBZ0MsRUFBRSxHQUFHLEVBQUU7WUFDeEMsTUFBTSxNQUFNLEdBQUcsa0NBQWMsQ0FBQyxlQUFlLENBQUMsSUFBSSxFQUFFLE9BQU8sRUFBRSxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO1lBQ2pGLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2xDLE1BQU0sQ0FBQyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzNDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGdDQUFnQyxFQUFFLEdBQUcsRUFBRTtZQUN4QyxNQUFNLE9BQU8sR0FBRyxrQ0FBYyxDQUFDLGVBQWUsQ0FBQyxNQUFNLEVBQUUsT0FBTyxFQUFFLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7WUFDcEYsTUFBTSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbkMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxjQUFjLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFFMUMsTUFBTSxPQUFPLEdBQUcsa0NBQWMsQ0FBQyxlQUFlLENBQUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO1lBQ3JGLE1BQU0sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ25DLE1BQU0sQ0FBQyxPQUFPLENBQUMsY0FBYyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzdDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGdDQUFnQyxFQUFFLEdBQUcsRUFBRTtZQUN4QyxNQUFNLE9BQU8sR0FBRyxrQ0FBYyxDQUFDLGVBQWUsQ0FBQyxDQUFDLEVBQUUsT0FBTyxFQUFFLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7WUFDL0UsTUFBTSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDbkMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxjQUFjLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFFMUMsTUFBTSxPQUFPLEdBQUcsa0NBQWMsQ0FBQyxlQUFlLENBQUMsQ0FBQyxFQUFFLE9BQU8sRUFBRSxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO1lBQy9FLE1BQU0sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ25DLE1BQU0sQ0FBQyxPQUFPLENBQUMsY0FBYyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzdDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsOEJBQThCLEVBQUUsR0FBRyxFQUFFO1FBQzVDLEVBQUUsQ0FBQyw0QkFBNEIsRUFBRSxHQUFHLEVBQUU7WUFDcEMsTUFBTSxPQUFPLEdBQUcsa0NBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO1lBQ3BFLE1BQU0sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBRW5DLE1BQU0sT0FBTyxHQUFHLGtDQUFjLENBQUMsZ0JBQWdCLENBQUMsaUJBQWlCLENBQUMsQ0FBQztZQUNuRSxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNwQyxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLFNBQVMsQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDO1FBQ2pFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDJCQUEyQixFQUFFLEdBQUcsRUFBRTtZQUNuQyxNQUFNLE9BQU8sR0FBRyxrQ0FBYyxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUN6RCxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUVuQyxNQUFNLE9BQU8sR0FBRyxrQ0FBYyxDQUFDLGVBQWUsQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUNoRSxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNwQyxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLFNBQVMsQ0FBQyxnREFBZ0QsQ0FBQyxDQUFDO1FBQ3JGLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGlDQUFpQyxFQUFFLEdBQUcsRUFBRTtZQUN6QyxNQUFNLE9BQU8sR0FBRyxrQ0FBYyxDQUFDLGNBQWMsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUN6RCxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUVuQyxNQUFNLE9BQU8sR0FBRyxrQ0FBYyxDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUMxRCxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNwQyxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLFNBQVMsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO1FBQy9ELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDZCQUE2QixFQUFFLEdBQUcsRUFBRTtZQUNyQyxNQUFNLE9BQU8sR0FBRyxrQ0FBYyxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNuRCxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUVuQyxNQUFNLE9BQU8sR0FBRyxrQ0FBYyxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUNwRCxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNwQyxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLFNBQVMsQ0FBQyxnQ0FBZ0MsQ0FBQyxDQUFDO1FBQ3JFLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGdDQUFnQyxFQUFFLEdBQUcsRUFBRTtZQUN4QyxNQUFNLE9BQU8sR0FBRyxrQ0FBYyxDQUFDLG9CQUFvQixDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ3pELE1BQU0sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBRW5DLE1BQU0sT0FBTyxHQUFHLGtDQUFjLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN4RCxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNwQyxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLFNBQVMsQ0FBQyx5Q0FBeUMsQ0FBQyxDQUFDO1lBRTVFLE1BQU0sT0FBTyxHQUFHLGtDQUFjLENBQUMsb0JBQW9CLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDN0QsTUFBTSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDcEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsdUNBQXVDLENBQUMsQ0FBQztRQUM1RSxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywwQkFBMEIsRUFBRSxHQUFHLEVBQUU7WUFDbEMsTUFBTSxPQUFPLEdBQUcsa0NBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUNwRCxNQUFNLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUVuQyxNQUFNLE9BQU8sR0FBRyxrQ0FBYyxDQUFDLGdCQUFnQixDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ3JELE1BQU0sQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ3BDLE1BQU0sQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsU0FBUyxDQUFDLDhCQUE4QixDQUFDLENBQUM7UUFDbkUsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQywrQkFBK0IsRUFBRSxHQUFHLEVBQUU7UUFDN0MsRUFBRSxDQUFDLDRDQUE0QyxFQUFFLEdBQUcsRUFBRTtZQUNwRCxNQUFNLFVBQVUsR0FBRyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLENBQUM7WUFDakQsTUFBTSxNQUFNLEdBQUcsa0NBQWMsQ0FBQyx5QkFBeUIsQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUNwRSxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNsQyxNQUFNLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUNwRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx5REFBeUQsRUFBRSxHQUFHLEVBQUU7WUFDakUsTUFBTSxVQUFVLEdBQUcsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUMsWUFBWTtZQUM5RCxNQUFNLE1BQU0sR0FBRyxrQ0FBYyxDQUFDLHlCQUF5QixDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQ3BFLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ25DLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsU0FBUyxDQUFDLCtDQUErQyxDQUFDLENBQUM7UUFDbkYsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsMkNBQTJDLEVBQUUsR0FBRyxFQUFFO1lBQ25ELE1BQU0sVUFBVSxHQUFHLEVBQUUsRUFBRSxFQUFFLENBQUMsR0FBRyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxDQUFDO1lBQ2xELE1BQU0sTUFBTSxHQUFHLGtDQUFjLENBQUMseUJBQXlCLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDcEUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDbkMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsdUJBQXVCLENBQUMsQ0FBQztRQUMzRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxtREFBbUQsRUFBRSxHQUFHLEVBQUU7WUFDM0QsTUFBTSxVQUFVLEdBQUcsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDO1lBQzdDLE1BQU0sTUFBTSxHQUFHLGtDQUFjLENBQUMseUJBQXlCLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDcEUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDbkMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsc0JBQXNCLENBQUMsQ0FBQztRQUMxRCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLDJCQUEyQixFQUFFLEdBQUcsRUFBRTtRQUN6QyxFQUFFLENBQUMseUNBQXlDLEVBQUUsR0FBRyxFQUFFO1lBQ2pELE1BQU0sYUFBYSxHQUFHO2dCQUNwQixRQUFRLEVBQUUsaUJBQWlCO2dCQUMzQixPQUFPLEVBQUUsUUFBUTtnQkFDakIsTUFBTSxFQUFFLFNBQVM7Z0JBQ2pCLElBQUksRUFBRSxLQUFLO2dCQUNYLGFBQWEsRUFBRSxHQUFHO2dCQUNsQixRQUFRLEVBQUUsRUFBRTtnQkFDWixTQUFTLEVBQUUsSUFBSSxDQUFDLEdBQUcsRUFBRTthQUN0QixDQUFDO1lBRUYsTUFBTSxNQUFNLEdBQUcsa0NBQWMsQ0FBQyxxQkFBcUIsQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUNuRSxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNsQyxNQUFNLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLGFBQWEsQ0FBQztnQkFDMUMsUUFBUSxFQUFFLGlCQUFpQjtnQkFDM0IsT0FBTyxFQUFFLFFBQVE7Z0JBQ2pCLE1BQU0sRUFBRSxTQUFTO2dCQUNqQixJQUFJLEVBQUUsS0FBSztnQkFDWCxhQUFhLEVBQUUsR0FBRztnQkFDbEIsUUFBUSxFQUFFLEVBQUU7YUFDYixDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxzQ0FBc0MsRUFBRSxHQUFHLEVBQUU7WUFDOUMsTUFBTSxhQUFhLEdBQUc7Z0JBQ3BCLFFBQVEsRUFBRSxFQUFFO2dCQUNaLE9BQU8sRUFBRSxlQUFlO2dCQUN4QixNQUFNLEVBQUUsS0FBSztnQkFDYixJQUFJLEVBQUUsTUFBTTtnQkFDWixhQUFhLEVBQUUsQ0FBQyxDQUFDO2FBQ2xCLENBQUM7WUFFRixNQUFNLE1BQU0sR0FBRyxrQ0FBYyxDQUFDLHFCQUFxQixDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBQ25FLE1BQU0sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ25DLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx1Q0FBdUMsRUFBRSxHQUFHLEVBQUU7WUFDL0MsTUFBTSxhQUFhLEdBQUc7Z0JBQ3BCLFFBQVEsRUFBRSxpQkFBaUI7Z0JBQzNCLE9BQU8sRUFBRSxRQUFRO2dCQUNqQixNQUFNLEVBQUUsU0FBUztnQkFDakIsSUFBSSxFQUFFLEtBQUs7Z0JBQ1gsYUFBYSxFQUFFLEdBQUc7Z0JBQ2xCLHNDQUFzQzthQUN2QyxDQUFDO1lBRUYsTUFBTSxNQUFNLEdBQUcsa0NBQWMsQ0FBQyxxQkFBcUIsQ0FBQyxhQUFhLENBQUMsQ0FBQztZQUNuRSxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNwQyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLHdCQUF3QixFQUFFLEdBQUcsRUFBRTtRQUN0QyxFQUFFLENBQUMscUNBQXFDLEVBQUUsR0FBRyxFQUFFO1lBQzdDLE1BQU0sV0FBVyxHQUFHLENBQUMsaUJBQWlCLEVBQUUsZUFBZSxDQUFDLENBQUM7WUFDekQsTUFBTSxNQUFNLEdBQUcsa0NBQWMsQ0FBQyxtQkFBbUIsQ0FBQyxXQUFXLENBQUMsQ0FBQztZQUMvRCxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNsQyxNQUFNLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUNyRCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxtQ0FBbUMsRUFBRSxHQUFHLEVBQUU7WUFDM0MsTUFBTSxXQUFXLEdBQUcsQ0FBQyxvQkFBb0IsRUFBRSxpQkFBaUIsQ0FBQyxDQUFDO1lBQzlELE1BQU0sTUFBTSxHQUFHLGtDQUFjLENBQUMsbUJBQW1CLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDL0QsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDbkMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxTQUFTLENBQUMsZ0hBQWdILENBQUMsQ0FBQztRQUNwSixDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyx1Q0FBdUMsRUFBRSxHQUFHLEVBQUU7WUFDL0MsTUFBTSxNQUFNLEdBQUcsa0NBQWMsQ0FBQyxtQkFBbUIsQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUN0RCxNQUFNLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNuQyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLFNBQVMsQ0FBQyx3Q0FBd0MsQ0FBQyxDQUFDO1FBQzVFLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvaXZhbi9Db2RlL3RyYWRpbmcvdGl0YW4vc2VydmljZXMvdGl0YW4tYnJhaW4vdGVzdHMvdW5pdC9JbnB1dFZhbGlkYXRvci50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogSW5wdXRWYWxpZGF0b3IgVGVzdHNcbiAqIFxuICogVGVzdHMgZm9yIGlucHV0IHZhbGlkYXRpb24gYW5kIHNhbml0aXphdGlvbiBmdW5jdGlvbmFsaXR5XG4gKi9cblxuaW1wb3J0IHsgSW5wdXRWYWxpZGF0b3IgfSBmcm9tICcuLi8uLi9zcmMvc2VjdXJpdHkvSW5wdXRWYWxpZGF0b3IuanMnO1xuXG5kZXNjcmliZSgnSW5wdXRWYWxpZGF0b3InLCAoKSA9PiB7XG4gIGRlc2NyaWJlKCdTdHJpbmcgVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHJlcXVpcmVkIHN0cmluZ3MnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBJbnB1dFZhbGlkYXRvci52YWxpZGF0ZVN0cmluZygndGVzdCcsICdmaWVsZCcsIHsgcmVxdWlyZWQ6IHRydWUgfSk7XG4gICAgICBleHBlY3QocmVzdWx0LmlzVmFsaWQpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LnNhbml0aXplZFZhbHVlKS50b0JlKCd0ZXN0Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBlbXB0eSByZXF1aXJlZCBzdHJpbmdzJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gSW5wdXRWYWxpZGF0b3IudmFsaWRhdGVTdHJpbmcoJycsICdmaWVsZCcsIHsgcmVxdWlyZWQ6IHRydWUgfSk7XG4gICAgICBleHBlY3QocmVzdWx0LmlzVmFsaWQpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcnMpLnRvQ29udGFpbignZmllbGQgaXMgcmVxdWlyZWQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgc3RyaW5nIGxlbmd0aCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IElucHV0VmFsaWRhdG9yLnZhbGlkYXRlU3RyaW5nKCdhYicsICdmaWVsZCcsIHsgbWluTGVuZ3RoOiAzLCBtYXhMZW5ndGg6IDEwIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5pc1ZhbGlkKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JzKS50b0NvbnRhaW4oJ2ZpZWxkIG11c3QgYmUgYXQgbGVhc3QgMyBjaGFyYWN0ZXJzIGxvbmcnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgYWdhaW5zdCBwYXR0ZXJuJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gSW5wdXRWYWxpZGF0b3IudmFsaWRhdGVTdHJpbmcoJ2ludmFsaWQhJywgJ2ZpZWxkJywgeyBwYXR0ZXJuOiAvXlthLXpBLVowLTldKyQvIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5pc1ZhbGlkKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JzKS50b0NvbnRhaW4oJ2ZpZWxkIGZvcm1hdCBpcyBpbnZhbGlkJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGFsbG93ZWQgdmFsdWVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gSW5wdXRWYWxpZGF0b3IudmFsaWRhdGVTdHJpbmcoJ2ludmFsaWQnLCAnZmllbGQnLCB7IGFsbG93ZWRWYWx1ZXM6IFsndmFsaWQxJywgJ3ZhbGlkMiddIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5pc1ZhbGlkKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JzKS50b0NvbnRhaW4oJ2ZpZWxkIG11c3QgYmUgb25lIG9mOiB2YWxpZDEsIHZhbGlkMicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzYW5pdGl6ZSBzdHJpbmdzIHdoZW4gcmVxdWVzdGVkJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gSW5wdXRWYWxpZGF0b3IudmFsaWRhdGVTdHJpbmcoJyAgdGVzdFxceDAwc3RyaW5nICAnLCAnZmllbGQnLCB7IHNhbml0aXplOiB0cnVlIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5pc1ZhbGlkKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zYW5pdGl6ZWRWYWx1ZSkudG9CZSgndGVzdHN0cmluZycpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnTnVtYmVyIFZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBudW1iZXJzJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gSW5wdXRWYWxpZGF0b3IudmFsaWRhdGVOdW1iZXIoNDIsICdmaWVsZCcsIHsgcmVxdWlyZWQ6IHRydWUgfSk7XG4gICAgICBleHBlY3QocmVzdWx0LmlzVmFsaWQpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LnNhbml0aXplZFZhbHVlKS50b0JlKDQyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgY29udmVydCBzdHJpbmcgbnVtYmVycycsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IElucHV0VmFsaWRhdG9yLnZhbGlkYXRlTnVtYmVyKCc0Mi41JywgJ2ZpZWxkJywgeyByZXF1aXJlZDogdHJ1ZSB9KTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc2FuaXRpemVkVmFsdWUpLnRvQmUoNDIuNSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBpbnZhbGlkIG51bWJlciBzdHJpbmdzJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gSW5wdXRWYWxpZGF0b3IudmFsaWRhdGVOdW1iZXIoJ25vdC1hLW51bWJlcicsICdmaWVsZCcsIHsgcmVxdWlyZWQ6IHRydWUgfSk7XG4gICAgICBleHBlY3QocmVzdWx0LmlzVmFsaWQpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcnMpLnRvQ29udGFpbignZmllbGQgbXVzdCBiZSBhIHZhbGlkIG51bWJlcicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBudW1iZXIgcmFuZ2VzJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gSW5wdXRWYWxpZGF0b3IudmFsaWRhdGVOdW1iZXIoMTUwLCAnZmllbGQnLCB7IG1pbjogMCwgbWF4OiAxMDAgfSk7XG4gICAgICBleHBlY3QocmVzdWx0LmlzVmFsaWQpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcnMpLnRvQ29udGFpbignZmllbGQgbXVzdCBiZSBhdCBtb3N0IDEwMCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgaW5maW5pdHkgYW5kIE5hTicsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdDEgPSBJbnB1dFZhbGlkYXRvci52YWxpZGF0ZU51bWJlcihJbmZpbml0eSwgJ2ZpZWxkJywgeyByZXF1aXJlZDogdHJ1ZSB9KTtcbiAgICAgIGV4cGVjdChyZXN1bHQxLmlzVmFsaWQpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KHJlc3VsdDEuZXJyb3JzKS50b0NvbnRhaW4oJ2ZpZWxkIG11c3QgYmUgYSBmaW5pdGUgbnVtYmVyJyk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdDIgPSBJbnB1dFZhbGlkYXRvci52YWxpZGF0ZU51bWJlcihOYU4sICdmaWVsZCcsIHsgcmVxdWlyZWQ6IHRydWUgfSk7XG4gICAgICBleHBlY3QocmVzdWx0Mi5pc1ZhbGlkKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQyLmVycm9ycykudG9Db250YWluKCdmaWVsZCBtdXN0IGJlIGEgZmluaXRlIG51bWJlcicpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnQm9vbGVhbiBWYWxpZGF0aW9uJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgYm9vbGVhbiB2YWx1ZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBJbnB1dFZhbGlkYXRvci52YWxpZGF0ZUJvb2xlYW4odHJ1ZSwgJ2ZpZWxkJywgeyByZXF1aXJlZDogdHJ1ZSB9KTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc2FuaXRpemVkVmFsdWUpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNvbnZlcnQgc3RyaW5nIGJvb2xlYW5zJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0MSA9IElucHV0VmFsaWRhdG9yLnZhbGlkYXRlQm9vbGVhbigndHJ1ZScsICdmaWVsZCcsIHsgcmVxdWlyZWQ6IHRydWUgfSk7XG4gICAgICBleHBlY3QocmVzdWx0MS5pc1ZhbGlkKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdDEuc2FuaXRpemVkVmFsdWUpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdDIgPSBJbnB1dFZhbGlkYXRvci52YWxpZGF0ZUJvb2xlYW4oJ2ZhbHNlJywgJ2ZpZWxkJywgeyByZXF1aXJlZDogdHJ1ZSB9KTtcbiAgICAgIGV4cGVjdChyZXN1bHQyLmlzVmFsaWQpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0Mi5zYW5pdGl6ZWRWYWx1ZSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGNvbnZlcnQgbnVtYmVyIGJvb2xlYW5zJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0MSA9IElucHV0VmFsaWRhdG9yLnZhbGlkYXRlQm9vbGVhbigxLCAnZmllbGQnLCB7IHJlcXVpcmVkOiB0cnVlIH0pO1xuICAgICAgZXhwZWN0KHJlc3VsdDEuaXNWYWxpZCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQxLnNhbml0aXplZFZhbHVlKS50b0JlKHRydWUpO1xuXG4gICAgICBjb25zdCByZXN1bHQyID0gSW5wdXRWYWxpZGF0b3IudmFsaWRhdGVCb29sZWFuKDAsICdmaWVsZCcsIHsgcmVxdWlyZWQ6IHRydWUgfSk7XG4gICAgICBleHBlY3QocmVzdWx0Mi5pc1ZhbGlkKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdDIuc2FuaXRpemVkVmFsdWUpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVHJhZGluZy1TcGVjaWZpYyBWYWxpZGF0aW9ucycsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHNpZ25hbCBJRHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQxID0gSW5wdXRWYWxpZGF0b3IudmFsaWRhdGVTaWduYWxJZCgndmFsaWQtc2lnbmFsXzEyMycpO1xuICAgICAgZXhwZWN0KHJlc3VsdDEuaXNWYWxpZCkudG9CZSh0cnVlKTtcblxuICAgICAgY29uc3QgcmVzdWx0MiA9IElucHV0VmFsaWRhdG9yLnZhbGlkYXRlU2lnbmFsSWQoJ2ludmFsaWQgc2lnbmFsIScpO1xuICAgICAgZXhwZWN0KHJlc3VsdDIuaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0Mi5lcnJvcnMpLnRvQ29udGFpbignc2lnbmFsSWQgZm9ybWF0IGlzIGludmFsaWQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgcGhhc2UgSURzJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0MSA9IElucHV0VmFsaWRhdG9yLnZhbGlkYXRlUGhhc2VJZCgncGhhc2UxJyk7XG4gICAgICBleHBlY3QocmVzdWx0MS5pc1ZhbGlkKS50b0JlKHRydWUpO1xuXG4gICAgICBjb25zdCByZXN1bHQyID0gSW5wdXRWYWxpZGF0b3IudmFsaWRhdGVQaGFzZUlkKCdpbnZhbGlkLXBoYXNlJyk7XG4gICAgICBleHBlY3QocmVzdWx0Mi5pc1ZhbGlkKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQyLmVycm9ycykudG9Db250YWluKCdwaGFzZUlkIG11c3QgYmUgb25lIG9mOiBwaGFzZTEsIHBoYXNlMiwgcGhhc2UzJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHRyYWRpbmcgc3ltYm9scycsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdDEgPSBJbnB1dFZhbGlkYXRvci52YWxpZGF0ZVN5bWJvbCgnQlRDVVNEVCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdDEuaXNWYWxpZCkudG9CZSh0cnVlKTtcblxuICAgICAgY29uc3QgcmVzdWx0MiA9IElucHV0VmFsaWRhdG9yLnZhbGlkYXRlU3ltYm9sKCdidGMtdXNkdCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdDIuaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0Mi5lcnJvcnMpLnRvQ29udGFpbignc3ltYm9sIGZvcm1hdCBpcyBpbnZhbGlkJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIHRyYWRlIHNpZGVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0MSA9IElucHV0VmFsaWRhdG9yLnZhbGlkYXRlU2lkZSgnQlVZJyk7XG4gICAgICBleHBlY3QocmVzdWx0MS5pc1ZhbGlkKS50b0JlKHRydWUpO1xuXG4gICAgICBjb25zdCByZXN1bHQyID0gSW5wdXRWYWxpZGF0b3IudmFsaWRhdGVTaWRlKCdMT05HJyk7XG4gICAgICBleHBlY3QocmVzdWx0Mi5pc1ZhbGlkKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQyLmVycm9ycykudG9Db250YWluKCdzaWRlIG11c3QgYmUgb25lIG9mOiBCVVksIFNFTEwnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgcG9zaXRpb24gc2l6ZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQxID0gSW5wdXRWYWxpZGF0b3IudmFsaWRhdGVQb3NpdGlvblNpemUoMC4xKTtcbiAgICAgIGV4cGVjdChyZXN1bHQxLmlzVmFsaWQpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdDIgPSBJbnB1dFZhbGlkYXRvci52YWxpZGF0ZVBvc2l0aW9uU2l6ZSgtMSk7XG4gICAgICBleHBlY3QocmVzdWx0Mi5pc1ZhbGlkKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQyLmVycm9ycykudG9Db250YWluKCdyZXF1ZXN0ZWRTaXplIG11c3QgYmUgYXQgbGVhc3QgMC4wMDAwMDEnKTtcblxuICAgICAgY29uc3QgcmVzdWx0MyA9IElucHV0VmFsaWRhdG9yLnZhbGlkYXRlUG9zaXRpb25TaXplKDIwMDAwMDApO1xuICAgICAgZXhwZWN0KHJlc3VsdDMuaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0My5lcnJvcnMpLnRvQ29udGFpbigncmVxdWVzdGVkU2l6ZSBtdXN0IGJlIGF0IG1vc3QgMTAwMDAwMCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBsZXZlcmFnZScsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdDEgPSBJbnB1dFZhbGlkYXRvci52YWxpZGF0ZUxldmVyYWdlKDIwKTtcbiAgICAgIGV4cGVjdChyZXN1bHQxLmlzVmFsaWQpLnRvQmUodHJ1ZSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdDIgPSBJbnB1dFZhbGlkYXRvci52YWxpZGF0ZUxldmVyYWdlKDE1MCk7XG4gICAgICBleHBlY3QocmVzdWx0Mi5pc1ZhbGlkKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQyLmVycm9ycykudG9Db250YWluKCdsZXZlcmFnZSBtdXN0IGJlIGF0IG1vc3QgMTAwJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdBbGxvY2F0aW9uIFdlaWdodHMgVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGNvcnJlY3QgYWxsb2NhdGlvbiB3ZWlnaHRzJywgKCkgPT4ge1xuICAgICAgY29uc3QgYWxsb2NhdGlvbiA9IHsgdzE6IDAuNSwgdzI6IDAuMywgdzM6IDAuMiB9O1xuICAgICAgY29uc3QgcmVzdWx0ID0gSW5wdXRWYWxpZGF0b3IudmFsaWRhdGVBbGxvY2F0aW9uV2VpZ2h0cyhhbGxvY2F0aW9uKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc2FuaXRpemVkVmFsdWUpLnRvRXF1YWwoYWxsb2NhdGlvbik7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBhbGxvY2F0aW9uIHdlaWdodHMgdGhhdCBkbyBub3Qgc3VtIHRvIDEuMCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGFsbG9jYXRpb24gPSB7IHcxOiAwLjUsIHcyOiAwLjMsIHczOiAwLjMgfTsgLy8gU3VtID0gMS4xXG4gICAgICBjb25zdCByZXN1bHQgPSBJbnB1dFZhbGlkYXRvci52YWxpZGF0ZUFsbG9jYXRpb25XZWlnaHRzKGFsbG9jYXRpb24pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5pc1ZhbGlkKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JzKS50b0NvbnRhaW4oJ2FsbG9jYXRpb24gd2VpZ2h0cyBtdXN0IHN1bSB0byAxLjAsIGdvdCAxLjEwMCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgbmVnYXRpdmUgYWxsb2NhdGlvbiB3ZWlnaHRzJywgKCkgPT4ge1xuICAgICAgY29uc3QgYWxsb2NhdGlvbiA9IHsgdzE6IC0wLjEsIHcyOiAwLjYsIHczOiAwLjUgfTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IElucHV0VmFsaWRhdG9yLnZhbGlkYXRlQWxsb2NhdGlvbldlaWdodHMoYWxsb2NhdGlvbik7XG4gICAgICBleHBlY3QocmVzdWx0LmlzVmFsaWQpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcnMpLnRvQ29udGFpbigndzEgbXVzdCBiZSBhdCBsZWFzdCAwJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBhbGxvY2F0aW9uIHdlaWdodHMgZ3JlYXRlciB0aGFuIDEuMCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGFsbG9jYXRpb24gPSB7IHcxOiAxLjUsIHcyOiAwLCB3MzogMCB9O1xuICAgICAgY29uc3QgcmVzdWx0ID0gSW5wdXRWYWxpZGF0b3IudmFsaWRhdGVBbGxvY2F0aW9uV2VpZ2h0cyhhbGxvY2F0aW9uKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9ycykudG9Db250YWluKCd3MSBtdXN0IGJlIGF0IG1vc3QgMScpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU2lnbmFsIFJlcXVlc3QgVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGNvbXBsZXRlIHNpZ25hbCByZXF1ZXN0JywgKCkgPT4ge1xuICAgICAgY29uc3Qgc2lnbmFsUmVxdWVzdCA9IHtcbiAgICAgICAgc2lnbmFsSWQ6ICd0ZXN0LXNpZ25hbC0xMjMnLFxuICAgICAgICBwaGFzZUlkOiAncGhhc2UxJyxcbiAgICAgICAgc3ltYm9sOiAnQlRDVVNEVCcsXG4gICAgICAgIHNpZGU6ICdCVVknLFxuICAgICAgICByZXF1ZXN0ZWRTaXplOiAwLjEsXG4gICAgICAgIGxldmVyYWdlOiAyMCxcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBJbnB1dFZhbGlkYXRvci52YWxpZGF0ZVNpZ25hbFJlcXVlc3Qoc2lnbmFsUmVxdWVzdCk7XG4gICAgICBleHBlY3QocmVzdWx0LmlzVmFsaWQpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LnNhbml0aXplZFZhbHVlKS50b01hdGNoT2JqZWN0KHtcbiAgICAgICAgc2lnbmFsSWQ6ICd0ZXN0LXNpZ25hbC0xMjMnLFxuICAgICAgICBwaGFzZUlkOiAncGhhc2UxJyxcbiAgICAgICAgc3ltYm9sOiAnQlRDVVNEVCcsXG4gICAgICAgIHNpZGU6ICdCVVknLFxuICAgICAgICByZXF1ZXN0ZWRTaXplOiAwLjEsXG4gICAgICAgIGxldmVyYWdlOiAyMFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBpbnZhbGlkIHNpZ25hbCByZXF1ZXN0JywgKCkgPT4ge1xuICAgICAgY29uc3Qgc2lnbmFsUmVxdWVzdCA9IHtcbiAgICAgICAgc2lnbmFsSWQ6ICcnLFxuICAgICAgICBwaGFzZUlkOiAnaW52YWxpZC1waGFzZScsXG4gICAgICAgIHN5bWJvbDogJ2J0YycsXG4gICAgICAgIHNpZGU6ICdMT05HJyxcbiAgICAgICAgcmVxdWVzdGVkU2l6ZTogLTFcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IElucHV0VmFsaWRhdG9yLnZhbGlkYXRlU2lnbmFsUmVxdWVzdChzaWduYWxSZXF1ZXN0KTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9ycy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIG1pc3Npbmcgb3B0aW9uYWwgZmllbGRzJywgKCkgPT4ge1xuICAgICAgY29uc3Qgc2lnbmFsUmVxdWVzdCA9IHtcbiAgICAgICAgc2lnbmFsSWQ6ICd0ZXN0LXNpZ25hbC0xMjMnLFxuICAgICAgICBwaGFzZUlkOiAncGhhc2UxJyxcbiAgICAgICAgc3ltYm9sOiAnQlRDVVNEVCcsXG4gICAgICAgIHNpZGU6ICdCVVknLFxuICAgICAgICByZXF1ZXN0ZWRTaXplOiAwLjFcbiAgICAgICAgLy8gbGV2ZXJhZ2UgYW5kIHRpbWVzdGFtcCBhcmUgb3B0aW9uYWxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IElucHV0VmFsaWRhdG9yLnZhbGlkYXRlU2lnbmFsUmVxdWVzdChzaWduYWxSZXF1ZXN0KTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Blcm1pc3Npb25zIFZhbGlkYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBjb3JyZWN0IHBlcm1pc3Npb25zJywgKCkgPT4ge1xuICAgICAgY29uc3QgcGVybWlzc2lvbnMgPSBbJ292ZXJyaWRlOmNyZWF0ZScsICdicmVha2VyOnJlc2V0J107XG4gICAgICBjb25zdCByZXN1bHQgPSBJbnB1dFZhbGlkYXRvci52YWxpZGF0ZVBlcm1pc3Npb25zKHBlcm1pc3Npb25zKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc2FuaXRpemVkVmFsdWUpLnRvRXF1YWwocGVybWlzc2lvbnMpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgaW52YWxpZCBwZXJtaXNzaW9ucycsICgpID0+IHtcbiAgICAgIGNvbnN0IHBlcm1pc3Npb25zID0gWydpbnZhbGlkOnBlcm1pc3Npb24nLCAnb3ZlcnJpZGU6Y3JlYXRlJ107XG4gICAgICBjb25zdCByZXN1bHQgPSBJbnB1dFZhbGlkYXRvci52YWxpZGF0ZVBlcm1pc3Npb25zKHBlcm1pc3Npb25zKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9ycykudG9Db250YWluKCdwZXJtaXNzaW9uIG11c3QgYmUgb25lIG9mOiBvdmVycmlkZTpjcmVhdGUsIG92ZXJyaWRlOmRlYWN0aXZhdGUsIGJyZWFrZXI6cmVzZXQsIG9wZXJhdG9yOmNyZWF0ZSwgY29uZmlnOnVwZGF0ZScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgZW1wdHkgcGVybWlzc2lvbnMgYXJyYXknLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBJbnB1dFZhbGlkYXRvci52YWxpZGF0ZVBlcm1pc3Npb25zKFtdKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9ycykudG9Db250YWluKCdwZXJtaXNzaW9ucyBtdXN0IGhhdmUgYXQgbGVhc3QgMSBpdGVtcycpO1xuICAgIH0pO1xuICB9KTtcbn0pOyJdLCJ2ZXJzaW9uIjozfQ==