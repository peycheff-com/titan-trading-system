480af06494218a4950b0e3503a836509
"use strict";
/**
 * Unit Tests for AllocationEngine
 *
 * Tests boundary conditions, sigmoid smoothness, and leverage cap lookup.
 * Requirements: 1.2, 1.3, 1.4, 1.5, 1.6, 3.4
 */
Object.defineProperty(exports, "__esModule", { value: true });
const AllocationEngine_js_1 = require("../../src/engine/AllocationEngine.js");
const index_js_1 = require("../../src/types/index.js");
const defaults_js_1 = require("../../src/config/defaults.js");
describe('AllocationEngine', () => {
    let engine;
    beforeEach(() => {
        engine = new AllocationEngine_js_1.AllocationEngine(defaults_js_1.defaultConfig.allocationEngine);
    });
    describe('constructor', () => {
        it('should initialize with provided configuration', () => {
            const transitionPoints = engine.getTransitionPoints();
            const leverageCaps = engine.getLeverageCaps();
            expect(transitionPoints.startP2).toBe(1500);
            expect(transitionPoints.fullP2).toBe(5000);
            expect(transitionPoints.startP3).toBe(25000);
            expect(leverageCaps[index_js_1.EquityTier.MICRO]).toBe(20);
            expect(leverageCaps[index_js_1.EquityTier.INSTITUTIONAL]).toBe(2);
        });
        it('should accept custom configuration', () => {
            const customEngine = new AllocationEngine_js_1.AllocationEngine({
                transitionPoints: {
                    startP2: 2000,
                    fullP2: 10000,
                    startP3: 50000,
                },
                leverageCaps: {
                    [index_js_1.EquityTier.MICRO]: 25,
                    [index_js_1.EquityTier.SMALL]: 15,
                    [index_js_1.EquityTier.MEDIUM]: 8,
                    [index_js_1.EquityTier.LARGE]: 4,
                    [index_js_1.EquityTier.INSTITUTIONAL]: 2,
                },
            });
            const transitionPoints = customEngine.getTransitionPoints();
            expect(transitionPoints.startP2).toBe(2000);
            expect(transitionPoints.fullP2).toBe(10000);
        });
    });
    describe('getWeights', () => {
        describe('boundary conditions', () => {
            it('should return 100% Phase 1 at $0', () => {
                const weights = engine.getWeights(0);
                expect(weights.w1).toBe(1.0);
                expect(weights.w2).toBe(0.0);
                expect(weights.w3).toBe(0.0);
            });
            it('should return 100% Phase 1 at $1,499', () => {
                const weights = engine.getWeights(1499);
                expect(weights.w1).toBe(1.0);
                expect(weights.w2).toBe(0.0);
                expect(weights.w3).toBe(0.0);
            });
            it('should start transitioning at $1,500', () => {
                const weights = engine.getWeights(1500);
                // At the start of transition, Phase 1 should still be dominant
                expect(weights.w1).toBeGreaterThan(0.5);
                expect(weights.w2).toBeLessThan(0.5);
                expect(weights.w3).toBe(0.0);
            });
            it('should be at stable allocation at $5,000', () => {
                const weights = engine.getWeights(5000);
                // At full P2, should be approximately 20% P1, 80% P2
                expect(weights.w1).toBeCloseTo(0.2, 1);
                expect(weights.w2).toBeCloseTo(0.8, 1);
                expect(weights.w3).toBe(0.0);
            });
            it('should maintain stable allocation at $10,000', () => {
                const weights = engine.getWeights(10000);
                expect(weights.w1).toBeCloseTo(0.2, 1);
                expect(weights.w2).toBeCloseTo(0.8, 1);
                expect(weights.w3).toBe(0.0);
            });
            it('should start Phase 3 transition at $25,000', () => {
                const weights = engine.getWeights(25000);
                // At the start of P3 transition
                expect(weights.w1).toBeCloseTo(0.2, 1);
                expect(weights.w2).toBeLessThanOrEqual(0.8);
                expect(weights.w3).toBeGreaterThanOrEqual(0);
            });
            it('should have significant Phase 3 allocation at $50,000', () => {
                const weights = engine.getWeights(50000);
                expect(weights.w1).toBeCloseTo(0.2, 1);
                expect(weights.w3).toBeGreaterThan(0.1);
                // Sum should still be 1.0
                expect(weights.w1 + weights.w2 + weights.w3).toBeCloseTo(1.0, 10);
            });
        });
        describe('sigmoid smoothness', () => {
            it('should have smooth transition in Phase 1 → Phase 2 zone', () => {
                const equityLevels = [1500, 2000, 2500, 3000, 3500, 4000, 4500, 5000];
                const weights = equityLevels.map(e => engine.getWeights(e));
                // Phase 1 weight should monotonically decrease
                for (let i = 1; i < weights.length; i++) {
                    expect(weights[i].w1).toBeLessThanOrEqual(weights[i - 1].w1);
                }
                // Phase 2 weight should monotonically increase
                for (let i = 1; i < weights.length; i++) {
                    expect(weights[i].w2).toBeGreaterThanOrEqual(weights[i - 1].w2);
                }
            });
            it('should have no sudden jumps in allocation', () => {
                const step = 100;
                let prevWeights = engine.getWeights(1500);
                for (let equity = 1600; equity <= 5000; equity += step) {
                    const weights = engine.getWeights(equity);
                    // No weight should change by more than 20% per $100 step
                    expect(Math.abs(weights.w1 - prevWeights.w1)).toBeLessThan(0.2);
                    expect(Math.abs(weights.w2 - prevWeights.w2)).toBeLessThan(0.2);
                    prevWeights = weights;
                }
            });
            it('should have smooth transition in Phase 2 → Phase 3 zone', () => {
                const equityLevels = [25000, 30000, 35000, 40000, 45000, 50000];
                const weights = equityLevels.map(e => engine.getWeights(e));
                // Phase 3 weight should monotonically increase
                for (let i = 1; i < weights.length; i++) {
                    expect(weights[i].w3).toBeGreaterThanOrEqual(weights[i - 1].w3);
                }
                // Phase 2 weight should monotonically decrease (as P3 takes over)
                for (let i = 1; i < weights.length; i++) {
                    expect(weights[i].w2).toBeLessThanOrEqual(weights[i - 1].w2);
                }
            });
        });
        describe('weight sum invariant', () => {
            it('should always sum to 1.0', () => {
                const testEquities = [0, 100, 500, 1000, 1500, 2500, 5000, 10000, 25000, 50000, 100000];
                for (const equity of testEquities) {
                    const weights = engine.getWeights(equity);
                    const sum = weights.w1 + weights.w2 + weights.w3;
                    expect(sum).toBeCloseTo(1.0, 10);
                }
            });
        });
        describe('edge cases', () => {
            it('should handle negative equity as $0', () => {
                const weights = engine.getWeights(-1000);
                expect(weights.w1).toBe(1.0);
                expect(weights.w2).toBe(0.0);
                expect(weights.w3).toBe(0.0);
            });
            it('should handle very large equity', () => {
                const weights = engine.getWeights(10000000);
                expect(weights.w1 + weights.w2 + weights.w3).toBeCloseTo(1.0, 10);
                expect(weights.w3).toBeGreaterThan(0);
            });
            it('should include timestamp in result', () => {
                const before = Date.now();
                const weights = engine.getWeights(5000);
                const after = Date.now();
                expect(weights.timestamp).toBeGreaterThanOrEqual(before);
                expect(weights.timestamp).toBeLessThanOrEqual(after);
            });
        });
    });
    describe('getEquityTier', () => {
        describe('tier boundaries', () => {
            it('should return MICRO for equity < $1,500', () => {
                expect(engine.getEquityTier(0)).toBe(index_js_1.EquityTier.MICRO);
                expect(engine.getEquityTier(500)).toBe(index_js_1.EquityTier.MICRO);
                expect(engine.getEquityTier(1499.99)).toBe(index_js_1.EquityTier.MICRO);
            });
            it('should return SMALL for equity $1,500 - $4,999.99', () => {
                expect(engine.getEquityTier(1500)).toBe(index_js_1.EquityTier.SMALL);
                expect(engine.getEquityTier(3000)).toBe(index_js_1.EquityTier.SMALL);
                expect(engine.getEquityTier(4999.99)).toBe(index_js_1.EquityTier.SMALL);
            });
            it('should return MEDIUM for equity $5,000 - $24,999.99', () => {
                expect(engine.getEquityTier(5000)).toBe(index_js_1.EquityTier.MEDIUM);
                expect(engine.getEquityTier(15000)).toBe(index_js_1.EquityTier.MEDIUM);
                expect(engine.getEquityTier(24999.99)).toBe(index_js_1.EquityTier.MEDIUM);
            });
            it('should return LARGE for equity $25,000 - $49,999.99', () => {
                expect(engine.getEquityTier(25000)).toBe(index_js_1.EquityTier.LARGE);
                expect(engine.getEquityTier(35000)).toBe(index_js_1.EquityTier.LARGE);
                expect(engine.getEquityTier(49999.99)).toBe(index_js_1.EquityTier.LARGE);
            });
            it('should return INSTITUTIONAL for equity >= $50,000', () => {
                expect(engine.getEquityTier(50000)).toBe(index_js_1.EquityTier.INSTITUTIONAL);
                expect(engine.getEquityTier(100000)).toBe(index_js_1.EquityTier.INSTITUTIONAL);
                expect(engine.getEquityTier(1000000)).toBe(index_js_1.EquityTier.INSTITUTIONAL);
            });
        });
        describe('edge cases', () => {
            it('should handle negative equity as MICRO', () => {
                expect(engine.getEquityTier(-100)).toBe(index_js_1.EquityTier.MICRO);
                expect(engine.getEquityTier(-1000000)).toBe(index_js_1.EquityTier.MICRO);
            });
            it('should handle exact boundary values', () => {
                // Exact boundaries should be in the higher tier
                expect(engine.getEquityTier(1500)).toBe(index_js_1.EquityTier.SMALL);
                expect(engine.getEquityTier(5000)).toBe(index_js_1.EquityTier.MEDIUM);
                expect(engine.getEquityTier(25000)).toBe(index_js_1.EquityTier.LARGE);
                expect(engine.getEquityTier(50000)).toBe(index_js_1.EquityTier.INSTITUTIONAL);
            });
        });
    });
    describe('getMaxLeverage', () => {
        describe('leverage cap lookup', () => {
            it('should return 20x for MICRO tier', () => {
                expect(engine.getMaxLeverage(0)).toBe(20);
                expect(engine.getMaxLeverage(500)).toBe(20);
                expect(engine.getMaxLeverage(1499)).toBe(20);
            });
            it('should return 10x for SMALL tier', () => {
                expect(engine.getMaxLeverage(1500)).toBe(10);
                expect(engine.getMaxLeverage(3000)).toBe(10);
                expect(engine.getMaxLeverage(4999)).toBe(10);
            });
            it('should return 5x for MEDIUM tier', () => {
                expect(engine.getMaxLeverage(5000)).toBe(5);
                expect(engine.getMaxLeverage(15000)).toBe(5);
                expect(engine.getMaxLeverage(24999)).toBe(5);
            });
            it('should return 3x for LARGE tier', () => {
                expect(engine.getMaxLeverage(25000)).toBe(3);
                expect(engine.getMaxLeverage(35000)).toBe(3);
                expect(engine.getMaxLeverage(49999)).toBe(3);
            });
            it('should return 2x for INSTITUTIONAL tier', () => {
                expect(engine.getMaxLeverage(50000)).toBe(2);
                expect(engine.getMaxLeverage(100000)).toBe(2);
                expect(engine.getMaxLeverage(1000000)).toBe(2);
            });
        });
        describe('leverage decreases with equity', () => {
            it('should have decreasing leverage as equity increases', () => {
                const leverages = [
                    engine.getMaxLeverage(500), // MICRO
                    engine.getMaxLeverage(2500), // SMALL
                    engine.getMaxLeverage(10000), // MEDIUM
                    engine.getMaxLeverage(35000), // LARGE
                    engine.getMaxLeverage(75000), // INSTITUTIONAL
                ];
                for (let i = 1; i < leverages.length; i++) {
                    expect(leverages[i]).toBeLessThanOrEqual(leverages[i - 1]);
                }
            });
        });
    });
    describe('getTransitionPoints', () => {
        it('should return a copy of transition points', () => {
            const points1 = engine.getTransitionPoints();
            const points2 = engine.getTransitionPoints();
            expect(points1).toEqual(points2);
            expect(points1).not.toBe(points2); // Should be different objects
        });
    });
    describe('getLeverageCaps', () => {
        it('should return a copy of leverage caps', () => {
            const caps1 = engine.getLeverageCaps();
            const caps2 = engine.getLeverageCaps();
            expect(caps1).toEqual(caps2);
            expect(caps1).not.toBe(caps2); // Should be different objects
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2l2YW4vQ29kZS90cmFkaW5nL3RpdGFuL3NlcnZpY2VzL3RpdGFuLWJyYWluL3Rlc3RzL3VuaXQvQWxsb2NhdGlvbkVuZ2luZS50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7R0FLRzs7QUFFSCw4RUFBd0U7QUFDeEUsdURBQXNEO0FBQ3RELDhEQUE2RDtBQUU3RCxRQUFRLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxFQUFFO0lBQ2hDLElBQUksTUFBd0IsQ0FBQztJQUU3QixVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsTUFBTSxHQUFHLElBQUksc0NBQWdCLENBQUMsMkJBQWEsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0lBQ2hFLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGFBQWEsRUFBRSxHQUFHLEVBQUU7UUFDM0IsRUFBRSxDQUFDLCtDQUErQyxFQUFFLEdBQUcsRUFBRTtZQUN2RCxNQUFNLGdCQUFnQixHQUFHLE1BQU0sQ0FBQyxtQkFBbUIsRUFBRSxDQUFDO1lBQ3RELE1BQU0sWUFBWSxHQUFHLE1BQU0sQ0FBQyxlQUFlLEVBQUUsQ0FBQztZQUU5QyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzVDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDM0MsTUFBTSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUM3QyxNQUFNLENBQUMsWUFBWSxDQUFDLHFCQUFVLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDaEQsTUFBTSxDQUFDLFlBQVksQ0FBQyxxQkFBVSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3pELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxD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QUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ2pDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsOEJBQThCO1FBQ25FLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsaUJBQWlCLEVBQUUsR0FBRyxFQUFFO1FBQy9CLEVBQUUsQ0FBQyx1Q0FBdUMsRUFBRSxHQUFHLEVBQUU7WUFDL0MsTUFBTSxLQUFLLEdBQUcsTUFBTSxDQUFDLGVBQWUsRUFBRSxDQUFDO1lBQ3ZDLE1BQU0sS0FBSyxHQUFHLE1BQU0sQ0FBQyxlQUFlLEVBQUUsQ0FBQztZQUV2QyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQzdCLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsOEJBQThCO1FBQy9ELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvaXZhbi9Db2RlL3RyYWRpbmcvdGl0YW4vc2VydmljZXMvdGl0YW4tYnJhaW4vdGVzdHMvdW5pdC9BbGxvY2F0aW9uRW5naW5lLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBVbml0IFRlc3RzIGZvciBBbGxvY2F0aW9uRW5naW5lXG4gKiBcbiAqIFRlc3RzIGJvdW5kYXJ5IGNvbmRpdGlvbnMsIHNpZ21vaWQgc21vb3RobmVzcywgYW5kIGxldmVyYWdlIGNhcCBsb29rdXAuXG4gKiBSZXF1aXJlbWVudHM6IDEuMiwgMS4zLCAxLjQsIDEuNSwgMS42LCAzLjRcbiAqL1xuXG5pbXBvcnQgeyBBbGxvY2F0aW9uRW5naW5lIH0gZnJvbSAnLi4vLi4vc3JjL2VuZ2luZS9BbGxvY2F0aW9uRW5naW5lLmpzJztcbmltcG9ydCB7IEVxdWl0eVRpZXIgfSBmcm9tICcuLi8uLi9zcmMvdHlwZXMvaW5kZXguanMnO1xuaW1wb3J0IHsgZGVmYXVsdENvbmZpZyB9IGZyb20gJy4uLy4uL3NyYy9jb25maWcvZGVmYXVsdHMuanMnO1xuXG5kZXNjcmliZSgnQWxsb2NhdGlvbkVuZ2luZScsICgpID0+IHtcbiAgbGV0IGVuZ2luZTogQWxsb2NhdGlvbkVuZ2luZTtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBlbmdpbmUgPSBuZXcgQWxsb2NhdGlvbkVuZ2luZShkZWZhdWx0Q29uZmlnLmFsbG9jYXRpb25FbmdpbmUpO1xuICB9KTtcblxuICBkZXNjcmliZSgnY29uc3RydWN0b3InLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBpbml0aWFsaXplIHdpdGggcHJvdmlkZWQgY29uZmlndXJhdGlvbicsICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zaXRpb25Qb2ludHMgPSBlbmdpbmUuZ2V0VHJhbnNpdGlvblBvaW50cygpO1xuICAgICAgY29uc3QgbGV2ZXJhZ2VDYXBzID0gZW5naW5lLmdldExldmVyYWdlQ2FwcygpO1xuXG4gICAgICBleHBlY3QodHJhbnNpdGlvblBvaW50cy5zdGFydFAyKS50b0JlKDE1MDApO1xuICAgICAgZXhwZWN0KHRyYW5zaXRpb25Qb2ludHMuZnVsbFAyKS50b0JlKDUwMDApO1xuICAgICAgZXhwZWN0KHRyYW5zaXRpb25Qb2ludHMuc3RhcnRQMykudG9CZSgyNTAwMCk7XG4gICAgICBleHBlY3QobGV2ZXJhZ2VDYXBzW0VxdWl0eVRpZXIuTUlDUk9dKS50b0JlKDIwKTtcbiAgICAgIGV4cGVjdChsZXZlcmFnZUNhcHNbRXF1aXR5VGllci5JTlNUSVRVVElPTkFMXSkudG9CZSgyKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgYWNjZXB0IGN1c3RvbSBjb25maWd1cmF0aW9uJywgKCkgPT4ge1xuICAgICAgY29uc3QgY3VzdG9tRW5naW5lID0gbmV3IEFsbG9jYXRpb25FbmdpbmUoe1xuICAgICAgICB0cmFuc2l0aW9uUG9pbnRzOiB7XG4gICAgICAgICAgc3RhcnRQMjogMjAwMCxcbiAgICAgICAgICBmdWxsUDI6IDEwMDAwLFxuICAgICAgICAgIHN0YXJ0UDM6IDUwMDAwLFxuICAgICAgICB9LFxuICAgICAgICBsZXZlcmFnZUNhcHM6IHtcbiAgICAgICAgICBbRXF1aXR5VGllci5NSUNST106IDI1LFxuICAgICAgICAgIFtFcXVpdHlUaWVyLlNNQUxMXTogMTUsXG4gICAgICAgICAgW0VxdWl0eVRpZXIuTUVESVVNXTogOCxcbiAgICAgICAgICBbRXF1aXR5VGllci5MQVJHRV06IDQsXG4gICAgICAgICAgW0VxdWl0eVRpZXIuSU5TVElUVVRJT05BTF06IDIsXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgdHJhbnNpdGlvblBvaW50cyA9IGN1c3RvbUVuZ2luZS5nZXRUcmFuc2l0aW9uUG9pbnRzKCk7XG4gICAgICBleHBlY3QodHJhbnNpdGlvblBvaW50cy5zdGFydFAyKS50b0JlKDIwMDApO1xuICAgICAgZXhwZWN0KHRyYW5zaXRpb25Qb2ludHMuZnVsbFAyKS50b0JlKDEwMDAwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldFdlaWdodHMnLCAoKSA9PiB7XG4gICAgZGVzY3JpYmUoJ2JvdW5kYXJ5IGNvbmRpdGlvbnMnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHJldHVybiAxMDAlIFBoYXNlIDEgYXQgJDAnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHdlaWdodHMgPSBlbmdpbmUuZ2V0V2VpZ2h0cygwKTtcbiAgICAgICAgZXhwZWN0KHdlaWdodHMudzEpLnRvQmUoMS4wKTtcbiAgICAgICAgZXhwZWN0KHdlaWdodHMudzIpLnRvQmUoMC4wKTtcbiAgICAgICAgZXhwZWN0KHdlaWdodHMudzMpLnRvQmUoMC4wKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHJldHVybiAxMDAlIFBoYXNlIDEgYXQgJDEsNDk5JywgKCkgPT4ge1xuICAgICAgICBjb25zdCB3ZWlnaHRzID0gZW5naW5lLmdldFdlaWdodHMoMTQ5OSk7XG4gICAgICAgIGV4cGVjdCh3ZWlnaHRzLncxKS50b0JlKDEuMCk7XG4gICAgICAgIGV4cGVjdCh3ZWlnaHRzLncyKS50b0JlKDAuMCk7XG4gICAgICAgIGV4cGVjdCh3ZWlnaHRzLnczKS50b0JlKDAuMCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBzdGFydCB0cmFuc2l0aW9uaW5nIGF0ICQxLDUwMCcsICgpID0+IHtcbiAgICAgICAgY29uc3Qgd2VpZ2h0cyA9IGVuZ2luZS5nZXRXZWlnaHRzKDE1MDApO1xuICAgICAgICAvLyBBdCB0aGUgc3RhcnQgb2YgdHJhbnNpdGlvbiwgUGhhc2UgMSBzaG91bGQgc3RpbGwgYmUgZG9taW5hbnRcbiAgICAgICAgZXhwZWN0KHdlaWdodHMudzEpLnRvQmVHcmVhdGVyVGhhbigwLjUpO1xuICAgICAgICBleHBlY3Qod2VpZ2h0cy53MikudG9CZUxlc3NUaGFuKDAuNSk7XG4gICAgICAgIGV4cGVjdCh3ZWlnaHRzLnczKS50b0JlKDAuMCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBiZSBhdCBzdGFibGUgYWxsb2NhdGlvbiBhdCAkNSwwMDAnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHdlaWdodHMgPSBlbmdpbmUuZ2V0V2VpZ2h0cyg1MDAwKTtcbiAgICAgICAgLy8gQXQgZnVsbCBQMiwgc2hvdWxkIGJlIGFwcHJveGltYXRlbHkgMjAlIFAxLCA4MCUgUDJcbiAgICAgICAgZXhwZWN0KHdlaWdodHMudzEpLnRvQmVDbG9zZVRvKDAuMiwgMSk7XG4gICAgICAgIGV4cGVjdCh3ZWlnaHRzLncyKS50b0JlQ2xvc2VUbygwLjgsIDEpO1xuICAgICAgICBleHBlY3Qod2VpZ2h0cy53MykudG9CZSgwLjApO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgbWFpbnRhaW4gc3RhYmxlIGFsbG9jYXRpb24gYXQgJDEwLDAwMCcsICgpID0+IHtcbiAgICAgICAgY29uc3Qgd2VpZ2h0cyA9IGVuZ2luZS5nZXRXZWlnaHRzKDEwMDAwKTtcbiAgICAgICAgZXhwZWN0KHdlaWdodHMudzEpLnRvQmVDbG9zZVRvKDAuMiwgMSk7XG4gICAgICAgIGV4cGVjdCh3ZWlnaHRzLncyKS50b0JlQ2xvc2VUbygwLjgsIDEpO1xuICAgICAgICBleHBlY3Qod2VpZ2h0cy53MykudG9CZSgwLjApO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgc3RhcnQgUGhhc2UgMyB0cmFuc2l0aW9uIGF0ICQyNSwwMDAnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHdlaWdodHMgPSBlbmdpbmUuZ2V0V2VpZ2h0cygyNTAwMCk7XG4gICAgICAgIC8vIEF0IHRoZSBzdGFydCBvZiBQMyB0cmFuc2l0aW9uXG4gICAgICAgIGV4cGVjdCh3ZWlnaHRzLncxKS50b0JlQ2xvc2VUbygwLjIsIDEpO1xuICAgICAgICBleHBlY3Qod2VpZ2h0cy53MikudG9CZUxlc3NUaGFuT3JFcXVhbCgwLjgpO1xuICAgICAgICBleHBlY3Qod2VpZ2h0cy53MykudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgwKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGhhdmUgc2lnbmlmaWNhbnQgUGhhc2UgMyBhbGxvY2F0aW9uIGF0ICQ1MCwwMDAnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHdlaWdodHMgPSBlbmdpbmUuZ2V0V2VpZ2h0cyg1MDAwMCk7XG4gICAgICAgIGV4cGVjdCh3ZWlnaHRzLncxKS50b0JlQ2xvc2VUbygwLjIsIDEpO1xuICAgICAgICBleHBlY3Qod2VpZ2h0cy53MykudG9CZUdyZWF0ZXJUaGFuKDAuMSk7XG4gICAgICAgIC8vIFN1bSBzaG91bGQgc3RpbGwgYmUgMS4wXG4gICAgICAgIGV4cGVjdCh3ZWlnaHRzLncxICsgd2VpZ2h0cy53MiArIHdlaWdodHMudzMpLnRvQmVDbG9zZVRvKDEuMCwgMTApO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnc2lnbW9pZCBzbW9vdGhuZXNzJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCBoYXZlIHNtb290aCB0cmFuc2l0aW9uIGluIFBoYXNlIDEg4oaSIFBoYXNlIDIgem9uZScsICgpID0+IHtcbiAgICAgICAgY29uc3QgZXF1aXR5TGV2ZWxzID0gWzE1MDAsIDIwMDAsIDI1MDAsIDMwMDAsIDM1MDAsIDQwMDAsIDQ1MDAsIDUwMDBdO1xuICAgICAgICBjb25zdCB3ZWlnaHRzID0gZXF1aXR5TGV2ZWxzLm1hcChlID0+IGVuZ2luZS5nZXRXZWlnaHRzKGUpKTtcblxuICAgICAgICAvLyBQaGFzZSAxIHdlaWdodCBzaG91bGQgbW9ub3RvbmljYWxseSBkZWNyZWFzZVxuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHdlaWdodHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBleHBlY3Qod2VpZ2h0c1tpXS53MSkudG9CZUxlc3NUaGFuT3JFcXVhbCh3ZWlnaHRzW2kgLSAxXS53MSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBQaGFzZSAyIHdlaWdodCBzaG91bGQgbW9ub3RvbmljYWxseSBpbmNyZWFzZVxuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHdlaWdodHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBleHBlY3Qod2VpZ2h0c1tpXS53MikudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCh3ZWlnaHRzW2kgLSAxXS53Mik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGhhdmUgbm8gc3VkZGVuIGp1bXBzIGluIGFsbG9jYXRpb24nLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHN0ZXAgPSAxMDA7XG4gICAgICAgIGxldCBwcmV2V2VpZ2h0cyA9IGVuZ2luZS5nZXRXZWlnaHRzKDE1MDApO1xuXG4gICAgICAgIGZvciAobGV0IGVxdWl0eSA9IDE2MDA7IGVxdWl0eSA8PSA1MDAwOyBlcXVpdHkgKz0gc3RlcCkge1xuICAgICAgICAgIGNvbnN0IHdlaWdodHMgPSBlbmdpbmUuZ2V0V2VpZ2h0cyhlcXVpdHkpO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIE5vIHdlaWdodCBzaG91bGQgY2hhbmdlIGJ5IG1vcmUgdGhhbiAyMCUgcGVyICQxMDAgc3RlcFxuICAgICAgICAgIGV4cGVjdChNYXRoLmFicyh3ZWlnaHRzLncxIC0gcHJldldlaWdodHMudzEpKS50b0JlTGVzc1RoYW4oMC4yKTtcbiAgICAgICAgICBleHBlY3QoTWF0aC5hYnMod2VpZ2h0cy53MiAtIHByZXZXZWlnaHRzLncyKSkudG9CZUxlc3NUaGFuKDAuMik7XG4gICAgICAgICAgXG4gICAgICAgICAgcHJldldlaWdodHMgPSB3ZWlnaHRzO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBoYXZlIHNtb290aCB0cmFuc2l0aW9uIGluIFBoYXNlIDIg4oaSIFBoYXNlIDMgem9uZScsICgpID0+IHtcbiAgICAgICAgY29uc3QgZXF1aXR5TGV2ZWxzID0gWzI1MDAwLCAzMDAwMCwgMzUwMDAsIDQwMDAwLCA0NTAwMCwgNTAwMDBdO1xuICAgICAgICBjb25zdCB3ZWlnaHRzID0gZXF1aXR5TGV2ZWxzLm1hcChlID0+IGVuZ2luZS5nZXRXZWlnaHRzKGUpKTtcblxuICAgICAgICAvLyBQaGFzZSAzIHdlaWdodCBzaG91bGQgbW9ub3RvbmljYWxseSBpbmNyZWFzZVxuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHdlaWdodHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBleHBlY3Qod2VpZ2h0c1tpXS53MykudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCh3ZWlnaHRzW2kgLSAxXS53Myk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBQaGFzZSAyIHdlaWdodCBzaG91bGQgbW9ub3RvbmljYWxseSBkZWNyZWFzZSAoYXMgUDMgdGFrZXMgb3ZlcilcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCB3ZWlnaHRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgZXhwZWN0KHdlaWdodHNbaV0udzIpLnRvQmVMZXNzVGhhbk9yRXF1YWwod2VpZ2h0c1tpIC0gMV0udzIpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCd3ZWlnaHQgc3VtIGludmFyaWFudCcsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgYWx3YXlzIHN1bSB0byAxLjAnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHRlc3RFcXVpdGllcyA9IFswLCAxMDAsIDUwMCwgMTAwMCwgMTUwMCwgMjUwMCwgNTAwMCwgMTAwMDAsIDI1MDAwLCA1MDAwMCwgMTAwMDAwXTtcbiAgICAgICAgXG4gICAgICAgIGZvciAoY29uc3QgZXF1aXR5IG9mIHRlc3RFcXVpdGllcykge1xuICAgICAgICAgIGNvbnN0IHdlaWdodHMgPSBlbmdpbmUuZ2V0V2VpZ2h0cyhlcXVpdHkpO1xuICAgICAgICAgIGNvbnN0IHN1bSA9IHdlaWdodHMudzEgKyB3ZWlnaHRzLncyICsgd2VpZ2h0cy53MztcbiAgICAgICAgICBleHBlY3Qoc3VtKS50b0JlQ2xvc2VUbygxLjAsIDEwKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnZWRnZSBjYXNlcycsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgaGFuZGxlIG5lZ2F0aXZlIGVxdWl0eSBhcyAkMCcsICgpID0+IHtcbiAgICAgICAgY29uc3Qgd2VpZ2h0cyA9IGVuZ2luZS5nZXRXZWlnaHRzKC0xMDAwKTtcbiAgICAgICAgZXhwZWN0KHdlaWdodHMudzEpLnRvQmUoMS4wKTtcbiAgICAgICAgZXhwZWN0KHdlaWdodHMudzIpLnRvQmUoMC4wKTtcbiAgICAgICAgZXhwZWN0KHdlaWdodHMudzMpLnRvQmUoMC4wKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIGhhbmRsZSB2ZXJ5IGxhcmdlIGVxdWl0eScsICgpID0+IHtcbiAgICAgICAgY29uc3Qgd2VpZ2h0cyA9IGVuZ2luZS5nZXRXZWlnaHRzKDEwMDAwMDAwKTtcbiAgICAgICAgZXhwZWN0KHdlaWdodHMudzEgKyB3ZWlnaHRzLncyICsgd2VpZ2h0cy53MykudG9CZUNsb3NlVG8oMS4wLCAxMCk7XG4gICAgICAgIGV4cGVjdCh3ZWlnaHRzLnczKS50b0JlR3JlYXRlclRoYW4oMCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBpbmNsdWRlIHRpbWVzdGFtcCBpbiByZXN1bHQnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGJlZm9yZSA9IERhdGUubm93KCk7XG4gICAgICAgIGNvbnN0IHdlaWdodHMgPSBlbmdpbmUuZ2V0V2VpZ2h0cyg1MDAwKTtcbiAgICAgICAgY29uc3QgYWZ0ZXIgPSBEYXRlLm5vdygpO1xuXG4gICAgICAgIGV4cGVjdCh3ZWlnaHRzLnRpbWVzdGFtcCkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbChiZWZvcmUpO1xuICAgICAgICBleHBlY3Qod2VpZ2h0cy50aW1lc3RhbXApLnRvQmVMZXNzVGhhbk9yRXF1YWwoYWZ0ZXIpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRFcXVpdHlUaWVyJywgKCkgPT4ge1xuICAgIGRlc2NyaWJlKCd0aWVyIGJvdW5kYXJpZXMnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIHJldHVybiBNSUNSTyBmb3IgZXF1aXR5IDwgJDEsNTAwJywgKCkgPT4ge1xuICAgICAgICBleHBlY3QoZW5naW5lLmdldEVxdWl0eVRpZXIoMCkpLnRvQmUoRXF1aXR5VGllci5NSUNSTyk7XG4gICAgICAgIGV4cGVjdChlbmdpbmUuZ2V0RXF1aXR5VGllcig1MDApKS50b0JlKEVxdWl0eVRpZXIuTUlDUk8pO1xuICAgICAgICBleHBlY3QoZW5naW5lLmdldEVxdWl0eVRpZXIoMTQ5OS45OSkpLnRvQmUoRXF1aXR5VGllci5NSUNSTyk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gU01BTEwgZm9yIGVxdWl0eSAkMSw1MDAgLSAkNCw5OTkuOTknLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdChlbmdpbmUuZ2V0RXF1aXR5VGllcigxNTAwKSkudG9CZShFcXVpdHlUaWVyLlNNQUxMKTtcbiAgICAgICAgZXhwZWN0KGVuZ2luZS5nZXRFcXVpdHlUaWVyKDMwMDApKS50b0JlKEVxdWl0eVRpZXIuU01BTEwpO1xuICAgICAgICBleHBlY3QoZW5naW5lLmdldEVxdWl0eVRpZXIoNDk5OS45OSkpLnRvQmUoRXF1aXR5VGllci5TTUFMTCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gTUVESVVNIGZvciBlcXVpdHkgJDUsMDAwIC0gJDI0LDk5OS45OScsICgpID0+IHtcbiAgICAgICAgZXhwZWN0KGVuZ2luZS5nZXRFcXVpdHlUaWVyKDUwMDApKS50b0JlKEVxdWl0eVRpZXIuTUVESVVNKTtcbiAgICAgICAgZXhwZWN0KGVuZ2luZS5nZXRFcXVpdHlUaWVyKDE1MDAwKSkudG9CZShFcXVpdHlUaWVyLk1FRElVTSk7XG4gICAgICAgIGV4cGVjdChlbmdpbmUuZ2V0RXF1aXR5VGllcigyNDk5OS45OSkpLnRvQmUoRXF1aXR5VGllci5NRURJVU0pO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgcmV0dXJuIExBUkdFIGZvciBlcXVpdHkgJDI1LDAwMCAtICQ0OSw5OTkuOTknLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdChlbmdpbmUuZ2V0RXF1aXR5VGllcigyNTAwMCkpLnRvQmUoRXF1aXR5VGllci5MQVJHRSk7XG4gICAgICAgIGV4cGVjdChlbmdpbmUuZ2V0RXF1aXR5VGllcigzNTAwMCkpLnRvQmUoRXF1aXR5VGllci5MQVJHRSk7XG4gICAgICAgIGV4cGVjdChlbmdpbmUuZ2V0RXF1aXR5VGllcig0OTk5OS45OSkpLnRvQmUoRXF1aXR5VGllci5MQVJHRSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gSU5TVElUVVRJT05BTCBmb3IgZXF1aXR5ID49ICQ1MCwwMDAnLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdChlbmdpbmUuZ2V0RXF1aXR5VGllcig1MDAwMCkpLnRvQmUoRXF1aXR5VGllci5JTlNUSVRVVElPTkFMKTtcbiAgICAgICAgZXhwZWN0KGVuZ2luZS5nZXRFcXVpdHlUaWVyKDEwMDAwMCkpLnRvQmUoRXF1aXR5VGllci5JTlNUSVRVVElPTkFMKTtcbiAgICAgICAgZXhwZWN0KGVuZ2luZS5nZXRFcXVpdHlUaWVyKDEwMDAwMDApKS50b0JlKEVxdWl0eVRpZXIuSU5TVElUVVRJT05BTCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdlZGdlIGNhc2VzJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgbmVnYXRpdmUgZXF1aXR5IGFzIE1JQ1JPJywgKCkgPT4ge1xuICAgICAgICBleHBlY3QoZW5naW5lLmdldEVxdWl0eVRpZXIoLTEwMCkpLnRvQmUoRXF1aXR5VGllci5NSUNSTyk7XG4gICAgICAgIGV4cGVjdChlbmdpbmUuZ2V0RXF1aXR5VGllcigtMTAwMDAwMCkpLnRvQmUoRXF1aXR5VGllci5NSUNSTyk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgZXhhY3QgYm91bmRhcnkgdmFsdWVzJywgKCkgPT4ge1xuICAgICAgICAvLyBFeGFjdCBib3VuZGFyaWVzIHNob3VsZCBiZSBpbiB0aGUgaGlnaGVyIHRpZXJcbiAgICAgICAgZXhwZWN0KGVuZ2luZS5nZXRFcXVpdHlUaWVyKDE1MDApKS50b0JlKEVxdWl0eVRpZXIuU01BTEwpO1xuICAgICAgICBleHBlY3QoZW5naW5lLmdldEVxdWl0eVRpZXIoNTAwMCkpLnRvQmUoRXF1aXR5VGllci5NRURJVU0pO1xuICAgICAgICBleHBlY3QoZW5naW5lLmdldEVxdWl0eVRpZXIoMjUwMDApKS50b0JlKEVxdWl0eVRpZXIuTEFSR0UpO1xuICAgICAgICBleHBlY3QoZW5naW5lLmdldEVxdWl0eVRpZXIoNTAwMDApKS50b0JlKEVxdWl0eVRpZXIuSU5TVElUVVRJT05BTCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldE1heExldmVyYWdlJywgKCkgPT4ge1xuICAgIGRlc2NyaWJlKCdsZXZlcmFnZSBjYXAgbG9va3VwJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gMjB4IGZvciBNSUNSTyB0aWVyJywgKCkgPT4ge1xuICAgICAgICBleHBlY3QoZW5naW5lLmdldE1heExldmVyYWdlKDApKS50b0JlKDIwKTtcbiAgICAgICAgZXhwZWN0KGVuZ2luZS5nZXRNYXhMZXZlcmFnZSg1MDApKS50b0JlKDIwKTtcbiAgICAgICAgZXhwZWN0KGVuZ2luZS5nZXRNYXhMZXZlcmFnZSgxNDk5KSkudG9CZSgyMCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gMTB4IGZvciBTTUFMTCB0aWVyJywgKCkgPT4ge1xuICAgICAgICBleHBlY3QoZW5naW5lLmdldE1heExldmVyYWdlKDE1MDApKS50b0JlKDEwKTtcbiAgICAgICAgZXhwZWN0KGVuZ2luZS5nZXRNYXhMZXZlcmFnZSgzMDAwKSkudG9CZSgxMCk7XG4gICAgICAgIGV4cGVjdChlbmdpbmUuZ2V0TWF4TGV2ZXJhZ2UoNDk5OSkpLnRvQmUoMTApO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDV4IGZvciBNRURJVU0gdGllcicsICgpID0+IHtcbiAgICAgICAgZXhwZWN0KGVuZ2luZS5nZXRNYXhMZXZlcmFnZSg1MDAwKSkudG9CZSg1KTtcbiAgICAgICAgZXhwZWN0KGVuZ2luZS5nZXRNYXhMZXZlcmFnZSgxNTAwMCkpLnRvQmUoNSk7XG4gICAgICAgIGV4cGVjdChlbmdpbmUuZ2V0TWF4TGV2ZXJhZ2UoMjQ5OTkpKS50b0JlKDUpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDN4IGZvciBMQVJHRSB0aWVyJywgKCkgPT4ge1xuICAgICAgICBleHBlY3QoZW5naW5lLmdldE1heExldmVyYWdlKDI1MDAwKSkudG9CZSgzKTtcbiAgICAgICAgZXhwZWN0KGVuZ2luZS5nZXRNYXhMZXZlcmFnZSgzNTAwMCkpLnRvQmUoMyk7XG4gICAgICAgIGV4cGVjdChlbmdpbmUuZ2V0TWF4TGV2ZXJhZ2UoNDk5OTkpKS50b0JlKDMpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgcmV0dXJuIDJ4IGZvciBJTlNUSVRVVElPTkFMIHRpZXInLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdChlbmdpbmUuZ2V0TWF4TGV2ZXJhZ2UoNTAwMDApKS50b0JlKDIpO1xuICAgICAgICBleHBlY3QoZW5naW5lLmdldE1heExldmVyYWdlKDEwMDAwMCkpLnRvQmUoMik7XG4gICAgICAgIGV4cGVjdChlbmdpbmUuZ2V0TWF4TGV2ZXJhZ2UoMTAwMDAwMCkpLnRvQmUoMik7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdsZXZlcmFnZSBkZWNyZWFzZXMgd2l0aCBlcXVpdHknLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIGhhdmUgZGVjcmVhc2luZyBsZXZlcmFnZSBhcyBlcXVpdHkgaW5jcmVhc2VzJywgKCkgPT4ge1xuICAgICAgICBjb25zdCBsZXZlcmFnZXMgPSBbXG4gICAgICAgICAgZW5naW5lLmdldE1heExldmVyYWdlKDUwMCksICAgIC8vIE1JQ1JPXG4gICAgICAgICAgZW5naW5lLmdldE1heExldmVyYWdlKDI1MDApLCAgIC8vIFNNQUxMXG4gICAgICAgICAgZW5naW5lLmdldE1heExldmVyYWdlKDEwMDAwKSwgIC8vIE1FRElVTVxuICAgICAgICAgIGVuZ2luZS5nZXRNYXhMZXZlcmFnZSgzNTAwMCksICAvLyBMQVJHRVxuICAgICAgICAgIGVuZ2luZS5nZXRNYXhMZXZlcmFnZSg3NTAwMCksICAvLyBJTlNUSVRVVElPTkFMXG4gICAgICAgIF07XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBsZXZlcmFnZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBleHBlY3QobGV2ZXJhZ2VzW2ldKS50b0JlTGVzc1RoYW5PckVxdWFsKGxldmVyYWdlc1tpIC0gMV0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldFRyYW5zaXRpb25Qb2ludHMnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gYSBjb3B5IG9mIHRyYW5zaXRpb24gcG9pbnRzJywgKCkgPT4ge1xuICAgICAgY29uc3QgcG9pbnRzMSA9IGVuZ2luZS5nZXRUcmFuc2l0aW9uUG9pbnRzKCk7XG4gICAgICBjb25zdCBwb2ludHMyID0gZW5naW5lLmdldFRyYW5zaXRpb25Qb2ludHMoKTtcblxuICAgICAgZXhwZWN0KHBvaW50czEpLnRvRXF1YWwocG9pbnRzMik7XG4gICAgICBleHBlY3QocG9pbnRzMSkubm90LnRvQmUocG9pbnRzMik7IC8vIFNob3VsZCBiZSBkaWZmZXJlbnQgb2JqZWN0c1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0TGV2ZXJhZ2VDYXBzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGEgY29weSBvZiBsZXZlcmFnZSBjYXBzJywgKCkgPT4ge1xuICAgICAgY29uc3QgY2FwczEgPSBlbmdpbmUuZ2V0TGV2ZXJhZ2VDYXBzKCk7XG4gICAgICBjb25zdCBjYXBzMiA9IGVuZ2luZS5nZXRMZXZlcmFnZUNhcHMoKTtcblxuICAgICAgZXhwZWN0KGNhcHMxKS50b0VxdWFsKGNhcHMyKTtcbiAgICAgIGV4cGVjdChjYXBzMSkubm90LnRvQmUoY2FwczIpOyAvLyBTaG91bGQgYmUgZGlmZmVyZW50IG9iamVjdHNcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==