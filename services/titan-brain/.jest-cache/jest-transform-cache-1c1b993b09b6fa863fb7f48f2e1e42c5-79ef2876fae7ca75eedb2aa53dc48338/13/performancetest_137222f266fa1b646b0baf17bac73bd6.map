{"file":"/Users/ivan/Code/trading/titan/services/titan-brain/tests/performance/performance.test.ts","mappings":"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","names":[],"sources":["/Users/ivan/Code/trading/titan/services/titan-brain/tests/performance/performance.test.ts"],"sourcesContent":["/**\n * Performance validation tests for Titan Brain\n * \n * Tests performance requirements under load:\n * - Cache operations performance\n * - Memory usage stability\n * - No memory leaks detected\n */\n\nimport { performance } from 'perf_hooks';\nimport { CacheManager } from '../../src/cache/CacheManager.js';\n\ndescribe('Performance Validation Tests', () => {\n  describe('Cache Performance', () => {\n    let cacheManager: CacheManager;\n\n    beforeAll(async () => {\n      cacheManager = new CacheManager({\n        redis: {\n          host: 'localhost',\n          port: 6379\n        },\n        enableInMemoryFallback: true,\n        inMemoryMaxSize: 1000,\n        inMemoryTtlMs: 300000, // 5 minutes\n        healthCheckIntervalMs: 30000,\n        healthCheckTimeoutMs: 5000,\n        maxReconnectAttempts: 3,\n        reconnectDelayMs: 1000\n      });\n\n      await cacheManager.initialize();\n    });\n\n    afterAll(async () => {\n      if (cacheManager) {\n        await cacheManager.shutdown();\n      }\n    });\n\n    it('should handle high-frequency cache operations', async () => {\n      const operations = 1000;\n      const start = performance.now();\n\n      // Perform mixed cache operations\n      for (let i = 0; i < operations; i++) {\n        const key = `test-key-${i % 100}`; // Reuse keys to test overwrites\n        const value = { data: `test-value-${i}`, timestamp: Date.now() };\n        \n        await cacheManager.set(key, value, 60000); // 1 minute TTL\n        \n        if (i % 10 === 0) {\n          await cacheManager.get(key);\n        }\n      }\n\n      const end = performance.now();\n      const totalTime = end - start;\n      const avgOperationTime = totalTime / operations;\n\n      console.log(`Cache performance:\n        Total time for ${operations} operations: ${totalTime.toFixed(2)}ms\n        Average operation time: ${avgOperationTime.toFixed(3)}ms`);\n\n      expect(avgOperationTime).toBeLessThan(5); // < 5ms per operation (more realistic)\n      expect(totalTime).toBeLessThan(10000); // Total < 10 seconds\n    }, 15000);\n\n    it('should handle concurrent cache operations', async () => {\n      const concurrentOps = 50;\n      const promises: Promise<number>[] = [];\n\n      for (let i = 0; i < concurrentOps; i++) {\n        promises.push(\n          (async () => {\n            const start = performance.now();\n            try {\n              const key = `concurrent-key-${i}`;\n              const value = { id: i, data: `concurrent-data-${i}` };\n              \n              await cacheManager.set(key, value, 30000);\n              const retrieved = await cacheManager.get(key);\n              \n              const end = performance.now();\n              \n              expect(retrieved).toBeDefined();\n              return end - start;\n            } catch (error) {\n              console.warn(`Concurrent cache operation ${i + 1} failed:`, error);\n              return 1000; // Return high time for failed operations\n            }\n          })()\n        );\n      }\n\n      const operationTimes = await Promise.all(promises);\n      const successfulOps = operationTimes.filter(time => time < 1000);\n      \n      // At least 90% of operations should succeed\n      expect(successfulOps.length).toBeGreaterThanOrEqual(concurrentOps * 0.9);\n      \n      // Average time should be reasonable under concurrent load\n      const avgOpTime = successfulOps.reduce((a, b) => a + b, 0) / successfulOps.length;\n      expect(avgOpTime).toBeLessThan(100); // < 100ms under concurrent load\n    }, 15000);\n  });\n\n  describe('Memory Usage', () => {\n    it('should maintain stable memory usage', async () => {\n      const initialMemory = process.memoryUsage();\n      const memorySnapshots: NodeJS.MemoryUsage[] = [initialMemory];\n\n      // Perform memory-intensive operations\n      for (let i = 0; i < 100; i++) {\n        // Create and discard objects to test garbage collection\n        const largeArray = new Array(10000).fill(0).map((_, idx) => ({\n          id: idx,\n          data: `test-data-${idx}`,\n          timestamp: Date.now()\n        }));\n        \n        // Force some async operations\n        await new Promise(resolve => setTimeout(resolve, 10));\n        \n        // Take memory snapshot every 20 iterations\n        if (i % 20 === 0) {\n          // Force garbage collection if available\n          if (global.gc) {\n            global.gc();\n          }\n          memorySnapshots.push(process.memoryUsage());\n        }\n      }\n\n      const finalMemory = process.memoryUsage();\n      const memoryGrowth = finalMemory.heapUsed - initialMemory.heapUsed;\n      const memoryGrowthMB = memoryGrowth / (1024 * 1024);\n\n      console.log(`Memory usage:\n        Initial heap: ${(initialMemory.heapUsed / 1024 / 1024).toFixed(2)} MB\n        Final heap: ${(finalMemory.heapUsed / 1024 / 1024).toFixed(2)} MB\n        Growth: ${memoryGrowthMB.toFixed(2)} MB`);\n\n      // Memory growth should be reasonable (< 50MB for this test)\n      expect(memoryGrowthMB).toBeLessThan(50);\n      \n      // Heap usage should not exceed 200MB\n      expect(finalMemory.heapUsed / 1024 / 1024).toBeLessThan(200);\n    }, 15000);\n\n    it('should not have significant memory leaks', async () => {\n      const iterations = 50;\n      const memoryReadings: number[] = [];\n\n      for (let i = 0; i < iterations; i++) {\n        // Create temporary objects\n        const tempData = new Array(1000).fill(0).map((_, idx) => ({\n          id: `temp-${i}-${idx}`,\n          data: new Array(100).fill(`data-${i}-${idx}`),\n          timestamp: Date.now()\n        }));\n\n        // Use the data briefly\n        const processed = tempData.filter(item => item.id.includes('temp'));\n        expect(processed.length).toBe(1000);\n\n        // Clear references\n        tempData.length = 0;\n\n        // Force garbage collection every 10 iterations\n        if (i % 10 === 0 && global.gc) {\n          global.gc();\n          memoryReadings.push(process.memoryUsage().heapUsed);\n        }\n\n        await new Promise(resolve => setTimeout(resolve, 5));\n      }\n\n      // Check that memory usage doesn't continuously grow\n      if (memoryReadings.length >= 3) {\n        const firstReading = memoryReadings[0];\n        const lastReading = memoryReadings[memoryReadings.length - 1];\n        const memoryGrowth = (lastReading - firstReading) / (1024 * 1024);\n\n        console.log(`Memory leak test:\n          First reading: ${(firstReading / 1024 / 1024).toFixed(2)} MB\n          Last reading: ${(lastReading / 1024 / 1024).toFixed(2)} MB\n          Growth: ${memoryGrowth.toFixed(2)} MB`);\n\n        // Memory growth should be minimal (< 20MB)\n        expect(memoryGrowth).toBeLessThan(20);\n      }\n    }, 20000);\n  });\n\n  describe('CPU Performance', () => {\n    it('should handle CPU-intensive operations efficiently', async () => {\n      const iterations = 1000;\n      const start = performance.now();\n\n      // Simulate CPU-intensive calculations\n      let result = 0;\n      for (let i = 0; i < iterations; i++) {\n        // Mathematical operations\n        result += Math.sqrt(i) * Math.sin(i) * Math.cos(i);\n        \n        // String operations\n        const str = `test-string-${i}`;\n        const processed = str.split('-').map(s => s.toUpperCase()).join('_');\n        \n        // Object operations\n        const obj = { id: i, value: processed, timestamp: Date.now() };\n        const serialized = JSON.stringify(obj);\n        const deserialized = JSON.parse(serialized);\n        \n        expect(deserialized.id).toBe(i);\n      }\n\n      const end = performance.now();\n      const totalTime = end - start;\n      const avgOperationTime = totalTime / iterations;\n\n      console.log(`CPU performance:\n        Total time for ${iterations} operations: ${totalTime.toFixed(2)}ms\n        Average operation time: ${avgOperationTime.toFixed(3)}ms\n        Result: ${result.toFixed(2)}`);\n\n      expect(avgOperationTime).toBeLessThan(1); // < 1ms per operation\n      expect(totalTime).toBeLessThan(2000); // Total < 2 seconds\n    }, 10000);\n  });\n});"],"version":3}