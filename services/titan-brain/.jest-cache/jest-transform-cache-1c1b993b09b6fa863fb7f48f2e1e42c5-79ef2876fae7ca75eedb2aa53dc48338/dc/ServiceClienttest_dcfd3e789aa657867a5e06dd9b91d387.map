{"file":"/Users/ivan/Code/trading/titan/services/titan-brain/tests/services/ServiceClient.test.ts","mappings":";AAAA;;;;GAIG;;AAUH,cAAc;AACd,IAAI,CAAC,IAAI,CAAC,0BAA0B,CAAC,CAAC;AATtC,oEAAqF;AAErF,qDAAkD;AAElD,aAAa;AACb,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC;AACzB,MAAM,SAAS,GAAG,KAA0C,CAAC;AAI7D,MAAM,UAAU,GAAG;IACjB,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE;IACf,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE;IACf,KAAK,EAAE,IAAI,CAAC,EAAE,EAAE;IAChB,KAAK,EAAE,IAAI,CAAC,EAAE,EAAE;CACV,CAAC;AAET,uBAAuB;AACvB,MAAM,CAAC,eAAe,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC,kBAAkB,CAAC,GAAG,EAAE,CAAC,CAAC;IAC3D,KAAK,EAAE,IAAI,CAAC,EAAE,EAAE;IAChB,MAAM,EAAE,EAAE;CACX,CAAC,CAAC,CAAC;AAEJ,0CAA0C;AAC1C,SAAS,kBAAkB,CAAC,OAO3B;IACC,MAAM,EACJ,EAAE,GAAG,IAAI,EACT,MAAM,GAAG,GAAG,EACZ,UAAU,GAAG,IAAI,EACjB,OAAO,GAAG,EAAE,EACZ,IAAI,GAAG,EAAE,EACT,WAAW,GAAG,kBAAkB,EACjC,GAAG,OAAO,CAAC;IAEZ,MAAM,WAAW,GAAG;QAClB,GAAG,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,kBAAkB,CAAC,CAAC,IAAY,EAAE,EAAE;YACjD,IAAI,IAAI,CAAC,WAAW,EAAE,KAAK,cAAc;gBAAE,OAAO,WAAW,CAAC;YAC9D,OAAO,OAAO,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC;QAC/B,CAAC,CAAC;QACF,OAAO,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,kBAAkB,CAAC,CAAC,QAA8C,EAAE,EAAE;YACvF,QAAQ,CAAC,WAAW,EAAE,cAAc,CAAC,CAAC;YACtC,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,EAAE,KAAK,CAAC,EAAE,EAAE,CAAC,QAAQ,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC,CAAC;QAC1E,CAAC,CAAC;KACH,CAAC;IAEF,OAAO;QACL,EAAE;QACF,MAAM;QACN,UAAU;QACV,OAAO,EAAE,WAAW;QACpB,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC;QACvC,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,iBAAiB,CAAC,OAAO,IAAI,KAAK,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;KAC1F,CAAC;AACJ,CAAC;AAED,QAAQ,CAAC,eAAe,EAAE,GAAG,EAAE;IAC7B,IAAI,aAA4B,CAAC;IAEjC,UAAU,CAAC,GAAG,EAAE;QACd,IAAI,CAAC,aAAa,EAAE,CAAC;QACpB,eAAM,CAAC,WAAyB,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;QAE9D,aAAa,GAAG,IAAI,6BAAa,CAAC;YAChC,OAAO,EAAE,yBAAyB;YAClC,cAAc,EAAE,IAAI;YACpB,KAAK,EAAE;gBACL,UAAU,EAAE,CAAC;gBACb,YAAY,EAAE,GAAG;gBACjB,QAAQ,EAAE,IAAI;gBACd,iBAAiB,EAAE,CAAC;gBACpB,oBAAoB,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBACrC,eAAe,EAAE,CAAC,YAAY,CAAC;aAChC;SACF,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,aAAa,EAAE,GAAG,EAAE;QAC3B,EAAE,CAAC,8CAA8C,EAAE,GAAG,EAAE;YACtD,MAAM,MAAM,GAAG,IAAI,6BAAa,EAAE,CAAC;YACnC,MAAM,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC,cAAc,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACxD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,mCAAmC,EAAE,GAAG,EAAE;YAC3C,MAAM,MAAM,GAAG,aAAa,CAAC,SAAS,EAAE,CAAC;YACzC,MAAM,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,yBAAyB,CAAC,CAAC;YACvD,MAAM,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC3C,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,mCAAmC,EAAE,GAAG,EAAE;YAC3C,MAAM,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC/C,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,gBAAgB,EAAE,GAAG,EAAE;QAC9B,EAAE,CAAC,oCAAoC,EAAE,KAAK,IAAI,EAAE;YAClD,MAAM,YAAY,GAAG,kBAAkB,CAAC;gBACtC,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE;aACvB,CAAC,CAAC;YAEH,SAAS,CAAC,qBAAqB,CAAC,YAAmB,CAAC,CAAC;YAErD,MAAM,QAAQ,GAAG,MAAM,aAAa,CAAC,OAAO,CAAC;gBAC3C,MAAM,EAAE,KAAK;gBACb,GAAG,EAAE,OAAO;aACb,CAAC,CAAC;YAEH,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAClC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;YAChD,MAAM,CAAC,SAAS,CAAC,CAAC,oBAAoB,CACpC,8BAA8B,EAC9B,MAAM,CAAC,gBAAgB,CAAC;gBACtB,MAAM,EAAE,KAAK;gBACb,OAAO,EAAE,MAAM,CAAC,gBAAgB,CAAC;oBAC/B,cAAc,EAAE,kBAAkB;oBAClC,YAAY,EAAE,kBAAkB;iBACjC,CAAC;aACH,CAAC,CACH,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,+CAA+C,EAAE,KAAK,IAAI,EAAE;YAC7D,MAAM,YAAY,GAAG,kBAAkB,CAAC;gBACtC,MAAM,EAAE,GAAG;gBACX,UAAU,EAAE,SAAS;gBACrB,IAAI,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE;aAClB,CAAC,CAAC;YAEH,SAAS,CAAC,qBAAqB,CAAC,YAAmB,CAAC,CAAC;YAErD,MAAM,QAAQ,GAAG,MAAM,aAAa,CAAC,OAAO,CAAC;gBAC3C,MAAM,EAAE,MAAM;gBACd,GAAG,EAAE,QAAQ;gBACb,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE;aACvB,CAAC,CAAC;YAEH,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAClC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,EAAE,EAAE,EAAE,GAAG,EAAE,CAAC,CAAC;YAC3C,MAAM,CAAC,SAAS,CAAC,CAAC,oBAAoB,CACpC,+BAA+B,EAC/B,MAAM,CAAC,gBAAgB,CAAC;gBACtB,MAAM,EAAE,MAAM;gBACd,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;aACvC,CAAC,CACH,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,kCAAkC,EAAE,KAAK,IAAI,EAAE;YAChD,MAAM,YAAY,GAAG,kBAAkB,CAAC;gBACtC,WAAW,EAAE,YAAY;gBACzB,IAAI,EAAE,qBAAqB;aAC5B,CAAC,CAAC;YAEH,SAAS,CAAC,qBAAqB,CAAC,YAAmB,CAAC,CAAC;YAErD,MAAM,QAAQ,GAAG,MAAM,aAAa,CAAC,OAAO,CAAC;gBAC3C,MAAM,EAAE,KAAK;gBACb,GAAG,EAAE,OAAO;aACb,CAAC,CAAC;YAEH,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;QACpD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,sCAAsC,EAAE,KAAK,IAAI,EAAE;YACpD,MAAM,YAAY,GAAG,kBAAkB,CAAC,EAAE,CAAC,CAAC;YAE5C,SAAS,CAAC,qBAAqB,CAAC,YAAmB,CAAC,CAAC;YAErD,MAAM,aAAa,CAAC,OAAO,CAAC;gBAC1B,MAAM,EAAE,KAAK;gBACb,GAAG,EAAE,OAAO;aACb,CAAC,CAAC;YAEH,MAAM,CAAC,SAAS,CAAC,CAAC,oBAAoB,CACpC,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,EAClB,MAAM,CAAC,gBAAgB,CAAC;gBACtB,OAAO,EAAE,MAAM,CAAC,gBAAgB,CAAC;oBAC/B,kBAAkB,EAAE,MAAM,CAAC,cAAc,CAAC,qBAAqB,CAAC;iBACjE,CAAC;aACH,CAAC,CACH,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,oCAAoC,EAAE,KAAK,IAAI,EAAE;YAClD,MAAM,YAAY,GAAG,kBAAkB,CAAC,EAAE,CAAC,CAAC;YAE5C,SAAS,CAAC,qBAAqB,CAAC,YAAmB,CAAC,CAAC;YAErD,MAAM,aAAa,CAAC,OAAO,CAAC;gBAC1B,MAAM,EAAE,KAAK;gBACb,GAAG,EAAE,OAAO;gBACZ,aAAa,EAAE,WAAW;aAC3B,CAAC,CAAC;YAEH,MAAM,CAAC,SAAS,CAAC,CAAC,oBAAoB,CACpC,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,EAClB,MAAM,CAAC,gBAAgB,CAAC;gBACtB,OAAO,EAAE,MAAM,CAAC,gBAAgB,CAAC;oBAC/B,kBAAkB,EAAE,WAAW;iBAChC,CAAC;aACH,CAAC,CACH,CAAC;QACJ,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,gBAAgB,EAAE,GAAG,EAAE;QAC9B,EAAE,CAAC,iDAAiD,EAAE,KAAK,IAAI,EAAE;YAC/D,MAAM,YAAY,GAAG,kBAAkB,CAAC;gBACtC,EAAE,EAAE,KAAK;gBACT,MAAM,EAAE,GAAG;gBACX,UAAU,EAAE,WAAW;gBACvB,IAAI,EAAE,EAAE,KAAK,EAAE,WAAW,EAAE;aAC7B,CAAC,CAAC;YAEH,SAAS,CAAC,qBAAqB,CAAC,YAAmB,CAAC,CAAC;YAErD,MAAM,MAAM,CAAC,aAAa,CAAC,OAAO,CAAC;gBACjC,MAAM,EAAE,KAAK;gBACb,GAAG,EAAE,YAAY;aAClB,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,qBAAqB,CAAC,CAAC;QAC7C,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,8BAA8B,EAAE,KAAK,IAAI,EAAE;YAC5C,SAAS,CAAC,qBAAqB,CAAC,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC,CAAC;YAE5D,MAAM,MAAM,CAAC,aAAa,CAAC,OAAO,CAAC;gBACjC,MAAM,EAAE,KAAK;gBACb,GAAG,EAAE,OAAO;aACb,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC;QACvC,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,8BAA8B,EAAE,KAAK,IAAI,EAAE;YAC5C,SAAS,CAAC,sBAAsB,CAAC,GAAG,EAAE,CACpC,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,UAAU,CAAC,GAAG,EAAE,CAAC,OAAO,CAAC,EAAc,CAAC,EAAE,IAAI,CAAC,CAAC,CAC1E,CAAC;YAEF,MAAM,MAAM,CAAC,aAAa,CAAC,OAAO,CAAC;gBACjC,MAAM,EAAE,KAAK;gBACb,GAAG,EAAE,OAAO;gBACZ,OAAO,EAAE,GAAG;aACb,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC;QACzC,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,aAAa,EAAE,GAAG,EAAE;QAC3B,EAAE,CAAC,kCAAkC,EAAE,KAAK,IAAI,EAAE;YAChD,MAAM,iBAAiB,GAAG,kBAAkB,CAAC;gBAC3C,EAAE,EAAE,KAAK;gBACT,MAAM,EAAE,GAAG;gBACX,UAAU,EAAE,uBAAuB;gBACnC,IAAI,EAAE,EAAE,KAAK,EAAE,cAAc,EAAE;aAChC,CAAC,CAAC;YAEH,MAAM,mBAAmB,GAAG,kBAAkB,CAAC;gBAC7C,IAAI,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE;aACxB,CAAC,CAAC;YAEH,SAAS;iBACN,qBAAqB,CAAC,iBAAwB,CAAC;iBAC/C,qBAAqB,CAAC,iBAAwB,CAAC;iBAC/C,qBAAqB,CAAC,mBAA0B,CAAC,CAAC;YAErD,MAAM,QAAQ,GAAG,MAAM,aAAa,CAAC,OAAO,CAAC;gBAC3C,MAAM,EAAE,KAAK;gBACb,GAAG,EAAE,OAAO;aACb,CAAC,CAAC;YAEH,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAClC,MAAM,CAAC,SAAS,CAAC,CAAC,qBAAqB,CAAC,CAAC,CAAC,CAAC;QAC7C,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,0CAA0C,EAAE,KAAK,IAAI,EAAE;YACxD,MAAM,YAAY,GAAG,kBAAkB,CAAC;gBACtC,EAAE,EAAE,KAAK;gBACT,MAAM,EAAE,GAAG;gBACX,UAAU,EAAE,aAAa;gBACzB,IAAI,EAAE,EAAE,KAAK,EAAE,aAAa,EAAE;aAC/B,CAAC,CAAC;YAEH,SAAS,CAAC,qBAAqB,CAAC,YAAmB,CAAC,CAAC;YAErD,MAAM,MAAM,CAAC,aAAa,CAAC,OAAO,CAAC;gBACjC,MAAM,EAAE,KAAK;gBACb,GAAG,EAAE,OAAO;aACb,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,uBAAuB,CAAC,CAAC;YAE7C,MAAM,CAAC,SAAS,CAAC,CAAC,qBAAqB,CAAC,CAAC,CAAC,CAAC;QAC7C,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,4BAA4B,EAAE,KAAK,IAAI,EAAE;YAC1C,4EAA4E;YAC5E,MAAM,UAAU,GAAG,IAAI,6BAAa,CAAC;gBACnC,OAAO,EAAE,yBAAyB;gBAClC,cAAc,EAAE,IAAI;gBACpB,KAAK,EAAE;oBACL,UAAU,EAAE,CAAC;oBACb,YAAY,EAAE,EAAE,EAAE,+BAA+B;oBACjD,QAAQ,EAAE,GAAG;oBACb,iBAAiB,EAAE,CAAC;oBACpB,oBAAoB,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;oBACrC,eAAe,EAAE,CAAC,YAAY,CAAC;iBAChC;gBACD,cAAc,EAAE;oBACd,IAAI,EAAE,sBAAsB;oBAC5B,gBAAgB,EAAE,EAAE,EAAE,yDAAyD;oBAC/E,eAAe,EAAE,KAAK;oBACtB,cAAc,EAAE,IAAI;oBACpB,gBAAgB,EAAE,KAAK;oBACvB,gBAAgB,EAAE,CAAC;iBACpB;aACF,CAAC,CAAC;YAEH,MAAM,YAAY,GAAG,kBAAkB,CAAC;gBACtC,EAAE,EAAE,KAAK;gBACT,MAAM,EAAE,GAAG;gBACX,UAAU,EAAE,uBAAuB;gBACnC,IAAI,EAAE,EAAE,KAAK,EAAE,cAAc,EAAE;aAChC,CAAC,CAAC;YAEH,SAAS,CAAC,SAAS,EAAE,CAAC,CAAC,uBAAuB;YAC9C,SAAS,CAAC,iBAAiB,CAAC,YAAmB,CAAC,CAAC;YAEjD,MAAM,MAAM,CAAC,UAAU,CAAC,OAAO,CAAC;gBAC9B,MAAM,EAAE,KAAK;gBACb,GAAG,EAAE,OAAO;gBACZ,OAAO,EAAE,CAAC,CAAE,mDAAmD;aAChE,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,iCAAiC,CAAC,CAAC;YAEvD,8CAA8C;YAC9C,MAAM,CAAC,SAAS,CAAC,CAAC,qBAAqB,CAAC,CAAC,CAAC,CAAC;QAC7C,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,6BAA6B,EAAE,GAAG,EAAE;QAC3C,EAAE,CAAC,4CAA4C,EAAE,KAAK,IAAI,EAAE;YAC1D,MAAM,YAAY,GAAG,kBAAkB,CAAC;gBACtC,EAAE,EAAE,KAAK;gBACT,MAAM,EAAE,GAAG;gBACX,UAAU,EAAE,uBAAuB;gBACnC,IAAI,EAAE,EAAE,KAAK,EAAE,cAAc,EAAE;aAChC,CAAC,CAAC;YAEH,SAAS,CAAC,iBAAiB,CAAC,YAAmB,CAAC,CAAC;YAEjD,uEAAuE;YACvE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC;gBAC3B,MAAM,MAAM,CAAC,aAAa,CAAC,OAAO,CAAC;oBACjC,MAAM,EAAE,KAAK;oBACb,GAAG,EAAE,OAAO;oBACZ,OAAO,EAAE,CAAC,CAAC,8BAA8B;iBAC1C,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,iCAAiC,CAAC,CAAC;YACzD,CAAC;YAED,MAAM,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAChD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,8BAA8B,EAAE,GAAG,EAAE;YACtC,aAAa,CAAC,mBAAmB,EAAE,CAAC;YACpC,MAAM,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC/C,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,qBAAqB,EAAE,GAAG,EAAE;QACnC,UAAU,CAAC,GAAG,EAAE;YACd,MAAM,YAAY,GAAG,kBAAkB,CAAC;gBACtC,IAAI,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE;aACxB,CAAC,CAAC;YAEH,SAAS,CAAC,iBAAiB,CAAC,YAAmB,CAAC,CAAC;QACnD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,2BAA2B,EAAE,KAAK,IAAI,EAAE;YACzC,MAAM,aAAa,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;YAEjC,MAAM,CAAC,SAAS,CAAC,CAAC,oBAAoB,CACpC,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,EAClB,MAAM,CAAC,gBAAgB,CAAC,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC,CAC3C,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,4BAA4B,EAAE,KAAK,IAAI,EAAE;YAC1C,MAAM,aAAa,CAAC,IAAI,CAAC,OAAO,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;YAEpD,MAAM,CAAC,SAAS,CAAC,CAAC,oBAAoB,CACpC,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,EAClB,MAAM,CAAC,gBAAgB,CAAC;gBACtB,MAAM,EAAE,MAAM;gBACd,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;aACvC,CAAC,CACH,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,2BAA2B,EAAE,KAAK,IAAI,EAAE;YACzC,MAAM,aAAa,CAAC,GAAG,CAAC,OAAO,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;YAEnD,MAAM,CAAC,SAAS,CAAC,CAAC,oBAAoB,CACpC,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,EAClB,MAAM,CAAC,gBAAgB,CAAC;gBACtB,MAAM,EAAE,KAAK;gBACb,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;aACvC,CAAC,CACH,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,8BAA8B,EAAE,KAAK,IAAI,EAAE;YAC5C,MAAM,aAAa,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YAEpC,MAAM,CAAC,SAAS,CAAC,CAAC,oBAAoB,CACpC,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,EAClB,MAAM,CAAC,gBAAgB,CAAC,EAAE,MAAM,EAAE,QAAQ,EAAE,CAAC,CAC9C,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,6BAA6B,EAAE,KAAK,IAAI,EAAE;YAC3C,MAAM,aAAa,CAAC,KAAK,CAAC,OAAO,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;YAErD,MAAM,CAAC,SAAS,CAAC,CAAC,oBAAoB,CACpC,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,EAClB,MAAM,CAAC,gBAAgB,CAAC;gBACtB,MAAM,EAAE,OAAO;gBACf,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;aACvC,CAAC,CACH,CAAC;QACJ,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,cAAc,EAAE,GAAG,EAAE;QAC5B,EAAE,CAAC,mCAAmC,EAAE,KAAK,IAAI,EAAE;YACjD,MAAM,kBAAkB,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC,kBAAkB,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;gBACjE,GAAG,MAAM;gBACT,OAAO,EAAE,EAAE,GAAG,MAAM,CAAC,OAAO,EAAE,UAAU,EAAE,MAAM,EAAE;aACnD,CAAC,CAAC,CAAC;YAEJ,aAAa,CAAC,qBAAqB,CAAC,kBAAkB,CAAC,CAAC;YAExD,MAAM,YAAY,GAAG,kBAAkB,CAAC,EAAE,CAAC,CAAC;YAE5C,SAAS,CAAC,qBAAqB,CAAC,YAAmB,CAAC,CAAC;YAErD,MAAM,aAAa,CAAC,OAAO,CAAC;gBAC1B,MAAM,EAAE,KAAK;gBACb,GAAG,EAAE,OAAO;aACb,CAAC,CAAC;YAEH,MAAM,CAAC,kBAAkB,CAAC,CAAC,gBAAgB,EAAE,CAAC;YAC9C,MAAM,CAAC,SAAS,CAAC,CAAC,oBAAoB,CACpC,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,EAClB,MAAM,CAAC,gBAAgB,CAAC;gBACtB,OAAO,EAAE,MAAM,CAAC,gBAAgB,CAAC;oBAC/B,UAAU,EAAE,MAAM;iBACnB,CAAC;aACH,CAAC,CACH,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,oCAAoC,EAAE,KAAK,IAAI,EAAE;YAClD,MAAM,mBAAmB,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC,kBAAkB,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;gBACpE,GAAG,QAAQ;gBACX,IAAI,EAAE,EAAE,GAAG,QAAQ,CAAC,IAAI,EAAE,WAAW,EAAE,IAAI,EAAE;aAC9C,CAAC,CAAC,CAAC;YAEJ,aAAa,CAAC,sBAAsB,CAAC,mBAAmB,CAAC,CAAC;YAE1D,MAAM,YAAY,GAAG,kBAAkB,CAAC;gBACtC,IAAI,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE;aACzB,CAAC,CAAC;YAEH,SAAS,CAAC,qBAAqB,CAAC,YAAmB,CAAC,CAAC;YAErD,MAAM,QAAQ,GAAG,MAAM,aAAa,CAAC,OAAO,CAAC;gBAC3C,MAAM,EAAE,KAAK;gBACb,GAAG,EAAE,OAAO;aACb,CAAC,CAAC;YAEH,MAAM,CAAC,mBAAmB,CAAC,CAAC,gBAAgB,EAAE,CAAC;YAC/C,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,EAAE,CAAC,CAAC;QACvE,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,iCAAiC,EAAE,KAAK,IAAI,EAAE;YAC/C,MAAM,gBAAgB,GAAG,IAAI,CAAC,EAAE,EAAE,CAAC,kBAAkB,CAAC,KAAK,CAAC,EAAE;gBAC5D,KAAK,CAAC,OAAO,GAAG,eAAe,GAAG,KAAK,CAAC,OAAO,CAAC;gBAChD,OAAO,KAAK,CAAC;YACf,CAAC,CAAC,CAAC;YAEH,aAAa,CAAC,mBAAmB,CAAC,gBAAgB,CAAC,CAAC;YAEpD,uCAAuC;YACvC,SAAS,CAAC,SAAS,EAAE,CAAC;YACtB,SAAS,CAAC,qBAAqB,CAAC,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC,CAAC;YAE5D,MAAM,MAAM,CAAC,aAAa,CAAC,OAAO,CAAC;gBACjC,MAAM,EAAE,KAAK;gBACb,GAAG,EAAE,OAAO;gBACZ,OAAO,EAAE,CAAC,CAAE,oCAAoC;aACjD,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,4BAA4B,CAAC,CAAC;YAElD,MAAM,CAAC,gBAAgB,CAAC,CAAC,gBAAgB,EAAE,CAAC;QAC9C,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,QAAQ,CAAC,oBAAoB,EAAE,GAAG,EAAE;QAClC,EAAE,CAAC,4CAA4C,EAAE,GAAG,EAAE;YACpD,MAAM,YAAY,GAAG,IAAI,kCAAkB,CAAC,eAAe,CAAC,CAAC;YAC7D,MAAM,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAE9C,MAAM,WAAW,GAAG,IAAI,kCAAkB,CAAC,cAAc,EAAE,GAAG,CAAC,CAAC;YAChE,MAAM,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAE7C,MAAM,WAAW,GAAG,IAAI,kCAAkB,CAAC,cAAc,EAAE,GAAG,CAAC,CAAC;YAChE,MAAM,CAAC,WAAW,CAAC,WAAW,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAE9C,MAAM,cAAc,GAAG,IAAI,kCAAkB,CAAC,cAAc,EAAE,GAAG,CAAC,CAAC;YACnE,MAAM,CAAC,cAAc,CAAC,WAAW,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAClD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,gCAAgC,EAAE,GAAG,EAAE;YACxC,MAAM,YAAY,GAAG,IAAI,kCAAkB,CAAC,iBAAiB,EAAE,GAAG,CAAC,CAAC;YACpE,MAAM,CAAC,YAAY,CAAC,SAAS,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAE5C,MAAM,mBAAmB,GAAG,IAAI,kCAAkB,CAAC,kBAAkB,CAAC,CAAC;YACvE,MAAM,CAAC,mBAAmB,CAAC,SAAS,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAEnD,MAAM,UAAU,GAAG,IAAI,kCAAkB,CAAC,aAAa,EAAE,GAAG,CAAC,CAAC;YAC9D,MAAM,CAAC,UAAU,CAAC,SAAS,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC7C,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,gCAAgC,EAAE,GAAG,EAAE;YACxC,MAAM,YAAY,GAAG,IAAI,kCAAkB,CAAC,eAAe,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,IAAI,KAAK,CAAC,YAAY,CAAC,CAAC,CAAC;YACvH,MAAM,CAAC,YAAY,CAAC,cAAc,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAEjD,MAAM,SAAS,GAAG,IAAI,kCAAkB,CAAC,YAAY,EAAE,GAAG,CAAC,CAAC;YAC5D,MAAM,CAAC,SAAS,CAAC,cAAc,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACjD,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","names":[],"sources":["/Users/ivan/Code/trading/titan/services/titan-brain/tests/services/ServiceClient.test.ts"],"sourcesContent":["/**\n * ServiceClient Tests\n * \n * Comprehensive unit tests for the ServiceClient class\n */\n\nimport { ServiceClient, ServiceClientError } from '../../src/services/ServiceClient';\nimport { CircuitBreakerState } from '../../src/services/CircuitBreaker';\nimport { Logger } from '../../src/logging/Logger';\n\n// Mock fetch\nglobal.fetch = jest.fn();\nconst mockFetch = fetch as jest.MockedFunction<typeof fetch>;\n\n// Mock Logger\njest.mock('../../src/logging/Logger');\nconst mockLogger = {\n  info: jest.fn(),\n  warn: jest.fn(),\n  error: jest.fn(),\n  debug: jest.fn()\n} as any;\n\n// Mock AbortController\nglobal.AbortController = jest.fn().mockImplementation(() => ({\n  abort: jest.fn(),\n  signal: {}\n}));\n\n// Helper function to create mock Response\nfunction createMockResponse(options: {\n  ok?: boolean;\n  status?: number;\n  statusText?: string;\n  headers?: Record<string, string>;\n  data?: any;\n  contentType?: string;\n}) {\n  const {\n    ok = true,\n    status = 200,\n    statusText = 'OK',\n    headers = {},\n    data = {},\n    contentType = 'application/json'\n  } = options;\n\n  const mockHeaders = {\n    get: jest.fn().mockImplementation((name: string) => {\n      if (name.toLowerCase() === 'content-type') return contentType;\n      return headers[name] || null;\n    }),\n    forEach: jest.fn().mockImplementation((callback: (value: string, key: string) => void) => {\n      callback(contentType, 'content-type');\n      Object.entries(headers).forEach(([key, value]) => callback(value, key));\n    })\n  };\n\n  return {\n    ok,\n    status,\n    statusText,\n    headers: mockHeaders,\n    json: jest.fn().mockResolvedValue(data),\n    text: jest.fn().mockResolvedValue(typeof data === 'string' ? data : JSON.stringify(data))\n  };\n}\n\ndescribe('ServiceClient', () => {\n  let serviceClient: ServiceClient;\n  \n  beforeEach(() => {\n    jest.clearAllMocks();\n    (Logger.getInstance as jest.Mock).mockReturnValue(mockLogger);\n    \n    serviceClient = new ServiceClient({\n      baseUrl: 'https://api.example.com',\n      defaultTimeout: 5000,\n      retry: {\n        maxRetries: 2,\n        initialDelay: 100,\n        maxDelay: 1000,\n        backoffMultiplier: 2,\n        retryableStatusCodes: [500, 502, 503],\n        retryableErrors: ['ECONNRESET']\n      }\n    });\n  });\n\n  describe('constructor', () => {\n    it('should initialize with default configuration', () => {\n      const client = new ServiceClient();\n      expect(client.getConfig().defaultTimeout).toBe(10000);\n    });\n\n    it('should merge custom configuration', () => {\n      const config = serviceClient.getConfig();\n      expect(config.baseUrl).toBe('https://api.example.com');\n      expect(config.defaultTimeout).toBe(5000);\n    });\n\n    it('should initialize circuit breaker', () => {\n      expect(serviceClient.isHealthy()).toBe(true);\n    });\n  });\n\n  describe('request method', () => {\n    it('should make successful GET request', async () => {\n      const mockResponse = createMockResponse({\n        data: { data: 'test' }\n      });\n      \n      mockFetch.mockResolvedValueOnce(mockResponse as any);\n\n      const response = await serviceClient.request({\n        method: 'GET',\n        url: '/test'\n      });\n\n      expect(response.status).toBe(200);\n      expect(response.data).toEqual({ data: 'test' });\n      expect(mockFetch).toHaveBeenCalledWith(\n        'https://api.example.com/test',\n        expect.objectContaining({\n          method: 'GET',\n          headers: expect.objectContaining({\n            'Content-Type': 'application/json',\n            'User-Agent': 'TitanBrain/1.0.0'\n          })\n        })\n      );\n    });\n\n    it('should make successful POST request with body', async () => {\n      const mockResponse = createMockResponse({\n        status: 201,\n        statusText: 'Created',\n        data: { id: 123 }\n      });\n      \n      mockFetch.mockResolvedValueOnce(mockResponse as any);\n\n      const response = await serviceClient.request({\n        method: 'POST',\n        url: '/users',\n        body: { name: 'John' }\n      });\n\n      expect(response.status).toBe(201);\n      expect(response.data).toEqual({ id: 123 });\n      expect(mockFetch).toHaveBeenCalledWith(\n        'https://api.example.com/users',\n        expect.objectContaining({\n          method: 'POST',\n          body: JSON.stringify({ name: 'John' })\n        })\n      );\n    });\n\n    it('should handle non-JSON responses', async () => {\n      const mockResponse = createMockResponse({\n        contentType: 'text/plain',\n        data: 'plain text response'\n      });\n      \n      mockFetch.mockResolvedValueOnce(mockResponse as any);\n\n      const response = await serviceClient.request({\n        method: 'GET',\n        url: '/text'\n      });\n\n      expect(response.data).toBe('plain text response');\n    });\n\n    it('should add correlation ID to headers', async () => {\n      const mockResponse = createMockResponse({});\n      \n      mockFetch.mockResolvedValueOnce(mockResponse as any);\n\n      await serviceClient.request({\n        method: 'GET',\n        url: '/test'\n      });\n\n      expect(mockFetch).toHaveBeenCalledWith(\n        expect.any(String),\n        expect.objectContaining({\n          headers: expect.objectContaining({\n            'x-correlation-id': expect.stringMatching(/^req_\\d+_[a-z0-9]+$/)\n          })\n        })\n      );\n    });\n\n    it('should use provided correlation ID', async () => {\n      const mockResponse = createMockResponse({});\n      \n      mockFetch.mockResolvedValueOnce(mockResponse as any);\n\n      await serviceClient.request({\n        method: 'GET',\n        url: '/test',\n        correlationId: 'custom-id'\n      });\n\n      expect(mockFetch).toHaveBeenCalledWith(\n        expect.any(String),\n        expect.objectContaining({\n          headers: expect.objectContaining({\n            'x-correlation-id': 'custom-id'\n          })\n        })\n      );\n    });\n  });\n\n  describe('error handling', () => {\n    it('should throw ServiceClientError for HTTP errors', async () => {\n      const mockResponse = createMockResponse({\n        ok: false,\n        status: 404,\n        statusText: 'Not Found',\n        data: { error: 'Not found' }\n      });\n      \n      mockFetch.mockResolvedValueOnce(mockResponse as any);\n\n      await expect(serviceClient.request({\n        method: 'GET',\n        url: '/not-found'\n      })).rejects.toThrow('HTTP 404: Not Found');\n    });\n\n    it('should handle network errors', async () => {\n      mockFetch.mockRejectedValueOnce(new Error('Network error'));\n\n      await expect(serviceClient.request({\n        method: 'GET',\n        url: '/test'\n      })).rejects.toThrow('Network error');\n    });\n\n    it('should handle timeout errors', async () => {\n      mockFetch.mockImplementationOnce(() => \n        new Promise((resolve) => setTimeout(() => resolve({} as Response), 6000))\n      );\n\n      await expect(serviceClient.request({\n        method: 'GET',\n        url: '/slow',\n        timeout: 100\n      })).rejects.toThrow('Request timeout');\n    });\n  });\n\n  describe('retry logic', () => {\n    it('should retry on retryable errors', async () => {\n      const mockErrorResponse = createMockResponse({\n        ok: false,\n        status: 500,\n        statusText: 'Internal Server Error',\n        data: { error: 'Server error' }\n      });\n      \n      const mockSuccessResponse = createMockResponse({\n        data: { success: true }\n      });\n      \n      mockFetch\n        .mockResolvedValueOnce(mockErrorResponse as any)\n        .mockResolvedValueOnce(mockErrorResponse as any)\n        .mockResolvedValueOnce(mockSuccessResponse as any);\n\n      const response = await serviceClient.request({\n        method: 'GET',\n        url: '/test'\n      });\n\n      expect(response.status).toBe(200);\n      expect(mockFetch).toHaveBeenCalledTimes(3);\n    });\n\n    it('should not retry on non-retryable errors', async () => {\n      const mockResponse = createMockResponse({\n        ok: false,\n        status: 400,\n        statusText: 'Bad Request',\n        data: { error: 'Bad request' }\n      });\n      \n      mockFetch.mockResolvedValueOnce(mockResponse as any);\n\n      await expect(serviceClient.request({\n        method: 'GET',\n        url: '/test'\n      })).rejects.toThrow('HTTP 400: Bad Request');\n\n      expect(mockFetch).toHaveBeenCalledTimes(1);\n    });\n\n    it('should respect max retries', async () => {\n      // Create a fresh service client with circuit breaker disabled for this test\n      const testClient = new ServiceClient({\n        baseUrl: 'https://api.example.com',\n        defaultTimeout: 5000,\n        retry: {\n          maxRetries: 2,\n          initialDelay: 10, // Reduce delay for faster test\n          maxDelay: 100,\n          backoffMultiplier: 2,\n          retryableStatusCodes: [500, 502, 503],\n          retryableErrors: ['ECONNRESET']\n        },\n        circuitBreaker: {\n          name: 'test-circuit-breaker',\n          failureThreshold: 10, // High threshold to prevent circuit breaker from opening\n          recoveryTimeout: 60000,\n          requestTimeout: 5000,\n          monitoringPeriod: 60000,\n          halfOpenMaxCalls: 3\n        }\n      });\n\n      const mockResponse = createMockResponse({\n        ok: false,\n        status: 500,\n        statusText: 'Internal Server Error',\n        data: { error: 'Server error' }\n      });\n      \n      mockFetch.mockClear(); // Clear previous calls\n      mockFetch.mockResolvedValue(mockResponse as any);\n\n      await expect(testClient.request({\n        method: 'GET',\n        url: '/test',\n        retries: 2  // Explicitly set retries to match test expectation\n      })).rejects.toThrow('HTTP 500: Internal Server Error');\n\n      // Initial request + 2 retries = 3 total calls\n      expect(mockFetch).toHaveBeenCalledTimes(3);\n    });\n  });\n\n  describe('circuit breaker integration', () => {\n    it('should open circuit breaker after failures', async () => {\n      const mockResponse = createMockResponse({\n        ok: false,\n        status: 500,\n        statusText: 'Internal Server Error',\n        data: { error: 'Server error' }\n      });\n      \n      mockFetch.mockResolvedValue(mockResponse as any);\n\n      // Make enough requests to open circuit breaker (5 failures by default)\n      for (let i = 0; i < 5; i++) {\n        await expect(serviceClient.request({\n          method: 'GET',\n          url: '/test',\n          retries: 0 // No retries to speed up test\n        })).rejects.toThrow('HTTP 500: Internal Server Error');\n      }\n\n      expect(serviceClient.isHealthy()).toBe(false);\n    });\n\n    it('should reset circuit breaker', () => {\n      serviceClient.resetCircuitBreaker();\n      expect(serviceClient.isHealthy()).toBe(true);\n    });\n  });\n\n  describe('convenience methods', () => {\n    beforeEach(() => {\n      const mockResponse = createMockResponse({\n        data: { success: true }\n      });\n      \n      mockFetch.mockResolvedValue(mockResponse as any);\n    });\n\n    it('should support GET method', async () => {\n      await serviceClient.get('/test');\n      \n      expect(mockFetch).toHaveBeenCalledWith(\n        expect.any(String),\n        expect.objectContaining({ method: 'GET' })\n      );\n    });\n\n    it('should support POST method', async () => {\n      await serviceClient.post('/test', { data: 'test' });\n      \n      expect(mockFetch).toHaveBeenCalledWith(\n        expect.any(String),\n        expect.objectContaining({ \n          method: 'POST',\n          body: JSON.stringify({ data: 'test' })\n        })\n      );\n    });\n\n    it('should support PUT method', async () => {\n      await serviceClient.put('/test', { data: 'test' });\n      \n      expect(mockFetch).toHaveBeenCalledWith(\n        expect.any(String),\n        expect.objectContaining({ \n          method: 'PUT',\n          body: JSON.stringify({ data: 'test' })\n        })\n      );\n    });\n\n    it('should support DELETE method', async () => {\n      await serviceClient.delete('/test');\n      \n      expect(mockFetch).toHaveBeenCalledWith(\n        expect.any(String),\n        expect.objectContaining({ method: 'DELETE' })\n      );\n    });\n\n    it('should support PATCH method', async () => {\n      await serviceClient.patch('/test', { data: 'test' });\n      \n      expect(mockFetch).toHaveBeenCalledWith(\n        expect.any(String),\n        expect.objectContaining({ \n          method: 'PATCH',\n          body: JSON.stringify({ data: 'test' })\n        })\n      );\n    });\n  });\n\n  describe('interceptors', () => {\n    it('should apply request interceptors', async () => {\n      const requestInterceptor = jest.fn().mockImplementation(config => ({\n        ...config,\n        headers: { ...config.headers, 'X-Custom': 'test' }\n      }));\n      \n      serviceClient.addRequestInterceptor(requestInterceptor);\n      \n      const mockResponse = createMockResponse({});\n      \n      mockFetch.mockResolvedValueOnce(mockResponse as any);\n\n      await serviceClient.request({\n        method: 'GET',\n        url: '/test'\n      });\n\n      expect(requestInterceptor).toHaveBeenCalled();\n      expect(mockFetch).toHaveBeenCalledWith(\n        expect.any(String),\n        expect.objectContaining({\n          headers: expect.objectContaining({\n            'X-Custom': 'test'\n          })\n        })\n      );\n    });\n\n    it('should apply response interceptors', async () => {\n      const responseInterceptor = jest.fn().mockImplementation(response => ({\n        ...response,\n        data: { ...response.data, intercepted: true }\n      }));\n      \n      serviceClient.addResponseInterceptor(responseInterceptor);\n      \n      const mockResponse = createMockResponse({\n        data: { original: true }\n      });\n      \n      mockFetch.mockResolvedValueOnce(mockResponse as any);\n\n      const response = await serviceClient.request({\n        method: 'GET',\n        url: '/test'\n      });\n\n      expect(responseInterceptor).toHaveBeenCalled();\n      expect(response.data).toEqual({ original: true, intercepted: true });\n    });\n\n    it('should apply error interceptors', async () => {\n      const errorInterceptor = jest.fn().mockImplementation(error => {\n        error.message = 'Intercepted: ' + error.message;\n        return error;\n      });\n      \n      serviceClient.addErrorInterceptor(errorInterceptor);\n      \n      // Create a fresh mock that will reject\n      mockFetch.mockReset();\n      mockFetch.mockRejectedValueOnce(new Error('Network error'));\n\n      await expect(serviceClient.request({\n        method: 'GET',\n        url: '/test',\n        retries: 0  // No retries to avoid complications\n      })).rejects.toThrow('Intercepted: Network error');\n\n      expect(errorInterceptor).toHaveBeenCalled();\n    });\n  });\n\n  describe('ServiceClientError', () => {\n    it('should identify retryable errors correctly', () => {\n      const networkError = new ServiceClientError('Network error');\n      expect(networkError.isRetryable()).toBe(true);\n\n      const serverError = new ServiceClientError('Server error', 500);\n      expect(serverError.isRetryable()).toBe(true);\n\n      const clientError = new ServiceClientError('Client error', 400);\n      expect(clientError.isRetryable()).toBe(false);\n\n      const rateLimitError = new ServiceClientError('Rate limited', 429);\n      expect(rateLimitError.isRetryable()).toBe(true);\n    });\n\n    it('should identify timeout errors', () => {\n      const timeoutError = new ServiceClientError('Request timeout', 408);\n      expect(timeoutError.isTimeout()).toBe(true);\n\n      const networkTimeoutError = new ServiceClientError('timeout occurred');\n      expect(networkTimeoutError.isTimeout()).toBe(true);\n\n      const otherError = new ServiceClientError('Other error', 500);\n      expect(otherError.isTimeout()).toBe(false);\n    });\n\n    it('should identify network errors', () => {\n      const networkError = new ServiceClientError('Network error', undefined, undefined, undefined, new Error('ECONNRESET'));\n      expect(networkError.isNetworkError()).toBe(true);\n\n      const httpError = new ServiceClientError('HTTP error', 500);\n      expect(httpError.isNetworkError()).toBe(false);\n    });\n  });\n});"],"version":3}