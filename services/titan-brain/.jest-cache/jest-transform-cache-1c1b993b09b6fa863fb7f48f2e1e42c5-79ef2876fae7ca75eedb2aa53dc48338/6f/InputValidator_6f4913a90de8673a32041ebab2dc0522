98bd52df6b211d718e81d46e9abb75ec
"use strict";
/**
 * InputValidator - Comprehensive input validation and sanitization
 *
 * Implements input validation, sanitization, and security checks
 * to prevent injection attacks and ensure data integrity.
 *
 * Requirements: 6.1, 6.2 - Input validation and sanitization
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.SecurityAuditLogger = exports.InputValidator = void 0;
/**
 * Input validation and sanitization utilities
 */
class InputValidator {
    /**
     * Validate and sanitize a string input
     */
    static validateString(value, fieldName, options = {}) {
        const errors = [];
        // Check if required
        if (options.required && (value === null || value === undefined || value === '')) {
            errors.push(`${fieldName} is required`);
            return { isValid: false, errors };
        }
        // Allow empty values if not required
        if (!options.required && (value === null || value === undefined || value === '')) {
            return { isValid: true, errors: [], sanitizedValue: value };
        }
        // Type check
        if (typeof value !== 'string') {
            errors.push(`${fieldName} must be a string`);
            return { isValid: false, errors };
        }
        let sanitizedValue = value;
        // Sanitize if requested
        if (options.sanitize) {
            sanitizedValue = this.sanitizeString(value);
        }
        // Length validation
        if (options.minLength !== undefined && sanitizedValue.length < options.minLength) {
            errors.push(`${fieldName} must be at least ${options.minLength} characters long`);
        }
        if (options.maxLength !== undefined && sanitizedValue.length > options.maxLength) {
            errors.push(`${fieldName} must be at most ${options.maxLength} characters long`);
        }
        // Pattern validation
        if (options.pattern && !options.pattern.test(sanitizedValue)) {
            errors.push(`${fieldName} format is invalid`);
        }
        // Allowed values validation
        if (options.allowedValues && !options.allowedValues.includes(sanitizedValue)) {
            errors.push(`${fieldName} must be one of: ${options.allowedValues.join(', ')}`);
        }
        return {
            isValid: errors.length === 0,
            errors,
            sanitizedValue
        };
    }
    /**
     * Validate and sanitize a number input
     */
    static validateNumber(value, fieldName, options = {}) {
        const errors = [];
        // Check if required
        if (options.required && (value === null || value === undefined)) {
            errors.push(`${fieldName} is required`);
            return { isValid: false, errors };
        }
        // Allow empty values if not required
        if (!options.required && (value === null || value === undefined)) {
            return { isValid: true, errors: [], sanitizedValue: value };
        }
        // Type check and conversion
        let numValue;
        if (typeof value === 'string') {
            numValue = parseFloat(value);
            if (isNaN(numValue)) {
                errors.push(`${fieldName} must be a valid number`);
                return { isValid: false, errors };
            }
        }
        else if (typeof value === 'number') {
            numValue = value;
        }
        else {
            errors.push(`${fieldName} must be a number`);
            return { isValid: false, errors };
        }
        // Check for infinity and NaN
        if (!isFinite(numValue)) {
            errors.push(`${fieldName} must be a finite number`);
            return { isValid: false, errors };
        }
        // Range validation
        if (options.min !== undefined && numValue < options.min) {
            errors.push(`${fieldName} must be at least ${options.min}`);
        }
        if (options.max !== undefined && numValue > options.max) {
            errors.push(`${fieldName} must be at most ${options.max}`);
        }
        return {
            isValid: errors.length === 0,
            errors,
            sanitizedValue: numValue
        };
    }
    /**
     * Validate boolean input
     */
    static validateBoolean(value, fieldName, options = {}) {
        const errors = [];
        // Check if required
        if (options.required && (value === null || value === undefined)) {
            errors.push(`${fieldName} is required`);
            return { isValid: false, errors };
        }
        // Allow empty values if not required
        if (!options.required && (value === null || value === undefined)) {
            return { isValid: true, errors: [], sanitizedValue: value };
        }
        // Type check and conversion
        let boolValue;
        if (typeof value === 'boolean') {
            boolValue = value;
        }
        else if (typeof value === 'string') {
            const lowerValue = value.toLowerCase();
            if (lowerValue === 'true' || lowerValue === '1') {
                boolValue = true;
            }
            else if (lowerValue === 'false' || lowerValue === '0') {
                boolValue = false;
            }
            else {
                errors.push(`${fieldName} must be a boolean value (true/false)`);
                return { isValid: false, errors };
            }
        }
        else if (typeof value === 'number') {
            boolValue = value !== 0;
        }
        else {
            errors.push(`${fieldName} must be a boolean value`);
            return { isValid: false, errors };
        }
        return {
            isValid: true,
            errors: [],
            sanitizedValue: boolValue
        };
    }
    /**
     * Validate array input
     */
    static validateArray(value, fieldName, options = {}) {
        const errors = [];
        // Check if required
        if (options.required && (value === null || value === undefined)) {
            errors.push(`${fieldName} is required`);
            return { isValid: false, errors };
        }
        // Allow empty values if not required
        if (!options.required && (value === null || value === undefined)) {
            return { isValid: true, errors: [], sanitizedValue: value };
        }
        // Type check
        if (!Array.isArray(value)) {
            errors.push(`${fieldName} must be an array`);
            return { isValid: false, errors };
        }
        // Length validation
        if (options.minLength !== undefined && value.length < options.minLength) {
            errors.push(`${fieldName} must have at least ${options.minLength} items`);
        }
        if (options.maxLength !== undefined && value.length > options.maxLength) {
            errors.push(`${fieldName} must have at most ${options.maxLength} items`);
        }
        return {
            isValid: errors.length === 0,
            errors,
            sanitizedValue: value
        };
    }
    /**
     * Sanitize string input to prevent XSS and injection attacks
     */
    static sanitizeString(input) {
        return input
            // Remove null bytes
            .replace(/\0/g, '')
            // Remove control characters except newline, carriage return, and tab
            .replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g, '')
            // Trim whitespace
            .trim();
    }
    /**
     * Validate signal ID format
     */
    static validateSignalId(signalId) {
        return this.validateString(signalId, 'signalId', {
            required: true,
            minLength: 1,
            maxLength: 100,
            pattern: /^[a-zA-Z0-9_-]+$/,
            sanitize: true
        });
    }
    /**
     * Validate phase ID
     */
    static validatePhaseId(phaseId) {
        return this.validateString(phaseId, 'phaseId', {
            required: true,
            allowedValues: ['phase1', 'phase2', 'phase3'],
            sanitize: true
        });
    }
    /**
     * Validate trading symbol
     */
    static validateSymbol(symbol) {
        return this.validateString(symbol, 'symbol', {
            required: true,
            minLength: 3,
            maxLength: 20,
            pattern: /^[A-Z0-9]+$/,
            sanitize: true
        });
    }
    /**
     * Validate trade side
     */
    static validateSide(side) {
        return this.validateString(side, 'side', {
            required: true,
            allowedValues: ['BUY', 'SELL'],
            sanitize: true
        });
    }
    /**
     * Validate position size
     */
    static validatePositionSize(size) {
        return this.validateNumber(size, 'requestedSize', {
            required: true,
            min: 0.000001,
            max: 1000000
        });
    }
    /**
     * Validate leverage
     */
    static validateLeverage(leverage) {
        return this.validateNumber(leverage, 'leverage', {
            required: false,
            min: 1,
            max: 100
        });
    }
    /**
     * Validate operator ID
     */
    static validateOperatorId(operatorId) {
        return this.validateString(operatorId, 'operatorId', {
            required: true,
            minLength: 3,
            maxLength: 50,
            pattern: /^[a-zA-Z0-9_-]+$/,
            sanitize: true
        });
    }
    /**
     * Validate password (basic validation - should be enhanced based on policy)
     */
    static validatePassword(password) {
        return this.validateString(password, 'password', {
            required: true,
            minLength: 8,
            maxLength: 128
        });
    }
    /**
     * Validate allocation weights
     */
    static validateAllocationWeights(allocation) {
        const errors = [];
        if (!allocation || typeof allocation !== 'object') {
            errors.push('allocation must be an object');
            return { isValid: false, errors };
        }
        const alloc = allocation;
        // Validate individual weights
        const w1Result = this.validateNumber(alloc.w1, 'w1', { required: true, min: 0, max: 1 });
        const w2Result = this.validateNumber(alloc.w2, 'w2', { required: true, min: 0, max: 1 });
        const w3Result = this.validateNumber(alloc.w3, 'w3', { required: true, min: 0, max: 1 });
        errors.push(...w1Result.errors, ...w2Result.errors, ...w3Result.errors);
        if (errors.length > 0) {
            return { isValid: false, errors };
        }
        // Validate sum equals 1.0
        const sum = w1Result.sanitizedValue +
            w2Result.sanitizedValue +
            w3Result.sanitizedValue;
        if (Math.abs(sum - 1.0) > 0.001) {
            errors.push(`allocation weights must sum to 1.0, got ${sum.toFixed(3)}`);
        }
        return {
            isValid: errors.length === 0,
            errors,
            sanitizedValue: {
                w1: w1Result.sanitizedValue,
                w2: w2Result.sanitizedValue,
                w3: w3Result.sanitizedValue
            }
        };
    }
    /**
     * Validate permissions array
     */
    static validatePermissions(permissions) {
        const arrayResult = this.validateArray(permissions, 'permissions', {
            required: true,
            minLength: 1,
            maxLength: 20
        });
        if (!arrayResult.isValid) {
            return arrayResult;
        }
        const errors = [];
        const validPermissions = [
            'override:create',
            'override:deactivate',
            'breaker:reset',
            'operator:create',
            'config:update'
        ];
        const perms = arrayResult.sanitizedValue;
        for (const perm of perms) {
            const permResult = this.validateString(perm, 'permission', {
                required: true,
                allowedValues: validPermissions,
                sanitize: true
            });
            if (!permResult.isValid) {
                errors.push(...permResult.errors);
            }
        }
        return {
            isValid: errors.length === 0,
            errors,
            sanitizedValue: perms
        };
    }
    /**
     * Validate and sanitize a complete signal request
     */
    static validateSignalRequest(body) {
        const errors = [];
        const sanitizedBody = {};
        if (!body || typeof body !== 'object') {
            errors.push('Request body must be an object');
            return { isValid: false, errors };
        }
        const req = body;
        // Validate each field
        const validations = [
            { field: 'signalId', validator: () => this.validateSignalId(req.signalId) },
            { field: 'phaseId', validator: () => this.validatePhaseId(req.phaseId) },
            { field: 'symbol', validator: () => this.validateSymbol(req.symbol) },
            { field: 'side', validator: () => this.validateSide(req.side) },
            { field: 'requestedSize', validator: () => this.validatePositionSize(req.requestedSize) },
            { field: 'leverage', validator: () => this.validateLeverage(req.leverage) },
            { field: 'timestamp', validator: () => this.validateNumber(req.timestamp, 'timestamp', { required: false, min: 0 }) }
        ];
        for (const { field, validator } of validations) {
            const result = validator();
            if (!result.isValid) {
                errors.push(...result.errors);
            }
            else if (result.sanitizedValue !== undefined) {
                sanitizedBody[field] = result.sanitizedValue;
            }
        }
        return {
            isValid: errors.length === 0,
            errors,
            sanitizedValue: sanitizedBody
        };
    }
    /**
     * Rate limiting validation (check if request rate is within limits)
     */
    static validateRateLimit(clientId, requestsPerMinute = 60, windowMs = 60000) {
        // This is a simplified rate limiting check
        // In production, you would use Redis or similar for distributed rate limiting
        const now = Date.now();
        const windowStart = now - windowMs;
        // This would typically be stored in Redis with expiration
        // For now, we'll just return success (implement proper rate limiting in production)
        return {
            isValid: true,
            errors: [],
            sanitizedValue: { clientId, timestamp: now }
        };
    }
}
exports.InputValidator = InputValidator;
/**
 * Security audit logger for validation failures
 */
class SecurityAuditLogger {
    /**
     * Log security validation failure
     */
    static logValidationFailure(clientIp, endpoint, errors, requestBody) {
        const auditEvent = {
            timestamp: new Date().toISOString(),
            event: 'VALIDATION_FAILURE',
            clientIp,
            endpoint,
            errors,
            // Don't log sensitive data in audit logs
            hasRequestBody: !!requestBody,
            severity: 'WARNING'
        };
        console.warn('SECURITY_AUDIT:', JSON.stringify(auditEvent));
    }
    /**
     * Log potential security threat
     */
    static logSecurityThreat(clientIp, endpoint, threatType, details) {
        const auditEvent = {
            timestamp: new Date().toISOString(),
            event: 'SECURITY_THREAT',
            clientIp,
            endpoint,
            threatType,
            details,
            severity: 'CRITICAL'
        };
        console.error('SECURITY_THREAT:', JSON.stringify(auditEvent));
    }
    /**
     * Log authentication failure
     */
    static logAuthenticationFailure(clientIp, operatorId, reason) {
        const auditEvent = {
            timestamp: new Date().toISOString(),
            event: 'AUTH_FAILURE',
            clientIp,
            operatorId,
            reason,
            severity: 'WARNING'
        };
        console.warn('AUTH_AUDIT:', JSON.stringify(auditEvent));
    }
}
exports.SecurityAuditLogger = SecurityAuditLogger;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2l2YW4vQ29kZS90cmFkaW5nL3RpdGFuL3NlcnZpY2VzL3RpdGFuLWJyYWluL3NyYy9zZWN1cml0eS9JbnB1dFZhbGlkYXRvci50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7R0FPRzs7O0FBMkJIOztHQUVHO0FBQ0gsTUFBYSxjQUFjO0lBRXpCOztPQUVHO0lBQ0gsTUFBTSxDQUFDLGNBQWMsQ0FDbkIsS0FBYyxFQUNkLFNBQWlCLEVBQ2pCLFVBQTZCLEVBQUU7UUFFL0IsTUFBTSxNQUFNLEdBQWEsRUFBRSxDQUFDO1FBRTVCLG9CQUFvQjtRQUNwQixJQUFJLE9BQU8sQ0FBQyxRQUFRLElBQUksQ0FBQyxLQUFLLEtBQUssSUFBSSxJQUFJLEtBQUssS0FBSyxTQUFTLElBQUksS0FBSyxLQUFLLEVBQUUsQ0FBQyxFQUFFLENBQUM7WUFDaEYsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLFNBQVMsY0FBYyxDQUFDLENBQUM7WUFDeEMsT0FBTyxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLENBQUM7UUFDcEMsQ0FBQztRQUVELHFDQUFxQztRQUNyQyxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsSUFBSSxDQUFDLEtBQUssS0FBSyxJQUFJLElBQUksS0FBSyxLQUFLLFNBQVMsSUFBSSxLQUFLLEtBQUssRUFBRSxDQUFDLEVBQUUsQ0FBQztZQUNqRixPQUFPLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFLGNBQWMsRUFBRSxLQUFLLEVBQUUsQ0FBQztRQUM5RCxDQUFDO1FBRUQsYUFBYTtRQUNiLElBQUksT0FBTyxLQUFLLEtBQUssUUFBUSxFQUFFLENBQUM7WUFDOUIsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLFNBQVMsbUJBQW1CLENBQUMsQ0FBQztZQUM3QyxPQUFPLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsQ0FBQztRQUNwQyxDQUFDO1FBRUQsSUFBSSxjQUFjLEdBQUcsS0FBSyxDQUFDO1FBRTNC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QixFQUNsQixNQUFjO1FBRWQsTUFBTSxVQUFVLEdBQUc7WUFDakIsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFO1lBQ25DLEtBQUssRUFBRSxjQUFjO1lBQ3JCLFFBQVE7WUFDUixVQUFVO1lBQ1YsTUFBTTtZQUNOLFFBQVEsRUFBRSxTQUFTO1NBQ3BCLENBQUM7UUFFRixPQUFPLENBQUMsSUFBSSxDQUFDLGFBQWEsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7SUFDMUQsQ0FBQztDQUNGO0FBbEVELGtEQWtFQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvaXZhbi9Db2RlL3RyYWRpbmcvdGl0YW4vc2VydmljZXMvdGl0YW4tYnJhaW4vc3JjL3NlY3VyaXR5L0lucHV0VmFsaWRhdG9yLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogSW5wdXRWYWxpZGF0b3IgLSBDb21wcmVoZW5zaXZlIGlucHV0IHZhbGlkYXRpb24gYW5kIHNhbml0aXphdGlvblxuICogXG4gKiBJbXBsZW1lbnRzIGlucHV0IHZhbGlkYXRpb24sIHNhbml0aXphdGlvbiwgYW5kIHNlY3VyaXR5IGNoZWNrc1xuICogdG8gcHJldmVudCBpbmplY3Rpb24gYXR0YWNrcyBhbmQgZW5zdXJlIGRhdGEgaW50ZWdyaXR5LlxuICogXG4gKiBSZXF1aXJlbWVudHM6IDYuMSwgNi4yIC0gSW5wdXQgdmFsaWRhdGlvbiBhbmQgc2FuaXRpemF0aW9uXG4gKi9cblxuaW1wb3J0IHsgUGhhc2VJZCB9IGZyb20gJy4uL3R5cGVzL2luZGV4LmpzJztcblxuLyoqXG4gKiBWYWxpZGF0aW9uIHJlc3VsdFxuICovXG5leHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRpb25SZXN1bHQge1xuICBpc1ZhbGlkOiBib29sZWFuO1xuICBlcnJvcnM6IHN0cmluZ1tdO1xuICBzYW5pdGl6ZWRWYWx1ZT86IHVua25vd247XG59XG5cbi8qKlxuICogVmFsaWRhdGlvbiBvcHRpb25zXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVmFsaWRhdGlvbk9wdGlvbnMge1xuICByZXF1aXJlZD86IGJvb2xlYW47XG4gIG1pbkxlbmd0aD86IG51bWJlcjtcbiAgbWF4TGVuZ3RoPzogbnVtYmVyO1xuICBtaW4/OiBudW1iZXI7XG4gIG1heD86IG51bWJlcjtcbiAgcGF0dGVybj86IFJlZ0V4cDtcbiAgYWxsb3dlZFZhbHVlcz86IHVua25vd25bXTtcbiAgc2FuaXRpemU/OiBib29sZWFuO1xufVxuXG4vKipcbiAqIElucHV0IHZhbGlkYXRpb24gYW5kIHNhbml0aXphdGlvbiB1dGlsaXRpZXNcbiAqL1xuZXhwb3J0IGNsYXNzIElucHV0VmFsaWRhdG9yIHtcbiAgXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBhbmQgc2FuaXRpemUgYSBzdHJpbmcgaW5wdXRcbiAgICovXG4gIHN0YXRpYyB2YWxpZGF0ZVN0cmluZyhcbiAgICB2YWx1ZTogdW5rbm93bixcbiAgICBmaWVsZE5hbWU6IHN0cmluZyxcbiAgICBvcHRpb25zOiBWYWxpZGF0aW9uT3B0aW9ucyA9IHt9XG4gICk6IFZhbGlkYXRpb25SZXN1bHQge1xuICAgIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcbiAgICBcbiAgICAvLyBDaGVjayBpZiByZXF1aXJlZFxuICAgIGlmIChvcHRpb25zLnJlcXVpcmVkICYmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSAnJykpIHtcbiAgICAgIGVycm9ycy5wdXNoKGAke2ZpZWxkTmFtZX0gaXMgcmVxdWlyZWRgKTtcbiAgICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBlcnJvcnMgfTtcbiAgICB9XG4gICAgXG4gICAgLy8gQWxsb3cgZW1wdHkgdmFsdWVzIGlmIG5vdCByZXF1aXJlZFxuICAgIGlmICghb3B0aW9ucy5yZXF1aXJlZCAmJiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gJycpKSB7XG4gICAgICByZXR1cm4geyBpc1ZhbGlkOiB0cnVlLCBlcnJvcnM6IFtdLCBzYW5pdGl6ZWRWYWx1ZTogdmFsdWUgfTtcbiAgICB9XG4gICAgXG4gICAgLy8gVHlwZSBjaGVja1xuICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICBlcnJvcnMucHVzaChgJHtmaWVsZE5hbWV9IG11c3QgYmUgYSBzdHJpbmdgKTtcbiAgICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBlcnJvcnMgfTtcbiAgICB9XG4gICAgXG4gICAgbGV0IHNhbml0aXplZFZhbHVlID0gdmFsdWU7XG4gICAgXG4gICAgLy8gU2FuaXRpemUgaWYgcmVxdWVzdGVkXG4gICAgaWYgKG9wdGlvbnMuc2FuaXRpemUpIHtcbiAgICAgIHNhbml0aXplZFZhbHVlID0gdGhpcy5zYW5pdGl6ZVN0cmluZyh2YWx1ZSk7XG4gICAgfVxuICAgIFxuICAgIC8vIExlbmd0aCB2YWxpZGF0aW9uXG4gICAgaWYgKG9wdGlvbnMubWluTGVuZ3RoICE9PSB1bmRlZmluZWQgJiYgc2FuaXRpemVkVmFsdWUubGVuZ3RoIDwgb3B0aW9ucy5taW5MZW5ndGgpIHtcbiAgICAgIGVycm9ycy5wdXNoKGAke2ZpZWxkTmFtZX0gbXVzdCBiZSBhdCBsZWFzdCAke29wdGlvbnMubWluTGVuZ3RofSBjaGFyYWN0ZXJzIGxvbmdgKTtcbiAgICB9XG4gICAgXG4gICAgaWYgKG9wdGlvbnMubWF4TGVuZ3RoICE9PSB1bmRlZmluZWQgJiYgc2FuaXRpemVkVmFsdWUubGVuZ3RoID4gb3B0aW9ucy5tYXhMZW5ndGgpIHtcbiAgICAgIGVycm9ycy5wdXNoKGAke2ZpZWxkTmFtZX0gbXVzdCBiZSBhdCBtb3N0ICR7b3B0aW9ucy5tYXhMZW5ndGh9IGNoYXJhY3RlcnMgbG9uZ2ApO1xuICAgIH1cbiAgICBcbiAgICAvLyBQYXR0ZXJuIHZhbGlkYXRpb25cbiAgICBpZiAob3B0aW9ucy5wYXR0ZXJuICYmICFvcHRpb25zLnBhdHRlcm4udGVzdChzYW5pdGl6ZWRWYWx1ZSkpIHtcbiAgICAgIGVycm9ycy5wdXNoKGAke2ZpZWxkTmFtZX0gZm9ybWF0IGlzIGludmFsaWRgKTtcbiAgICB9XG4gICAgXG4gICAgLy8gQWxsb3dlZCB2YWx1ZXMgdmFsaWRhdGlvblxuICAgIGlmIChvcHRpb25zLmFsbG93ZWRWYWx1ZXMgJiYgIW9wdGlvbnMuYWxsb3dlZFZhbHVlcy5pbmNsdWRlcyhzYW5pdGl6ZWRWYWx1ZSkpIHtcbiAgICAgIGVycm9ycy5wdXNoKGAke2ZpZWxkTmFtZX0gbXVzdCBiZSBvbmUgb2Y6ICR7b3B0aW9ucy5hbGxvd2VkVmFsdWVzLmpvaW4oJywgJyl9YCk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBpc1ZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxuICAgICAgZXJyb3JzLFxuICAgICAgc2FuaXRpemVkVmFsdWVcbiAgICB9O1xuICB9XG4gIFxuICAvKipcbiAgICogVmFsaWRhdGUgYW5kIHNhbml0aXplIGEgbnVtYmVyIGlucHV0XG4gICAqL1xuICBzdGF0aWMgdmFsaWRhdGVOdW1iZXIoXG4gICAgdmFsdWU6IHVua25vd24sXG4gICAgZmllbGROYW1lOiBzdHJpbmcsXG4gICAgb3B0aW9uczogVmFsaWRhdGlvbk9wdGlvbnMgPSB7fVxuICApOiBWYWxpZGF0aW9uUmVzdWx0IHtcbiAgICBjb25zdCBlcnJvcnM6IHN0cmluZ1tdID0gW107XG4gICAgXG4gICAgLy8gQ2hlY2sgaWYgcmVxdWlyZWRcbiAgICBpZiAob3B0aW9ucy5yZXF1aXJlZCAmJiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkpIHtcbiAgICAgIGVycm9ycy5wdXNoKGAke2ZpZWxkTmFtZX0gaXMgcmVxdWlyZWRgKTtcbiAgICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBlcnJvcnMgfTtcbiAgICB9XG4gICAgXG4gICAgLy8gQWxsb3cgZW1wdHkgdmFsdWVzIGlmIG5vdCByZXF1aXJlZFxuICAgIGlmICghb3B0aW9ucy5yZXF1aXJlZCAmJiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkpIHtcbiAgICAgIHJldHVybiB7IGlzVmFsaWQ6IHRydWUsIGVycm9yczogW10sIHNhbml0aXplZFZhbHVlOiB2YWx1ZSB9O1xuICAgIH1cbiAgICBcbiAgICAvLyBUeXBlIGNoZWNrIGFuZCBjb252ZXJzaW9uXG4gICAgbGV0IG51bVZhbHVlOiBudW1iZXI7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIG51bVZhbHVlID0gcGFyc2VGbG9hdCh2YWx1ZSk7XG4gICAgICBpZiAoaXNOYU4obnVtVmFsdWUpKSB7XG4gICAgICAgIGVycm9ycy5wdXNoKGAke2ZpZWxkTmFtZX0gbXVzdCBiZSBhIHZhbGlkIG51bWJlcmApO1xuICAgICAgICByZXR1cm4geyBpc1ZhbGlkOiBmYWxzZSwgZXJyb3JzIH07XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgICBudW1WYWx1ZSA9IHZhbHVlO1xuICAgIH0gZWxzZSB7XG4gICAgICBlcnJvcnMucHVzaChgJHtmaWVsZE5hbWV9IG11c3QgYmUgYSBudW1iZXJgKTtcbiAgICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBlcnJvcnMgfTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ2hlY2sgZm9yIGluZmluaXR5IGFuZCBOYU5cbiAgICBpZiAoIWlzRmluaXRlKG51bVZhbHVlKSkge1xuICAgICAgZXJyb3JzLnB1c2goYCR7ZmllbGROYW1lfSBtdXN0IGJlIGEgZmluaXRlIG51bWJlcmApO1xuICAgICAgcmV0dXJuIHsgaXNWYWxpZDogZmFsc2UsIGVycm9ycyB9O1xuICAgIH1cbiAgICBcbiAgICAvLyBSYW5nZSB2YWxpZGF0aW9uXG4gICAgaWYgKG9wdGlvbnMubWluICE9PSB1bmRlZmluZWQgJiYgbnVtVmFsdWUgPCBvcHRpb25zLm1pbikge1xuICAgICAgZXJyb3JzLnB1c2goYCR7ZmllbGROYW1lfSBtdXN0IGJlIGF0IGxlYXN0ICR7b3B0aW9ucy5taW59YCk7XG4gICAgfVxuICAgIFxuICAgIGlmIChvcHRpb25zLm1heCAhPT0gdW5kZWZpbmVkICYmIG51bVZhbHVlID4gb3B0aW9ucy5tYXgpIHtcbiAgICAgIGVycm9ycy5wdXNoKGAke2ZpZWxkTmFtZX0gbXVzdCBiZSBhdCBtb3N0ICR7b3B0aW9ucy5tYXh9YCk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBpc1ZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxuICAgICAgZXJyb3JzLFxuICAgICAgc2FuaXRpemVkVmFsdWU6IG51bVZhbHVlXG4gICAgfTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIFZhbGlkYXRlIGJvb2xlYW4gaW5wdXRcbiAgICovXG4gIHN0YXRpYyB2YWxpZGF0ZUJvb2xlYW4oXG4gICAgdmFsdWU6IHVua25vd24sXG4gICAgZmllbGROYW1lOiBzdHJpbmcsXG4gICAgb3B0aW9uczogVmFsaWRhdGlvbk9wdGlvbnMgPSB7fVxuICApOiBWYWxpZGF0aW9uUmVzdWx0IHtcbiAgICBjb25zdCBlcnJvcnM6IHN0cmluZ1tdID0gW107XG4gICAgXG4gICAgLy8gQ2hlY2sgaWYgcmVxdWlyZWRcbiAgICBpZiAob3B0aW9ucy5yZXF1aXJlZCAmJiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkpIHtcbiAgICAgIGVycm9ycy5wdXNoKGAke2ZpZWxkTmFtZX0gaXMgcmVxdWlyZWRgKTtcbiAgICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBlcnJvcnMgfTtcbiAgICB9XG4gICAgXG4gICAgLy8gQWxsb3cgZW1wdHkgdmFsdWVzIGlmIG5vdCByZXF1aXJlZFxuICAgIGlmICghb3B0aW9ucy5yZXF1aXJlZCAmJiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCkpIHtcbiAgICAgIHJldHVybiB7IGlzVmFsaWQ6IHRydWUsIGVycm9yczogW10sIHNhbml0aXplZFZhbHVlOiB2YWx1ZSB9O1xuICAgIH1cbiAgICBcbiAgICAvLyBUeXBlIGNoZWNrIGFuZCBjb252ZXJzaW9uXG4gICAgbGV0IGJvb2xWYWx1ZTogYm9vbGVhbjtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbicpIHtcbiAgICAgIGJvb2xWYWx1ZSA9IHZhbHVlO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgY29uc3QgbG93ZXJWYWx1ZSA9IHZhbHVlLnRvTG93ZXJDYXNlKCk7XG4gICAgICBpZiAobG93ZXJWYWx1ZSA9PT0gJ3RydWUnIHx8IGxvd2VyVmFsdWUgPT09ICcxJykge1xuICAgICAgICBib29sVmFsdWUgPSB0cnVlO1xuICAgICAgfSBlbHNlIGlmIChsb3dlclZhbHVlID09PSAnZmFsc2UnIHx8IGxvd2VyVmFsdWUgPT09ICcwJykge1xuICAgICAgICBib29sVmFsdWUgPSBmYWxzZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVycm9ycy5wdXNoKGAke2ZpZWxkTmFtZX0gbXVzdCBiZSBhIGJvb2xlYW4gdmFsdWUgKHRydWUvZmFsc2UpYCk7XG4gICAgICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBlcnJvcnMgfTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgIGJvb2xWYWx1ZSA9IHZhbHVlICE9PSAwO1xuICAgIH0gZWxzZSB7XG4gICAgICBlcnJvcnMucHVzaChgJHtmaWVsZE5hbWV9IG11c3QgYmUgYSBib29sZWFuIHZhbHVlYCk7XG4gICAgICByZXR1cm4geyBpc1ZhbGlkOiBmYWxzZSwgZXJyb3JzIH07XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBpc1ZhbGlkOiB0cnVlLFxuICAgICAgZXJyb3JzOiBbXSxcbiAgICAgIHNhbml0aXplZFZhbHVlOiBib29sVmFsdWVcbiAgICB9O1xuICB9XG4gIFxuICAvKipcbiAgICogVmFsaWRhdGUgYXJyYXkgaW5wdXRcbiAgICovXG4gIHN0YXRpYyB2YWxpZGF0ZUFycmF5KFxuICAgIHZhbHVlOiB1bmtub3duLFxuICAgIGZpZWxkTmFtZTogc3RyaW5nLFxuICAgIG9wdGlvbnM6IFZhbGlkYXRpb25PcHRpb25zID0ge31cbiAgKTogVmFsaWRhdGlvblJlc3VsdCB7XG4gICAgY29uc3QgZXJyb3JzOiBzdHJpbmdbXSA9IFtdO1xuICAgIFxuICAgIC8vIENoZWNrIGlmIHJlcXVpcmVkXG4gICAgaWYgKG9wdGlvbnMucmVxdWlyZWQgJiYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpKSB7XG4gICAgICBlcnJvcnMucHVzaChgJHtmaWVsZE5hbWV9IGlzIHJlcXVpcmVkYCk7XG4gICAgICByZXR1cm4geyBpc1ZhbGlkOiBmYWxzZSwgZXJyb3JzIH07XG4gICAgfVxuICAgIFxuICAgIC8vIEFsbG93IGVtcHR5IHZhbHVlcyBpZiBub3QgcmVxdWlyZWRcbiAgICBpZiAoIW9wdGlvbnMucmVxdWlyZWQgJiYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQpKSB7XG4gICAgICByZXR1cm4geyBpc1ZhbGlkOiB0cnVlLCBlcnJvcnM6IFtdLCBzYW5pdGl6ZWRWYWx1ZTogdmFsdWUgfTtcbiAgICB9XG4gICAgXG4gICAgLy8gVHlwZSBjaGVja1xuICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgIGVycm9ycy5wdXNoKGAke2ZpZWxkTmFtZX0gbXVzdCBiZSBhbiBhcnJheWApO1xuICAgICAgcmV0dXJuIHsgaXNWYWxpZDogZmFsc2UsIGVycm9ycyB9O1xuICAgIH1cbiAgICBcbiAgICAvLyBMZW5ndGggdmFsaWRhdGlvblxuICAgIGlmIChvcHRpb25zLm1pbkxlbmd0aCAhPT0gdW5kZWZpbmVkICYmIHZhbHVlLmxlbmd0aCA8IG9wdGlvbnMubWluTGVuZ3RoKSB7XG4gICAgICBlcnJvcnMucHVzaChgJHtmaWVsZE5hbWV9IG11c3QgaGF2ZSBhdCBsZWFzdCAke29wdGlvbnMubWluTGVuZ3RofSBpdGVtc2ApO1xuICAgIH1cbiAgICBcbiAgICBpZiAob3B0aW9ucy5tYXhMZW5ndGggIT09IHVuZGVmaW5lZCAmJiB2YWx1ZS5sZW5ndGggPiBvcHRpb25zLm1heExlbmd0aCkge1xuICAgICAgZXJyb3JzLnB1c2goYCR7ZmllbGROYW1lfSBtdXN0IGhhdmUgYXQgbW9zdCAke29wdGlvbnMubWF4TGVuZ3RofSBpdGVtc2ApO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgaXNWYWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCxcbiAgICAgIGVycm9ycyxcbiAgICAgIHNhbml0aXplZFZhbHVlOiB2YWx1ZVxuICAgIH07XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBTYW5pdGl6ZSBzdHJpbmcgaW5wdXQgdG8gcHJldmVudCBYU1MgYW5kIGluamVjdGlvbiBhdHRhY2tzXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBzYW5pdGl6ZVN0cmluZyhpbnB1dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gaW5wdXRcbiAgICAgIC8vIFJlbW92ZSBudWxsIGJ5dGVzXG4gICAgICAucmVwbGFjZSgvXFwwL2csICcnKVxuICAgICAgLy8gUmVtb3ZlIGNvbnRyb2wgY2hhcmFjdGVycyBleGNlcHQgbmV3bGluZSwgY2FycmlhZ2UgcmV0dXJuLCBhbmQgdGFiXG4gICAgICAucmVwbGFjZSgvW1xceDAwLVxceDA4XFx4MEJcXHgwQ1xceDBFLVxceDFGXFx4N0ZdL2csICcnKVxuICAgICAgLy8gVHJpbSB3aGl0ZXNwYWNlXG4gICAgICAudHJpbSgpO1xuICB9XG4gIFxuICAvKipcbiAgICogVmFsaWRhdGUgc2lnbmFsIElEIGZvcm1hdFxuICAgKi9cbiAgc3RhdGljIHZhbGlkYXRlU2lnbmFsSWQoc2lnbmFsSWQ6IHVua25vd24pOiBWYWxpZGF0aW9uUmVzdWx0IHtcbiAgICByZXR1cm4gdGhpcy52YWxpZGF0ZVN0cmluZyhzaWduYWxJZCwgJ3NpZ25hbElkJywge1xuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICBtaW5MZW5ndGg6IDEsXG4gICAgICBtYXhMZW5ndGg6IDEwMCxcbiAgICAgIHBhdHRlcm46IC9eW2EtekEtWjAtOV8tXSskLyxcbiAgICAgIHNhbml0aXplOiB0cnVlXG4gICAgfSk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBwaGFzZSBJRFxuICAgKi9cbiAgc3RhdGljIHZhbGlkYXRlUGhhc2VJZChwaGFzZUlkOiB1bmtub3duKTogVmFsaWRhdGlvblJlc3VsdCB7XG4gICAgcmV0dXJuIHRoaXMudmFsaWRhdGVTdHJpbmcocGhhc2VJZCwgJ3BoYXNlSWQnLCB7XG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGFsbG93ZWRWYWx1ZXM6IFsncGhhc2UxJywgJ3BoYXNlMicsICdwaGFzZTMnXSxcbiAgICAgIHNhbml0aXplOiB0cnVlXG4gICAgfSk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSB0cmFkaW5nIHN5bWJvbFxuICAgKi9cbiAgc3RhdGljIHZhbGlkYXRlU3ltYm9sKHN5bWJvbDogdW5rbm93bik6IFZhbGlkYXRpb25SZXN1bHQge1xuICAgIHJldHVybiB0aGlzLnZhbGlkYXRlU3RyaW5nKHN5bWJvbCwgJ3N5bWJvbCcsIHtcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgbWluTGVuZ3RoOiAzLFxuICAgICAgbWF4TGVuZ3RoOiAyMCxcbiAgICAgIHBhdHRlcm46IC9eW0EtWjAtOV0rJC8sXG4gICAgICBzYW5pdGl6ZTogdHJ1ZVxuICAgIH0pO1xuICB9XG4gIFxuICAvKipcbiAgICogVmFsaWRhdGUgdHJhZGUgc2lkZVxuICAgKi9cbiAgc3RhdGljIHZhbGlkYXRlU2lkZShzaWRlOiB1bmtub3duKTogVmFsaWRhdGlvblJlc3VsdCB7XG4gICAgcmV0dXJuIHRoaXMudmFsaWRhdGVTdHJpbmcoc2lkZSwgJ3NpZGUnLCB7XG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGFsbG93ZWRWYWx1ZXM6IFsnQlVZJywgJ1NFTEwnXSxcbiAgICAgIHNhbml0aXplOiB0cnVlXG4gICAgfSk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBwb3NpdGlvbiBzaXplXG4gICAqL1xuICBzdGF0aWMgdmFsaWRhdGVQb3NpdGlvblNpemUoc2l6ZTogdW5rbm93bik6IFZhbGlkYXRpb25SZXN1bHQge1xuICAgIHJldHVybiB0aGlzLnZhbGlkYXRlTnVtYmVyKHNpemUsICdyZXF1ZXN0ZWRTaXplJywge1xuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICBtaW46IDAuMDAwMDAxLFxuICAgICAgbWF4OiAxMDAwMDAwXG4gICAgfSk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBsZXZlcmFnZVxuICAgKi9cbiAgc3RhdGljIHZhbGlkYXRlTGV2ZXJhZ2UobGV2ZXJhZ2U6IHVua25vd24pOiBWYWxpZGF0aW9uUmVzdWx0IHtcbiAgICByZXR1cm4gdGhpcy52YWxpZGF0ZU51bWJlcihsZXZlcmFnZSwgJ2xldmVyYWdlJywge1xuICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgbWluOiAxLFxuICAgICAgbWF4OiAxMDBcbiAgICB9KTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIFZhbGlkYXRlIG9wZXJhdG9yIElEXG4gICAqL1xuICBzdGF0aWMgdmFsaWRhdGVPcGVyYXRvcklkKG9wZXJhdG9ySWQ6IHVua25vd24pOiBWYWxpZGF0aW9uUmVzdWx0IHtcbiAgICByZXR1cm4gdGhpcy52YWxpZGF0ZVN0cmluZyhvcGVyYXRvcklkLCAnb3BlcmF0b3JJZCcsIHtcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgbWluTGVuZ3RoOiAzLFxuICAgICAgbWF4TGVuZ3RoOiA1MCxcbiAgICAgIHBhdHRlcm46IC9eW2EtekEtWjAtOV8tXSskLyxcbiAgICAgIHNhbml0aXplOiB0cnVlXG4gICAgfSk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBwYXNzd29yZCAoYmFzaWMgdmFsaWRhdGlvbiAtIHNob3VsZCBiZSBlbmhhbmNlZCBiYXNlZCBvbiBwb2xpY3kpXG4gICAqL1xuICBzdGF0aWMgdmFsaWRhdGVQYXNzd29yZChwYXNzd29yZDogdW5rbm93bik6IFZhbGlkYXRpb25SZXN1bHQge1xuICAgIHJldHVybiB0aGlzLnZhbGlkYXRlU3RyaW5nKHBhc3N3b3JkLCAncGFzc3dvcmQnLCB7XG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIG1pbkxlbmd0aDogOCxcbiAgICAgIG1heExlbmd0aDogMTI4XG4gICAgfSk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBhbGxvY2F0aW9uIHdlaWdodHNcbiAgICovXG4gIHN0YXRpYyB2YWxpZGF0ZUFsbG9jYXRpb25XZWlnaHRzKGFsbG9jYXRpb246IHVua25vd24pOiBWYWxpZGF0aW9uUmVzdWx0IHtcbiAgICBjb25zdCBlcnJvcnM6IHN0cmluZ1tdID0gW107XG4gICAgXG4gICAgaWYgKCFhbGxvY2F0aW9uIHx8IHR5cGVvZiBhbGxvY2F0aW9uICE9PSAnb2JqZWN0Jykge1xuICAgICAgZXJyb3JzLnB1c2goJ2FsbG9jYXRpb24gbXVzdCBiZSBhbiBvYmplY3QnKTtcbiAgICAgIHJldHVybiB7IGlzVmFsaWQ6IGZhbHNlLCBlcnJvcnMgfTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgYWxsb2MgPSBhbGxvY2F0aW9uIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICAgIFxuICAgIC8vIFZhbGlkYXRlIGluZGl2aWR1YWwgd2VpZ2h0c1xuICAgIGNvbnN0IHcxUmVzdWx0ID0gdGhpcy52YWxpZGF0ZU51bWJlcihhbGxvYy53MSwgJ3cxJywgeyByZXF1aXJlZDogdHJ1ZSwgbWluOiAwLCBtYXg6IDEgfSk7XG4gICAgY29uc3QgdzJSZXN1bHQgPSB0aGlzLnZhbGlkYXRlTnVtYmVyKGFsbG9jLncyLCAndzInLCB7IHJlcXVpcmVkOiB0cnVlLCBtaW46IDAsIG1heDogMSB9KTtcbiAgICBjb25zdCB3M1Jlc3VsdCA9IHRoaXMudmFsaWRhdGVOdW1iZXIoYWxsb2MudzMsICd3MycsIHsgcmVxdWlyZWQ6IHRydWUsIG1pbjogMCwgbWF4OiAxIH0pO1xuICAgIFxuICAgIGVycm9ycy5wdXNoKC4uLncxUmVzdWx0LmVycm9ycywgLi4udzJSZXN1bHQuZXJyb3JzLCAuLi53M1Jlc3VsdC5lcnJvcnMpO1xuICAgIFxuICAgIGlmIChlcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIHsgaXNWYWxpZDogZmFsc2UsIGVycm9ycyB9O1xuICAgIH1cbiAgICBcbiAgICAvLyBWYWxpZGF0ZSBzdW0gZXF1YWxzIDEuMFxuICAgIGNvbnN0IHN1bSA9ICh3MVJlc3VsdC5zYW5pdGl6ZWRWYWx1ZSBhcyBudW1iZXIpICsgXG4gICAgICAgICAgICAgICAgKHcyUmVzdWx0LnNhbml0aXplZFZhbHVlIGFzIG51bWJlcikgKyBcbiAgICAgICAgICAgICAgICAodzNSZXN1bHQuc2FuaXRpemVkVmFsdWUgYXMgbnVtYmVyKTtcbiAgICBcbiAgICBpZiAoTWF0aC5hYnMoc3VtIC0gMS4wKSA+IDAuMDAxKSB7XG4gICAgICBlcnJvcnMucHVzaChgYWxsb2NhdGlvbiB3ZWlnaHRzIG11c3Qgc3VtIHRvIDEuMCwgZ290ICR7c3VtLnRvRml4ZWQoMyl9YCk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBpc1ZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxuICAgICAgZXJyb3JzLFxuICAgICAgc2FuaXRpemVkVmFsdWU6IHtcbiAgICAgICAgdzE6IHcxUmVzdWx0LnNhbml0aXplZFZhbHVlLFxuICAgICAgICB3MjogdzJSZXN1bHQuc2FuaXRpemVkVmFsdWUsXG4gICAgICAgIHczOiB3M1Jlc3VsdC5zYW5pdGl6ZWRWYWx1ZVxuICAgICAgfVxuICAgIH07XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBWYWxpZGF0ZSBwZXJtaXNzaW9ucyBhcnJheVxuICAgKi9cbiAgc3RhdGljIHZhbGlkYXRlUGVybWlzc2lvbnMocGVybWlzc2lvbnM6IHVua25vd24pOiBWYWxpZGF0aW9uUmVzdWx0IHtcbiAgICBjb25zdCBhcnJheVJlc3VsdCA9IHRoaXMudmFsaWRhdGVBcnJheShwZXJtaXNzaW9ucywgJ3Blcm1pc3Npb25zJywge1xuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICBtaW5MZW5ndGg6IDEsXG4gICAgICBtYXhMZW5ndGg6IDIwXG4gICAgfSk7XG4gICAgXG4gICAgaWYgKCFhcnJheVJlc3VsdC5pc1ZhbGlkKSB7XG4gICAgICByZXR1cm4gYXJyYXlSZXN1bHQ7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcbiAgICBjb25zdCB2YWxpZFBlcm1pc3Npb25zID0gW1xuICAgICAgJ292ZXJyaWRlOmNyZWF0ZScsXG4gICAgICAnb3ZlcnJpZGU6ZGVhY3RpdmF0ZScsXG4gICAgICAnYnJlYWtlcjpyZXNldCcsXG4gICAgICAnb3BlcmF0b3I6Y3JlYXRlJyxcbiAgICAgICdjb25maWc6dXBkYXRlJ1xuICAgIF07XG4gICAgXG4gICAgY29uc3QgcGVybXMgPSBhcnJheVJlc3VsdC5zYW5pdGl6ZWRWYWx1ZSBhcyBzdHJpbmdbXTtcbiAgICBmb3IgKGNvbnN0IHBlcm0gb2YgcGVybXMpIHtcbiAgICAgIGNvbnN0IHBlcm1SZXN1bHQgPSB0aGlzLnZhbGlkYXRlU3RyaW5nKHBlcm0sICdwZXJtaXNzaW9uJywge1xuICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgYWxsb3dlZFZhbHVlczogdmFsaWRQZXJtaXNzaW9ucyxcbiAgICAgICAgc2FuaXRpemU6IHRydWVcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBpZiAoIXBlcm1SZXN1bHQuaXNWYWxpZCkge1xuICAgICAgICBlcnJvcnMucHVzaCguLi5wZXJtUmVzdWx0LmVycm9ycyk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBpc1ZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxuICAgICAgZXJyb3JzLFxuICAgICAgc2FuaXRpemVkVmFsdWU6IHBlcm1zXG4gICAgfTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIFZhbGlkYXRlIGFuZCBzYW5pdGl6ZSBhIGNvbXBsZXRlIHNpZ25hbCByZXF1ZXN0XG4gICAqL1xuICBzdGF0aWMgdmFsaWRhdGVTaWduYWxSZXF1ZXN0KGJvZHk6IHVua25vd24pOiBWYWxpZGF0aW9uUmVzdWx0IHtcbiAgICBjb25zdCBlcnJvcnM6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3Qgc2FuaXRpemVkQm9keTogUmVjb3JkPHN0cmluZywgdW5rbm93bj4gPSB7fTtcbiAgICBcbiAgICBpZiAoIWJvZHkgfHwgdHlwZW9mIGJvZHkgIT09ICdvYmplY3QnKSB7XG4gICAgICBlcnJvcnMucHVzaCgnUmVxdWVzdCBib2R5IG11c3QgYmUgYW4gb2JqZWN0Jyk7XG4gICAgICByZXR1cm4geyBpc1ZhbGlkOiBmYWxzZSwgZXJyb3JzIH07XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHJlcSA9IGJvZHkgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgXG4gICAgLy8gVmFsaWRhdGUgZWFjaCBmaWVsZFxuICAgIGNvbnN0IHZhbGlkYXRpb25zID0gW1xuICAgICAgeyBmaWVsZDogJ3NpZ25hbElkJywgdmFsaWRhdG9yOiAoKSA9PiB0aGlzLnZhbGlkYXRlU2lnbmFsSWQocmVxLnNpZ25hbElkKSB9LFxuICAgICAgeyBmaWVsZDogJ3BoYXNlSWQnLCB2YWxpZGF0b3I6ICgpID0+IHRoaXMudmFsaWRhdGVQaGFzZUlkKHJlcS5waGFzZUlkKSB9LFxuICAgICAgeyBmaWVsZDogJ3N5bWJvbCcsIHZhbGlkYXRvcjogKCkgPT4gdGhpcy52YWxpZGF0ZVN5bWJvbChyZXEuc3ltYm9sKSB9LFxuICAgICAgeyBmaWVsZDogJ3NpZGUnLCB2YWxpZGF0b3I6ICgpID0+IHRoaXMudmFsaWRhdGVTaWRlKHJlcS5zaWRlKSB9LFxuICAgICAgeyBmaWVsZDogJ3JlcXVlc3RlZFNpemUnLCB2YWxpZGF0b3I6ICgpID0+IHRoaXMudmFsaWRhdGVQb3NpdGlvblNpemUocmVxLnJlcXVlc3RlZFNpemUpIH0sXG4gICAgICB7IGZpZWxkOiAnbGV2ZXJhZ2UnLCB2YWxpZGF0b3I6ICgpID0+IHRoaXMudmFsaWRhdGVMZXZlcmFnZShyZXEubGV2ZXJhZ2UpIH0sXG4gICAgICB7IGZpZWxkOiAndGltZXN0YW1wJywgdmFsaWRhdG9yOiAoKSA9PiB0aGlzLnZhbGlkYXRlTnVtYmVyKHJlcS50aW1lc3RhbXAsICd0aW1lc3RhbXAnLCB7IHJlcXVpcmVkOiBmYWxzZSwgbWluOiAwIH0pIH1cbiAgICBdO1xuICAgIFxuICAgIGZvciAoY29uc3QgeyBmaWVsZCwgdmFsaWRhdG9yIH0gb2YgdmFsaWRhdGlvbnMpIHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHZhbGlkYXRvcigpO1xuICAgICAgaWYgKCFyZXN1bHQuaXNWYWxpZCkge1xuICAgICAgICBlcnJvcnMucHVzaCguLi5yZXN1bHQuZXJyb3JzKTtcbiAgICAgIH0gZWxzZSBpZiAocmVzdWx0LnNhbml0aXplZFZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgc2FuaXRpemVkQm9keVtmaWVsZF0gPSByZXN1bHQuc2FuaXRpemVkVmFsdWU7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBpc1ZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxuICAgICAgZXJyb3JzLFxuICAgICAgc2FuaXRpemVkVmFsdWU6IHNhbml0aXplZEJvZHlcbiAgICB9O1xuICB9XG4gIFxuICAvKipcbiAgICogUmF0ZSBsaW1pdGluZyB2YWxpZGF0aW9uIChjaGVjayBpZiByZXF1ZXN0IHJhdGUgaXMgd2l0aGluIGxpbWl0cylcbiAgICovXG4gIHN0YXRpYyB2YWxpZGF0ZVJhdGVMaW1pdChcbiAgICBjbGllbnRJZDogc3RyaW5nLFxuICAgIHJlcXVlc3RzUGVyTWludXRlOiBudW1iZXIgPSA2MCxcbiAgICB3aW5kb3dNczogbnVtYmVyID0gNjAwMDBcbiAgKTogVmFsaWRhdGlvblJlc3VsdCB7XG4gICAgLy8gVGhpcyBpcyBhIHNpbXBsaWZpZWQgcmF0ZSBsaW1pdGluZyBjaGVja1xuICAgIC8vIEluIHByb2R1Y3Rpb24sIHlvdSB3b3VsZCB1c2UgUmVkaXMgb3Igc2ltaWxhciBmb3IgZGlzdHJpYnV0ZWQgcmF0ZSBsaW1pdGluZ1xuICAgIFxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgY29uc3Qgd2luZG93U3RhcnQgPSBub3cgLSB3aW5kb3dNcztcbiAgICBcbiAgICAvLyBUaGlzIHdvdWxkIHR5cGljYWxseSBiZSBzdG9yZWQgaW4gUmVkaXMgd2l0aCBleHBpcmF0aW9uXG4gICAgLy8gRm9yIG5vdywgd2UnbGwganVzdCByZXR1cm4gc3VjY2VzcyAoaW1wbGVtZW50IHByb3BlciByYXRlIGxpbWl0aW5nIGluIHByb2R1Y3Rpb24pXG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIGlzVmFsaWQ6IHRydWUsXG4gICAgICBlcnJvcnM6IFtdLFxuICAgICAgc2FuaXRpemVkVmFsdWU6IHsgY2xpZW50SWQsIHRpbWVzdGFtcDogbm93IH1cbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogU2VjdXJpdHkgYXVkaXQgbG9nZ2VyIGZvciB2YWxpZGF0aW9uIGZhaWx1cmVzXG4gKi9cbmV4cG9ydCBjbGFzcyBTZWN1cml0eUF1ZGl0TG9nZ2VyIHtcbiAgXG4gIC8qKlxuICAgKiBMb2cgc2VjdXJpdHkgdmFsaWRhdGlvbiBmYWlsdXJlXG4gICAqL1xuICBzdGF0aWMgbG9nVmFsaWRhdGlvbkZhaWx1cmUoXG4gICAgY2xpZW50SXA6IHN0cmluZyxcbiAgICBlbmRwb2ludDogc3RyaW5nLFxuICAgIGVycm9yczogc3RyaW5nW10sXG4gICAgcmVxdWVzdEJvZHk/OiB1bmtub3duXG4gICk6IHZvaWQge1xuICAgIGNvbnN0IGF1ZGl0RXZlbnQgPSB7XG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIGV2ZW50OiAnVkFMSURBVElPTl9GQUlMVVJFJyxcbiAgICAgIGNsaWVudElwLFxuICAgICAgZW5kcG9pbnQsXG4gICAgICBlcnJvcnMsXG4gICAgICAvLyBEb24ndCBsb2cgc2Vuc2l0aXZlIGRhdGEgaW4gYXVkaXQgbG9nc1xuICAgICAgaGFzUmVxdWVzdEJvZHk6ICEhcmVxdWVzdEJvZHksXG4gICAgICBzZXZlcml0eTogJ1dBUk5JTkcnXG4gICAgfTtcbiAgICBcbiAgICBjb25zb2xlLndhcm4oJ1NFQ1VSSVRZX0FVRElUOicsIEpTT04uc3RyaW5naWZ5KGF1ZGl0RXZlbnQpKTtcbiAgfVxuICBcbiAgLyoqXG4gICAqIExvZyBwb3RlbnRpYWwgc2VjdXJpdHkgdGhyZWF0XG4gICAqL1xuICBzdGF0aWMgbG9nU2VjdXJpdHlUaHJlYXQoXG4gICAgY2xpZW50SXA6IHN0cmluZyxcbiAgICBlbmRwb2ludDogc3RyaW5nLFxuICAgIHRocmVhdFR5cGU6IHN0cmluZyxcbiAgICBkZXRhaWxzOiBzdHJpbmdcbiAgKTogdm9pZCB7XG4gICAgY29uc3QgYXVkaXRFdmVudCA9IHtcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgZXZlbnQ6ICdTRUNVUklUWV9USFJFQVQnLFxuICAgICAgY2xpZW50SXAsXG4gICAgICBlbmRwb2ludCxcbiAgICAgIHRocmVhdFR5cGUsXG4gICAgICBkZXRhaWxzLFxuICAgICAgc2V2ZXJpdHk6ICdDUklUSUNBTCdcbiAgICB9O1xuICAgIFxuICAgIGNvbnNvbGUuZXJyb3IoJ1NFQ1VSSVRZX1RIUkVBVDonLCBKU09OLnN0cmluZ2lmeShhdWRpdEV2ZW50KSk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBMb2cgYXV0aGVudGljYXRpb24gZmFpbHVyZVxuICAgKi9cbiAgc3RhdGljIGxvZ0F1dGhlbnRpY2F0aW9uRmFpbHVyZShcbiAgICBjbGllbnRJcDogc3RyaW5nLFxuICAgIG9wZXJhdG9ySWQ6IHN0cmluZyxcbiAgICByZWFzb246IHN0cmluZ1xuICApOiB2b2lkIHtcbiAgICBjb25zdCBhdWRpdEV2ZW50ID0ge1xuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBldmVudDogJ0FVVEhfRkFJTFVSRScsXG4gICAgICBjbGllbnRJcCxcbiAgICAgIG9wZXJhdG9ySWQsXG4gICAgICByZWFzb24sXG4gICAgICBzZXZlcml0eTogJ1dBUk5JTkcnXG4gICAgfTtcbiAgICBcbiAgICBjb25zb2xlLndhcm4oJ0FVVEhfQVVESVQ6JywgSlNPTi5zdHJpbmdpZnkoYXVkaXRFdmVudCkpO1xuICB9XG59Il0sInZlcnNpb24iOjN9