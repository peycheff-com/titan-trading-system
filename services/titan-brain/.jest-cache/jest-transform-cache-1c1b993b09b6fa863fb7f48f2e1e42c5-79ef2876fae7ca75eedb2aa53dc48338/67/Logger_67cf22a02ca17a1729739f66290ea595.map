{"file":"/Users/ivan/Code/trading/titan/services/titan-brain/src/logging/Logger.ts","mappings":"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","names":[],"sources":["/Users/ivan/Code/trading/titan/services/titan-brain/src/logging/Logger.ts"],"sourcesContent":["/**\n * Logger - Structured logging with correlation IDs and performance tracking\n * \n * Provides JSON structured logging with correlation IDs, configurable log levels,\n * sensitive data masking, and performance tracking for Railway deployment.\n * \n * Requirements: 4.1.1, 4.1.2, 4.1.3, 4.1.4, 4.1.5\n */\n\nimport { randomUUID } from 'crypto';\n\n/**\n * Log levels in order of severity\n */\nexport enum LogLevel {\n  DEBUG = 0,\n  INFO = 1,\n  WARN = 2,\n  ERROR = 3,\n  FATAL = 4\n}\n\n/**\n * Log entry structure\n */\nexport interface LogEntry {\n  timestamp: string;\n  level: string;\n  message: string;\n  correlationId?: string;\n  component?: string;\n  operation?: string;\n  duration?: number;\n  metadata?: Record<string, any>;\n  error?: {\n    name: string;\n    message: string;\n    stack?: string;\n    code?: string | number;\n  };\n}\n\n/**\n * Logger configuration\n */\nexport interface LoggerConfig {\n  level: LogLevel;\n  component: string;\n  enableConsole: boolean;\n  enableFile: boolean;\n  filePath?: string;\n  enablePerformanceLogging: boolean;\n  sensitiveFields: string[];\n  maxStackTraceLines: number;\n}\n\n/**\n * Performance timer for operation tracking\n */\nexport interface PerformanceTimer {\n  operation: string;\n  startTime: number;\n  correlationId?: string;\n  metadata?: Record<string, any>;\n}\n\n/**\n * Structured logger with correlation IDs and performance tracking\n */\nexport class Logger {\n  private config: LoggerConfig;\n  private static instance: Logger | null = null;\n  private activeTimers: Map<string, PerformanceTimer> = new Map();\n\n  constructor(config: LoggerConfig) {\n    this.config = config;\n  }\n\n  /**\n   * Create logger configuration from environment variables\n   */\n  static createConfigFromEnv(component: string = 'titan-brain'): LoggerConfig {\n    const logLevelStr = process.env.LOG_LEVEL || 'INFO';\n    const logLevel = LogLevel[logLevelStr.toUpperCase() as keyof typeof LogLevel] ?? LogLevel.INFO;\n\n    return {\n      level: logLevel,\n      component,\n      enableConsole: process.env.LOG_ENABLE_CONSOLE !== 'false',\n      enableFile: process.env.LOG_ENABLE_FILE === 'true',\n      filePath: process.env.LOG_FILE_PATH || './logs/titan-brain.log',\n      enablePerformanceLogging: process.env.LOG_ENABLE_PERFORMANCE !== 'false',\n      sensitiveFields: (process.env.LOG_SENSITIVE_FIELDS || 'password,secret,token,key,authorization').split(','),\n      maxStackTraceLines: parseInt(process.env.LOG_MAX_STACK_LINES || '10')\n    };\n  }\n\n  /**\n   * Get or create singleton logger instance\n   */\n  static getInstance(component?: string): Logger {\n    if (!Logger.instance) {\n      const config = Logger.createConfigFromEnv(component);\n      Logger.instance = new Logger(config);\n    }\n    return Logger.instance;\n  }\n\n  /**\n   * Generate a new correlation ID\n   */\n  static generateCorrelationId(): string {\n    return randomUUID();\n  }\n\n  /**\n   * Mask sensitive data in objects\n   */\n  private maskSensitiveData(obj: any): any {\n    if (obj === null || obj === undefined) {\n      return obj;\n    }\n\n    if (typeof obj === 'string') {\n      // Check if the string looks like a sensitive value\n      const lowerStr = obj.toLowerCase();\n      if (lowerStr.includes('password') || lowerStr.includes('secret') || lowerStr.includes('token')) {\n        return '[MASKED]';\n      }\n      return obj;\n    }\n\n    if (Array.isArray(obj)) {\n      return obj.map(item => this.maskSensitiveData(item));\n    }\n\n    if (typeof obj === 'object') {\n      const masked: any = {};\n      for (const [key, value] of Object.entries(obj)) {\n        const lowerKey = key.toLowerCase();\n        if (this.config.sensitiveFields.some(field => lowerKey.includes(field.toLowerCase()))) {\n          masked[key] = '[MASKED]';\n        } else {\n          masked[key] = this.maskSensitiveData(value);\n        }\n      }\n      return masked;\n    }\n\n    return obj;\n  }\n\n  /**\n   * Format error for logging\n   */\n  private formatError(error: Error): LogEntry['error'] {\n    const stackLines = error.stack?.split('\\n').slice(0, this.config.maxStackTraceLines);\n    \n    return {\n      name: error.name,\n      message: error.message,\n      stack: stackLines?.join('\\n'),\n      code: (error as any).code || (error as any).statusCode\n    };\n  }\n\n  /**\n   * Create log entry\n   */\n  private createLogEntry(\n    level: LogLevel,\n    message: string,\n    correlationId?: string,\n    operation?: string,\n    duration?: number,\n    metadata?: Record<string, any>,\n    error?: Error\n  ): LogEntry {\n    const entry: LogEntry = {\n      timestamp: new Date().toISOString(),\n      level: LogLevel[level],\n      message,\n      component: this.config.component\n    };\n\n    if (correlationId) {\n      entry.correlationId = correlationId;\n    }\n\n    if (operation) {\n      entry.operation = operation;\n    }\n\n    if (duration !== undefined) {\n      entry.duration = duration;\n    }\n\n    if (metadata) {\n      entry.metadata = this.maskSensitiveData(metadata);\n    }\n\n    if (error) {\n      entry.error = this.formatError(error);\n    }\n\n    return entry;\n  }\n\n  /**\n   * Write log entry to outputs\n   */\n  private writeLog(entry: LogEntry): void {\n    const logString = JSON.stringify(entry);\n\n    // Console output\n    if (this.config.enableConsole) {\n      switch (entry.level) {\n        case 'DEBUG':\n          console.debug(logString);\n          break;\n        case 'INFO':\n          console.info(logString);\n          break;\n        case 'WARN':\n          console.warn(logString);\n          break;\n        case 'ERROR':\n        case 'FATAL':\n          console.error(logString);\n          break;\n        default:\n          console.log(logString);\n      }\n    }\n\n    // File output (if enabled)\n    if (this.config.enableFile && this.config.filePath) {\n      // In a production environment, you might want to use a proper logging library\n      // like winston or pino for file rotation and better performance\n      try {\n        const fs = require('fs');\n        const path = require('path');\n        \n        // Ensure log directory exists\n        const logDir = path.dirname(this.config.filePath);\n        if (!fs.existsSync(logDir)) {\n          fs.mkdirSync(logDir, { recursive: true });\n        }\n        \n        fs.appendFileSync(this.config.filePath, logString + '\\n');\n      } catch (error) {\n        console.error('Failed to write to log file:', error);\n      }\n    }\n  }\n\n  /**\n   * Check if log level should be logged\n   */\n  private shouldLog(level: LogLevel): boolean {\n    return level >= this.config.level;\n  }\n\n  /**\n   * Debug logging\n   */\n  debug(message: string, correlationId?: string, metadata?: Record<string, any>): void {\n    if (!this.shouldLog(LogLevel.DEBUG)) return;\n    \n    const entry = this.createLogEntry(LogLevel.DEBUG, message, correlationId, undefined, undefined, metadata);\n    this.writeLog(entry);\n  }\n\n  /**\n   * Info logging\n   */\n  info(message: string, correlationId?: string, metadata?: Record<string, any>): void {\n    if (!this.shouldLog(LogLevel.INFO)) return;\n    \n    const entry = this.createLogEntry(LogLevel.INFO, message, correlationId, undefined, undefined, metadata);\n    this.writeLog(entry);\n  }\n\n  /**\n   * Warning logging\n   */\n  warn(message: string, correlationId?: string, metadata?: Record<string, any>): void {\n    if (!this.shouldLog(LogLevel.WARN)) return;\n    \n    const entry = this.createLogEntry(LogLevel.WARN, message, correlationId, undefined, undefined, metadata);\n    this.writeLog(entry);\n  }\n\n  /**\n   * Error logging\n   */\n  error(message: string, error?: Error, correlationId?: string, metadata?: Record<string, any>): void {\n    if (!this.shouldLog(LogLevel.ERROR)) return;\n    \n    const entry = this.createLogEntry(LogLevel.ERROR, message, correlationId, undefined, undefined, metadata, error);\n    this.writeLog(entry);\n  }\n\n  /**\n   * Fatal error logging\n   */\n  fatal(message: string, error?: Error, correlationId?: string, metadata?: Record<string, any>): void {\n    if (!this.shouldLog(LogLevel.FATAL)) return;\n    \n    const entry = this.createLogEntry(LogLevel.FATAL, message, correlationId, undefined, undefined, metadata, error);\n    this.writeLog(entry);\n  }\n\n  /**\n   * Start performance timer\n   */\n  startTimer(operation: string, correlationId?: string, metadata?: Record<string, any>): string {\n    const timerId = randomUUID();\n    const timer: PerformanceTimer = {\n      operation,\n      startTime: Date.now(),\n      correlationId,\n      metadata\n    };\n    \n    this.activeTimers.set(timerId, timer);\n    \n    if (this.config.enablePerformanceLogging) {\n      this.debug(`Started operation: ${operation}`, correlationId, { \n        timerId, \n        ...metadata \n      });\n    }\n    \n    return timerId;\n  }\n\n  /**\n   * End performance timer and log duration\n   */\n  endTimer(timerId: string, additionalMetadata?: Record<string, any>): number | null {\n    const timer = this.activeTimers.get(timerId);\n    if (!timer) {\n      this.warn(`Timer not found: ${timerId}`);\n      return null;\n    }\n\n    const duration = Date.now() - timer.startTime;\n    this.activeTimers.delete(timerId);\n\n    if (this.config.enablePerformanceLogging) {\n      const metadata = {\n        timerId,\n        ...timer.metadata,\n        ...additionalMetadata\n      };\n\n      const entry = this.createLogEntry(\n        LogLevel.INFO,\n        `Completed operation: ${timer.operation}`,\n        timer.correlationId,\n        timer.operation,\n        duration,\n        metadata\n      );\n      \n      this.writeLog(entry);\n    }\n\n    return duration;\n  }\n\n  /**\n   * Log HTTP request\n   */\n  logHttpRequest(\n    method: string,\n    url: string,\n    statusCode: number,\n    duration: number,\n    correlationId?: string,\n    metadata?: Record<string, any>\n  ): void {\n    const level = statusCode >= 400 ? LogLevel.WARN : LogLevel.INFO;\n    if (!this.shouldLog(level)) return;\n\n    const entry = this.createLogEntry(\n      level,\n      `HTTP ${method} ${url} - ${statusCode}`,\n      correlationId,\n      'http_request',\n      duration,\n      {\n        method,\n        url,\n        statusCode,\n        ...metadata\n      }\n    );\n\n    this.writeLog(entry);\n  }\n\n  /**\n   * Log database operation\n   */\n  logDatabaseOperation(\n    operation: string,\n    table: string,\n    duration: number,\n    rowCount?: number,\n    correlationId?: string,\n    metadata?: Record<string, any>\n  ): void {\n    if (!this.shouldLog(LogLevel.DEBUG)) return;\n\n    const entry = this.createLogEntry(\n      LogLevel.DEBUG,\n      `Database ${operation} on ${table}`,\n      correlationId,\n      'database_operation',\n      duration,\n      {\n        operation,\n        table,\n        rowCount,\n        ...metadata\n      }\n    );\n\n    this.writeLog(entry);\n  }\n\n  /**\n   * Log cache operation\n   */\n  logCacheOperation(\n    operation: string,\n    key: string,\n    hit: boolean,\n    duration: number,\n    correlationId?: string,\n    metadata?: Record<string, any>\n  ): void {\n    if (!this.shouldLog(LogLevel.DEBUG)) return;\n\n    const entry = this.createLogEntry(\n      LogLevel.DEBUG,\n      `Cache ${operation} for ${key} - ${hit ? 'HIT' : 'MISS'}`,\n      correlationId,\n      'cache_operation',\n      duration,\n      {\n        operation,\n        key,\n        hit,\n        ...metadata\n      }\n    );\n\n    this.writeLog(entry);\n  }\n\n  /**\n   * Log security event\n   */\n  logSecurityEvent(\n    event: string,\n    severity: 'low' | 'medium' | 'high' | 'critical',\n    correlationId?: string,\n    metadata?: Record<string, any>\n  ): void {\n    const level = severity === 'critical' ? LogLevel.FATAL : \n                  severity === 'high' ? LogLevel.ERROR :\n                  severity === 'medium' ? LogLevel.WARN : LogLevel.INFO;\n\n    if (!this.shouldLog(level)) return;\n\n    const entry = this.createLogEntry(\n      level,\n      `Security event: ${event}`,\n      correlationId,\n      'security_event',\n      undefined,\n      {\n        event,\n        severity,\n        ...metadata\n      }\n    );\n\n    this.writeLog(entry);\n  }\n\n  /**\n   * Get current configuration\n   */\n  getConfig(): LoggerConfig {\n    return { ...this.config };\n  }\n\n  /**\n   * Update log level\n   */\n  setLogLevel(level: LogLevel): void {\n    this.config.level = level;\n    this.info(`Log level changed to ${LogLevel[level]}`);\n  }\n\n  /**\n   * Get active timer count\n   */\n  getActiveTimerCount(): number {\n    return this.activeTimers.size;\n  }\n\n  /**\n   * Clear all active timers (useful for testing)\n   */\n  clearTimers(): void {\n    this.activeTimers.clear();\n  }\n}"],"version":3}