{"file":"/Users/ivan/Code/trading/titan/services/titan-brain/tests/property/AllocationEngine.property.test.ts","mappings":"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","names":[],"sources":["/Users/ivan/Code/trading/titan/services/titan-brain/tests/property/AllocationEngine.property.test.ts"],"sourcesContent":["/**\n * Property-Based Tests for AllocationEngine\n * \n * Tests correctness properties using fast-check:\n * - Property 1: Allocation Vector Sum Invariant (Req 1.6)\n * - Property 12: Equity Tier Consistency (Req 1.2, 1.3, 1.4, 1.5)\n */\n\nimport * as fc from 'fast-check';\nimport { AllocationEngine } from '../../src/engine/AllocationEngine.js';\nimport { EquityTier } from '../../src/types/index.js';\nimport { defaultConfig } from '../../src/config/defaults.js';\n\ndescribe('AllocationEngine Property Tests', () => {\n  let engine: AllocationEngine;\n\n  beforeEach(() => {\n    engine = new AllocationEngine(defaultConfig.allocationEngine);\n  });\n\n  /**\n   * Property 1: Allocation Vector Sum Invariant\n   * \n   * For any equity level, the sum of all phase weights in the allocation\n   * vector should always equal 1.0 (100% capital allocation).\n   * \n   * Validates: Requirements 1.6\n   */\n  describe('Property 1: Allocation Vector Sum Invariant', () => {\n    it('should always sum to 1.0 for any positive equity', () => {\n      fc.assert(\n        fc.property(\n          fc.float({ min: 0, max: 1000000, noNaN: true }),\n          (equity) => {\n            const weights = engine.getWeights(equity);\n            const sum = weights.w1 + weights.w2 + weights.w3;\n            \n            // Allow for floating point precision (within 1e-10)\n            return Math.abs(sum - 1.0) < 1e-10;\n          }\n        ),\n        { numRuns: 1000 }\n      );\n    });\n\n    it('should always sum to 1.0 for edge case equity values', () => {\n      fc.assert(\n        fc.property(\n          fc.oneof(\n            fc.constant(0),\n            fc.constant(1),\n            fc.constant(1499),\n            fc.constant(1500),\n            fc.constant(1501),\n            fc.constant(4999),\n            fc.constant(5000),\n            fc.constant(5001),\n            fc.constant(24999),\n            fc.constant(25000),\n            fc.constant(25001),\n            fc.constant(49999),\n            fc.constant(50000),\n            fc.constant(50001),\n            fc.constant(100000),\n            fc.constant(1000000)\n          ),\n          (equity) => {\n            const weights = engine.getWeights(equity);\n            const sum = weights.w1 + weights.w2 + weights.w3;\n            \n            return Math.abs(sum - 1.0) < 1e-10;\n          }\n        ),\n        { numRuns: 100 }\n      );\n    });\n\n    it('should have all weights between 0 and 1', () => {\n      fc.assert(\n        fc.property(\n          fc.float({ min: 0, max: 1000000, noNaN: true }),\n          (equity) => {\n            const weights = engine.getWeights(equity);\n            \n            return (\n              weights.w1 >= 0 && weights.w1 <= 1 &&\n              weights.w2 >= 0 && weights.w2 <= 1 &&\n              weights.w3 >= 0 && weights.w3 <= 1\n            );\n          }\n        ),\n        { numRuns: 1000 }\n      );\n    });\n\n    it('should handle negative equity gracefully (treat as 0)', () => {\n      fc.assert(\n        fc.property(\n          fc.float({ min: -1000000, max: 0, noNaN: true }),\n          (equity) => {\n            const weights = engine.getWeights(equity);\n            const sum = weights.w1 + weights.w2 + weights.w3;\n            \n            // Should still sum to 1.0 and default to Phase 1 only\n            return (\n              Math.abs(sum - 1.0) < 1e-10 &&\n              weights.w1 === 1.0 &&\n              weights.w2 === 0.0 &&\n              weights.w3 === 0.0\n            );\n          }\n        ),\n        { numRuns: 100 }\n      );\n    });\n  });\n\n  /**\n   * Property 12: Equity Tier Consistency\n   * \n   * For any equity value, the assigned equity tier should match\n   * the tier boundaries defined in the allocation engine.\n   * \n   * Validates: Requirements 1.2, 1.3, 1.4, 1.5\n   */\n  describe('Property 12: Equity Tier Consistency', () => {\n    it('should assign MICRO tier for equity < $1,500', () => {\n      fc.assert(\n        fc.property(\n          fc.float({ min: 0, max: Math.fround(1499.99), noNaN: true }),\n          (equity) => {\n            const tier = engine.getEquityTier(equity);\n            return tier === EquityTier.MICRO;\n          }\n        ),\n        { numRuns: 500 }\n      );\n    });\n\n    it('should assign SMALL tier for equity $1,500 - $4,999.99', () => {\n      fc.assert(\n        fc.property(\n          fc.float({ min: 1500, max: Math.fround(4999.99), noNaN: true }),\n          (equity) => {\n            const tier = engine.getEquityTier(equity);\n            return tier === EquityTier.SMALL;\n          }\n        ),\n        { numRuns: 500 }\n      );\n    });\n\n    it('should assign MEDIUM tier for equity $5,000 - $24,999.99', () => {\n      fc.assert(\n        fc.property(\n          fc.float({ min: 5000, max: Math.fround(24999.99), noNaN: true }),\n          (equity) => {\n            const tier = engine.getEquityTier(equity);\n            return tier === EquityTier.MEDIUM;\n          }\n        ),\n        { numRuns: 500 }\n      );\n    });\n\n    it('should assign LARGE tier for equity $25,000 - $49,999.99', () => {\n      fc.assert(\n        fc.property(\n          fc.float({ min: 25000, max: Math.fround(49999.99), noNaN: true }),\n          (equity) => {\n            const tier = engine.getEquityTier(equity);\n            return tier === EquityTier.LARGE;\n          }\n        ),\n        { numRuns: 500 }\n      );\n    });\n\n    it('should assign INSTITUTIONAL tier for equity >= $50,000', () => {\n      fc.assert(\n        fc.property(\n          fc.float({ min: 50000, max: 10000000, noNaN: true }),\n          (equity) => {\n            const tier = engine.getEquityTier(equity);\n            return tier === EquityTier.INSTITUTIONAL;\n          }\n        ),\n        { numRuns: 500 }\n      );\n    });\n\n    it('should have consistent tier boundaries (no gaps or overlaps)', () => {\n      fc.assert(\n        fc.property(\n          fc.float({ min: 0, max: 100000, noNaN: true }),\n          (equity) => {\n            const tier = engine.getEquityTier(equity);\n            \n            // Verify tier is one of the valid values\n            const validTiers = [\n              EquityTier.MICRO,\n              EquityTier.SMALL,\n              EquityTier.MEDIUM,\n              EquityTier.LARGE,\n              EquityTier.INSTITUTIONAL,\n            ];\n            \n            return validTiers.includes(tier);\n          }\n        ),\n        { numRuns: 1000 }\n      );\n    });\n\n    it('should handle negative equity as MICRO tier', () => {\n      fc.assert(\n        fc.property(\n          fc.float({ min: -1000000, max: 0, noNaN: true }),\n          (equity) => {\n            const tier = engine.getEquityTier(equity);\n            return tier === EquityTier.MICRO;\n          }\n        ),\n        { numRuns: 100 }\n      );\n    });\n  });\n\n  /**\n   * Additional Property: Leverage Cap Consistency\n   * \n   * For any equity value, the max leverage should match the tier's cap.\n   */\n  describe('Leverage Cap Consistency', () => {\n    it('should return correct leverage cap for each tier', () => {\n      fc.assert(\n        fc.property(\n          fc.float({ min: 0, max: 100000, noNaN: true }),\n          (equity) => {\n            const tier = engine.getEquityTier(equity);\n            const maxLeverage = engine.getMaxLeverage(equity);\n            const leverageCaps = engine.getLeverageCaps();\n            \n            return maxLeverage === leverageCaps[tier];\n          }\n        ),\n        { numRuns: 1000 }\n      );\n    });\n\n    it('should have decreasing leverage caps as equity increases', () => {\n      fc.assert(\n        fc.property(\n          fc.tuple(\n            fc.float({ min: 0, max: 50000, noNaN: true }),\n            fc.float({ min: 0, max: 50000, noNaN: true })\n          ),\n          ([equity1, equity2]) => {\n            const leverage1 = engine.getMaxLeverage(equity1);\n            const leverage2 = engine.getMaxLeverage(equity2);\n            \n            // If equity1 < equity2, leverage1 should be >= leverage2\n            // (higher equity = lower leverage allowed)\n            if (equity1 < equity2) {\n              return leverage1 >= leverage2;\n            }\n            return leverage2 >= leverage1;\n          }\n        ),\n        { numRuns: 500 }\n      );\n    });\n  });\n\n  /**\n   * Additional Property: Allocation Monotonicity\n   * \n   * Phase 1 weight should decrease as equity increases (in general trend).\n   * Phase 2 weight should increase then stabilize.\n   * Phase 3 weight should only appear at high equity.\n   */\n  describe('Allocation Monotonicity', () => {\n    it('should have Phase 1 weight = 1.0 below $1,500', () => {\n      fc.assert(\n        fc.property(\n          fc.float({ min: 0, max: 1499, noNaN: true }),\n          (equity) => {\n            const weights = engine.getWeights(equity);\n            return weights.w1 === 1.0 && weights.w2 === 0.0 && weights.w3 === 0.0;\n          }\n        ),\n        { numRuns: 500 }\n      );\n    });\n\n    it('should have Phase 3 weight = 0 below $25,000', () => {\n      fc.assert(\n        fc.property(\n          fc.float({ min: 0, max: 24999, noNaN: true }),\n          (equity) => {\n            const weights = engine.getWeights(equity);\n            return weights.w3 === 0.0;\n          }\n        ),\n        { numRuns: 500 }\n      );\n    });\n\n    it('should have Phase 3 weight > 0 above $25,000', () => {\n      fc.assert(\n        fc.property(\n          fc.float({ min: 25001, max: 1000000, noNaN: true }),\n          (equity) => {\n            const weights = engine.getWeights(equity);\n            return weights.w3 > 0;\n          }\n        ),\n        { numRuns: 500 }\n      );\n    });\n  });\n});\n"],"version":3}