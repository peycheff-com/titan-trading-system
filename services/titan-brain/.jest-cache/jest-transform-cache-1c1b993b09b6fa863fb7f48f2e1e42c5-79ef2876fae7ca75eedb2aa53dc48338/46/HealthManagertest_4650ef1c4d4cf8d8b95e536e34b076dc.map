{"file":"/Users/ivan/Code/trading/titan/services/titan-brain/tests/health/HealthManager.test.ts","mappings":"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","names":[],"sources":["/Users/ivan/Code/trading/titan/services/titan-brain/tests/health/HealthManager.test.ts"],"sourcesContent":["/**\n * Unit tests for HealthManager\n */\n\nimport {\n  HealthManager,\n  HealthStatus,\n  HealthComponent,\n  ComponentHealth,\n  DatabaseHealthComponent,\n  ConfigHealthComponent,\n  MemoryHealthComponent,\n  RedisHealthComponent\n} from '../../src/health/HealthManager';\n\n// Mock database manager\nconst mockDatabaseManager = {\n  isHealthy: jest.fn(),\n  getMetrics: jest.fn()\n};\n\n// Mock cache manager\nconst mockCacheManager = {\n  isHealthy: jest.fn()\n};\n\n// Mock config\nconst mockConfig = {\n  port: 3000,\n  nodeEnv: 'test'\n};\n\ndescribe('HealthManager', () => {\n  let healthManager: HealthManager;\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n    healthManager = new HealthManager();\n  });\n\n  afterEach(() => {\n    healthManager.shutdown();\n  });\n\n  describe('component registration', () => {\n    it('should register and unregister components', () => {\n      const component: HealthComponent = {\n        name: 'test',\n        check: jest.fn(),\n        isRequired: true,\n        timeout: 1000\n      };\n\n      const registerSpy = jest.fn();\n      const unregisterSpy = jest.fn();\n      \n      healthManager.on('component:registered', registerSpy);\n      healthManager.on('component:unregistered', unregisterSpy);\n\n      healthManager.registerComponent(component);\n      expect(registerSpy).toHaveBeenCalledWith({ name: 'test' });\n\n      healthManager.unregisterComponent('test');\n      expect(unregisterSpy).toHaveBeenCalledWith({ name: 'test' });\n    });\n  });\n\n  describe('health checks', () => {\n    it('should perform health check on all components', async () => {\n      const mockComponent: HealthComponent = {\n        name: 'test',\n        check: jest.fn().mockResolvedValue({\n          name: 'test',\n          status: HealthStatus.HEALTHY,\n          message: 'Test component healthy',\n          duration: 10,\n          timestamp: Date.now()\n        }),\n        isRequired: true,\n        timeout: 1000\n      };\n\n      healthManager.registerComponent(mockComponent);\n      \n      const health = await healthManager.checkHealth();\n      \n      expect(health.status).toBe(HealthStatus.HEALTHY);\n      expect(health.components).toHaveLength(1);\n      expect(health.components[0].name).toBe('test');\n      expect(health.version).toBeDefined();\n      expect(health.uptime).toBeGreaterThanOrEqual(0);\n    });\n\n    it('should handle component timeout', async () => {\n      const slowComponent: HealthComponent = {\n        name: 'slow',\n        check: jest.fn().mockImplementation(() => \n          new Promise(resolve => setTimeout(resolve, 2000))\n        ),\n        isRequired: true,\n        timeout: 100\n      };\n\n      healthManager.registerComponent(slowComponent);\n      \n      const health = await healthManager.checkHealth();\n      \n      expect(health.status).toBe(HealthStatus.UNHEALTHY);\n      expect(health.components[0].status).toBe(HealthStatus.UNHEALTHY);\n      expect(health.components[0].message).toContain('timeout');\n    });\n\n    it('should determine overall status correctly', async () => {\n      const healthyComponent: HealthComponent = {\n        name: 'healthy',\n        check: jest.fn().mockResolvedValue({\n          name: 'healthy',\n          status: HealthStatus.HEALTHY,\n          message: 'OK',\n          duration: 10,\n          timestamp: Date.now()\n        }),\n        isRequired: true,\n        timeout: 1000\n      };\n\n      const unhealthyComponent: HealthComponent = {\n        name: 'unhealthy',\n        check: jest.fn().mockResolvedValue({\n          name: 'unhealthy',\n          status: HealthStatus.UNHEALTHY,\n          message: 'Failed',\n          duration: 10,\n          timestamp: Date.now()\n        }),\n        isRequired: true,\n        timeout: 1000\n      };\n\n      healthManager.registerComponent(healthyComponent);\n      healthManager.registerComponent(unhealthyComponent);\n      \n      const health = await healthManager.checkHealth();\n      \n      expect(health.status).toBe(HealthStatus.UNHEALTHY);\n    });\n\n    it('should cache health results', async () => {\n      const component: HealthComponent = {\n        name: 'test',\n        check: jest.fn().mockResolvedValue({\n          name: 'test',\n          status: HealthStatus.HEALTHY,\n          message: 'OK',\n          duration: 10,\n          timestamp: Date.now()\n        }),\n        isRequired: true,\n        timeout: 1000\n      };\n\n      healthManager.registerComponent(component);\n      \n      // First call\n      const health1 = await healthManager.checkHealth();\n      // Second call (should use cache)\n      const health2 = await healthManager.checkHealth();\n      \n      expect(component.check).toHaveBeenCalledTimes(1);\n      expect(health1.timestamp).toBe(health2.timestamp);\n    });\n  });\n\n  describe('periodic checks', () => {\n    it('should start and stop periodic checks', () => {\n      const startSpy = jest.fn();\n      const stopSpy = jest.fn();\n      \n      healthManager.on('periodic:started', startSpy);\n      healthManager.on('periodic:stopped', stopSpy);\n\n      healthManager.startPeriodicChecks();\n      expect(startSpy).toHaveBeenCalled();\n\n      healthManager.stopPeriodicChecks();\n      expect(stopSpy).toHaveBeenCalled();\n    });\n  });\n\n  describe('utility methods', () => {\n    it('should return uptime', async () => {\n      // Wait a small amount to ensure uptime > 0\n      await new Promise(resolve => setTimeout(resolve, 1));\n      const uptime = healthManager.getUptime();\n      expect(uptime).toBeGreaterThanOrEqual(0);\n    });\n\n    it('should return last health check', async () => {\n      expect(healthManager.getLastHealthCheck()).toBeNull();\n      \n      await healthManager.checkHealth();\n      \n      expect(healthManager.getLastHealthCheck()).not.toBeNull();\n    });\n\n    it('should check if system is healthy', async () => {\n      const healthyComponent: HealthComponent = {\n        name: 'test',\n        check: jest.fn().mockResolvedValue({\n          name: 'test',\n          status: HealthStatus.HEALTHY,\n          message: 'OK',\n          duration: 10,\n          timestamp: Date.now()\n        }),\n        isRequired: true,\n        timeout: 1000\n      };\n\n      healthManager.registerComponent(healthyComponent);\n      await healthManager.checkHealth();\n      \n      expect(healthManager.isHealthy()).toBe(true);\n    });\n  });\n});\n\ndescribe('DatabaseHealthComponent', () => {\n  let component: DatabaseHealthComponent;\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n    component = new DatabaseHealthComponent(mockDatabaseManager);\n  });\n\n  it('should report healthy when database is healthy', async () => {\n    mockDatabaseManager.isHealthy.mockReturnValue(true);\n    mockDatabaseManager.getMetrics.mockReturnValue({\n      totalConnections: 5,\n      idleConnections: 3,\n      successfulQueries: 100,\n      failedQueries: 0\n    });\n\n    const result = await component.check();\n\n    expect(result.status).toBe(HealthStatus.HEALTHY);\n    expect(result.name).toBe('database');\n    expect(result.details).toEqual({\n      totalConnections: 5,\n      idleConnections: 3,\n      successfulQueries: 100,\n      failedQueries: 0\n    });\n  });\n\n  it('should report unhealthy when database is unhealthy', async () => {\n    mockDatabaseManager.isHealthy.mockReturnValue(false);\n    mockDatabaseManager.getMetrics.mockReturnValue({\n      connectionErrors: 5,\n      lastHealthCheck: Date.now()\n    });\n\n    const result = await component.check();\n\n    expect(result.status).toBe(HealthStatus.UNHEALTHY);\n    expect(result.message).toContain('unhealthy');\n  });\n\n  it('should report unhealthy when database manager is not initialized', async () => {\n    const component = new DatabaseHealthComponent(null);\n    \n    const result = await component.check();\n\n    expect(result.status).toBe(HealthStatus.UNHEALTHY);\n    expect(result.message).toContain('not initialized');\n  });\n});\n\ndescribe('ConfigHealthComponent', () => {\n  let component: ConfigHealthComponent;\n\n  beforeEach(() => {\n    component = new ConfigHealthComponent(mockConfig);\n  });\n\n  it('should report healthy when configuration is valid', async () => {\n    const result = await component.check();\n\n    expect(result.status).toBe(HealthStatus.HEALTHY);\n    expect(result.name).toBe('configuration');\n    expect(result.details).toEqual({\n      nodeEnv: 'test',\n      port: 3000\n    });\n  });\n\n  it('should report unhealthy when required fields are missing', async () => {\n    const invalidConfig = { nodeEnv: 'test' }; // missing port\n    const component = new ConfigHealthComponent(invalidConfig);\n    \n    const result = await component.check();\n\n    expect(result.status).toBe(HealthStatus.UNHEALTHY);\n    expect(result.message).toContain('Missing required configuration');\n    expect(result.details?.missingFields).toContain('port');\n  });\n});\n\ndescribe('MemoryHealthComponent', () => {\n  let component: MemoryHealthComponent;\n\n  beforeEach(() => {\n    component = new MemoryHealthComponent();\n  });\n\n  it('should report healthy when memory usage is normal', async () => {\n    // Mock process.memoryUsage to return normal values\n    const originalMemoryUsage = process.memoryUsage;\n    (process as any).memoryUsage = jest.fn().mockReturnValue({\n      heapUsed: 50 * 1024 * 1024, // 50MB\n      heapTotal: 100 * 1024 * 1024, // 100MB (50% usage)\n      external: 10 * 1024 * 1024,\n      rss: 80 * 1024 * 1024,\n      arrayBuffers: 5 * 1024 * 1024\n    });\n\n    const result = await component.check();\n\n    expect(result.status).toBe(HealthStatus.HEALTHY);\n    expect(result.name).toBe('memory');\n    expect(result.details?.usagePercentage).toBe(50);\n\n    process.memoryUsage = originalMemoryUsage;\n  });\n\n  it('should report degraded when memory usage is high', async () => {\n    const originalMemoryUsage = process.memoryUsage;\n    (process as any).memoryUsage = jest.fn().mockReturnValue({\n      heapUsed: 85 * 1024 * 1024, // 85MB\n      heapTotal: 100 * 1024 * 1024, // 100MB (85% usage)\n      external: 10 * 1024 * 1024,\n      rss: 120 * 1024 * 1024,\n      arrayBuffers: 5 * 1024 * 1024\n    });\n\n    const result = await component.check();\n\n    expect(result.status).toBe(HealthStatus.DEGRADED);\n    expect(result.message).toContain('High memory usage');\n\n    process.memoryUsage = originalMemoryUsage;\n  });\n\n  it('should report unhealthy when memory usage is critical', async () => {\n    const originalMemoryUsage = process.memoryUsage;\n    (process as any).memoryUsage = jest.fn().mockReturnValue({\n      heapUsed: 95 * 1024 * 1024, // 95MB\n      heapTotal: 100 * 1024 * 1024, // 100MB (95% usage)\n      external: 10 * 1024 * 1024,\n      rss: 150 * 1024 * 1024,\n      arrayBuffers: 5 * 1024 * 1024\n    });\n\n    const result = await component.check();\n\n    expect(result.status).toBe(HealthStatus.UNHEALTHY);\n    expect(result.message).toContain('Critical memory usage');\n\n    process.memoryUsage = originalMemoryUsage;\n  });\n});\n\ndescribe('RedisHealthComponent', () => {\n  let component: RedisHealthComponent;\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n    component = new RedisHealthComponent(mockCacheManager);\n  });\n\n  it('should report healthy when Redis is available', async () => {\n    mockCacheManager.isHealthy.mockResolvedValue(true);\n\n    const result = await component.check();\n\n    expect(result.status).toBe(HealthStatus.HEALTHY);\n    expect(result.name).toBe('redis');\n    expect(result.message).toContain('healthy');\n  });\n\n  it('should report degraded when Redis is unavailable', async () => {\n    mockCacheManager.isHealthy.mockResolvedValue(false);\n\n    const result = await component.check();\n\n    expect(result.status).toBe(HealthStatus.DEGRADED);\n    expect(result.message).toContain('unavailable');\n  });\n\n  it('should report degraded when Redis is not configured', async () => {\n    const component = new RedisHealthComponent();\n    \n    const result = await component.check();\n\n    expect(result.status).toBe(HealthStatus.DEGRADED);\n    expect(result.message).toContain('not configured');\n  });\n\n  it('should report degraded when Redis check fails', async () => {\n    mockCacheManager.isHealthy.mockRejectedValue(new Error('Connection failed'));\n\n    const result = await component.check();\n\n    expect(result.status).toBe(HealthStatus.DEGRADED);\n    expect(result.message).toContain('check failed');\n  });\n});"],"version":3}