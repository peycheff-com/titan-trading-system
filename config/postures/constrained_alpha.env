# =============================================================================
# TITAN PRODUCTION LAUNCH POSTURE - CONSTRAINED ALPHA
# =============================================================================
# This configuration defines the explicit constraints for first live cutover.
# All caps are hard limits that cannot be exceeded even if strategy requests more.
#
# POSTURE: Single venue, 1-3 symbols, minimal leverage, default disarmed
# =============================================================================

# -----------------------------------------------------------------------------
# IDENTITY & MODE
# -----------------------------------------------------------------------------
TITAN_ENVIRONMENT=production
TITAN_POSTURE=constrained_alpha
TITAN_DEFAULT_ARMED=false
TITAN_REQUIRE_EXPLICIT_ARM=true

# -----------------------------------------------------------------------------
# VENUE CONSTRAINTS
# -----------------------------------------------------------------------------
# Single venue only for initial rollout
TITAN_ALLOWED_VENUES=binance
TITAN_MAX_VENUES=1

# -----------------------------------------------------------------------------
# SYMBOL WHITELIST
# -----------------------------------------------------------------------------
# Limit to 3 most liquid symbols initially
TITAN_SYMBOL_WHITELIST=BTCUSDT,ETHUSDT,SOLUSDT
TITAN_MAX_SYMBOLS=3

# -----------------------------------------------------------------------------
# POSITION LIMITS (HARD CAPS)
# -----------------------------------------------------------------------------
# These are absolute ceilings - cannot be exceeded under any circumstance
TITAN_MAX_POSITION_NOTIONAL_USD=5000
TITAN_MAX_TOTAL_EXPOSURE_USD=10000
TITAN_MAX_SINGLE_ORDER_SIZE_USD=1000
TITAN_MAX_LEVERAGE=2
TITAN_MAX_OPEN_ORDERS=5

# -----------------------------------------------------------------------------
# LOSS LIMITS (DAILY)
# -----------------------------------------------------------------------------
# Daily loss triggers automatic HALT
TITAN_DAILY_LOSS_LIMIT_USD=500
TITAN_DAILY_LOSS_LIMIT_PERCENT=5
TITAN_HALT_ON_DAILY_LOSS=true

# -----------------------------------------------------------------------------
# RATE LIMITS
# -----------------------------------------------------------------------------
TITAN_MAX_ORDERS_PER_MINUTE=10
TITAN_MAX_ORDERS_PER_HOUR=100
TITAN_MIN_ORDER_INTERVAL_MS=1000

# -----------------------------------------------------------------------------
# STALENESS GATES
# -----------------------------------------------------------------------------
# Reject signals older than threshold
TITAN_SIGNAL_STALENESS_MS=5000
TITAN_PRICE_STALENESS_MS=2000
TITAN_HALT_ON_STALE_DATA=true

# -----------------------------------------------------------------------------
# PHASE RESTRICTIONS
# -----------------------------------------------------------------------------
# Disable aggressive phases for initial rollout
TITAN_PHASE1_ENABLED=true
TITAN_PHASE2_ENABLED=false
TITAN_PHASE3_ENABLED=false

# -----------------------------------------------------------------------------
# RECONCILIATION
# -----------------------------------------------------------------------------
TITAN_RECONCILE_INTERVAL_MS=30000
TITAN_RECONCILE_TOLERANCE_USD=10
TITAN_HALT_ON_RECONCILE_MISMATCH=true

# -----------------------------------------------------------------------------
# CIRCUIT BREAKERS
# -----------------------------------------------------------------------------
TITAN_CIRCUIT_BREAKER_ENABLED=true
TITAN_CB_ORDER_REJECT_THRESHOLD=5
TITAN_CB_LATENCY_THRESHOLD_MS=5000
TITAN_CB_RECOVERY_TIME_MS=60000

# -----------------------------------------------------------------------------
# SECURITY
# -----------------------------------------------------------------------------
# HMAC_SECRET must be set - see secrets manager
# TITAN_HMAC_SECRET=<from-secrets-manager>
TITAN_REQUIRE_SIGNED_COMMANDS=true
TITAN_POLICY_HASH_ENFORCEMENT=true

# -----------------------------------------------------------------------------
# MONITORING
# -----------------------------------------------------------------------------
TITAN_METRICS_ENABLED=true
TITAN_METRICS_PORT=9090
TITAN_HEALTH_PORT=8080

# -----------------------------------------------------------------------------
# ALERTS (10 Survival Alerts Only)
# -----------------------------------------------------------------------------
TITAN_ALERT_CHANNELS=pagerduty,telegram
TITAN_SURVIVAL_ALERTS_ONLY=true

# Survival alert list (routed to wake-up channel):
# 1. policy_hash_mismatch
# 2. exchange_connectivity_lost
# 3. jetstream_disk_critical
# 4. drawdown_breach
# 5. circuit_breaker_tripped
# 6. reconcile_mismatch
# 7. event_lag_critical
# 8. order_reject_spike
# 9. leverage_breach
# 10. service_down

# -----------------------------------------------------------------------------
# CUTOVER CRITERIA (Metric-based promotion)
# -----------------------------------------------------------------------------
# Promote to next posture only when ALL are true over 100+ trades:
#
# CUTOVER_UNSIGNED_COMMANDS_ACCEPTED=0
# CUTOVER_POLICY_HASH_MISMATCHES=0
# CUTOVER_RECONCILE_MISMATCH_RATE<0.01
# CUTOVER_ORDER_LIFECYCLE_COMPLETENESS>0.99
# CUTOVER_EVENT_LAG_P99_MS<1000
# CUTOVER_SLIPPAGE_BPS<50
# CUTOVER_P0_ALERTS_UNACKED=0
